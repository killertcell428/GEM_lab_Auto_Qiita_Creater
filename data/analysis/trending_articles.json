{
  "fetched_at": "2025-12-11T13:46:45.130884",
  "articles": [
    {
      "rendered_body": "<p data-sourcepos=\"1:1-2:132\">この記事は<strong>株式会社ドットログ</strong>による<br>\n<a href=\"https://qiita.com/advent-calendar/2025/dotlog\">コンストラク体操日記 Advent Calendar 2025</a> の 11日目 の記事です。</p>\n<h2 data-sourcepos=\"4:1-4:15\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h2>\n<p data-sourcepos=\"6:1-6:147\">「MAS」について調べていたら、「MoA」と「MAS」がごちゃついて頭の整理のメモ程度で記事を書いてみました。</p>\n<p data-sourcepos=\"9:1-9:603\">正直に言うと、私はこの2つの用語を完全に混同していました。どっちも「マルチエージェント」っぽいし、どっちも「複数のAIが協力する」みたいな話っぽく感じました。調べていくうちに**「あ、これって親子関係なんや」**ということがわかったりして整理できてスッキリしたので、同じように混乱している人はなかなか少ないと思いますが、MoAとMASのどちらか一方でも分かっていない人には、input材料として焼くだけていただければ幸いです。</p>\n<div data-sourcepos=\"11:1-16:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"12:1-12:34\"><strong>この記事でわかること</strong></p>\n<ul data-sourcepos=\"13:1-15:45\">\n<li data-sourcepos=\"13:1-13:47\">MASとMoAの違い（結論：親子関係）</li>\n<li data-sourcepos=\"14:1-14:38\">ついでにMoEとの違いも整理</li>\n<li data-sourcepos=\"15:1-15:45\">2025年時点での具体的な活用事例</li>\n</ul>\n</div>\n</div>\n<h2 data-sourcepos=\"18:1-18:103\">\n<span id=\"結論masが親moaが子みたいな感じ-masがでかい要素moaがその中の一部\" class=\"fragment\"></span><a href=\"#%E7%B5%90%E8%AB%96mas%E3%81%8C%E8%A6%AAmoa%E3%81%8C%E5%AD%90%E3%81%BF%E3%81%9F%E3%81%84%E3%81%AA%E6%84%9F%E3%81%98-mas%E3%81%8C%E3%81%A7%E3%81%8B%E3%81%84%E8%A6%81%E7%B4%A0moa%E3%81%8C%E3%81%9D%E3%81%AE%E4%B8%AD%E3%81%AE%E4%B8%80%E9%83%A8\"><i class=\"fa fa-link\"></i></a>結論：MASが親、MoAが子みたいな感じ→ MASがでかい要素、MoAがその中の一部</h2>\n<p data-sourcepos=\"20:1-20:73\">先に結論を言うと、この2つの関係はシンプルでした。</p>\n<p data-sourcepos=\"22:1-22:85\"><strong>MASは「広い概念」、MoAは「具体的な手法」。MoAはMASの一種。</strong></p>\n<table data-sourcepos=\"24:1-28:92\">\n<thead>\n<tr data-sourcepos=\"24:1-24:46\">\n<th data-sourcepos=\"24:2-24:9\">用語</th>\n<th data-sourcepos=\"24:11-24:24\">正式名称</th>\n<th data-sourcepos=\"24:26-24:45\">一言で言うと</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"26:1-26:77\">\n<td data-sourcepos=\"26:2-26:10\"><strong>MAS</strong></td>\n<td data-sourcepos=\"26:12-26:31\">Multi-Agent System</td>\n<td data-sourcepos=\"26:33-26:76\">複数AIが協力する仕組み<strong>全般</strong>\n</td>\n</tr>\n<tr data-sourcepos=\"27:1-27:92\">\n<td data-sourcepos=\"27:2-27:10\"><strong>MoA</strong></td>\n<td data-sourcepos=\"27:12-27:30\">Mixture of Agents</td>\n<td data-sourcepos=\"27:32-27:91\">LLMを階層的に組み合わせる<strong>具体的な手法</strong>\n</td>\n</tr>\n<tr data-sourcepos=\"28:1-28:92\">\n<td data-sourcepos=\"28:2-28:6\">MoE</td>\n<td data-sourcepos=\"28:8-28:27\">Mixture of Experts</td>\n<td data-sourcepos=\"28:29-28:91\">モデル内部で専門家を選ぶ仕組み（<strong>別物</strong>）</td>\n</tr>\n</tbody>\n</table>\n<div data-sourcepos=\"32:1-34:3\" class=\"note warn\">\n<span class=\"fa fa-fw fa-exclamation-circle\"></span><div>\n<p data-sourcepos=\"33:1-33:63\">※MoEについては最後くらいに軽く触れます、、</p>\n</div>\n</div>\n<hr data-sourcepos=\"36:1-37:0\">\n<h2 data-sourcepos=\"38:1-38:63\">\n<span id=\"masマルチエージェントシステムって何\" class=\"fragment\"></span><a href=\"#mas%E3%83%9E%E3%83%AB%E3%83%81%E3%82%A8%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%B3%E3%83%88%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%81%A3%E3%81%A6%E4%BD%95\"><i class=\"fa fa-link\"></i></a>MAS（マルチエージェントシステム）って何？</h2>\n<h3 data-sourcepos=\"40:1-40:25\">\n<span id=\"ざっくり言うと\" class=\"fragment\"></span><a href=\"#%E3%81%96%E3%81%A3%E3%81%8F%E3%82%8A%E8%A8%80%E3%81%86%E3%81%A8\"><i class=\"fa fa-link\"></i></a>ざっくり言うと</h3>\n<p data-sourcepos=\"42:1-42:99\"><strong>複数のAIエージェントが協力して問題を解決するシステムの総称</strong>です。</p>\n<p data-sourcepos=\"44:1-44:144\">1970年代から研究されている歴史ある分野で、「生成AIの時代に急に出てきた概念」ではありませんでした。</p>\n<div data-sourcepos=\"46:1-49:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"47:1-48:236\"><strong>私が勘違いしてたこと</strong><br>\nMASは「最近のLLMブームで生まれた概念」だと思ってましたが、50年近い歴史がありました。ロボット工学や交通システムなど、LLM以外の分野でも昔から使われていたようです。</p>\n</div>\n</div>\n<h3 data-sourcepos=\"51:1-51:10\">\n<span id=\"特徴\" class=\"fragment\"></span><a href=\"#%E7%89%B9%E5%BE%B4\"><i class=\"fa fa-link\"></i></a>特徴</h3>\n<ul data-sourcepos=\"53:1-56:0\">\n<li data-sourcepos=\"53:1-53:87\">\n<strong>複数のエージェントがいる</strong>：1つじゃなくて、複数のAIが動く</li>\n<li data-sourcepos=\"54:1-54:84\">\n<strong>それぞれが自律的</strong>：各エージェントが自分で判断して動く</li>\n<li data-sourcepos=\"55:1-56:0\">\n<strong>協力・分担する</strong>：情報を共有したり、役割分担したりする</li>\n</ul>\n<h3 data-sourcepos=\"57:1-57:32\">\n<span id=\"2025年時点での具体例\" class=\"fragment\"></span><a href=\"#2025%E5%B9%B4%E6%99%82%E7%82%B9%E3%81%A7%E3%81%AE%E5%85%B7%E4%BD%93%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>2025年時点での具体例</h3>\n<p data-sourcepos=\"59:1-59:90\">調べてみると、最近はこんなサービスがMASを使っているようです。</p>\n<ul data-sourcepos=\"61:1-65:0\">\n<li data-sourcepos=\"61:1-61:80\">\n<strong>Gemini Enterprise</strong>：Googleの汎用マルチエージェントシステム</li>\n<li data-sourcepos=\"62:1-62:52\">\n<strong>Microsoft Magentic-One</strong>：Microsoftの汎用MAS</li>\n<li data-sourcepos=\"63:1-63:77\">\n<strong>OpenAI Operator</strong>：ブラウザ操作などを行うAIエージェント</li>\n<li data-sourcepos=\"64:1-65:0\">\n<strong>Anthropic Claude Computer Use</strong>：PCを操作できるAIエージェント</li>\n</ul>\n<p data-sourcepos=\"66:1-66:135\">他にも、自動運転車同士の連携とか、Amazonの倉庫ロボットの協調動作なんかもMASの一種らしいです。</p>\n<h3 data-sourcepos=\"68:1-68:16\">\n<span id=\"ポイント\" class=\"fragment\"></span><a href=\"#%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\"><i class=\"fa fa-link\"></i></a>ポイント</h3>\n<p data-sourcepos=\"70:1-70:202\">MASは「考え方・設計思想」です。AIにおいてでいうと、MASは「複数のAIを協力させよう」という大きな枠組みであり、具体的なやり方は色々あります。</p>\n<hr data-sourcepos=\"72:1-73:0\">\n<h2 data-sourcepos=\"74:1-74:41\">\n<span id=\"moamixture-of-agentsって何\" class=\"fragment\"></span><a href=\"#moamixture-of-agents%E3%81%A3%E3%81%A6%E4%BD%95\"><i class=\"fa fa-link\"></i></a>MoA（Mixture of Agents）って何？</h2>\n<h3 data-sourcepos=\"76:1-76:25\">\n<span id=\"ざっくり言うと-1\" class=\"fragment\"></span><a href=\"#%E3%81%96%E3%81%A3%E3%81%8F%E3%82%8A%E8%A8%80%E3%81%86%E3%81%A8-1\"><i class=\"fa fa-link\"></i></a>ざっくり言うと</h3>\n<p data-sourcepos=\"78:1-78:124\"><strong>複数のLLM（大規模言語モデル）を階層的に組み合わせて、より良い回答を作る手法</strong>です。</p>\n<p data-sourcepos=\"80:1-80:131\">2024年6月にTogether AIという会社が発表しました。MASの中でも、LLMに特化した具体的なやり方の1つ。</p>\n<h3 data-sourcepos=\"82:1-82:13\">\n<span id=\"仕組み\" class=\"fragment\"></span><a href=\"#%E4%BB%95%E7%B5%84%E3%81%BF\"><i class=\"fa fa-link\"></i></a>仕組み</h3>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"84:1-90:3\"><div class=\"highlight\"><pre><code>ステップ1：複数のLLMがそれぞれ回答を作る（Proposer）\n    ↓\nステップ2：それらの回答を参考に、さらに良い回答を作る（中間層）\n    ↓\nステップ3：最終的に1つの回答にまとめる（Aggregator）\n</code></pre></div></div>\n<p data-sourcepos=\"93:1-93:122\"><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Fa18a5862-ec98-4001-80b9-5970180f6327.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1d9b9d7f3842e81a54d0705647798eab\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Fa18a5862-ec98-4001-80b9-5970180f6327.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1d9b9d7f3842e81a54d0705647798eab\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Fa18a5862-ec98-4001-80b9-5970180f6327.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=33aef90e6e3ea006b33e1442f8aca923 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/a18a5862-ec98-4001-80b9-5970180f6327.png\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"96:1-96:91\"><em>出典：Wang et al., 2024 \"Mixture-of-Agents Enhances Large Language Model Capabilities\"</em></p>\n<div data-sourcepos=\"98:1-101:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"99:1-100:317\"><strong>なぜこれで性能が上がるのか</strong><br>\nLLMには「他のモデルの出力を見ると、より良い回答ができる」という性質があることがわかっっているらしいです。これを「協調性（collaborativeness）」と呼ぶそうです。人間で言うと、他の人の意見を聞くと考えが深まるみたいな感じ。</p>\n</div>\n</div>\n<h3 data-sourcepos=\"103:1-103:59\">\n<span id=\"実績2024年発表時点で古いかもです\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E7%B8%BE2024%E5%B9%B4%E7%99%BA%E8%A1%A8%E6%99%82%E7%82%B9%E3%81%A7%E5%8F%A4%E3%81%84%E3%81%8B%E3%82%82%E3%81%A7%E3%81%99\"><i class=\"fa fa-link\"></i></a>実績（※2024年発表時点で古いかもです）</h3>\n<ul data-sourcepos=\"105:1-108:0\">\n<li data-sourcepos=\"105:1-105:64\">AlpacaEval 2.0というベンチマークで**65.1%**を達成</li>\n<li data-sourcepos=\"106:1-106:44\">当時のGPT-4oの**57.5%**を上回った</li>\n<li data-sourcepos=\"107:1-108:0\">オープンソースのモデルだけでこの性能を実現</li>\n</ul>\n<div data-sourcepos=\"109:1-112:3\" class=\"note warn\">\n<span class=\"fa fa-fw fa-exclamation-circle\"></span><div>\n<p data-sourcepos=\"110:1-111:201\"><strong>注意</strong><br>\nGPT-4oは2024年時点のモデルです。今はGPT-5とか出てるので、単純比較はできないかもしれません。「当時すごかった」という文脈で理解してください。</p>\n</div>\n</div>\n<h3 data-sourcepos=\"114:1-114:26\">\n<span id=\"2025年の活用事例\" class=\"fragment\"></span><a href=\"#2025%E5%B9%B4%E3%81%AE%E6%B4%BB%E7%94%A8%E4%BA%8B%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>2025年の活用事例</h3>\n<p data-sourcepos=\"116:1-116:96\">調べてみると、実際にMoAを使っているサービスがいくつかありました。</p>\n<ul data-sourcepos=\"118:1-121:0\">\n<li data-sourcepos=\"118:1-118:113\">\n<strong>GenSpark MoA</strong>：MoA技術を採用したAI検索エンジン。検索・画像生成・翻訳などを統合</li>\n<li data-sourcepos=\"119:1-119:126\">\n<strong>医療分野</strong>：放射線科、ゲノム、薬剤治療など専門分野のエージェントが協調して診断支援</li>\n<li data-sourcepos=\"120:1-121:0\">\n<strong>金融分野</strong>：リスク分析などで複数エージェントが協調</li>\n</ul>\n<h3 data-sourcepos=\"122:1-122:34\">\n<span id=\"メリットデメリット\" class=\"fragment\"></span><a href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"><i class=\"fa fa-link\"></i></a>メリット・デメリット</h3>\n<table data-sourcepos=\"124:1-127:121\">\n<thead>\n<tr data-sourcepos=\"124:1-124:34\">\n<th data-sourcepos=\"124:2-124:15\">メリット</th>\n<th data-sourcepos=\"124:17-124:33\">デメリット</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"126:1-126:130\">\n<td data-sourcepos=\"126:2-126:54\">単体のLLMより高品質な出力が得られる</td>\n<td data-sourcepos=\"126:56-126:129\">処理に時間がかかる（複数のLLMを順番に動かすため）</td>\n</tr>\n<tr data-sourcepos=\"127:1-127:121\">\n<td data-sourcepos=\"127:2-127:66\">既存のモデルをそのまま使える（再学習不要）</td>\n<td data-sourcepos=\"127:68-127:120\">コストが高い（複数回の推論が必要）</td>\n</tr>\n</tbody>\n</table>\n<hr data-sourcepos=\"129:1-130:0\">\n<h2 data-sourcepos=\"131:1-131:36\">\n<span id=\"moaとmasの関係を図で整理\" class=\"fragment\"></span><a href=\"#moa%E3%81%A8mas%E3%81%AE%E9%96%A2%E4%BF%82%E3%82%92%E5%9B%B3%E3%81%A7%E6%95%B4%E7%90%86\"><i class=\"fa fa-link\"></i></a>MoAとMASの関係を図で整理</h2>\n<p data-sourcepos=\"133:1-133:111\">ここまで読んで「結局どういう関係なの？」と思った人向けに、図で整理します。</p>\n<p data-sourcepos=\"136:1-136:122\"><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2F562cd9e5-c38f-4ce6-917f-ebbc01233a38.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9c1bc54ae2278b2e1b07d4bec3f2cf4b\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2F562cd9e5-c38f-4ce6-917f-ebbc01233a38.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9c1bc54ae2278b2e1b07d4bec3f2cf4b\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2F562cd9e5-c38f-4ce6-917f-ebbc01233a38.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a2816ad26330cedb94da19a2ba87c74a 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/562cd9e5-c38f-4ce6-917f-ebbc01233a38.png\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"138:1-138:24\">↑ nano bananaで作成</p>\n<p data-sourcepos=\"140:1-140:98\">MASは「広い概念」、MoAは「具体的な手法」くらいで覚えておけばOKです。</p>\n<hr data-sourcepos=\"142:1-143:0\">\n<h2 data-sourcepos=\"144:1-144:36\">\n<span id=\"moeも似てない問題\" class=\"fragment\"></span><a href=\"#moe%E3%82%82%E4%BC%BC%E3%81%A6%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C\"><i class=\"fa fa-link\"></i></a>「MoEも似てない？」問題</h2>\n<p data-sourcepos=\"146:1-146:94\">ここで、私が最初に混乱したもう1つの用語について触れておきます。</p>\n<p data-sourcepos=\"148:1-148:67\">MoE（Mixture of Experts）という用語、MoAと1文字違い。</p>\n<div data-sourcepos=\"150:1-153:3\" class=\"note alert\">\n<span class=\"fa fa-fw fa-times-circle\"></span><div>\n<p data-sourcepos=\"151:1-152:69\"><strong>MoEは別物です</strong><br>\n名前は似てますが、やってることは全然違います。</p>\n</div>\n</div>\n<table data-sourcepos=\"155:1-160:64\">\n<thead>\n<tr data-sourcepos=\"155:1-155:22\">\n<th data-sourcepos=\"155:2-155:9\">項目</th>\n<th data-sourcepos=\"155:11-155:15\">MoA</th>\n<th data-sourcepos=\"155:17-155:21\">MoE</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"157:1-157:57\">\n<td data-sourcepos=\"157:2-157:15\">正式名称</td>\n<td data-sourcepos=\"157:17-157:35\">Mixture of Agents</td>\n<td data-sourcepos=\"157:37-157:56\">Mixture of Experts</td>\n</tr>\n<tr data-sourcepos=\"158:1-158:96\">\n<td data-sourcepos=\"158:2-158:18\">何をするか</td>\n<td data-sourcepos=\"158:20-158:52\">複数LLMの出力を<strong>合成</strong>\n</td>\n<td data-sourcepos=\"158:54-158:95\">入力に応じて専門家を<strong>選択</strong>\n</td>\n</tr>\n<tr data-sourcepos=\"159:1-159:70\">\n<td data-sourcepos=\"159:2-159:12\">レベル</td>\n<td data-sourcepos=\"159:14-159:42\">アプリケーション層</td>\n<td data-sourcepos=\"159:44-159:69\">モデル内部の構造</td>\n</tr>\n<tr data-sourcepos=\"160:1-160:64\">\n<td data-sourcepos=\"160:2-160:9\">目的</td>\n<td data-sourcepos=\"160:11-160:36\">回答の質を上げる</td>\n<td data-sourcepos=\"160:38-160:63\">計算効率を上げる</td>\n</tr>\n</tbody>\n</table>\n<h3 data-sourcepos=\"163:1-163:24\">\n<span id=\"moa-vs-moe-比較図\" class=\"fragment\"></span><a href=\"#moa-vs-moe-%E6%AF%94%E8%BC%83%E5%9B%B3\"><i class=\"fa fa-link\"></i></a>MoA vs MoE 比較図</h3>\n<p data-sourcepos=\"164:1-165:122\">MoA<br>\n<a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Fa230e0a9-7f07-4e46-8768-d7308aa5fcaf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ec352d80c048af4dc293be2c22800b04\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Fa230e0a9-7f07-4e46-8768-d7308aa5fcaf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ec352d80c048af4dc293be2c22800b04\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Fa230e0a9-7f07-4e46-8768-d7308aa5fcaf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9e053ed28de08b6805c9ce88e1e8a57c 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/a230e0a9-7f07-4e46-8768-d7308aa5fcaf.png\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"167:1-168:122\">MoE<br>\n<a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2F860211d5-95af-4b24-a3c6-1270320db0fd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=26fd2ed66fbab8ad7074de6c5093db74\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2F860211d5-95af-4b24-a3c6-1270320db0fd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=26fd2ed66fbab8ad7074de6c5093db74\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2F860211d5-95af-4b24-a3c6-1270320db0fd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=09d373fffc95fdb4c10d598ea4838d1f 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/860211d5-95af-4b24-a3c6-1270320db0fd.png\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"173:1-173:15\">参考記事：</p>\n<ul data-sourcepos=\"174:1-176:0\">\n<li data-sourcepos=\"174:1-176:0\"><a href=\"https://medium.com/@abdulrahmanrihan/mixture-of-agents-moa-a-better-moe-33683151beec\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://medium.com/@abdulrahmanrihan/mixture-of-agents-moa-a-better-moe-33683151beec</a></li>\n</ul>\n<h4 data-sourcepos=\"177:1-177:86\">\n<span id=\"もっとわかりやすくするためにnano-banana-proに投げてみた画像\" class=\"fragment\"></span><a href=\"#%E3%82%82%E3%81%A3%E3%81%A8%E3%82%8F%E3%81%8B%E3%82%8A%E3%82%84%E3%81%99%E3%81%8F%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%ABnano-banana-pro%E3%81%AB%E6%8A%95%E3%81%92%E3%81%A6%E3%81%BF%E3%81%9F%E7%94%BB%E5%83%8F\"><i class=\"fa fa-link\"></i></a>もっとわかりやすくするためにnano banana proに投げてみた画像</h4>\n<p data-sourcepos=\"179:1-179:122\"><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Ff7be5a0f-4f6e-4ab3-865c-97e7494fc40b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1a7f18e1ad9be2b1023dd56302f41d6a\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Ff7be5a0f-4f6e-4ab3-865c-97e7494fc40b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1a7f18e1ad9be2b1023dd56302f41d6a\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4165185%2Ff7be5a0f-4f6e-4ab3-865c-97e7494fc40b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0b514b17d65dfd1c61b8d59f33805a8b 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/f7be5a0f-4f6e-4ab3-865c-97e7494fc40b.png\" loading=\"lazy\"></a></p>\n<div data-sourcepos=\"183:1-189:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"184:1-184:25\"><strong>ざっくり言うと</strong></p>\n<ul data-sourcepos=\"185:1-187:0\">\n<li data-sourcepos=\"185:1-185:66\">\n<strong>MoA</strong>：みんなの意見をまとめて良い答えを作る</li>\n<li data-sourcepos=\"186:1-187:0\">\n<strong>MoE</strong>：得意な人に任せる（他の人は休んでる）</li>\n</ul>\n<p data-sourcepos=\"188:1-188:69\">全然違いますね。名前が似てるだけで別物でした。</p>\n</div>\n</div>\n<hr data-sourcepos=\"191:1-192:0\">\n<h2 data-sourcepos=\"193:1-193:51\">\n<span id=\"実装したい人向けフレームワーク\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E8%A3%85%E3%81%97%E3%81%9F%E3%81%84%E4%BA%BA%E5%90%91%E3%81%91%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%83%AF%E3%83%BC%E3%82%AF\"><i class=\"fa fa-link\"></i></a>実装したい人向け：フレームワーク</h2>\n<p data-sourcepos=\"195:1-195:129\">「自分でもMASやMoAを試してみたい」という人向けに、使えるフレームワークも調べてみました。</p>\n<table data-sourcepos=\"197:1-202:81\">\n<thead>\n<tr data-sourcepos=\"197:1-197:31\">\n<th data-sourcepos=\"197:2-197:9\">名前</th>\n<th data-sourcepos=\"197:11-197:21\">開発元</th>\n<th data-sourcepos=\"197:23-197:30\">特徴</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"199:1-199:104\">\n<td data-sourcepos=\"199:2-199:16\"><strong>LangGraph</strong></td>\n<td data-sourcepos=\"199:18-199:28\">LangChain</td>\n<td data-sourcepos=\"199:30-199:103\">グラフ構造でワークフローを定義。細かい制御が可能</td>\n</tr>\n<tr data-sourcepos=\"200:1-200:90\">\n<td data-sourcepos=\"200:2-200:14\"><strong>AutoGen</strong></td>\n<td data-sourcepos=\"200:16-200:26\">Microsoft</td>\n<td data-sourcepos=\"200:28-200:89\">会話ベースで複数エージェントを協調させる</td>\n</tr>\n<tr data-sourcepos=\"201:1-201:100\">\n<td data-sourcepos=\"201:2-201:13\"><strong>CrewAI</strong></td>\n<td data-sourcepos=\"201:15-201:27\">CrewAI Inc.</td>\n<td data-sourcepos=\"201:29-201:99\">役割を定義してチームのように動かす。初心者向け</td>\n</tr>\n<tr data-sourcepos=\"202:1-202:81\">\n<td data-sourcepos=\"202:2-202:24\"><strong>OpenAI Agents SDK</strong></td>\n<td data-sourcepos=\"202:26-202:33\">OpenAI</td>\n<td data-sourcepos=\"202:35-202:80\">2025年3月リリース。MAS構築に特化</td>\n</tr>\n</tbody>\n</table>\n<div data-sourcepos=\"204:1-206:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"205:1-205:152\">OpenAI Agents SDKで私ものちのちに手を動かそうかなと思います。情報が多そう、この辺りは、あまり調べてません。</p>\n</div>\n</div>\n<hr data-sourcepos=\"208:1-209:0\">\n<h2 data-sourcepos=\"210:1-210:12\">\n<span id=\"まとめ\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>まとめ</h2>\n<p data-sourcepos=\"212:1-212:48\">MoAとMASの違い、整理できましたか？</p>\n<div data-sourcepos=\"214:1-220:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"215:1-215:28\"><strong>今回わかったこと</strong></p>\n<ul data-sourcepos=\"216:1-219:42\">\n<li data-sourcepos=\"216:1-216:88\">\n<strong>MAS</strong>は複数AIが協力する仕組み<strong>全般</strong>（広い概念、1970年代〜）</li>\n<li data-sourcepos=\"217:1-217:101\">\n<strong>MoA</strong>はLLMを階層的に組み合わせる<strong>具体的な手法</strong>（MASの一種、2024年〜）</li>\n<li data-sourcepos=\"218:1-218:66\">\n<strong>MoE</strong>は別物。モデル内部で専門家を選ぶ仕組み</li>\n<li data-sourcepos=\"219:1-219:42\">\n<strong>MASが親、MoAが子</strong>という関係</li>\n</ul>\n</div>\n</div>\n<h3 data-sourcepos=\"222:1-222:13\">\n<span id=\"覚え方\" class=\"fragment\"></span><a href=\"#%E8%A6%9A%E3%81%88%E6%96%B9\"><i class=\"fa fa-link\"></i></a>覚え方</h3>\n<ul data-sourcepos=\"224:1-227:0\">\n<li data-sourcepos=\"224:1-224:84\">MAS = <strong>M</strong>ulti-<strong>A</strong>gent <strong>S</strong>ystem = 複数エージェントの<strong>システム</strong>\n</li>\n<li data-sourcepos=\"225:1-225:71\">MoA = <strong>M</strong>ixture-<strong>o</strong>f-<strong>A</strong>gents = エージェントの<strong>混合</strong>\n</li>\n<li data-sourcepos=\"226:1-227:0\">MoE = <strong>M</strong>ixture-<strong>o</strong>f-<strong>E</strong>xperts = 専門家の<strong>混合</strong>\n</li>\n</ul>\n<p data-sourcepos=\"228:1-228:48\">少しでも、参考になれば幸いです。</p>\n<hr data-sourcepos=\"230:1-231:0\">\n<h2 data-sourcepos=\"232:1-232:9\">\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h2>\n<ul data-sourcepos=\"234:1-239:0\">\n<li data-sourcepos=\"234:1-234:106\"><a href=\"https://arxiv.org/abs/2406.04692\" rel=\"nofollow noopener\" target=\"_blank\">Mixture-of-Agents Enhances Large Language Model Capabilities (arXiv)</a></li>\n<li data-sourcepos=\"235:1-235:88\"><a href=\"https://www.together.ai/blog/together-moa\" rel=\"nofollow noopener\" target=\"_blank\">Together MoA (Together AI公式ブログ)</a></li>\n<li data-sourcepos=\"236:1-236:91\"><a href=\"https://www.ibm.com/think/topics/multiagent-system\" rel=\"nofollow noopener\" target=\"_blank\">What is a Multi-Agent System? (IBM)</a></li>\n<li data-sourcepos=\"237:1-237:106\"><a href=\"https://ai-market.jp/technology/mixture-of-agents/\" rel=\"nofollow noopener\" target=\"_blank\">Mixture-of-Agents（MoA）とは？（AI market）</a></li>\n<li data-sourcepos=\"238:1-239:0\"><a href=\"https://ai-market.jp/technology/ai-agent-mas/\" rel=\"nofollow noopener\" target=\"_blank\">マルチエージェントシステム（MAS）とは？（AI market）</a></li>\n</ul>\n",
      "body": "この記事は**株式会社ドットログ**による\n[コンストラク体操日記 Advent Calendar 2025](https://qiita.com/advent-calendar/2025/dotlog) の 11日目 の記事です。\n\n## はじめに\n\n「MAS」について調べていたら、「MoA」と「MAS」がごちゃついて頭の整理のメモ程度で記事を書いてみました。\n\n\n正直に言うと、私はこの2つの用語を完全に混同していました。どっちも「マルチエージェント」っぽいし、どっちも「複数のAIが協力する」みたいな話っぽく感じました。調べていくうちに**「あ、これって親子関係なんや」**ということがわかったりして整理できてスッキリしたので、同じように混乱している人はなかなか少ないと思いますが、MoAとMASのどちらか一方でも分かっていない人には、input材料として焼くだけていただければ幸いです。\n\n:::note info\n**この記事でわかること**\n- MASとMoAの違い（結論：親子関係）\n- ついでにMoEとの違いも整理\n- 2025年時点での具体的な活用事例\n:::\n\n## 結論：MASが親、MoAが子みたいな感じ→ MASがでかい要素、MoAがその中の一部\n\n先に結論を言うと、この2つの関係はシンプルでした。\n\n**MASは「広い概念」、MoAは「具体的な手法」。MoAはMASの一種。**\n\n| 用語 | 正式名称 | 一言で言うと |\n|------|----------|--------------|\n| **MAS** | Multi-Agent System | 複数AIが協力する仕組み**全般** |\n| **MoA** | Mixture of Agents | LLMを階層的に組み合わせる**具体的な手法** |\n| MoE | Mixture of Experts | モデル内部で専門家を選ぶ仕組み（**別物**） |\n\n\n\n:::note warn\n※MoEについては最後くらいに軽く触れます、、\n:::\n\n---\n\n## MAS（マルチエージェントシステム）って何？\n\n### ざっくり言うと\n\n**複数のAIエージェントが協力して問題を解決するシステムの総称**です。\n\n1970年代から研究されている歴史ある分野で、「生成AIの時代に急に出てきた概念」ではありませんでした。\n\n:::note info\n**私が勘違いしてたこと**\nMASは「最近のLLMブームで生まれた概念」だと思ってましたが、50年近い歴史がありました。ロボット工学や交通システムなど、LLM以外の分野でも昔から使われていたようです。\n:::\n\n### 特徴\n\n- **複数のエージェントがいる**：1つじゃなくて、複数のAIが動く\n- **それぞれが自律的**：各エージェントが自分で判断して動く\n- **協力・分担する**：情報を共有したり、役割分担したりする\n\n### 2025年時点での具体例\n\n調べてみると、最近はこんなサービスがMASを使っているようです。\n\n- **Gemini Enterprise**：Googleの汎用マルチエージェントシステム\n- **Microsoft Magentic-One**：Microsoftの汎用MAS\n- **OpenAI Operator**：ブラウザ操作などを行うAIエージェント\n- **Anthropic Claude Computer Use**：PCを操作できるAIエージェント\n\n他にも、自動運転車同士の連携とか、Amazonの倉庫ロボットの協調動作なんかもMASの一種らしいです。\n\n### ポイント\n\nMASは「考え方・設計思想」です。AIにおいてでいうと、MASは「複数のAIを協力させよう」という大きな枠組みであり、具体的なやり方は色々あります。\n\n---\n\n## MoA（Mixture of Agents）って何？\n\n### ざっくり言うと\n\n**複数のLLM（大規模言語モデル）を階層的に組み合わせて、より良い回答を作る手法**です。\n\n2024年6月にTogether AIという会社が発表しました。MASの中でも、LLMに特化した具体的なやり方の1つ。\n\n### 仕組み\n\n```\nステップ1：複数のLLMがそれぞれ回答を作る（Proposer）\n    ↓\nステップ2：それらの回答を参考に、さらに良い回答を作る（中間層）\n    ↓\nステップ3：最終的に1つの回答にまとめる（Aggregator）\n```\n\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/a18a5862-ec98-4001-80b9-5970180f6327.png)\n\n\n*出典：Wang et al., 2024 \"Mixture-of-Agents Enhances Large Language Model Capabilities\"*\n\n:::note info\n**なぜこれで性能が上がるのか**\nLLMには「他のモデルの出力を見ると、より良い回答ができる」という性質があることがわかっっているらしいです。これを「協調性（collaborativeness）」と呼ぶそうです。人間で言うと、他の人の意見を聞くと考えが深まるみたいな感じ。\n:::\n\n### 実績（※2024年発表時点で古いかもです）\n\n- AlpacaEval 2.0というベンチマークで**65.1%**を達成\n- 当時のGPT-4oの**57.5%**を上回った\n- オープンソースのモデルだけでこの性能を実現\n\n:::note warn\n**注意**\nGPT-4oは2024年時点のモデルです。今はGPT-5とか出てるので、単純比較はできないかもしれません。「当時すごかった」という文脈で理解してください。\n:::\n\n### 2025年の活用事例\n\n調べてみると、実際にMoAを使っているサービスがいくつかありました。\n\n- **GenSpark MoA**：MoA技術を採用したAI検索エンジン。検索・画像生成・翻訳などを統合\n- **医療分野**：放射線科、ゲノム、薬剤治療など専門分野のエージェントが協調して診断支援\n- **金融分野**：リスク分析などで複数エージェントが協調\n\n### メリット・デメリット\n\n| メリット | デメリット |\n|----------|------------|\n| 単体のLLMより高品質な出力が得られる | 処理に時間がかかる（複数のLLMを順番に動かすため） |\n| 既存のモデルをそのまま使える（再学習不要） | コストが高い（複数回の推論が必要） |\n\n---\n\n## MoAとMASの関係を図で整理\n\nここまで読んで「結局どういう関係なの？」と思った人向けに、図で整理します。\n\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/562cd9e5-c38f-4ce6-917f-ebbc01233a38.png)\n\n↑ nano bananaで作成\n\nMASは「広い概念」、MoAは「具体的な手法」くらいで覚えておけばOKです。\n\n---\n\n## 「MoEも似てない？」問題\n\nここで、私が最初に混乱したもう1つの用語について触れておきます。\n\nMoE（Mixture of Experts）という用語、MoAと1文字違い。\n\n:::note alert\n**MoEは別物です**\n名前は似てますが、やってることは全然違います。\n:::\n\n| 項目 | MoA | MoE |\n|------|-----|-----|\n| 正式名称 | Mixture of Agents | Mixture of Experts |\n| 何をするか | 複数LLMの出力を**合成** | 入力に応じて専門家を**選択** |\n| レベル | アプリケーション層 | モデル内部の構造 |\n| 目的 | 回答の質を上げる | 計算効率を上げる |\n\n\n### MoA vs MoE 比較図\nMoA\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/a230e0a9-7f07-4e46-8768-d7308aa5fcaf.png)\n\nMoE\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/860211d5-95af-4b24-a3c6-1270320db0fd.png)\n\n\n\n\n参考記事：\n- https://medium.com/@abdulrahmanrihan/mixture-of-agents-moa-a-better-moe-33683151beec\n\n\n#### もっとわかりやすくするためにnano banana proに投げてみた画像\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4165185/f7be5a0f-4f6e-4ab3-865c-97e7494fc40b.png)\n\n\n\n:::note info\n**ざっくり言うと**\n- **MoA**：みんなの意見をまとめて良い答えを作る\n- **MoE**：得意な人に任せる（他の人は休んでる）\n\n全然違いますね。名前が似てるだけで別物でした。\n:::\n\n---\n\n## 実装したい人向け：フレームワーク\n\n「自分でもMASやMoAを試してみたい」という人向けに、使えるフレームワークも調べてみました。\n\n| 名前 | 開発元 | 特徴 |\n|------|--------|------|\n| **LangGraph** | LangChain | グラフ構造でワークフローを定義。細かい制御が可能 |\n| **AutoGen** | Microsoft | 会話ベースで複数エージェントを協調させる |\n| **CrewAI** | CrewAI Inc. | 役割を定義してチームのように動かす。初心者向け |\n| **OpenAI Agents SDK** | OpenAI | 2025年3月リリース。MAS構築に特化 |\n\n:::note info\nOpenAI Agents SDKで私ものちのちに手を動かそうかなと思います。情報が多そう、この辺りは、あまり調べてません。\n:::\n\n---\n\n## まとめ\n\nMoAとMASの違い、整理できましたか？\n\n:::note info\n**今回わかったこと**\n- **MAS**は複数AIが協力する仕組み**全般**（広い概念、1970年代〜）\n- **MoA**はLLMを階層的に組み合わせる**具体的な手法**（MASの一種、2024年〜）\n- **MoE**は別物。モデル内部で専門家を選ぶ仕組み\n- **MASが親、MoAが子**という関係\n:::\n\n### 覚え方\n\n- MAS = **M**ulti-**A**gent **S**ystem = 複数エージェントの**システム**\n- MoA = **M**ixture-**o**f-**A**gents = エージェントの**混合**\n- MoE = **M**ixture-**o**f-**E**xperts = 専門家の**混合**\n\n少しでも、参考になれば幸いです。\n\n---\n\n## 参考\n\n- [Mixture-of-Agents Enhances Large Language Model Capabilities (arXiv)](https://arxiv.org/abs/2406.04692)\n- [Together MoA (Together AI公式ブログ)](https://www.together.ai/blog/together-moa)\n- [What is a Multi-Agent System? (IBM)](https://www.ibm.com/think/topics/multiagent-system)\n- [Mixture-of-Agents（MoA）とは？（AI market）](https://ai-market.jp/technology/mixture-of-agents/)\n- [マルチエージェントシステム（MAS）とは？（AI market）](https://ai-market.jp/technology/ai-agent-mas/)\n\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T12:59:16+09:00",
      "group": null,
      "id": "ebaf596f47cf518a409b",
      "likes_count": 6,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 3,
      "tags": [
        {
          "name": "ポエム",
          "versions": []
        },
        {
          "name": "マルチエージェントシステム",
          "versions": []
        },
        {
          "name": "新卒エンジニア",
          "versions": []
        },
        {
          "name": "Gemini",
          "versions": []
        },
        {
          "name": "AIエージェント",
          "versions": []
        }
      ],
      "title": "# MoAとMASで混乱したので整理してみた",
      "updated_at": "2025-12-11T12:59:16+09:00",
      "url": "https://qiita.com/kaichan_dot/items/ebaf596f47cf518a409b",
      "user": {
        "description": "KDDIアジャイル開発センター株式会社で働く、新人のチキンなエンジニアです",
        "facebook_id": "",
        "followees_count": 16,
        "followers_count": 13,
        "github_login_name": null,
        "id": "kaichan_dot",
        "items_count": 3,
        "linkedin_id": "",
        "location": "",
        "name": "KAITO MURATA",
        "organization": "KDDIアジャイル開発センター株式会社/株式会社.log",
        "permanent_id": 4165185,
        "profile_image_url": "https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/4165185/c57f8ca5b78481653abc5b2f35ed037c5e917934/x_large.png?1755161961",
        "team_only": false,
        "twitter_screen_name": "kaichan_ai_dev",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": "dotlog-dev",
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-2:147\">こんにちは、GMOコネクト株式会社で執行役員CTOをしている菅野 哲（かんの さとる）です。<br>\n暗号おじさんなので暗号に関する情報を見つけると解説する病気なのでお付き合いいただけたら嬉しいです。</p>\n<h2 data-sourcepos=\"5:1-5:9\">\n<span id=\"概要\" class=\"fragment\"></span><a href=\"#%E6%A6%82%E8%A6%81\"><i class=\"fa fa-link\"></i></a>概要</h2>\n<p data-sourcepos=\"7:1-7:180\"><strong>2025年11月18日</strong>、米国防総省（Department of Defense、以下DoD）は、全コンポーネントに対しPQCへの移行準備を命じる覚書を発出しました。</p>\n<p data-sourcepos=\"9:1-10:102\">ファーストビューが厳ついのよ。<br>\nでも、このPDFにある公開承認スタンプが消せて保存できるのが気になったｗ</p>\n<p data-sourcepos=\"12:1-12:122\"><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4173853%2Fde540750-e68d-4256-8bf1-78e801b6ade2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=50d2b65d65b2c9090508ea3be66a7c86\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4173853%2Fde540750-e68d-4256-8bf1-78e801b6ade2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=50d2b65d65b2c9090508ea3be66a7c86\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F4173853%2Fde540750-e68d-4256-8bf1-78e801b6ade2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cf9c5d982f75bf135ce086458c5ad969 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4173853/de540750-e68d-4256-8bf1-78e801b6ade2.png\" loading=\"lazy\"></a></p>\n<blockquote data-sourcepos=\"14:1-15:183\">\n<p data-sourcepos=\"14:3-15:183\"><strong>注記</strong>: 原文書では \"Department of War\" (DoW) という名称が使用されています。これは2025年9月5日の大統領令14347号により、DoDが公式文書で使用することが認可された副次的名称です。<br>\n法的名称は Department of Defense のままですが、本記事では一般読者の理解を助けるため、より広く認知されている DoD 表記を使用します。</p>\n</blockquote>\n<p data-sourcepos=\"17:1-17:210\">本記事では、エンジニアやセキュリティ実装者の視点から、この文書に含まれる <strong>「特定の技術の禁止」</strong> と <strong>「移行期限」</strong> について詳細に解説します。</p>\n<h2 data-sourcepos=\"19:1-19:33\">\n<span id=\"1-公開文書の基本情報\" class=\"fragment\"></span><a href=\"#1-%E5%85%AC%E9%96%8B%E6%96%87%E6%9B%B8%E3%81%AE%E5%9F%BA%E6%9C%AC%E6%83%85%E5%A0%B1\"><i class=\"fa fa-link\"></i></a>1. 公開文書の基本情報</h2>\n<ul data-sourcepos=\"21:1-26:0\">\n<li data-sourcepos=\"21:1-21:66\">\n<strong>件名</strong>: Preparing for Migration to Post Quantum Cryptography</li>\n<li data-sourcepos=\"22:1-22:50\">\n<strong>発信</strong>: DoD CIO (Acting) Katherine Arrington</li>\n<li data-sourcepos=\"23:1-23:77\">\n<strong>PQC担当責任者</strong>: Dr. Britta Hale (Director, DoD CIO PQC Directorate)</li>\n<li data-sourcepos=\"24:1-24:188\">\n<strong>目的</strong>: 量子計算機の脅威に対し、「意図的な緊急性（deliberate urgency）」を持ってPQCへの移行を計画・実行し、情報支配権を維持すること</li>\n<li data-sourcepos=\"25:1-26:0\">\n<strong>全システム対象</strong>: 国家安全保障システム（NSS）だけでなく、兵器システム、IoT、クラウド、モバイルなど、あらゆる区分のシステムが対象</li>\n</ul>\n<h2 data-sourcepos=\"27:1-27:54\">\n<span id=\"2-重要禁止および廃止される技術\" class=\"fragment\"></span><a href=\"#2-%E9%87%8D%E8%A6%81%E7%A6%81%E6%AD%A2%E3%81%8A%E3%82%88%E3%81%B3%E5%BB%83%E6%AD%A2%E3%81%95%E3%82%8C%E3%82%8B%E6%8A%80%E8%A1%93\"><i class=\"fa fa-link\"></i></a>2. 【重要】禁止および廃止される技術</h2>\n<p data-sourcepos=\"29:1-29:236\">本覚書の最も注目すべき点は、NIST標準以外の「耐量子」ソリューション（特に物理層セキュリティや旧来の共通鍵管理）に対して、<strong>非常に厳しい姿勢</strong>を示している点です。</p>\n<h3 data-sourcepos=\"31:1-31:53\">\n<span id=\"-量子鍵配送qkdの事実上の禁止\" class=\"fragment\"></span><a href=\"#-%E9%87%8F%E5%AD%90%E9%8D%B5%E9%85%8D%E9%80%81qkd%E3%81%AE%E4%BA%8B%E5%AE%9F%E4%B8%8A%E3%81%AE%E7%A6%81%E6%AD%A2\"><i class=\"fa fa-link\"></i></a>① 量子鍵配送（QKD）の事実上の禁止</h3>\n<p data-sourcepos=\"33:1-33:235\">文書は、<strong>「量子機密性（Quantum Confidentiality）」技術</strong> または <strong>「量子鍵配送（Keying）技術」</strong> を、機密性・完全性・鍵配送の手段として使用することを明確に禁止しました。</p>\n<ul data-sourcepos=\"35:1-45:0\">\n<li data-sourcepos=\"35:1-41:0\">\n<p data-sourcepos=\"35:3-35:19\"><strong>対象技術</strong>:</p>\n<ul data-sourcepos=\"36:3-41:0\">\n<li data-sourcepos=\"36:3-37:77\">Quantum Key Distribution (QKD)\n<ul data-sourcepos=\"37:7-37:77\">\n<li data-sourcepos=\"37:7-37:77\">QKDと他の暗号鍵確立を組み合わせたソリューション</li>\n</ul>\n</li>\n<li data-sourcepos=\"38:3-38:49\">量子通信またはネットワーキング</li>\n<li data-sourcepos=\"39:3-39:34\">非局所的量子乱数生成</li>\n<li data-sourcepos=\"40:3-41:0\">FIPS非準拠の乱数生成</li>\n</ul>\n</li>\n<li data-sourcepos=\"42:1-43:0\">\n<p data-sourcepos=\"42:3-42:329\"><strong>理由</strong>: これらの技術は、機密性保護、データまたはエンティティ認証、鍵配送、非局所的乱数生成の手段として認められません。DoDは、物理層の量子効果ではなく、数学的な安全性を持つPQC（耐量子計算機暗号）への一本化を選択しました。</p>\n</li>\n<li data-sourcepos=\"44:1-45:0\">\n<p data-sourcepos=\"44:3-44:125\"><strong>例外</strong>: 上記の連絡先（Dr. Britta Hale）から例外承認を得た場合のみ、導入が認められます。</p>\n</li>\n</ul>\n<h3 data-sourcepos=\"46:1-46:63\">\n<span id=\"-共通鍵symmetric-keyによる鍵配送の廃止\" class=\"fragment\"></span><a href=\"#-%E5%85%B1%E9%80%9A%E9%8D%B5symmetric-key%E3%81%AB%E3%82%88%E3%82%8B%E9%8D%B5%E9%85%8D%E9%80%81%E3%81%AE%E5%BB%83%E6%AD%A2\"><i class=\"fa fa-link\"></i></a>② 共通鍵（Symmetric Key）による鍵配送の廃止</h3>\n<p data-sourcepos=\"48:1-48:221\">ここが実装者にとって最大の変更点です。データの暗号化そのものではなく、<strong>「鍵を共有・配送するプロトコル」</strong> において、共通鍵技術の使用が制限されます。</p>\n<ul data-sourcepos=\"50:1-64:0\">\n<li data-sourcepos=\"50:1-54:0\">\n<p data-sourcepos=\"50:3-50:19\"><strong>廃止対象</strong>:</p>\n<ul data-sourcepos=\"51:3-54:0\">\n<li data-sourcepos=\"51:3-51:77\">Symmetric key establishment protocols（共通鍵確立プロトコル）</li>\n<li data-sourcepos=\"52:3-52:73\">Symmetric key agreement protocols（共通鍵合意プロトコル）</li>\n<li data-sourcepos=\"53:3-54:0\">Symmetric key distribution protocols（共通鍵配送プロトコル）</li>\n</ul>\n</li>\n<li data-sourcepos=\"55:1-58:0\">\n<p data-sourcepos=\"55:3-55:14\"><strong>期限</strong>:</p>\n<ul data-sourcepos=\"56:3-58:0\">\n<li data-sourcepos=\"56:3-56:73\">\n<strong>2030年12月31日</strong>までに廃止し、置換を完了すること</li>\n<li data-sourcepos=\"57:3-58:0\">NSA CSfC登録済みソリューションは<strong>2031年12月31日</strong>まで猶予</li>\n</ul>\n</li>\n<li data-sourcepos=\"59:1-60:0\">\n<p data-sourcepos=\"59:3-59:158\"><strong>移行先</strong>: NISTが承認した <strong>「非対称PQCアルゴリズム（Asymmetric PQC）」</strong> を用いた鍵確立（例：ML-KEM）への移行が必須</p>\n</li>\n<li data-sourcepos=\"61:1-62:0\">\n<p data-sourcepos=\"61:3-61:146\"><strong>即時禁止</strong>: 商用の共通鍵ベースの耐量子ソリューションの新規テスト・調達は、本覚書発効と同時に禁止</p>\n</li>\n<li data-sourcepos=\"63:1-64:0\">\n<p data-sourcepos=\"63:3-63:360\"><strong>既存システムの例外</strong>: 2010年以前から共通鍵配送プロトコルを使用しているユースケースは、新たなリスクを導入するものではないため、この要件から免除されます。ただし、非対称PQCアルゴリズムベースの鍵確立へのアップグレードを検討すべきとされています。</p>\n</li>\n</ul>\n<h3 data-sourcepos=\"65:1-65:41\">\n<span id=\"-事前共有鍵pskの規制\" class=\"fragment\"></span><a href=\"#-%E4%BA%8B%E5%89%8D%E5%85%B1%E6%9C%89%E9%8D%B5psk%E3%81%AE%E8%A6%8F%E5%88%B6\"><i class=\"fa fa-link\"></i></a>③ 事前共有鍵（PSK）の規制</h3>\n<p data-sourcepos=\"67:1-67:137\">「とりあえず長いPSK（Pre-Shared Key）を使えば耐量子になる」という安易なアプローチも規制されます。</p>\n<ul data-sourcepos=\"69:1-71:0\">\n<li data-sourcepos=\"69:1-69:213\">NSAのKMI（Key Management Infrastructure）経由でType 1デバイス用に提供されるPSK以外は、耐量子目的でのPSK利用は認められず、上記同様に2030年12月31日までに廃止対象</li>\n<li data-sourcepos=\"70:1-71:0\">商用PSKベースの耐量子ソリューションの新規テスト・調達は即時禁止</li>\n</ul>\n<h2 data-sourcepos=\"72:1-72:54\">\n<span id=\"3-実装と開発へのインプリケーション\" class=\"fragment\"></span><a href=\"#3-%E5%AE%9F%E8%A3%85%E3%81%A8%E9%96%8B%E7%99%BA%E3%81%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3\"><i class=\"fa fa-link\"></i></a>3. 実装と開発へのインプリケーション</h2>\n<p data-sourcepos=\"74:1-74:109\">このポリシーは、IETF等で議論されているPQC実装の方向性を決定づけるものです。</p>\n<h3 data-sourcepos=\"76:1-76:46\">\n<span id=\"1-ハイブリッド鍵交換の必須化\" class=\"fragment\"></span><a href=\"#1-%E3%83%8F%E3%82%A4%E3%83%96%E3%83%AA%E3%83%83%E3%83%89%E9%8D%B5%E4%BA%A4%E6%8F%9B%E3%81%AE%E5%BF%85%E9%A0%88%E5%8C%96\"><i class=\"fa fa-link\"></i></a>1. ハイブリッド鍵交換の必須化</h3>\n<ul data-sourcepos=\"78:1-83:0\">\n<li data-sourcepos=\"78:1-79:0\">\n<p data-sourcepos=\"78:3-78:194\"><strong>共通鍵暗号の役割</strong>: AESのような共通鍵暗号アルゴリズム自体は、データプレーンの暗号化（Bulk Encryption）のために引き続き必要不可欠です。</p>\n</li>\n<li data-sourcepos=\"80:1-81:0\">\n<p data-sourcepos=\"80:3-80:297\"><strong>鍵交換の変更</strong>: しかし、その<strong>共通鍵を通信相手と共有するフェーズ（Control Plane）</strong> においては、Kerberosのような共通鍵ベースの仕組みや、単純なPSKではなく、<strong>ML-KEM</strong> 等のPQC公開鍵暗号を用いることが強制されます。</p>\n</li>\n<li data-sourcepos=\"82:1-83:0\">\n<p data-sourcepos=\"82:3-82:236\"><strong>開発者の対応</strong>: 自身のアプリケーションが鍵交換に何を使っているか（ECDHなのか、PSKなのか、Kerberosなのか）を再確認し、PQCなKEMへの置き換えを設計する必要があります。</p>\n</li>\n</ul>\n<h3 data-sourcepos=\"84:1-84:58\">\n<span id=\"2-インベントリ棚卸しの自動化需要\" class=\"fragment\"></span><a href=\"#2-%E3%82%A4%E3%83%B3%E3%83%99%E3%83%B3%E3%83%88%E3%83%AA%E6%A3%9A%E5%8D%B8%E3%81%97%E3%81%AE%E8%87%AA%E5%8B%95%E5%8C%96%E9%9C%80%E8%A6%81\"><i class=\"fa fa-link\"></i></a>2. インベントリ（棚卸し）の自動化需要</h3>\n<ul data-sourcepos=\"86:1-88:0\">\n<li data-sourcepos=\"86:1-86:116\">DoDは全システムに対して「あらゆる種類の暗号」のインベントリ作成を求めています</li>\n<li data-sourcepos=\"87:1-88:0\">CBOM（Cryptography Bill of Materials）のようなツールや、ソースコード/バイナリをスキャンして暗号ライブラリの使用箇所を特定する自動化ツールの需要が急増すると予想されます？！</li>\n</ul>\n<h3 data-sourcepos=\"89:1-89:43\">\n<span id=\"3-中央集権的な承認プロセス\" class=\"fragment\"></span><a href=\"#3-%E4%B8%AD%E5%A4%AE%E9%9B%86%E6%A8%A9%E7%9A%84%E3%81%AA%E6%89%BF%E8%AA%8D%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9\"><i class=\"fa fa-link\"></i></a>3. 中央集権的な承認プロセス</h3>\n<ul data-sourcepos=\"91:1-96:0\">\n<li data-sourcepos=\"91:1-91:175\">PQC関連技術のテスト、パイロット、導入を行う場合、事前にDoD CIO PQC局（Dr. Britta Hale）への報告と承認（Intake Approval）が必要です</li>\n<li data-sourcepos=\"92:1-94:114\">承認プロセス:\n<ol data-sourcepos=\"93:3-94:114\">\n<li data-sourcepos=\"93:3-93:104\">\n<strong>Intake Approval</strong>: テスト・評価・パイロット・投資・使用・調達の前に必要</li>\n<li data-sourcepos=\"94:3-94:114\">\n<strong>Deployment Approval</strong>: 実際の展開前に必要（IC、NIST、NSAの認証結果を踏まえて発行）</li>\n</ol>\n</li>\n<li data-sourcepos=\"95:1-96:0\">勝手な <strong>「オレオレ耐量子実装」や「未承認アルゴリズム」の導入</strong> は、<strong>コンプライアンス違反</strong> となります</li>\n</ul>\n<h3 data-sourcepos=\"97:1-97:34\">\n<span id=\"4-技術選定の考慮事項\" class=\"fragment\"></span><a href=\"#4-%E6%8A%80%E8%A1%93%E9%81%B8%E5%AE%9A%E3%81%AE%E8%80%83%E6%85%AE%E4%BA%8B%E9%A0%85\"><i class=\"fa fa-link\"></i></a>4. 技術選定の考慮事項</h3>\n<ul data-sourcepos=\"99:1-101:0\">\n<li data-sourcepos=\"99:1-99:145\">本覚書は、CNSS Policy #15（2024年12月）と統合参謀本部指示6510.02（2022年8月16日）の要件に追加されるものです</li>\n<li data-sourcepos=\"100:1-101:0\">量子耐性または量子レジリエントとして説明される技術も、すべて承認プロセスの対象です</li>\n</ul>\n<h2 data-sourcepos=\"102:1-102:12\">\n<span id=\"4-結論\" class=\"fragment\"></span><a href=\"#4-%E7%B5%90%E8%AB%96\"><i class=\"fa fa-link\"></i></a>4. 結論</h2>\n<p data-sourcepos=\"104:1-104:238\">この覚書は、米国の防衛システムにおいて <strong>「QKDなどの物理層セキュリティではなく、NIST標準のアルゴリズムベースPQCを採用する」</strong> という最終決断を下した文書と言えます。</p>\n<p data-sourcepos=\"106:1-106:328\">2030年という期限は、インフラの刷新サイクルを考えると「待ったなし」のスケジュールです。共通鍵暗号の高速性を活かしつつ、鍵交換には最新のPQC標準を組み込む <strong>「正しいハイブリッド実装」</strong> が、今後の開発のスタンダードとなります。</p>\n<h2 data-sourcepos=\"108:1-108:15\">\n<span id=\"参考情報\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83%E6%83%85%E5%A0%B1\"><i class=\"fa fa-link\"></i></a>参考情報</h2>\n<ul data-sourcepos=\"110:1-113:0\">\n<li data-sourcepos=\"110:1-110:166\">\n<strong>原文書</strong>: <a href=\"https://dodcio.defense.gov/Portals/0/Documents/Library/PreparingForMigrationPQC.pdf\" rel=\"nofollow noopener\" target=\"_blank\">Preparing for Migration to Post Quantum Cryptography (DoD CIO)</a>\n</li>\n<li data-sourcepos=\"111:1-113:0\">\n<strong>情報サイト</strong>: <a href=\"https://cybersecurityks.osd.mil/DoDcs/pqc\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://cybersecurityks.osd.mil/DoDcs/pqc</a>\n<ul data-sourcepos=\"112:5-113:0\">\n<li data-sourcepos=\"112:5-113:0\">注：DoD内部向けサイトのため一般アクセス不可の可能性あり..というか、できないw</li>\n</ul>\n</li>\n</ul>\n<h2 data-sourcepos=\"114:1-114:15\">\n<span id=\"注意事項\" class=\"fragment\"></span><a href=\"#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85\"><i class=\"fa fa-link\"></i></a>注意事項</h2>\n<p data-sourcepos=\"116:1-116:222\">本記事は技術解説を目的としており、法的助言ではありません。実際の実装においては、最新の公式ガイダンスを参照し、必要に応じて専門家に相談してください。</p>\n<hr data-sourcepos=\"118:1-118:3\">\n<p data-sourcepos=\"119:1-119:222\">最後に、GMOコネクトでは研究開発や国際標準化に関する支援や技術検証をはじめ、幅広い支援を行っておりますので、何かありましたらお気軽にお問合せください。</p>\n<p data-sourcepos=\"121:1-121:47\">お問合せ: <a href=\"https://gmo-connect.jp/contactus/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://gmo-connect.jp/contactus/</a></p>\n",
      "body": "こんにちは、GMOコネクト株式会社で執行役員CTOをしている菅野 哲（かんの さとる）です。\n暗号おじさんなので暗号に関する情報を見つけると解説する病気なのでお付き合いいただけたら嬉しいです。\n\n\n## 概要\n\n**2025年11月18日**、米国防総省（Department of Defense、以下DoD）は、全コンポーネントに対しPQCへの移行準備を命じる覚書を発出しました。\n\nファーストビューが厳ついのよ。\nでも、このPDFにある公開承認スタンプが消せて保存できるのが気になったｗ\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4173853/de540750-e68d-4256-8bf1-78e801b6ade2.png)\n\n> **注記**: 原文書では \"Department of War\" (DoW) という名称が使用されています。これは2025年9月5日の大統領令14347号により、DoDが公式文書で使用することが認可された副次的名称です。\n> 法的名称は Department of Defense のままですが、本記事では一般読者の理解を助けるため、より広く認知されている DoD 表記を使用します。\n\n本記事では、エンジニアやセキュリティ実装者の視点から、この文書に含まれる **「特定の技術の禁止」** と **「移行期限」** について詳細に解説します。\n\n## 1. 公開文書の基本情報\n\n* **件名**: Preparing for Migration to Post Quantum Cryptography\n* **発信**: DoD CIO (Acting) Katherine Arrington\n* **PQC担当責任者**: Dr. Britta Hale (Director, DoD CIO PQC Directorate)\n* **目的**: 量子計算機の脅威に対し、「意図的な緊急性（deliberate urgency）」を持ってPQCへの移行を計画・実行し、情報支配権を維持すること\n* **全システム対象**: 国家安全保障システム（NSS）だけでなく、兵器システム、IoT、クラウド、モバイルなど、あらゆる区分のシステムが対象\n\n## 2. 【重要】禁止および廃止される技術\n\n本覚書の最も注目すべき点は、NIST標準以外の「耐量子」ソリューション（特に物理層セキュリティや旧来の共通鍵管理）に対して、**非常に厳しい姿勢**を示している点です。\n\n### ① 量子鍵配送（QKD）の事実上の禁止\n\n文書は、**「量子機密性（Quantum Confidentiality）」技術** または **「量子鍵配送（Keying）技術」** を、機密性・完全性・鍵配送の手段として使用することを明確に禁止しました。\n\n* **対象技術**:\n  * Quantum Key Distribution (QKD)\n      * QKDと他の暗号鍵確立を組み合わせたソリューション\n  * 量子通信またはネットワーキング\n  * 非局所的量子乱数生成\n  * FIPS非準拠の乱数生成\n\n* **理由**: これらの技術は、機密性保護、データまたはエンティティ認証、鍵配送、非局所的乱数生成の手段として認められません。DoDは、物理層の量子効果ではなく、数学的な安全性を持つPQC（耐量子計算機暗号）への一本化を選択しました。\n\n* **例外**: 上記の連絡先（Dr. Britta Hale）から例外承認を得た場合のみ、導入が認められます。\n\n### ② 共通鍵（Symmetric Key）による鍵配送の廃止\n\nここが実装者にとって最大の変更点です。データの暗号化そのものではなく、**「鍵を共有・配送するプロトコル」** において、共通鍵技術の使用が制限されます。\n\n* **廃止対象**:\n  * Symmetric key establishment protocols（共通鍵確立プロトコル）\n  * Symmetric key agreement protocols（共通鍵合意プロトコル）\n  * Symmetric key distribution protocols（共通鍵配送プロトコル）\n\n* **期限**: \n  * **2030年12月31日**までに廃止し、置換を完了すること\n  * NSA CSfC登録済みソリューションは**2031年12月31日**まで猶予\n\n* **移行先**: NISTが承認した **「非対称PQCアルゴリズム（Asymmetric PQC）」** を用いた鍵確立（例：ML-KEM）への移行が必須\n\n* **即時禁止**: 商用の共通鍵ベースの耐量子ソリューションの新規テスト・調達は、本覚書発効と同時に禁止\n\n* **既存システムの例外**: 2010年以前から共通鍵配送プロトコルを使用しているユースケースは、新たなリスクを導入するものではないため、この要件から免除されます。ただし、非対称PQCアルゴリズムベースの鍵確立へのアップグレードを検討すべきとされています。\n\n### ③ 事前共有鍵（PSK）の規制\n\n「とりあえず長いPSK（Pre-Shared Key）を使えば耐量子になる」という安易なアプローチも規制されます。\n\n* NSAのKMI（Key Management Infrastructure）経由でType 1デバイス用に提供されるPSK以外は、耐量子目的でのPSK利用は認められず、上記同様に2030年12月31日までに廃止対象\n* 商用PSKベースの耐量子ソリューションの新規テスト・調達は即時禁止\n\n## 3. 実装と開発へのインプリケーション\n\nこのポリシーは、IETF等で議論されているPQC実装の方向性を決定づけるものです。\n\n### 1. ハイブリッド鍵交換の必須化\n\n* **共通鍵暗号の役割**: AESのような共通鍵暗号アルゴリズム自体は、データプレーンの暗号化（Bulk Encryption）のために引き続き必要不可欠です。\n\n* **鍵交換の変更**: しかし、その**共通鍵を通信相手と共有するフェーズ（Control Plane）** においては、Kerberosのような共通鍵ベースの仕組みや、単純なPSKではなく、**ML-KEM** 等のPQC公開鍵暗号を用いることが強制されます。\n\n* **開発者の対応**: 自身のアプリケーションが鍵交換に何を使っているか（ECDHなのか、PSKなのか、Kerberosなのか）を再確認し、PQCなKEMへの置き換えを設計する必要があります。\n\n### 2. インベントリ（棚卸し）の自動化需要\n\n* DoDは全システムに対して「あらゆる種類の暗号」のインベントリ作成を求めています\n* CBOM（Cryptography Bill of Materials）のようなツールや、ソースコード/バイナリをスキャンして暗号ライブラリの使用箇所を特定する自動化ツールの需要が急増すると予想されます？！\n\n### 3. 中央集権的な承認プロセス\n\n* PQC関連技術のテスト、パイロット、導入を行う場合、事前にDoD CIO PQC局（Dr. Britta Hale）への報告と承認（Intake Approval）が必要です\n* 承認プロセス:\n  1. **Intake Approval**: テスト・評価・パイロット・投資・使用・調達の前に必要\n  2. **Deployment Approval**: 実際の展開前に必要（IC、NIST、NSAの認証結果を踏まえて発行）\n* 勝手な **「オレオレ耐量子実装」や「未承認アルゴリズム」の導入** は、**コンプライアンス違反** となります\n\n### 4. 技術選定の考慮事項\n\n* 本覚書は、CNSS Policy #15（2024年12月）と統合参謀本部指示6510.02（2022年8月16日）の要件に追加されるものです\n* 量子耐性または量子レジリエントとして説明される技術も、すべて承認プロセスの対象です\n\n## 4. 結論\n\nこの覚書は、米国の防衛システムにおいて **「QKDなどの物理層セキュリティではなく、NIST標準のアルゴリズムベースPQCを採用する」** という最終決断を下した文書と言えます。\n\n2030年という期限は、インフラの刷新サイクルを考えると「待ったなし」のスケジュールです。共通鍵暗号の高速性を活かしつつ、鍵交換には最新のPQC標準を組み込む **「正しいハイブリッド実装」** が、今後の開発のスタンダードとなります。\n\n## 参考情報\n\n* **原文書**: [Preparing for Migration to Post Quantum Cryptography (DoD CIO)](https://dodcio.defense.gov/Portals/0/Documents/Library/PreparingForMigrationPQC.pdf)\n* **情報サイト**: https://cybersecurityks.osd.mil/DoDcs/pqc\n    * 注：DoD内部向けサイトのため一般アクセス不可の可能性あり..というか、できないw\n\n## 注意事項\n\n本記事は技術解説を目的としており、法的助言ではありません。実際の実装においては、最新の公式ガイダンスを参照し、必要に応じて専門家に相談してください。\n\n---\n最後に、GMOコネクトでは研究開発や国際標準化に関する支援や技術検証をはじめ、幅広い支援を行っておりますので、何かありましたらお気軽にお問合せください。\n\nお問合せ: https://gmo-connect.jp/contactus/\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T12:42:37+09:00",
      "group": null,
      "id": "6743ecd48f6e607ff320",
      "likes_count": 1,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 1,
      "tags": [
        {
          "name": "量子計算機",
          "versions": []
        },
        {
          "name": "dod",
          "versions": []
        },
        {
          "name": "pqc",
          "versions": []
        },
        {
          "name": "暗号移行",
          "versions": []
        },
        {
          "name": "NIST標準",
          "versions": []
        }
      ],
      "title": "【解説】米国防総省、PQC移行へ「意図的な緊急性」を指示：QKDの禁止と共通鍵配送の廃止",
      "updated_at": "2025-12-11T12:42:37+09:00",
      "url": "https://qiita.com/satokan3/items/6743ecd48f6e607ff320",
      "user": {
        "description": "GMOコネクトで執行役員CTOしてます。\r\nIETFでの国際標準化や高機能暗号をはじめとした暗号技術全般が好物です。\r\n最近は、耐量子計算機暗号（PQC）の移行に関する「暗号の2030年問題」が気になってます。",
        "facebook_id": "satoru.kanno",
        "followees_count": 49,
        "followers_count": 82,
        "github_login_name": null,
        "id": "satokan3",
        "items_count": 43,
        "linkedin_id": "satoru-kanno",
        "location": "東京都",
        "name": "Satoru Kanno",
        "organization": "GMOコネクト株式会社",
        "permanent_id": 4173853,
        "profile_image_url": "https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/4173853/59914164d55f4fd56bac80b150f0ee1bf9c6e6c2/x_large.png?1756140172",
        "team_only": false,
        "twitter_screen_name": "satorukanno",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": "gmo-connect",
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<h1 data-sourcepos=\"1:1-1:49\">\n<span id=\"verilog自作cpuシリーズ-最終回\" class=\"fragment\"></span><a href=\"#verilog%E8%87%AA%E4%BD%9Ccpu%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-%E6%9C%80%E7%B5%82%E5%9B%9E\"><i class=\"fa fa-link\"></i></a>【Verilog自作CPU】シリーズ 最終回！</h1>\n<table data-sourcepos=\"3:1-9:78\">\n<thead>\n<tr data-sourcepos=\"3:1-3:32\">\n<th style=\"text-align: left\" data-sourcepos=\"3:2-3:7\">Part</th>\n<th style=\"text-align: left\" data-sourcepos=\"3:9-3:22\">タイトル</th>\n<th style=\"text-align: left\" data-sourcepos=\"3:24-3:31\">内容</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"5:1-5:114\">\n<td style=\"text-align: left\" data-sourcepos=\"5:2-5:65\"><a href=\"https://qiita.com/Aqua-218/items/9926da55621f0b9fed7d\" id=\"reference-d0f35434017dac4d45d5\">Part1</a></td>\n<td style=\"text-align: left\" data-sourcepos=\"5:67-5:98\">レジスタファイルとALU</td>\n<td style=\"text-align: left\" data-sourcepos=\"5:100-5:113\">基本部品</td>\n</tr>\n<tr data-sourcepos=\"6:1-6:102\">\n<td style=\"text-align: left\" data-sourcepos=\"6:2-6:65\"><a href=\"https://qiita.com/Aqua-218/items/36c81c5c4e16b0303b16\" id=\"reference-001269be9739c3c8c332\">Part2</a></td>\n<td style=\"text-align: left\" data-sourcepos=\"6:67-6:86\">命令デコーダ</td>\n<td style=\"text-align: left\" data-sourcepos=\"6:88-6:101\">命令解析</td>\n</tr>\n<tr data-sourcepos=\"7:1-7:116\">\n<td style=\"text-align: left\" data-sourcepos=\"7:2-7:65\"><a href=\"https://qiita.com/Aqua-218/items/e842553e255b87ce32bf\" id=\"reference-ae7f132d64af6d8b4633\">Part3</a></td>\n<td style=\"text-align: left\" data-sourcepos=\"7:67-7:101\">メモリとロード・ストア</td>\n<td style=\"text-align: left\" data-sourcepos=\"7:103-7:115\">LW/SW命令</td>\n</tr>\n<tr data-sourcepos=\"8:1-8:106\">\n<td style=\"text-align: left\" data-sourcepos=\"8:2-8:65\"><a href=\"https://qiita.com/Aqua-218/items/802dc86c816a50facf35\" id=\"reference-1eae1e9b09970dd56087\">Part4</a></td>\n<td style=\"text-align: left\" data-sourcepos=\"8:67-8:89\">分岐とジャンプ</td>\n<td style=\"text-align: left\" data-sourcepos=\"8:91-8:105\">BEQ/JAL命令</td>\n</tr>\n<tr data-sourcepos=\"9:1-9:78\">\n<td style=\"text-align: left\" data-sourcepos=\"9:2-9:12\"><strong>Part5</strong></td>\n<td style=\"text-align: left\" data-sourcepos=\"9:14-9:46\"><strong>CPU統合と動作テスト</strong></td>\n<td style=\"text-align: left\" data-sourcepos=\"9:48-9:77\"><strong>本記事（最終回）</strong></td>\n</tr>\n</tbody>\n</table>\n<hr data-sourcepos=\"11:1-12:0\">\n<h1 data-sourcepos=\"13:1-13:14\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n<p data-sourcepos=\"15:1-15:128\">ついに最終回です！これまで作ってきた部品を全て統合して、<strong>動くRISC-V CPUを完成</strong>させます。</p>\n<h2 data-sourcepos=\"17:1-17:21\">\n<span id=\"今回やること\" class=\"fragment\"></span><a href=\"#%E4%BB%8A%E5%9B%9E%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>今回やること</h2>\n<ol data-sourcepos=\"19:1-23:0\">\n<li data-sourcepos=\"19:1-19:39\">CPUトップモジュールの実装</li>\n<li data-sourcepos=\"20:1-20:36\">全コンポーネントの接続</li>\n<li data-sourcepos=\"21:1-21:36\">テストプログラムの実行</li>\n<li data-sourcepos=\"22:1-23:0\">動作確認</li>\n</ol>\n<hr data-sourcepos=\"24:1-25:0\">\n<h1 data-sourcepos=\"26:1-26:29\">\n<span id=\"cpuトップモジュール\" class=\"fragment\"></span><a href=\"#cpu%E3%83%88%E3%83%83%E3%83%97%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB\"><i class=\"fa fa-link\"></i></a>CPUトップモジュール</h1>\n<p data-sourcepos=\"28:1-28:57\">全ての部品を接続したトップモジュール：</p>\n<div class=\"code-frame\" data-lang=\"verilog\" data-sourcepos=\"30:1-164:3\">\n<div class=\"code-lang\"><span class=\"bold\">src/riscv_cpu.v</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">// RISC-V Single-Cycle CPU</span>\n<span class=\"k\">module</span> <span class=\"n\">riscv_cpu</span> <span class=\"p\">(</span>\n    <span class=\"kt\">input</span>         <span class=\"n\">clk</span><span class=\"p\">,</span>\n    <span class=\"kt\">input</span>         <span class=\"n\">reset</span><span class=\"p\">,</span>\n    <span class=\"kt\">output</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">pc_out</span><span class=\"p\">,</span>\n    <span class=\"kt\">output</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">instr_out</span>\n<span class=\"p\">);</span>\n    <span class=\"c1\">// PC</span>\n    <span class=\"kt\">reg</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">pc</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">pc_next</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">// 命令</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">instr</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">// デコード結果</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span>  <span class=\"n\">rs1</span><span class=\"p\">,</span> <span class=\"n\">rs2</span><span class=\"p\">,</span> <span class=\"n\">rd</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">imm</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span>        <span class=\"n\">reg_write</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span>        <span class=\"n\">mem_read</span><span class=\"p\">,</span> <span class=\"n\">mem_write</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span>        <span class=\"n\">branch</span><span class=\"p\">,</span> <span class=\"n\">jump</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span>        <span class=\"n\">alu_src</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span>  <span class=\"n\">alu_op</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span>        <span class=\"n\">mem_to_reg</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">// レジスタファイル</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">rs1_data</span><span class=\"p\">,</span> <span class=\"n\">rs2_data</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">// ALU</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">alu_a</span><span class=\"p\">,</span> <span class=\"n\">alu_b</span><span class=\"p\">,</span> <span class=\"n\">alu_result</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span>        <span class=\"n\">zero</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">// データメモリ</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">mem_data</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">// ライトバック</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">wb_data</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">//=========================================</span>\n    <span class=\"c1\">// 命令フェッチ</span>\n    <span class=\"c1\">//=========================================</span>\n    <span class=\"n\">imem</span> <span class=\"n\">instruction_memory</span> <span class=\"p\">(</span>\n        <span class=\"p\">.</span><span class=\"n\">addr</span><span class=\"p\">(</span><span class=\"n\">pc</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">data</span><span class=\"p\">(</span><span class=\"n\">instr</span><span class=\"p\">)</span>\n    <span class=\"p\">);</span>\n    \n    <span class=\"c1\">//=========================================</span>\n    <span class=\"c1\">// デコード</span>\n    <span class=\"c1\">//=========================================</span>\n    <span class=\"n\">decoder</span> <span class=\"n\">instruction_decoder</span> <span class=\"p\">(</span>\n        <span class=\"p\">.</span><span class=\"n\">instr</span><span class=\"p\">(</span><span class=\"n\">instr</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">rs1</span><span class=\"p\">(</span><span class=\"n\">rs1</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">rs2</span><span class=\"p\">(</span><span class=\"n\">rs2</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">rd</span><span class=\"p\">(</span><span class=\"n\">rd</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">imm</span><span class=\"p\">(</span><span class=\"n\">imm</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">reg_write</span><span class=\"p\">(</span><span class=\"n\">reg_write</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">mem_read</span><span class=\"p\">(</span><span class=\"n\">mem_read</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">mem_write</span><span class=\"p\">(</span><span class=\"n\">mem_write</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">branch</span><span class=\"p\">(</span><span class=\"n\">branch</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">jump</span><span class=\"p\">(</span><span class=\"n\">jump</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">alu_src</span><span class=\"p\">(</span><span class=\"n\">alu_src</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">alu_op</span><span class=\"p\">(</span><span class=\"n\">alu_op</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">mem_to_reg</span><span class=\"p\">(</span><span class=\"n\">mem_to_reg</span><span class=\"p\">)</span>\n    <span class=\"p\">);</span>\n    \n    <span class=\"c1\">//=========================================</span>\n    <span class=\"c1\">// レジスタファイル</span>\n    <span class=\"c1\">//=========================================</span>\n    <span class=\"n\">regfile</span> <span class=\"n\">registers</span> <span class=\"p\">(</span>\n        <span class=\"p\">.</span><span class=\"n\">clk</span><span class=\"p\">(</span><span class=\"n\">clk</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">we</span><span class=\"p\">(</span><span class=\"n\">reg_write</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">rs1</span><span class=\"p\">(</span><span class=\"n\">rs1</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">rs2</span><span class=\"p\">(</span><span class=\"n\">rs2</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">rd</span><span class=\"p\">(</span><span class=\"n\">rd</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">wdata</span><span class=\"p\">(</span><span class=\"n\">wb_data</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">rdata1</span><span class=\"p\">(</span><span class=\"n\">rs1_data</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">rdata2</span><span class=\"p\">(</span><span class=\"n\">rs2_data</span><span class=\"p\">)</span>\n    <span class=\"p\">);</span>\n    \n    <span class=\"c1\">//=========================================</span>\n    <span class=\"c1\">// ALU</span>\n    <span class=\"c1\">//=========================================</span>\n    <span class=\"c1\">// ALU入力選択</span>\n    <span class=\"k\">assign</span> <span class=\"n\">alu_a</span> <span class=\"o\">=</span> <span class=\"n\">rs1_data</span><span class=\"p\">;</span>\n    <span class=\"k\">assign</span> <span class=\"n\">alu_b</span> <span class=\"o\">=</span> <span class=\"n\">alu_src</span> <span class=\"o\">?</span> <span class=\"n\">imm</span> <span class=\"o\">:</span> <span class=\"n\">rs2_data</span><span class=\"p\">;</span>\n    \n    <span class=\"n\">alu</span> <span class=\"n\">main_alu</span> <span class=\"p\">(</span>\n        <span class=\"p\">.</span><span class=\"n\">a</span><span class=\"p\">(</span><span class=\"n\">alu_a</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">b</span><span class=\"p\">(</span><span class=\"n\">alu_b</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">alu_op</span><span class=\"p\">(</span><span class=\"n\">alu_op</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">result</span><span class=\"p\">(</span><span class=\"n\">alu_result</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">zero</span><span class=\"p\">(</span><span class=\"n\">zero</span><span class=\"p\">)</span>\n    <span class=\"p\">);</span>\n    \n    <span class=\"c1\">//=========================================</span>\n    <span class=\"c1\">// データメモリ</span>\n    <span class=\"c1\">//=========================================</span>\n    <span class=\"n\">dmem</span> <span class=\"n\">data_memory</span> <span class=\"p\">(</span>\n        <span class=\"p\">.</span><span class=\"n\">clk</span><span class=\"p\">(</span><span class=\"n\">clk</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">addr</span><span class=\"p\">(</span><span class=\"n\">alu_result</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">write_data</span><span class=\"p\">(</span><span class=\"n\">rs2_data</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">write_enable</span><span class=\"p\">(</span><span class=\"n\">mem_write</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">read_data</span><span class=\"p\">(</span><span class=\"n\">mem_data</span><span class=\"p\">)</span>\n    <span class=\"p\">);</span>\n    \n    <span class=\"c1\">//=========================================</span>\n    <span class=\"c1\">// ライトバック</span>\n    <span class=\"c1\">//=========================================</span>\n    <span class=\"k\">assign</span> <span class=\"n\">wb_data</span> <span class=\"o\">=</span> <span class=\"n\">mem_to_reg</span> <span class=\"o\">?</span> <span class=\"n\">mem_data</span> <span class=\"o\">:</span> <span class=\"n\">alu_result</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">//=========================================</span>\n    <span class=\"c1\">// PC制御</span>\n    <span class=\"c1\">//=========================================</span>\n    <span class=\"kt\">wire</span> <span class=\"n\">branch_taken</span> <span class=\"o\">=</span> <span class=\"n\">branch</span> <span class=\"o\">&amp;</span> <span class=\"n\">zero</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">branch_target</span> <span class=\"o\">=</span> <span class=\"n\">pc</span> <span class=\"o\">+</span> <span class=\"n\">imm</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">jump_target</span> <span class=\"o\">=</span> <span class=\"n\">pc</span> <span class=\"o\">+</span> <span class=\"n\">imm</span><span class=\"p\">;</span>\n    \n    <span class=\"k\">assign</span> <span class=\"n\">pc_next</span> <span class=\"o\">=</span> <span class=\"n\">jump</span> <span class=\"o\">?</span> <span class=\"n\">jump_target</span> <span class=\"o\">:</span>\n                     <span class=\"n\">branch_taken</span> <span class=\"o\">?</span> <span class=\"n\">branch_target</span> <span class=\"o\">:</span>\n                     <span class=\"n\">pc</span> <span class=\"o\">+</span> <span class=\"mi\">4</span><span class=\"p\">;</span>\n    \n    <span class=\"c1\">// PC更新</span>\n    <span class=\"k\">always</span> <span class=\"o\">@</span><span class=\"p\">(</span><span class=\"kt\">posedge</span> <span class=\"n\">clk</span> <span class=\"kt\">or</span> <span class=\"kt\">posedge</span> <span class=\"n\">reset</span><span class=\"p\">)</span> <span class=\"k\">begin</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">reset</span><span class=\"p\">)</span>\n            <span class=\"n\">pc</span> <span class=\"o\">&lt;=</span> <span class=\"mi\">32'd0</span><span class=\"p\">;</span>\n        <span class=\"k\">else</span>\n            <span class=\"n\">pc</span> <span class=\"o\">&lt;=</span> <span class=\"n\">pc_next</span><span class=\"p\">;</span>\n    <span class=\"k\">end</span>\n    \n    <span class=\"c1\">// デバッグ出力</span>\n    <span class=\"k\">assign</span> <span class=\"n\">pc_out</span> <span class=\"o\">=</span> <span class=\"n\">pc</span><span class=\"p\">;</span>\n    <span class=\"k\">assign</span> <span class=\"n\">instr_out</span> <span class=\"o\">=</span> <span class=\"n\">instr</span><span class=\"p\">;</span>\n    \n<span class=\"k\">endmodule</span>\n</code></pre></div>\n</div>\n<hr data-sourcepos=\"166:1-167:0\">\n<h1 data-sourcepos=\"168:1-168:20\">\n<span id=\"テストベンチ\" class=\"fragment\"></span><a href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%83%99%E3%83%B3%E3%83%81\"><i class=\"fa fa-link\"></i></a>テストベンチ</h1>\n<p data-sourcepos=\"170:1-170:60\">実際にプログラムを実行するテストベンチ：</p>\n<div class=\"code-frame\" data-lang=\"verilog\" data-sourcepos=\"172:1-270:3\">\n<div class=\"code-lang\"><span class=\"bold\">test/riscv_cpu_tb.v</span></div>\n<div class=\"highlight\"><pre><code><span class=\"cp\">`timescale</span> <span class=\"mi\">1</span><span class=\"n\">ns</span><span class=\"o\">/</span><span class=\"mi\">1</span><span class=\"n\">ps</span>\n\n<span class=\"k\">module</span> <span class=\"n\">riscv_cpu_tb</span><span class=\"p\">;</span>\n    <span class=\"kt\">reg</span>         <span class=\"n\">clk</span><span class=\"p\">;</span>\n    <span class=\"kt\">reg</span>         <span class=\"n\">reset</span><span class=\"p\">;</span>\n    <span class=\"kt\">wire</span> <span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">pc</span><span class=\"p\">,</span> <span class=\"n\">instr</span><span class=\"p\">;</span>\n\n    <span class=\"n\">riscv_cpu</span> <span class=\"n\">dut</span> <span class=\"p\">(</span>\n        <span class=\"p\">.</span><span class=\"n\">clk</span><span class=\"p\">(</span><span class=\"n\">clk</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">reset</span><span class=\"p\">(</span><span class=\"n\">reset</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">pc_out</span><span class=\"p\">(</span><span class=\"n\">pc</span><span class=\"p\">),</span>\n        <span class=\"p\">.</span><span class=\"n\">instr_out</span><span class=\"p\">(</span><span class=\"n\">instr</span><span class=\"p\">)</span>\n    <span class=\"p\">);</span>\n\n    <span class=\"c1\">// クロック生成</span>\n    <span class=\"k\">initial</span> <span class=\"n\">clk</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n    <span class=\"k\">always</span> <span class=\"p\">#</span><span class=\"mi\">5</span> <span class=\"n\">clk</span> <span class=\"o\">=</span> <span class=\"o\">~</span><span class=\"n\">clk</span><span class=\"p\">;</span>\n\n    <span class=\"k\">initial</span> <span class=\"k\">begin</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"=== RISC-V CPU Test ===\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"Testing simple program:\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"  ADDI x1, x0, 5    ; x1 = 5\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"  ADDI x2, x0, 10   ; x2 = 10\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"  ADD  x3, x1, x2   ; x3 = 15\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"  SUB  x4, x2, x1   ; x4 = 5\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"  AND  x5, x1, x2   ; x5 = 0\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"\"</span><span class=\"p\">);</span>\n        \n        <span class=\"c1\">// 命令メモリにプログラムをロード</span>\n        <span class=\"c1\">// ADDI x1, x0, 5</span>\n        <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">instruction_memory</span><span class=\"p\">.</span><span class=\"n\">memory</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mh\">32'h00500093</span><span class=\"p\">;</span>\n        <span class=\"c1\">// ADDI x2, x0, 10</span>\n        <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">instruction_memory</span><span class=\"p\">.</span><span class=\"n\">memory</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mh\">32'h00a00113</span><span class=\"p\">;</span>\n        <span class=\"c1\">// ADD x3, x1, x2</span>\n        <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">instruction_memory</span><span class=\"p\">.</span><span class=\"n\">memory</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mh\">32'h002081b3</span><span class=\"p\">;</span>\n        <span class=\"c1\">// SUB x4, x2, x1</span>\n        <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">instruction_memory</span><span class=\"p\">.</span><span class=\"n\">memory</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mh\">32'h40110233</span><span class=\"p\">;</span>\n        <span class=\"c1\">// AND x5, x1, x2</span>\n        <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">instruction_memory</span><span class=\"p\">.</span><span class=\"n\">memory</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mh\">32'h0020f2b3</span><span class=\"p\">;</span>\n        <span class=\"c1\">// NOP</span>\n        <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">instruction_memory</span><span class=\"p\">.</span><span class=\"n\">memory</span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mh\">32'h00000013</span><span class=\"p\">;</span>\n        <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">instruction_memory</span><span class=\"p\">.</span><span class=\"n\">memory</span><span class=\"p\">[</span><span class=\"mi\">6</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mh\">32'h00000013</span><span class=\"p\">;</span>\n        \n        <span class=\"c1\">// リセット</span>\n        <span class=\"n\">reset</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">;</span>\n        <span class=\"p\">#</span><span class=\"mi\">20</span><span class=\"p\">;</span>\n        <span class=\"n\">reset</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n        \n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"Executing instructions:\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"\"</span><span class=\"p\">);</span>\n        \n        <span class=\"c1\">// 各命令を実行</span>\n        <span class=\"kt\">repeat</span> <span class=\"p\">(</span><span class=\"mi\">6</span><span class=\"p\">)</span> <span class=\"k\">begin</span>\n            <span class=\"o\">@</span><span class=\"p\">(</span><span class=\"kt\">posedge</span> <span class=\"n\">clk</span><span class=\"p\">);</span>\n            <span class=\"p\">#</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n            <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"PC=0x%08x  Instr=0x%08x\"</span><span class=\"p\">,</span> <span class=\"n\">pc</span><span class=\"p\">,</span> <span class=\"n\">instr</span><span class=\"p\">);</span>\n            <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"  x1=%d, x2=%d, x3=%d, x4=%d, x5=%d\"</span><span class=\"p\">,</span> \n                     <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span>\n                     <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">],</span>\n                     <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">],</span>\n                     <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">],</span>\n                     <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]);</span>\n        <span class=\"k\">end</span>\n        \n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"=== Final Register State ===\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"x1 = %d (expected: 5)\"</span><span class=\"p\">,</span> <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"x2 = %d (expected: 10)\"</span><span class=\"p\">,</span> <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"x3 = %d (expected: 15)\"</span><span class=\"p\">,</span> <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"x4 = %d (expected: 5)\"</span><span class=\"p\">,</span> <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]);</span>\n        <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"x5 = %d (expected: 0)\"</span><span class=\"p\">,</span> <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]);</span>\n        \n        <span class=\"c1\">// 検証</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"mi\">5</span> <span class=\"o\">&amp;&amp;</span>\n            <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"mi\">10</span> <span class=\"o\">&amp;&amp;</span>\n            <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"mi\">15</span> <span class=\"o\">&amp;&amp;</span>\n            <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"mi\">5</span> <span class=\"o\">&amp;&amp;</span>\n            <span class=\"n\">dut</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">.</span><span class=\"n\">registers</span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"k\">begin</span>\n            <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"\"</span><span class=\"p\">);</span>\n            <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"*** ALL TESTS PASSED! ***\"</span><span class=\"p\">);</span>\n        <span class=\"k\">end</span> <span class=\"k\">else</span> <span class=\"k\">begin</span>\n            <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"\"</span><span class=\"p\">);</span>\n            <span class=\"p\">$</span><span class=\"nb\">display</span><span class=\"p\">(</span><span class=\"s\">\"*** SOME TESTS FAILED ***\"</span><span class=\"p\">);</span>\n        <span class=\"k\">end</span>\n        \n        <span class=\"p\">#</span><span class=\"mi\">20</span><span class=\"p\">;</span>\n        <span class=\"p\">$</span><span class=\"nb\">finish</span><span class=\"p\">;</span>\n    <span class=\"k\">end</span>\n\n    <span class=\"c1\">// 波形出力</span>\n    <span class=\"k\">initial</span> <span class=\"k\">begin</span>\n        <span class=\"p\">$</span><span class=\"nb\">dumpfile</span><span class=\"p\">(</span><span class=\"s\">\"riscv_cpu_tb.vcd\"</span><span class=\"p\">);</span>\n        <span class=\"p\">$</span><span class=\"nb\">dumpvars</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">riscv_cpu_tb</span><span class=\"p\">);</span>\n    <span class=\"k\">end</span>\n\n<span class=\"k\">endmodule</span>\n</code></pre></div>\n</div>\n<hr data-sourcepos=\"272:1-273:0\">\n<h1 data-sourcepos=\"274:1-274:14\">\n<span id=\"実行結果\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\"><i class=\"fa fa-link\"></i></a>実行結果</h1>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"276:1-281:3\"><div class=\"highlight\"><pre><code><span class=\"nv\">$ </span><span class=\"nb\">cd</span> ~/riscv-cpu\n<span class=\"nv\">$ </span>iverilog <span class=\"nt\">-o</span> cpu_test src/regfile.v src/alu.v src/decoder.v <span class=\"se\">\\</span>\n           src/imem.v src/dmem.v src/riscv_cpu.v <span class=\"nb\">test</span>/riscv_cpu_tb.v\n<span class=\"nv\">$ </span>./cpu_test\n</code></pre></div></div>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"283:1-317:3\"><div class=\"highlight\"><pre><code>=== RISC-V CPU Test ===\n\nTesting simple program:\n  ADDI x1, x0, 5    ; x1 = 5\n  ADDI x2, x0, 10   ; x2 = 10\n  ADD  x3, x1, x2   ; x3 = 15\n  SUB  x4, x2, x1   ; x4 = 5\n  AND  x5, x1, x2   ; x5 = 0\n\nVCD info: dumpfile riscv_cpu_tb.vcd opened for output.\nExecuting instructions:\n\nPC=0x00000004  Instr=0x00a00113\n  x1=         5, x2=         0, x3=         0, x4=         0, x5=         0\nPC=0x00000008  Instr=0x002081b3\n  x1=         5, x2=        10, x3=         0, x4=         0, x5=         0\nPC=0x0000000c  Instr=0x40110233\n  x1=         5, x2=        10, x3=        15, x4=         0, x5=         0\nPC=0x00000010  Instr=0x0020f2b3\n  x1=         5, x2=        10, x3=        15, x4=         5, x5=         0\nPC=0x00000014  Instr=0x00000013\n  x1=         5, x2=        10, x3=        15, x4=         5, x5=         0\nPC=0x00000018  Instr=0x00000013\n  x1=         5, x2=        10, x3=        15, x4=         5, x5=         0\n\n=== Final Register State ===\nx1 =          5 (expected: 5)\nx2 =         10 (expected: 10)\nx3 =         15 (expected: 15)\nx4 =          5 (expected: 5)\nx5 =          0 (expected: 0)\n\n*** ALL TESTS PASSED! ***\n</code></pre></div></div>\n<p data-sourcepos=\"319:1-319:42\">🎉 <strong>CPU完成！全テスト合格！</strong></p>\n<hr data-sourcepos=\"321:1-322:0\">\n<h1 data-sourcepos=\"323:1-323:17\">\n<span id=\"動作の解説\" class=\"fragment\"></span><a href=\"#%E5%8B%95%E4%BD%9C%E3%81%AE%E8%A7%A3%E8%AA%AC\"><i class=\"fa fa-link\"></i></a>動作の解説</h1>\n<p data-sourcepos=\"325:1-325:66\">シミュレーション結果を詳しく見てみましょう：</p>\n<h2 data-sourcepos=\"327:1-327:32\">\n<span id=\"サイクル1-addi-x1-x0-5\" class=\"fragment\"></span><a href=\"#%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB1-addi-x1-x0-5\"><i class=\"fa fa-link\"></i></a>サイクル1: ADDI x1, x0, 5</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"329:1-332:3\"><div class=\"highlight\"><pre><code>PC=0x00000004  Instr=0x00a00113\n  x1=5, x2=0, x3=0, x4=0, x5=0\n</code></pre></div></div>\n<ul data-sourcepos=\"334:1-337:0\">\n<li data-sourcepos=\"334:1-334:43\">PC=0 の命令 <code>ADDI x1, x0, 5</code> を実行</li>\n<li data-sourcepos=\"335:1-335:39\">x0(=0) + 5 = 5 を x1 に書き込み</li>\n<li data-sourcepos=\"336:1-337:0\">PC は次の命令 0x04 を指している</li>\n</ul>\n<h2 data-sourcepos=\"338:1-338:33\">\n<span id=\"サイクル2-addi-x2-x0-10\" class=\"fragment\"></span><a href=\"#%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB2-addi-x2-x0-10\"><i class=\"fa fa-link\"></i></a>サイクル2: ADDI x2, x0, 10</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"340:1-343:3\"><div class=\"highlight\"><pre><code>PC=0x00000008  Instr=0x002081b3\n  x1=5, x2=10, x3=0, x4=0, x5=0\n</code></pre></div></div>\n<ul data-sourcepos=\"345:1-346:0\">\n<li data-sourcepos=\"345:1-346:0\">x0 + 10 = 10 を x2 に書き込み</li>\n</ul>\n<h2 data-sourcepos=\"347:1-347:32\">\n<span id=\"サイクル3-add-x3-x1-x2\" class=\"fragment\"></span><a href=\"#%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB3-add-x3-x1-x2\"><i class=\"fa fa-link\"></i></a>サイクル3: ADD x3, x1, x2</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"349:1-352:3\"><div class=\"highlight\"><pre><code>PC=0x0000000c  Instr=0x40110233\n  x1=5, x2=10, x3=15, x4=0, x5=0\n</code></pre></div></div>\n<ul data-sourcepos=\"354:1-355:0\">\n<li data-sourcepos=\"354:1-355:0\">x1(=5) + x2(=10) = 15 を x3 に書き込み</li>\n</ul>\n<h2 data-sourcepos=\"356:1-356:32\">\n<span id=\"サイクル4-sub-x4-x2-x1\" class=\"fragment\"></span><a href=\"#%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB4-sub-x4-x2-x1\"><i class=\"fa fa-link\"></i></a>サイクル4: SUB x4, x2, x1</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"358:1-361:3\"><div class=\"highlight\"><pre><code>PC=0x00000010  Instr=0x0020f2b3\n  x1=5, x2=10, x3=15, x4=5, x5=0\n</code></pre></div></div>\n<ul data-sourcepos=\"363:1-364:0\">\n<li data-sourcepos=\"363:1-364:0\">x2(=10) - x1(=5) = 5 を x4 に書き込み</li>\n</ul>\n<h2 data-sourcepos=\"365:1-365:32\">\n<span id=\"サイクル5-and-x5-x1-x2\" class=\"fragment\"></span><a href=\"#%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB5-and-x5-x1-x2\"><i class=\"fa fa-link\"></i></a>サイクル5: AND x5, x1, x2</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"367:1-370:3\"><div class=\"highlight\"><pre><code>PC=0x00000014\n  x1=5, x2=10, x3=15, x4=5, x5=0\n</code></pre></div></div>\n<ul data-sourcepos=\"372:1-373:0\">\n<li data-sourcepos=\"372:1-373:0\">x1(=5) &amp; x2(=10) = 0b0101 &amp; 0b1010 = 0</li>\n</ul>\n<p data-sourcepos=\"374:1-374:51\">全ての演算が正しく実行されました！</p>\n<hr data-sourcepos=\"376:1-377:0\">\n<h1 data-sourcepos=\"378:1-378:20\">\n<span id=\"波形ビューア\" class=\"fragment\"></span><a href=\"#%E6%B3%A2%E5%BD%A2%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2\"><i class=\"fa fa-link\"></i></a>波形ビューア</h1>\n<p data-sourcepos=\"380:1-380:49\">GTKWaveで波形を見ることもできます：</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"382:1-384:3\"><div class=\"highlight\"><pre><code><span class=\"nv\">$ </span>gtkwave riscv_cpu_tb.vcd\n</code></pre></div></div>\n<p data-sourcepos=\"386:1-386:77\"><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fplacehold.jp%2F400x200.png%3Ftext%3DGTKWave%2Bwaveform?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=faa3975c90daaf1a059d59aef9e146a5\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fplacehold.jp%2F400x200.png%3Ftext%3DGTKWave%2Bwaveform?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=faa3975c90daaf1a059d59aef9e146a5\" alt=\"波形イメージ\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fplacehold.jp%2F400x200.png%3Ftext%3DGTKWave%2Bwaveform?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4bc38186ae51d8f9157beecc7846dad0 1x\" data-canonical-src=\"https://placehold.jp/400x200.png?text=GTKWave+waveform\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"388:1-388:117\">クロックに同期してPCが4ずつ増加し、レジスタの値が更新されていく様子が見えます。</p>\n<hr data-sourcepos=\"390:1-391:0\">\n<h1 data-sourcepos=\"392:1-392:26\">\n<span id=\"完成したcpuの仕様\" class=\"fragment\"></span><a href=\"#%E5%AE%8C%E6%88%90%E3%81%97%E3%81%9Fcpu%E3%81%AE%E4%BB%95%E6%A7%98\"><i class=\"fa fa-link\"></i></a>完成したCPUの仕様</h1>\n<table data-sourcepos=\"394:1-401:61\">\n<thead>\n<tr data-sourcepos=\"394:1-394:19\">\n<th style=\"text-align: left\" data-sourcepos=\"394:2-394:9\">項目</th>\n<th style=\"text-align: left\" data-sourcepos=\"394:11-394:18\">仕様</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"396:1-396:61\">\n<td style=\"text-align: left\" data-sourcepos=\"396:2-396:24\">アーキテクチャ</td>\n<td style=\"text-align: left\" data-sourcepos=\"396:26-396:60\">RISC-V RV32I（サブセット）</td>\n</tr>\n<tr data-sourcepos=\"397:1-397:30\">\n<td style=\"text-align: left\" data-sourcepos=\"397:2-397:15\">データ幅</td>\n<td style=\"text-align: left\" data-sourcepos=\"397:17-397:29\">32ビット</td>\n</tr>\n<tr data-sourcepos=\"398:1-398:42\">\n<td style=\"text-align: left\" data-sourcepos=\"398:2-398:15\">レジスタ</td>\n<td style=\"text-align: left\" data-sourcepos=\"398:17-398:41\">32本（x0は常に0）</td>\n</tr>\n<tr data-sourcepos=\"399:1-399:37\">\n<td style=\"text-align: left\" data-sourcepos=\"399:2-399:18\">命令メモリ</td>\n<td style=\"text-align: left\" data-sourcepos=\"399:20-399:36\">1KB (256命令)</td>\n</tr>\n<tr data-sourcepos=\"400:1-400:28\">\n<td style=\"text-align: left\" data-sourcepos=\"400:2-400:21\">データメモリ</td>\n<td style=\"text-align: left\" data-sourcepos=\"400:23-400:27\">1KB</td>\n</tr>\n<tr data-sourcepos=\"401:1-401:61\">\n<td style=\"text-align: left\" data-sourcepos=\"401:2-401:21\">パイプライン</td>\n<td style=\"text-align: left\" data-sourcepos=\"401:23-401:60\">なし（シングルサイクル）</td>\n</tr>\n</tbody>\n</table>\n<h2 data-sourcepos=\"403:1-403:21\">\n<span id=\"サポート命令\" class=\"fragment\"></span><a href=\"#%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88%E5%91%BD%E4%BB%A4\"><i class=\"fa fa-link\"></i></a>サポート命令</h2>\n<table data-sourcepos=\"405:1-413:28\">\n<thead>\n<tr data-sourcepos=\"405:1-405:25\">\n<th style=\"text-align: left\" data-sourcepos=\"405:2-405:15\">カテゴリ</th>\n<th style=\"text-align: left\" data-sourcepos=\"405:17-405:24\">命令</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"407:1-407:33\">\n<td style=\"text-align: left\" data-sourcepos=\"407:2-407:15\">算術演算</td>\n<td style=\"text-align: left\" data-sourcepos=\"407:17-407:32\">ADD, SUB, ADDI</td>\n</tr>\n<tr data-sourcepos=\"408:1-408:48\">\n<td style=\"text-align: left\" data-sourcepos=\"408:2-408:15\">論理演算</td>\n<td style=\"text-align: left\" data-sourcepos=\"408:17-408:47\">AND, OR, XOR, ANDI, ORI, XORI</td>\n</tr>\n<tr data-sourcepos=\"409:1-409:47\">\n<td style=\"text-align: left\" data-sourcepos=\"409:2-409:12\">シフト</td>\n<td style=\"text-align: left\" data-sourcepos=\"409:14-409:46\">SLL, SRL, SRA, SLLI, SRLI, SRAI</td>\n</tr>\n<tr data-sourcepos=\"410:1-410:35\">\n<td style=\"text-align: left\" data-sourcepos=\"410:2-410:9\">比較</td>\n<td style=\"text-align: left\" data-sourcepos=\"410:11-410:34\">SLT, SLTU, SLTI, SLTIU</td>\n</tr>\n<tr data-sourcepos=\"411:1-411:22\">\n<td style=\"text-align: left\" data-sourcepos=\"411:2-411:12\">メモリ</td>\n<td style=\"text-align: left\" data-sourcepos=\"411:14-411:21\">LW, SW</td>\n</tr>\n<tr data-sourcepos=\"412:1-412:55\">\n<td style=\"text-align: left\" data-sourcepos=\"412:2-412:9\">分岐</td>\n<td style=\"text-align: left\" data-sourcepos=\"412:11-412:54\">BEQ (※他の分岐命令も対応可能)</td>\n</tr>\n<tr data-sourcepos=\"413:1-413:28\">\n<td style=\"text-align: left\" data-sourcepos=\"413:2-413:15\">ジャンプ</td>\n<td style=\"text-align: left\" data-sourcepos=\"413:17-413:27\">JAL, JALR</td>\n</tr>\n</tbody>\n</table>\n<hr data-sourcepos=\"415:1-416:0\">\n<h1 data-sourcepos=\"417:1-417:17\">\n<span id=\"今後の拡張\" class=\"fragment\"></span><a href=\"#%E4%BB%8A%E5%BE%8C%E3%81%AE%E6%8B%A1%E5%BC%B5\"><i class=\"fa fa-link\"></i></a>今後の拡張</h1>\n<p data-sourcepos=\"419:1-419:60\">このCPUをベースに、以下の拡張が可能です：</p>\n<h2 data-sourcepos=\"421:1-421:24\">\n<span id=\"パイプライン化\" class=\"fragment\"></span><a href=\"#%E3%83%91%E3%82%A4%E3%83%97%E3%83%A9%E3%82%A4%E3%83%B3%E5%8C%96\"><i class=\"fa fa-link\"></i></a>パイプライン化</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"423:1-425:3\"><div class=\"highlight\"><pre><code>IF → ID → EX → MEM → WB\n</code></pre></div></div>\n<p data-sourcepos=\"427:1-427:79\">5段パイプラインで性能向上。ただしハザード処理が必要。</p>\n<h2 data-sourcepos=\"429:1-429:27\">\n<span id=\"キャッシュの追加\" class=\"fragment\"></span><a href=\"#%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%AE%E8%BF%BD%E5%8A%A0\"><i class=\"fa fa-link\"></i></a>キャッシュの追加</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"431:1-433:3\"><div class=\"highlight\"><pre><code>CPU ←→ L1 Cache ←→ Main Memory\n</code></pre></div></div>\n<p data-sourcepos=\"435:1-435:36\">メモリアクセスの高速化。</p>\n<h2 data-sourcepos=\"437:1-437:21\">\n<span id=\"割り込み対応\" class=\"fragment\"></span><a href=\"#%E5%89%B2%E3%82%8A%E8%BE%BC%E3%81%BF%E5%AF%BE%E5%BF%9C\"><i class=\"fa fa-link\"></i></a>割り込み対応</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"439:1-442:3\"><div class=\"highlight\"><pre><code>CSR（Control and Status Registers）\n例外処理機構\n</code></pre></div></div>\n<p data-sourcepos=\"444:1-444:20\">OS実装に必須。</p>\n<h2 data-sourcepos=\"446:1-446:13\">\n<span id=\"fpga実装\" class=\"fragment\"></span><a href=\"#fpga%E5%AE%9F%E8%A3%85\"><i class=\"fa fa-link\"></i></a>FPGA実装</h2>\n<p data-sourcepos=\"448:1-448:60\">実際のFPGA（Xilinx, Intel/Alteraなど）で動かす！</p>\n<hr data-sourcepos=\"450:1-451:0\">\n<h1 data-sourcepos=\"452:1-452:11\">\n<span id=\"まとめ\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>まとめ</h1>\n<p data-sourcepos=\"454:1-454:81\">5回にわたるシリーズで、<strong>ゼロからRISC-V CPUを作りました！</strong></p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"456:1-462:3\"><div class=\"highlight\"><pre><code>Part1: レジスタファイル + ALU\nPart2: 命令デコーダ\nPart3: メモリアクセス\nPart4: 分岐・ジャンプ\nPart5: CPU統合・完成！\n</code></pre></div></div>\n<h2 data-sourcepos=\"464:1-464:18\">\n<span id=\"学んだこと\" class=\"fragment\"></span><a href=\"#%E5%AD%A6%E3%82%93%E3%81%A0%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>学んだこと</h2>\n<ol data-sourcepos=\"466:1-470:0\">\n<li data-sourcepos=\"466:1-466:60\">\n<strong>CPUの基本構造</strong> - PC, レジスタ, ALU, メモリ</li>\n<li data-sourcepos=\"467:1-467:62\">\n<strong>RISC-V命令セット</strong> - 6つの命令フォーマット</li>\n<li data-sourcepos=\"468:1-468:65\">\n<strong>Verilog記述</strong> - モジュール設計、テストベンチ</li>\n<li data-sourcepos=\"469:1-470:0\">\n<strong>シミュレーション</strong> - iverilogによる動作確認</li>\n</ol>\n<h2 data-sourcepos=\"471:1-471:21\">\n<span id=\"ファイル一覧\" class=\"fragment\"></span><a href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E4%B8%80%E8%A6%A7\"><i class=\"fa fa-link\"></i></a>ファイル一覧</h2>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"473:1-487:3\"><div class=\"highlight\"><pre><code>~/riscv-cpu/\n├── src/\n│   ├── regfile.v      # レジスタファイル\n│   ├── alu.v          # ALU\n│   ├── decoder.v      # 命令デコーダ\n│   ├── imem.v         # 命令メモリ\n│   ├── dmem.v         # データメモリ\n│   └── riscv_cpu.v    # CPUトップモジュール\n└── test/\n    ├── regfile_tb.v   # テストベンチ\n    ├── alu_tb.v\n    ├── decoder_tb.v\n    └── riscv_cpu_tb.v\n</code></pre></div></div>\n<hr data-sourcepos=\"489:1-490:0\">\n<h1 data-sourcepos=\"491:1-491:14\">\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h1>\n<p data-sourcepos=\"493:1-493:189\">「CPUって難しそう」と思っていた方も、一つずつ部品を作って組み合わせていけば、ちゃんと動くものが作れることがわかったと思います。</p>\n<p data-sourcepos=\"495:1-495:172\">このシリーズのコードは自由に使ってください。FPGAに載せたり、パイプライン化したり、自分なりの拡張を楽しんでください！</p>\n<p data-sourcepos=\"497:1-497:73\">ここまで読んでいただきありがとうございました！🎉</p>\n<hr data-sourcepos=\"499:1-500:0\">\n<h2 data-sourcepos=\"501:1-501:15\">\n<span id=\"参考資料\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\"><i class=\"fa fa-link\"></i></a>参考資料</h2>\n<ul data-sourcepos=\"503:1-505:0\">\n<li data-sourcepos=\"503:1-503:64\"><a href=\"https://riscv.org/technical/specifications/\" rel=\"nofollow noopener\" target=\"_blank\">RISC-V仕様書</a></li>\n<li data-sourcepos=\"504:1-505:0\"><a href=\"https://www.amazon.co.jp/dp/4822298426\" rel=\"nofollow noopener\" target=\"_blank\">Patterson &amp; Hennessy「コンピュータの構成と設計」</a></li>\n</ul>\n<hr data-sourcepos=\"506:1-507:0\">\n<h2 data-sourcepos=\"508:1-508:21\">\n<span id=\"関連シリーズ\" class=\"fragment\"></span><a href=\"#%E9%96%A2%E9%80%A3%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA\"><i class=\"fa fa-link\"></i></a>関連シリーズ</h2>\n<ul data-sourcepos=\"510:1-510:105\">\n<li data-sourcepos=\"510:1-510:105\"><a href=\"https://qiita.com/Aqua-218/items/cff90b502753b122399a\" id=\"reference-0e1a8173411a953d135c\">UEFIベアメタルプログラミング入門</a></li>\n</ul>\n",
      "body": "# 【Verilog自作CPU】シリーズ 最終回！\n\n| Part | タイトル | 内容 |\n|:--|:--|:--|\n| [Part1](https://qiita.com/Aqua-218/items/9926da55621f0b9fed7d) | レジスタファイルとALU | 基本部品 |\n| [Part2](https://qiita.com/Aqua-218/items/36c81c5c4e16b0303b16) | 命令デコーダ | 命令解析 |\n| [Part3](https://qiita.com/Aqua-218/items/e842553e255b87ce32bf) | メモリとロード・ストア | LW/SW命令 |\n| [Part4](https://qiita.com/Aqua-218/items/802dc86c816a50facf35) | 分岐とジャンプ | BEQ/JAL命令 |\n| **Part5** | **CPU統合と動作テスト** | **本記事（最終回）** |\n\n---\n\n# はじめに\n\nついに最終回です！これまで作ってきた部品を全て統合して、**動くRISC-V CPUを完成**させます。\n\n## 今回やること\n\n1. CPUトップモジュールの実装\n2. 全コンポーネントの接続\n3. テストプログラムの実行\n4. 動作確認\n\n---\n\n# CPUトップモジュール\n\n全ての部品を接続したトップモジュール：\n\n```verilog:src/riscv_cpu.v\n// RISC-V Single-Cycle CPU\nmodule riscv_cpu (\n    input         clk,\n    input         reset,\n    output [31:0] pc_out,\n    output [31:0] instr_out\n);\n    // PC\n    reg [31:0] pc;\n    wire [31:0] pc_next;\n    \n    // 命令\n    wire [31:0] instr;\n    \n    // デコード結果\n    wire [4:0]  rs1, rs2, rd;\n    wire [31:0] imm;\n    wire        reg_write;\n    wire        mem_read, mem_write;\n    wire        branch, jump;\n    wire        alu_src;\n    wire [3:0]  alu_op;\n    wire        mem_to_reg;\n    \n    // レジスタファイル\n    wire [31:0] rs1_data, rs2_data;\n    \n    // ALU\n    wire [31:0] alu_a, alu_b, alu_result;\n    wire        zero;\n    \n    // データメモリ\n    wire [31:0] mem_data;\n    \n    // ライトバック\n    wire [31:0] wb_data;\n    \n    //=========================================\n    // 命令フェッチ\n    //=========================================\n    imem instruction_memory (\n        .addr(pc),\n        .data(instr)\n    );\n    \n    //=========================================\n    // デコード\n    //=========================================\n    decoder instruction_decoder (\n        .instr(instr),\n        .rs1(rs1),\n        .rs2(rs2),\n        .rd(rd),\n        .imm(imm),\n        .reg_write(reg_write),\n        .mem_read(mem_read),\n        .mem_write(mem_write),\n        .branch(branch),\n        .jump(jump),\n        .alu_src(alu_src),\n        .alu_op(alu_op),\n        .mem_to_reg(mem_to_reg)\n    );\n    \n    //=========================================\n    // レジスタファイル\n    //=========================================\n    regfile registers (\n        .clk(clk),\n        .we(reg_write),\n        .rs1(rs1),\n        .rs2(rs2),\n        .rd(rd),\n        .wdata(wb_data),\n        .rdata1(rs1_data),\n        .rdata2(rs2_data)\n    );\n    \n    //=========================================\n    // ALU\n    //=========================================\n    // ALU入力選択\n    assign alu_a = rs1_data;\n    assign alu_b = alu_src ? imm : rs2_data;\n    \n    alu main_alu (\n        .a(alu_a),\n        .b(alu_b),\n        .alu_op(alu_op),\n        .result(alu_result),\n        .zero(zero)\n    );\n    \n    //=========================================\n    // データメモリ\n    //=========================================\n    dmem data_memory (\n        .clk(clk),\n        .addr(alu_result),\n        .write_data(rs2_data),\n        .write_enable(mem_write),\n        .read_data(mem_data)\n    );\n    \n    //=========================================\n    // ライトバック\n    //=========================================\n    assign wb_data = mem_to_reg ? mem_data : alu_result;\n    \n    //=========================================\n    // PC制御\n    //=========================================\n    wire branch_taken = branch & zero;\n    wire [31:0] branch_target = pc + imm;\n    wire [31:0] jump_target = pc + imm;\n    \n    assign pc_next = jump ? jump_target :\n                     branch_taken ? branch_target :\n                     pc + 4;\n    \n    // PC更新\n    always @(posedge clk or posedge reset) begin\n        if (reset)\n            pc <= 32'd0;\n        else\n            pc <= pc_next;\n    end\n    \n    // デバッグ出力\n    assign pc_out = pc;\n    assign instr_out = instr;\n    \nendmodule\n```\n\n---\n\n# テストベンチ\n\n実際にプログラムを実行するテストベンチ：\n\n```verilog:test/riscv_cpu_tb.v\n`timescale 1ns/1ps\n\nmodule riscv_cpu_tb;\n    reg         clk;\n    reg         reset;\n    wire [31:0] pc, instr;\n\n    riscv_cpu dut (\n        .clk(clk),\n        .reset(reset),\n        .pc_out(pc),\n        .instr_out(instr)\n    );\n\n    // クロック生成\n    initial clk = 0;\n    always #5 clk = ~clk;\n\n    initial begin\n        $display(\"=== RISC-V CPU Test ===\");\n        $display(\"\");\n        $display(\"Testing simple program:\");\n        $display(\"  ADDI x1, x0, 5    ; x1 = 5\");\n        $display(\"  ADDI x2, x0, 10   ; x2 = 10\");\n        $display(\"  ADD  x3, x1, x2   ; x3 = 15\");\n        $display(\"  SUB  x4, x2, x1   ; x4 = 5\");\n        $display(\"  AND  x5, x1, x2   ; x5 = 0\");\n        $display(\"\");\n        \n        // 命令メモリにプログラムをロード\n        // ADDI x1, x0, 5\n        dut.instruction_memory.memory[0] = 32'h00500093;\n        // ADDI x2, x0, 10\n        dut.instruction_memory.memory[1] = 32'h00a00113;\n        // ADD x3, x1, x2\n        dut.instruction_memory.memory[2] = 32'h002081b3;\n        // SUB x4, x2, x1\n        dut.instruction_memory.memory[3] = 32'h40110233;\n        // AND x5, x1, x2\n        dut.instruction_memory.memory[4] = 32'h0020f2b3;\n        // NOP\n        dut.instruction_memory.memory[5] = 32'h00000013;\n        dut.instruction_memory.memory[6] = 32'h00000013;\n        \n        // リセット\n        reset = 1;\n        #20;\n        reset = 0;\n        \n        $display(\"Executing instructions:\");\n        $display(\"\");\n        \n        // 各命令を実行\n        repeat (6) begin\n            @(posedge clk);\n            #1;\n            $display(\"PC=0x%08x  Instr=0x%08x\", pc, instr);\n            $display(\"  x1=%d, x2=%d, x3=%d, x4=%d, x5=%d\", \n                     dut.registers.registers[1],\n                     dut.registers.registers[2],\n                     dut.registers.registers[3],\n                     dut.registers.registers[4],\n                     dut.registers.registers[5]);\n        end\n        \n        $display(\"\");\n        $display(\"=== Final Register State ===\");\n        $display(\"x1 = %d (expected: 5)\", dut.registers.registers[1]);\n        $display(\"x2 = %d (expected: 10)\", dut.registers.registers[2]);\n        $display(\"x3 = %d (expected: 15)\", dut.registers.registers[3]);\n        $display(\"x4 = %d (expected: 5)\", dut.registers.registers[4]);\n        $display(\"x5 = %d (expected: 0)\", dut.registers.registers[5]);\n        \n        // 検証\n        if (dut.registers.registers[1] == 5 &&\n            dut.registers.registers[2] == 10 &&\n            dut.registers.registers[3] == 15 &&\n            dut.registers.registers[4] == 5 &&\n            dut.registers.registers[5] == 0) begin\n            $display(\"\");\n            $display(\"*** ALL TESTS PASSED! ***\");\n        end else begin\n            $display(\"\");\n            $display(\"*** SOME TESTS FAILED ***\");\n        end\n        \n        #20;\n        $finish;\n    end\n\n    // 波形出力\n    initial begin\n        $dumpfile(\"riscv_cpu_tb.vcd\");\n        $dumpvars(0, riscv_cpu_tb);\n    end\n\nendmodule\n```\n\n---\n\n# 実行結果\n\n```bash\n$ cd ~/riscv-cpu\n$ iverilog -o cpu_test src/regfile.v src/alu.v src/decoder.v \\\n           src/imem.v src/dmem.v src/riscv_cpu.v test/riscv_cpu_tb.v\n$ ./cpu_test\n```\n\n```\n=== RISC-V CPU Test ===\n\nTesting simple program:\n  ADDI x1, x0, 5    ; x1 = 5\n  ADDI x2, x0, 10   ; x2 = 10\n  ADD  x3, x1, x2   ; x3 = 15\n  SUB  x4, x2, x1   ; x4 = 5\n  AND  x5, x1, x2   ; x5 = 0\n\nVCD info: dumpfile riscv_cpu_tb.vcd opened for output.\nExecuting instructions:\n\nPC=0x00000004  Instr=0x00a00113\n  x1=         5, x2=         0, x3=         0, x4=         0, x5=         0\nPC=0x00000008  Instr=0x002081b3\n  x1=         5, x2=        10, x3=         0, x4=         0, x5=         0\nPC=0x0000000c  Instr=0x40110233\n  x1=         5, x2=        10, x3=        15, x4=         0, x5=         0\nPC=0x00000010  Instr=0x0020f2b3\n  x1=         5, x2=        10, x3=        15, x4=         5, x5=         0\nPC=0x00000014  Instr=0x00000013\n  x1=         5, x2=        10, x3=        15, x4=         5, x5=         0\nPC=0x00000018  Instr=0x00000013\n  x1=         5, x2=        10, x3=        15, x4=         5, x5=         0\n\n=== Final Register State ===\nx1 =          5 (expected: 5)\nx2 =         10 (expected: 10)\nx3 =         15 (expected: 15)\nx4 =          5 (expected: 5)\nx5 =          0 (expected: 0)\n\n*** ALL TESTS PASSED! ***\n```\n\n🎉 **CPU完成！全テスト合格！**\n\n---\n\n# 動作の解説\n\nシミュレーション結果を詳しく見てみましょう：\n\n## サイクル1: ADDI x1, x0, 5\n\n```\nPC=0x00000004  Instr=0x00a00113\n  x1=5, x2=0, x3=0, x4=0, x5=0\n```\n\n- PC=0 の命令 `ADDI x1, x0, 5` を実行\n- x0(=0) + 5 = 5 を x1 に書き込み\n- PC は次の命令 0x04 を指している\n\n## サイクル2: ADDI x2, x0, 10\n\n```\nPC=0x00000008  Instr=0x002081b3\n  x1=5, x2=10, x3=0, x4=0, x5=0\n```\n\n- x0 + 10 = 10 を x2 に書き込み\n\n## サイクル3: ADD x3, x1, x2\n\n```\nPC=0x0000000c  Instr=0x40110233\n  x1=5, x2=10, x3=15, x4=0, x5=0\n```\n\n- x1(=5) + x2(=10) = 15 を x3 に書き込み\n\n## サイクル4: SUB x4, x2, x1\n\n```\nPC=0x00000010  Instr=0x0020f2b3\n  x1=5, x2=10, x3=15, x4=5, x5=0\n```\n\n- x2(=10) - x1(=5) = 5 を x4 に書き込み\n\n## サイクル5: AND x5, x1, x2\n\n```\nPC=0x00000014\n  x1=5, x2=10, x3=15, x4=5, x5=0\n```\n\n- x1(=5) & x2(=10) = 0b0101 & 0b1010 = 0\n\n全ての演算が正しく実行されました！\n\n---\n\n# 波形ビューア\n\nGTKWaveで波形を見ることもできます：\n\n```bash\n$ gtkwave riscv_cpu_tb.vcd\n```\n\n![波形イメージ](https://placehold.jp/400x200.png?text=GTKWave+waveform)\n\nクロックに同期してPCが4ずつ増加し、レジスタの値が更新されていく様子が見えます。\n\n---\n\n# 完成したCPUの仕様\n\n| 項目 | 仕様 |\n|:--|:--|\n| アーキテクチャ | RISC-V RV32I（サブセット） |\n| データ幅 | 32ビット |\n| レジスタ | 32本（x0は常に0） |\n| 命令メモリ | 1KB (256命令) |\n| データメモリ | 1KB |\n| パイプライン | なし（シングルサイクル） |\n\n## サポート命令\n\n| カテゴリ | 命令 |\n|:--|:--|\n| 算術演算 | ADD, SUB, ADDI |\n| 論理演算 | AND, OR, XOR, ANDI, ORI, XORI |\n| シフト | SLL, SRL, SRA, SLLI, SRLI, SRAI |\n| 比較 | SLT, SLTU, SLTI, SLTIU |\n| メモリ | LW, SW |\n| 分岐 | BEQ (※他の分岐命令も対応可能) |\n| ジャンプ | JAL, JALR |\n\n---\n\n# 今後の拡張\n\nこのCPUをベースに、以下の拡張が可能です：\n\n## パイプライン化\n\n```\nIF → ID → EX → MEM → WB\n```\n\n5段パイプラインで性能向上。ただしハザード処理が必要。\n\n## キャッシュの追加\n\n```\nCPU ←→ L1 Cache ←→ Main Memory\n```\n\nメモリアクセスの高速化。\n\n## 割り込み対応\n\n```\nCSR（Control and Status Registers）\n例外処理機構\n```\n\nOS実装に必須。\n\n## FPGA実装\n\n実際のFPGA（Xilinx, Intel/Alteraなど）で動かす！\n\n---\n\n# まとめ\n\n5回にわたるシリーズで、**ゼロからRISC-V CPUを作りました！**\n\n```\nPart1: レジスタファイル + ALU\nPart2: 命令デコーダ\nPart3: メモリアクセス\nPart4: 分岐・ジャンプ\nPart5: CPU統合・完成！\n```\n\n## 学んだこと\n\n1. **CPUの基本構造** - PC, レジスタ, ALU, メモリ\n2. **RISC-V命令セット** - 6つの命令フォーマット\n3. **Verilog記述** - モジュール設計、テストベンチ\n4. **シミュレーション** - iverilogによる動作確認\n\n## ファイル一覧\n\n```\n~/riscv-cpu/\n├── src/\n│   ├── regfile.v      # レジスタファイル\n│   ├── alu.v          # ALU\n│   ├── decoder.v      # 命令デコーダ\n│   ├── imem.v         # 命令メモリ\n│   ├── dmem.v         # データメモリ\n│   └── riscv_cpu.v    # CPUトップモジュール\n└── test/\n    ├── regfile_tb.v   # テストベンチ\n    ├── alu_tb.v\n    ├── decoder_tb.v\n    └── riscv_cpu_tb.v\n```\n\n---\n\n# おわりに\n\n「CPUって難しそう」と思っていた方も、一つずつ部品を作って組み合わせていけば、ちゃんと動くものが作れることがわかったと思います。\n\nこのシリーズのコードは自由に使ってください。FPGAに載せたり、パイプライン化したり、自分なりの拡張を楽しんでください！\n\nここまで読んでいただきありがとうございました！🎉\n\n---\n\n## 参考資料\n\n- [RISC-V仕様書](https://riscv.org/technical/specifications/)\n- [Patterson & Hennessy「コンピュータの構成と設計」](https://www.amazon.co.jp/dp/4822298426)\n\n---\n\n## 関連シリーズ\n\n- [UEFIベアメタルプログラミング入門](https://qiita.com/Aqua-218/items/cff90b502753b122399a)\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T12:41:57+09:00",
      "group": null,
      "id": "38fe0fd3a95adcc34119",
      "likes_count": 1,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Verilog",
          "versions": []
        },
        {
          "name": "CPU",
          "versions": []
        },
        {
          "name": "自作cpu",
          "versions": []
        },
        {
          "name": "RISC-V",
          "versions": []
        },
        {
          "name": "アドベントカレンダー2025",
          "versions": []
        }
      ],
      "title": "【Verilogで自作CPU】RISC-Vプロセッサを作る Part5 - CPU完成！",
      "updated_at": "2025-12-11T12:52:01+09:00",
      "url": "https://qiita.com/Aqua-218/items/38fe0fd3a95adcc34119",
      "user": {
        "description": "こんにちは！Aquaです。\r\n現役中学生プログラマーとして、低レイヤー開発に日々奮闘しています。\r\n「なぜそう動くのか？」を徹底的に追求し、自力で解決していくプロセスが大好きです。\r\nコメントやフィードバックも大歓迎です！\r\nhttps://x.com/aqua_developer",
        "facebook_id": "",
        "followees_count": 16,
        "followers_count": 27,
        "github_login_name": "Aqua-218",
        "id": "Aqua-218",
        "items_count": 51,
        "linkedin_id": "",
        "location": "日本のどこか",
        "name": "Aqua",
        "organization": "Arivell",
        "permanent_id": 4012029,
        "profile_image_url": "https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/4012029/e05af05bb5a6d30f7f2512ff933e73facce70f4c/x_large.png?1750471754",
        "team_only": false,
        "twitter_screen_name": "aqua_developer",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": "unipro-tech",
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "\n<h2 data-sourcepos=\"3:1-3:15\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h2>\n<p data-sourcepos=\"5:1-5:120\">この記事は<a href=\"https://adventar.org/calendars/11648\" rel=\"nofollow noopener\" target=\"_blank\">Udon Advent Calendar 2025 - Adventar</a>の11日目の記事です。</p>\n<h2 data-sourcepos=\"7:1-7:13\">\n<span id=\"rubyのgem\" class=\"fragment\"></span><a href=\"#ruby%E3%81%AEgem\"><i class=\"fa fa-link\"></i></a>RubyのGem</h2>\n<p data-sourcepos=\"9:1-9:195\"><a href=\"https://qiita.com/Q_Udon/items/87a56349a54c0e431f9f\" id=\"reference-3241db55fae45ac82d23\">9日目の記事</a>でRubyの環境構築について解説しました。その後半でGemについての話にも触れたと思います。</p>\n<p data-sourcepos=\"11:1-11:100\">今回の記事では、RubyのGemについてもう少し掘り下げてみようと思います。</p>\n<h2 data-sourcepos=\"13:1-13:12\">\n<span id=\"gemとは\" class=\"fragment\"></span><a href=\"#gem%E3%81%A8%E3%81%AF\"><i class=\"fa fa-link\"></i></a>Gemとは</h2>\n<p data-sourcepos=\"15:1-15:96\">Gemとは<code>gem</code>形式にパッケージングされたRuby用のライブラリの総称です。</p>\n<p data-sourcepos=\"17:1-17:309\">ある機能を作りたいときに一から実装するのは大変ですが、ライブラリを使うことでそういった機能をすぐに使うことができます。別プログラムで同じことがしたいなら同じライブラリを使えばいいので、再現性も高くなります。</p>\n<p data-sourcepos=\"19:1-19:81\">Gemは<code>RubyGems</code>によって管理されます。Pythonで言う<code>pip</code>ですね。</p>\n<h2 data-sourcepos=\"21:1-21:15\">\n<span id=\"gemの種類\" class=\"fragment\"></span><a href=\"#gem%E3%81%AE%E7%A8%AE%E9%A1%9E\"><i class=\"fa fa-link\"></i></a>Gemの種類</h2>\n<p data-sourcepos=\"23:1-23:48\">Gemは大きく分けて二種類あります。</p>\n<h3 data-sourcepos=\"25:1-25:25\">\n<span id=\"標準ライブラリ\" class=\"fragment\"></span><a href=\"#%E6%A8%99%E6%BA%96%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"><i class=\"fa fa-link\"></i></a>標準ライブラリ</h3>\n<p data-sourcepos=\"27:1-27:110\">Rubyのインストール時に同時にインストールされるGemです。Rubyのバージョンごとに</p>\n<p data-sourcepos=\"29:1-29:91\">Rubyをインストールしたら、以下のコマンドを実行してみましょう。</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"31:1-33:3\"><div class=\"highlight\"><pre><code>gem list\n</code></pre></div></div>\n<p data-sourcepos=\"35:1-35:107\">そうすると、以下のように現在あるGemがリストアップされます(Ruby3.4.7の場合)。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"37:1-129:3\"><div class=\"highlight\"><pre><code>$ gem list\n\n*** LOCAL GEMS ***\n\nabbrev (0.1.2)\nbase64 (0.2.0)\nbenchmark (default: 0.4.0)\nbigdecimal (3.1.8)\nbundler (default: 2.6.9)\ncgi (default: 0.4.2)\ncsv (3.3.2)\ndate (default: 3.4.1)\ndebug (1.11.0)\ndelegate (default: 0.4.0)\ndid_you_mean (default: 2.0.0)\ndigest (default: 3.2.0)\ndrb (2.2.1)\nenglish (default: 0.8.0)\nerb (default: 4.0.4)\nerror_highlight (default: 0.7.0)\netc (default: 1.4.6)\nfcntl (default: 1.2.0)\nfiddle (default: 1.1.6)\nfileutils (default: 1.7.3)\nfind (default: 0.2.0)\nforwardable (default: 1.3.3)\ngetoptlong (0.2.1)\nio-console (default: 0.8.1)\nio-nonblock (default: 0.3.2)\nio-wait (default: 0.3.2)\nipaddr (default: 1.2.7)\nirb (default: 1.14.3)\njson (default: 2.9.1)\nlogger (default: 1.6.4)\nmatrix (0.4.2)\nminitest (5.25.4)\nmutex_m (0.3.0)\nnet-ftp (0.3.8)\nnet-http (default: 0.6.0)\nnet-imap (0.5.8)\nnet-pop (0.1.2)\nnet-protocol (default: 0.2.2)\nnet-smtp (0.5.1)\nnkf (0.2.0)\nobserver (0.1.2)\nopen-uri (default: 0.5.0)\nopen3 (default: 0.2.1)\nopenssl (default: 3.3.0)\noptparse (default: 0.6.0)\nostruct (default: 0.6.1)\npathname (default: 0.4.0)\npower_assert (2.0.5)\npp (default: 0.6.2)\nprettyprint (default: 0.2.0)\nprime (0.1.3)\nprism (default: 1.5.1)\npstore (default: 0.1.4)\npsych (default: 5.2.2)\nracc (1.8.1)\nrake (13.2.1)\nrbs (3.8.0)\nrdoc (default: 6.14.0)\nreadline (default: 0.0.4)\nreline (default: 0.6.0)\nrepl_type_completor (0.1.9)\nresolv (default: 0.6.2)\nresolv-replace (0.1.1)\nrexml (3.4.0)\nrinda (0.2.0)\nrss (0.3.1)\nruby2_keywords (default: 0.0.5)\nsecurerandom (default: 0.4.1)\nset (default: 1.1.1)\nshellwords (default: 0.2.2)\nsingleton (default: 0.3.0)\nstringio (default: 3.1.2)\nstrscan (default: 3.1.2)\nsyntax_suggest (default: 2.0.2)\nsyslog (0.2.0)\ntempfile (default: 0.3.1)\ntest-unit (3.6.7)\ntime (default: 0.4.1)\ntimeout (default: 0.4.3)\ntmpdir (default: 0.3.1)\ntsort (default: 0.2.0)\ntypeprof (0.30.1)\nun (default: 0.3.0)\nuri (default: 1.0.4)\nweakref (default: 0.1.3)\nyaml (default: 0.4.0)\nzlib (default: 3.2.1)\n</code></pre></div></div>\n<p data-sourcepos=\"131:1-131:275\"><code>Hash</code>や<code>Array</code>なども標準ライブラリですが、これらは<code>require</code>なしでも使えます。これはRuby本体としてインストールされている「組み込みライブラリ」です。その証拠に、上記のリストには入っていません。</p>\n<p data-sourcepos=\"133:1-133:201\">これらのライブラリは<code>require</code>を用いることでプログラム内で利用することができます。例として<code>json</code>を利用してみましょう。サンプルは以下の通り。</p>\n<div class=\"code-frame\" data-lang=\"ruby\" data-sourcepos=\"135:1-139:3\"><div class=\"highlight\"><pre><code><span class=\"nb\">require</span> <span class=\"s2\">\"json\"</span>\n\n<span class=\"nb\">p</span> <span class=\"no\">JSON</span><span class=\"p\">.</span><span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"s1\">'{\"name\": \"Test\"}'</span><span class=\"p\">)</span>\n</code></pre></div></div>\n<p data-sourcepos=\"141:1-141:127\"><code>JSON</code>の<code>parse</code>メソッドは、文字列として受け取った<code>json</code>をハッシュに変換してくれるものです。</p>\n<p data-sourcepos=\"143:1-143:51\">実行すると、以下のようになります。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"145:1-148:3\"><div class=\"highlight\"><pre><code>$ ruby example.rb\n{\"name\" =&gt; \"Test\"}\n</code></pre></div></div>\n<p data-sourcepos=\"150:1-150:228\">また、組み込みライブラリではありません(上記リストに入っています)が、<code>time</code>はよく使われるからなのか<code>require</code>しなくても最初から使えます(明示的に<code>require</code>してもOK)。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"152:1-157:3\"><div class=\"highlight\"><pre><code>$ irb\nirb(main):001&gt; puts Time.now\n2025-12-11 13:14:00 +0900\n=&gt; nil\n</code></pre></div></div>\n<h3 data-sourcepos=\"159:1-159:25\">\n<span id=\"外部ライブラリ\" class=\"fragment\"></span><a href=\"#%E5%A4%96%E9%83%A8%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"><i class=\"fa fa-link\"></i></a>外部ライブラリ</h3>\n<p data-sourcepos=\"161:1-161:129\">外部ライブラリはいきなり使うことはできず、使う前にインストールが必要なライブラリです。</p>\n<p data-sourcepos=\"163:1-163:92\">インストールは以下のように行います。記法は<code>apt</code>に似ていますね。</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"165:1-167:3\"><div class=\"highlight\"><pre><code>gem <span class=\"nb\">install</span> <span class=\"o\">[</span>name]\n</code></pre></div></div>\n<h3 data-sourcepos=\"169:1-169:17\">\n<span id=\"nokogiri例\" class=\"fragment\"></span><a href=\"#nokogiri%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>nokogiri(例)</h3>\n<p data-sourcepos=\"171:1-171:44\"><iframe id=\"qiita-embed-content__3127c5c09f3e94eb25162b9c3089deac\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__3127c5c09f3e94eb25162b9c3089deac\" data-content=\"https%3A%2F%2Frubygems.org%2Fgems%2Fnokogiri%3Flocale%3Dja\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<p data-sourcepos=\"173:1-173:133\">HTMLやXMLを解析しパースする機能を持つライブラリです。スクレイピングの際によく利用されます。</p>\n<p data-sourcepos=\"175:1-175:108\">サンプルはこんな感じ。標準ライブラリと同様に利用前には<code>require</code>が必要です。</p>\n<div class=\"code-frame\" data-lang=\"ruby\" data-sourcepos=\"177:1-184:3\"><div class=\"highlight\"><pre><code><span class=\"nb\">require</span> <span class=\"s1\">'nokogiri'</span>\n\n<span class=\"n\">html</span> <span class=\"o\">=</span> <span class=\"s1\">'&lt;div&gt;&lt;p&gt;Hello World&lt;/p&gt;&lt;/div&gt;'</span>\n\n<span class=\"n\">doc</span> <span class=\"o\">=</span> <span class=\"no\">Nokogiri</span><span class=\"o\">::</span><span class=\"no\">HTML</span><span class=\"p\">(</span><span class=\"n\">html</span><span class=\"p\">)</span>\n<span class=\"nb\">puts</span> <span class=\"n\">doc</span><span class=\"p\">.</span><span class=\"nf\">css</span><span class=\"p\">(</span><span class=\"s1\">'p'</span><span class=\"p\">).</span><span class=\"nf\">text</span> <span class=\"c1\"># =&gt; Hello World</span>\n</code></pre></div></div>\n<h2 data-sourcepos=\"186:1-186:31\">\n<span id=\"gemをbundlerで管理する\" class=\"fragment\"></span><a href=\"#gem%E3%82%92bundler%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>GemをBundlerで管理する</h2>\n<p data-sourcepos=\"188:1-188:294\">Gemをグローバルにインストールするだけでなく、プロジェクトごとに使うGemの種類やバージョンを管理したいときがあります。特に他のGemに依存しているGemを使う際は依存関係もしっかりと管理しなくてはなりません。</p>\n<p data-sourcepos=\"190:1-190:118\">そんな時に便利なのがBundlerというGemです。これはGemのバージョンをディレクトリごとに</p>\n<p data-sourcepos=\"192:1-192:125\"><code>rbenv</code>のRubyバージョン機能と組み合わせることで多彩な仮想環境を用意することができます！</p>\n<h3 data-sourcepos=\"194:1-194:11\">\n<span id=\"gemfile\" class=\"fragment\"></span><a href=\"#gemfile\"><i class=\"fa fa-link\"></i></a>Gemfile</h3>\n<p data-sourcepos=\"196:1-196:185\">Bundlerは以下のようなGemfileを利用してGemのバージョン管理を行います。これが含まれているパス以下がバージョン管理の対象となります。</p>\n<div class=\"code-frame\" data-lang=\"Gemfile\" data-sourcepos=\"198:1-202:3\"><div class=\"highlight\"><pre><code>source \"https://rubygems.org\"\n\ngem \"nokogiri\"\n</code></pre></div></div>\n<p data-sourcepos=\"204:1-204:122\">どこからダウンロードするのかを明記した後、<code>gem \"[name]\"</code>の形式で必要なGemを列挙します。</p>\n<p data-sourcepos=\"206:1-206:111\">インストールするGemのバージョンを以下のように細かく指定することもできます。</p>\n<div class=\"code-frame\" data-lang=\"Gemfile\" data-sourcepos=\"208:1-210:3\"><div class=\"highlight\"><pre><code>gem \"nokogiri\" ~&gt; 1.18 # 1.18以降の互換性のあるバージョンを指定\n</code></pre></div></div>\n<div class=\"code-frame\" data-lang=\"Gemfile\" data-sourcepos=\"212:1-214:3\"><div class=\"highlight\"><pre><code>gem \"nokogiri\" &gt;= 1.18.10 # 最低でも1.18以上のバージョン\n</code></pre></div></div>\n<p data-sourcepos=\"216:1-216:172\">今回は以下のように1.18.9を狙ってインストールしてみます。これによってグローバルにインストールした<code>nokogiri</code>と区別します。</p>\n<div class=\"code-frame\" data-lang=\"Gemfile\" data-sourcepos=\"218:1-220:3\"><div class=\"highlight\"><pre><code>gem \"nokogiri\", \"1.18.9\"\n</code></pre></div></div>\n<p data-sourcepos=\"222:1-222:93\">準備できたら、以下のコマンドで指定したGemをインストールします。</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"224:1-226:3\"><div class=\"highlight\"><pre><code>bundle <span class=\"nb\">install</span>\n</code></pre></div></div>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"228:1-234:3\"><div class=\"highlight\"><pre><code>$ bundle install\nFetching gem metadata from https://rubygems.org/.......\nResolving dependencies...\nBundle complete! 1 Gemfile dependency, 3 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\n</code></pre></div></div>\n<p data-sourcepos=\"236:1-236:194\">実行後、<code>Gemfile.lock</code>というファイルができています。ファイルの中には依存関係が記入されています。<code>racc</code>というGemに依存しているようですね。</p>\n<p data-sourcepos=\"238:1-238:120\">各ライブラリのどのバージョンがインストールされたのか、という情報も載っています。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"240:1-288:3\"><div class=\"highlight\"><pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    nokogiri (1.18.9-aarch64-linux-gnu)\n      racc (~&gt; 1.4)\n    nokogiri (1.18.9-aarch64-linux-musl)\n      racc (~&gt; 1.4)\n    nokogiri (1.18.9-arm-linux-gnu)\n      racc (~&gt; 1.4)\n    nokogiri (1.18.9-arm-linux-musl)\n      racc (~&gt; 1.4)\n    nokogiri (1.18.9-arm64-darwin)\n      racc (~&gt; 1.4)\n    nokogiri (1.18.9-x86_64-darwin)\n      racc (~&gt; 1.4)\n    nokogiri (1.18.9-x86_64-linux-gnu)\n      racc (~&gt; 1.4)\n    nokogiri (1.18.9-x86_64-linux-musl)\n      racc (~&gt; 1.4)\n    racc (1.8.1)\n\nPLATFORMS\n  aarch64-linux-gnu\n  aarch64-linux-musl\n  arm-linux-gnu\n  arm-linux-musl\n  arm64-darwin\n  x86_64-darwin\n  x86_64-linux-gnu\n  x86_64-linux-musl\n\nDEPENDENCIES\n  nokogiri (= 1.18.9)\n\nCHECKSUMS\n  nokogiri (1.18.9-aarch64-linux-gnu) sha256=5bcfdf7aa8d1056a7ad5e52e1adffc64ef53d12d0724fbc6f458a3af1a4b9e32\n  nokogiri (1.18.9-aarch64-linux-musl) sha256=55e9e6ca46c4ad1715e313f407d8481d15be1e3b65d9f8e52ba1c124d01676a7\n  nokogiri (1.18.9-arm-linux-gnu) sha256=fe611ae65880e445a9c0f650d52327db239f3488626df4173c05beafd161d46e\n  nokogiri (1.18.9-arm-linux-musl) sha256=935605e14c0ba17da18d203922440bf6c0676c602659278d855d4622d756a324\n  nokogiri (1.18.9-arm64-darwin) sha256=eea3f1f06463ff6309d3ff5b88033c4948d0da1ab3cc0a3a24f63c4d4a763979\n  nokogiri (1.18.9-x86_64-darwin) sha256=e0d2deb03d3d7af8016e8c9df5ff4a7d692159cefb135cbb6a4109f265652348\n  nokogiri (1.18.9-x86_64-linux-gnu) sha256=b52f5defedc53d14f71eeaaf990da66b077e1918a2e13088b6a96d0230f44360\n  nokogiri (1.18.9-x86_64-linux-musl) sha256=e69359d6240c17e64cc9f43970d54f13bfc7b8cc516b819228f687e953425e69\n  racc (1.8.1) sha256=4a7f6929691dbec8b5209a0b373bc2614882b55fc5d2e447a21aaa691303d62f\n\nBUNDLED WITH\n  4.0.0\n</code></pre></div></div>\n<p data-sourcepos=\"290:1-290:127\">また、下の方にはどのバージョンのBundlerでインストールされたか、の情報も書いてあります。</p>\n<p data-sourcepos=\"292:1-292:251\">この管理されたバージョンでRubyプログラムを実行してみましょう。サンプルとして以下のRubyファイルを利用します。<code>require</code>した外部ライブラリのバージョンを出力するというものです。</p>\n<div class=\"code-frame\" data-lang=\"ruby\" data-sourcepos=\"294:1-298:3\"><div class=\"highlight\"><pre><code><span class=\"nb\">require</span> <span class=\"s1\">'nokogiri'</span>\n\n<span class=\"nb\">puts</span> <span class=\"no\">Nokogiri</span><span class=\"o\">::</span><span class=\"no\">VERSION</span>\n</code></pre></div></div>\n<p data-sourcepos=\"300:1-300:73\">Bundleを使ってRubyを実行する時は以下のようにします。</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"302:1-304:3\"><div class=\"highlight\"><pre><code>bundle <span class=\"nb\">exec </span>ruby example.rb\n</code></pre></div></div>\n<p data-sourcepos=\"306:1-306:63\">結果は以下の通りです。1.18.9が出てきました。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"308:1-311:3\"><div class=\"highlight\"><pre><code>$ bundle exec ruby example.rb\n1.18.9\n</code></pre></div></div>\n<p data-sourcepos=\"313:1-313:81\">逆に、以下のようにやるとグローバルなGemが参照されます。</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"315:1-317:3\"><div class=\"highlight\"><pre><code>ruby example.rb\n</code></pre></div></div>\n<p data-sourcepos=\"319:1-319:78\">実行すると、グローバルの方のバージョンになりました。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"321:1-324:3\"><div class=\"highlight\"><pre><code>$ ruby example.rb\n1.18.10\n</code></pre></div></div>\n<p data-sourcepos=\"326:1-326:241\">こうして、ライブラリに関しても仮想環境を用意することができました。Gemfileを共有しておくと別のマシンでも同じ環境が作れるのでチーム内で足並みを揃えることができます。</p>\n<h2 data-sourcepos=\"328:1-328:15\">\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h2>\n<p data-sourcepos=\"330:1-330:82\">Gemを使いこなすことで、Rubyでできることが格段に増えます。</p>\n<p data-sourcepos=\"332:1-332:99\">皆さんも標準のGemだけでなく、外部Gemもどんどん利用してみてください！</p>\n<p data-sourcepos=\"334:1-334:66\">それではまた、明日の記事でお会いしましょう！</p>\n<h2 data-sourcepos=\"336:1-336:15\">\n<span id=\"参考文献\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"><i class=\"fa fa-link\"></i></a>参考文献</h2>\n<p data-sourcepos=\"338:1-338:62\"><a href=\"https://ja.wikipedia.org/wiki/RubyGems\" rel=\"nofollow noopener\" target=\"_blank\">RubyGems - Wikipedia</a></p>\n<p data-sourcepos=\"340:1-340:107\"><a href=\"https://pikawaka.com/ruby/how-gem-works\" rel=\"nofollow noopener\" target=\"_blank\">【Ruby】 gemの仕組みを図解形式で学ぼう | Pikawaka</a></p>\n<p data-sourcepos=\"342:1-342:188\"><a href=\"https://qiita.com/sugamaan/items/d7871da28c0160b69609\" id=\"reference-49c346178221cf92a06a\">【Ruby】ライブラリまとめ（標準ライブラリ？組み込みライブラリ？外部ライブラリ？） #Gem - Qiita</a></p>\n<p data-sourcepos=\"344:1-344:135\"><a href=\"https://popinsight.jp/blog/?p=18845\" rel=\"nofollow noopener\" target=\"_blank\">【Ruby入門】Rubyで外部ライブラリを読み込む：require - ポップインサイト</a></p>\n",
      "body": "<!-- RubyのGemについて -->\n\n## はじめに\n\nこの記事は[Udon Advent Calendar 2025 - Adventar](https://adventar.org/calendars/11648)の11日目の記事です。\n\n## RubyのGem\n\n[9日目の記事](https://qiita.com/Q_Udon/items/87a56349a54c0e431f9f)でRubyの環境構築について解説しました。その後半でGemについての話にも触れたと思います。\n\n今回の記事では、RubyのGemについてもう少し掘り下げてみようと思います。\n\n## Gemとは\n\nGemとは`gem`形式にパッケージングされたRuby用のライブラリの総称です。\n\nある機能を作りたいときに一から実装するのは大変ですが、ライブラリを使うことでそういった機能をすぐに使うことができます。別プログラムで同じことがしたいなら同じライブラリを使えばいいので、再現性も高くなります。\n\nGemは`RubyGems`によって管理されます。Pythonで言う`pip`ですね。\n\n## Gemの種類\n\nGemは大きく分けて二種類あります。\n\n### 標準ライブラリ\n\nRubyのインストール時に同時にインストールされるGemです。Rubyのバージョンごとに\n\nRubyをインストールしたら、以下のコマンドを実行してみましょう。\n\n```bash\ngem list\n```\n\nそうすると、以下のように現在あるGemがリストアップされます(Ruby3.4.7の場合)。\n\n```\n$ gem list\n\n*** LOCAL GEMS ***\n\nabbrev (0.1.2)\nbase64 (0.2.0)\nbenchmark (default: 0.4.0)\nbigdecimal (3.1.8)\nbundler (default: 2.6.9)\ncgi (default: 0.4.2)\ncsv (3.3.2)\ndate (default: 3.4.1)\ndebug (1.11.0)\ndelegate (default: 0.4.0)\ndid_you_mean (default: 2.0.0)\ndigest (default: 3.2.0)\ndrb (2.2.1)\nenglish (default: 0.8.0)\nerb (default: 4.0.4)\nerror_highlight (default: 0.7.0)\netc (default: 1.4.6)\nfcntl (default: 1.2.0)\nfiddle (default: 1.1.6)\nfileutils (default: 1.7.3)\nfind (default: 0.2.0)\nforwardable (default: 1.3.3)\ngetoptlong (0.2.1)\nio-console (default: 0.8.1)\nio-nonblock (default: 0.3.2)\nio-wait (default: 0.3.2)\nipaddr (default: 1.2.7)\nirb (default: 1.14.3)\njson (default: 2.9.1)\nlogger (default: 1.6.4)\nmatrix (0.4.2)\nminitest (5.25.4)\nmutex_m (0.3.0)\nnet-ftp (0.3.8)\nnet-http (default: 0.6.0)\nnet-imap (0.5.8)\nnet-pop (0.1.2)\nnet-protocol (default: 0.2.2)\nnet-smtp (0.5.1)\nnkf (0.2.0)\nobserver (0.1.2)\nopen-uri (default: 0.5.0)\nopen3 (default: 0.2.1)\nopenssl (default: 3.3.0)\noptparse (default: 0.6.0)\nostruct (default: 0.6.1)\npathname (default: 0.4.0)\npower_assert (2.0.5)\npp (default: 0.6.2)\nprettyprint (default: 0.2.0)\nprime (0.1.3)\nprism (default: 1.5.1)\npstore (default: 0.1.4)\npsych (default: 5.2.2)\nracc (1.8.1)\nrake (13.2.1)\nrbs (3.8.0)\nrdoc (default: 6.14.0)\nreadline (default: 0.0.4)\nreline (default: 0.6.0)\nrepl_type_completor (0.1.9)\nresolv (default: 0.6.2)\nresolv-replace (0.1.1)\nrexml (3.4.0)\nrinda (0.2.0)\nrss (0.3.1)\nruby2_keywords (default: 0.0.5)\nsecurerandom (default: 0.4.1)\nset (default: 1.1.1)\nshellwords (default: 0.2.2)\nsingleton (default: 0.3.0)\nstringio (default: 3.1.2)\nstrscan (default: 3.1.2)\nsyntax_suggest (default: 2.0.2)\nsyslog (0.2.0)\ntempfile (default: 0.3.1)\ntest-unit (3.6.7)\ntime (default: 0.4.1)\ntimeout (default: 0.4.3)\ntmpdir (default: 0.3.1)\ntsort (default: 0.2.0)\ntypeprof (0.30.1)\nun (default: 0.3.0)\nuri (default: 1.0.4)\nweakref (default: 0.1.3)\nyaml (default: 0.4.0)\nzlib (default: 3.2.1)\n```\n\n`Hash`や`Array`なども標準ライブラリですが、これらは`require`なしでも使えます。これはRuby本体としてインストールされている「組み込みライブラリ」です。その証拠に、上記のリストには入っていません。\n\nこれらのライブラリは`require`を用いることでプログラム内で利用することができます。例として`json`を利用してみましょう。サンプルは以下の通り。\n\n```ruby\nrequire \"json\"\n\np JSON.parse('{\"name\": \"Test\"}')\n```\n\n`JSON`の`parse`メソッドは、文字列として受け取った`json`をハッシュに変換してくれるものです。\n\n実行すると、以下のようになります。\n\n```\n$ ruby example.rb\n{\"name\" => \"Test\"}\n```\n\nまた、組み込みライブラリではありません(上記リストに入っています)が、`time`はよく使われるからなのか`require`しなくても最初から使えます(明示的に`require`してもOK)。\n\n```\n$ irb\nirb(main):001> puts Time.now\n2025-12-11 13:14:00 +0900\n=> nil\n```\n\n### 外部ライブラリ\n\n外部ライブラリはいきなり使うことはできず、使う前にインストールが必要なライブラリです。\n\nインストールは以下のように行います。記法は`apt`に似ていますね。\n\n```bash\ngem install [name]\n```\n\n### nokogiri(例)\n\nhttps://rubygems.org/gems/nokogiri?locale=ja\n\nHTMLやXMLを解析しパースする機能を持つライブラリです。スクレイピングの際によく利用されます。\n\nサンプルはこんな感じ。標準ライブラリと同様に利用前には`require`が必要です。\n\n```ruby\nrequire 'nokogiri'\n\nhtml = '<div><p>Hello World</p></div>'\n\ndoc = Nokogiri::HTML(html)\nputs doc.css('p').text # => Hello World\n```\n\n## GemをBundlerで管理する\n\nGemをグローバルにインストールするだけでなく、プロジェクトごとに使うGemの種類やバージョンを管理したいときがあります。特に他のGemに依存しているGemを使う際は依存関係もしっかりと管理しなくてはなりません。\n\nそんな時に便利なのがBundlerというGemです。これはGemのバージョンをディレクトリごとに\n\n`rbenv`のRubyバージョン機能と組み合わせることで多彩な仮想環境を用意することができます！\n\n### Gemfile\n\nBundlerは以下のようなGemfileを利用してGemのバージョン管理を行います。これが含まれているパス以下がバージョン管理の対象となります。\n\n```Gemfile\nsource \"https://rubygems.org\"\n\ngem \"nokogiri\"\n```\n\nどこからダウンロードするのかを明記した後、`gem \"[name]\"`の形式で必要なGemを列挙します。\n\nインストールするGemのバージョンを以下のように細かく指定することもできます。\n\n```Gemfile\ngem \"nokogiri\" ~> 1.18 # 1.18以降の互換性のあるバージョンを指定\n```\n\n```Gemfile\ngem \"nokogiri\" >= 1.18.10 # 最低でも1.18以上のバージョン\n```\n\n今回は以下のように1.18.9を狙ってインストールしてみます。これによってグローバルにインストールした`nokogiri`と区別します。\n\n```Gemfile\ngem \"nokogiri\", \"1.18.9\"\n```\n\n準備できたら、以下のコマンドで指定したGemをインストールします。\n\n```bash\nbundle install\n```\n\n```\n$ bundle install\nFetching gem metadata from https://rubygems.org/.......\nResolving dependencies...\nBundle complete! 1 Gemfile dependency, 3 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\n```\n\n実行後、`Gemfile.lock`というファイルができています。ファイルの中には依存関係が記入されています。`racc`というGemに依存しているようですね。\n\n各ライブラリのどのバージョンがインストールされたのか、という情報も載っています。\n\n```\nGEM\n  remote: https://rubygems.org/\n  specs:\n    nokogiri (1.18.9-aarch64-linux-gnu)\n      racc (~> 1.4)\n    nokogiri (1.18.9-aarch64-linux-musl)\n      racc (~> 1.4)\n    nokogiri (1.18.9-arm-linux-gnu)\n      racc (~> 1.4)\n    nokogiri (1.18.9-arm-linux-musl)\n      racc (~> 1.4)\n    nokogiri (1.18.9-arm64-darwin)\n      racc (~> 1.4)\n    nokogiri (1.18.9-x86_64-darwin)\n      racc (~> 1.4)\n    nokogiri (1.18.9-x86_64-linux-gnu)\n      racc (~> 1.4)\n    nokogiri (1.18.9-x86_64-linux-musl)\n      racc (~> 1.4)\n    racc (1.8.1)\n\nPLATFORMS\n  aarch64-linux-gnu\n  aarch64-linux-musl\n  arm-linux-gnu\n  arm-linux-musl\n  arm64-darwin\n  x86_64-darwin\n  x86_64-linux-gnu\n  x86_64-linux-musl\n\nDEPENDENCIES\n  nokogiri (= 1.18.9)\n\nCHECKSUMS\n  nokogiri (1.18.9-aarch64-linux-gnu) sha256=5bcfdf7aa8d1056a7ad5e52e1adffc64ef53d12d0724fbc6f458a3af1a4b9e32\n  nokogiri (1.18.9-aarch64-linux-musl) sha256=55e9e6ca46c4ad1715e313f407d8481d15be1e3b65d9f8e52ba1c124d01676a7\n  nokogiri (1.18.9-arm-linux-gnu) sha256=fe611ae65880e445a9c0f650d52327db239f3488626df4173c05beafd161d46e\n  nokogiri (1.18.9-arm-linux-musl) sha256=935605e14c0ba17da18d203922440bf6c0676c602659278d855d4622d756a324\n  nokogiri (1.18.9-arm64-darwin) sha256=eea3f1f06463ff6309d3ff5b88033c4948d0da1ab3cc0a3a24f63c4d4a763979\n  nokogiri (1.18.9-x86_64-darwin) sha256=e0d2deb03d3d7af8016e8c9df5ff4a7d692159cefb135cbb6a4109f265652348\n  nokogiri (1.18.9-x86_64-linux-gnu) sha256=b52f5defedc53d14f71eeaaf990da66b077e1918a2e13088b6a96d0230f44360\n  nokogiri (1.18.9-x86_64-linux-musl) sha256=e69359d6240c17e64cc9f43970d54f13bfc7b8cc516b819228f687e953425e69\n  racc (1.8.1) sha256=4a7f6929691dbec8b5209a0b373bc2614882b55fc5d2e447a21aaa691303d62f\n\nBUNDLED WITH\n  4.0.0\n```\n\nまた、下の方にはどのバージョンのBundlerでインストールされたか、の情報も書いてあります。\n\nこの管理されたバージョンでRubyプログラムを実行してみましょう。サンプルとして以下のRubyファイルを利用します。`require`した外部ライブラリのバージョンを出力するというものです。\n\n```ruby\nrequire 'nokogiri'\n\nputs Nokogiri::VERSION\n```\n\nBundleを使ってRubyを実行する時は以下のようにします。\n\n```bash\nbundle exec ruby example.rb\n```\n\n結果は以下の通りです。1.18.9が出てきました。\n\n```\n$ bundle exec ruby example.rb\n1.18.9\n```\n\n逆に、以下のようにやるとグローバルなGemが参照されます。\n\n```bash\nruby example.rb\n```\n\n実行すると、グローバルの方のバージョンになりました。\n\n```\n$ ruby example.rb\n1.18.10\n```\n\nこうして、ライブラリに関しても仮想環境を用意することができました。Gemfileを共有しておくと別のマシンでも同じ環境が作れるのでチーム内で足並みを揃えることができます。\n\n## おわりに\n\nGemを使いこなすことで、Rubyでできることが格段に増えます。\n\n皆さんも標準のGemだけでなく、外部Gemもどんどん利用してみてください！\n\nそれではまた、明日の記事でお会いしましょう！\n\n## 参考文献\n\n[RubyGems - Wikipedia](https://ja.wikipedia.org/wiki/RubyGems)\n\n[【Ruby】 gemの仕組みを図解形式で学ぼう | Pikawaka](https://pikawaka.com/ruby/how-gem-works)\n\n[【Ruby】ライブラリまとめ（標準ライブラリ？組み込みライブラリ？外部ライブラリ？） #Gem - Qiita](https://qiita.com/sugamaan/items/d7871da28c0160b69609)\n\n[【Ruby入門】Rubyで外部ライブラリを読み込む：require - ポップインサイト](https://popinsight.jp/blog/?p=18845)\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:43:41+09:00",
      "group": null,
      "id": "6932028e03530b47b97b",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Ruby",
          "versions": []
        },
        {
          "name": "Gem",
          "versions": []
        },
        {
          "name": "Bundler",
          "versions": []
        }
      ],
      "title": "RubyのGemについて",
      "updated_at": "2025-12-11T13:43:41+09:00",
      "url": "https://qiita.com/Q_Udon/items/6932028e03530b47b97b",
      "user": {
        "description": "どこかの大学生です\r\n出来るだけ記事を投稿しようと思ってます",
        "facebook_id": "",
        "followees_count": 12,
        "followers_count": 11,
        "github_login_name": "Gitudon",
        "id": "Q_Udon",
        "items_count": 64,
        "linkedin_id": "",
        "location": "",
        "name": "",
        "organization": "",
        "permanent_id": 3468660,
        "profile_image_url": "https://avatars.githubusercontent.com/u/104332931?v=4",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": "https://gitudon.github.io/"
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<h2 data-sourcepos=\"1:1-1:9\">\n<span id=\"概要\" class=\"fragment\"></span><a href=\"#%E6%A6%82%E8%A6%81\"><i class=\"fa fa-link\"></i></a>概要</h2>\n<p data-sourcepos=\"2:1-4:96\">最近、AmazonのブラックフライデーセールでChromebookを購入しました。<br>\nちょうど復職に向けて動いていることもあり、ChatGPTを使ってReactを勉強してみようと思い立ちました。<br>\nその環境構築手順を、備忘録としてここにまとめておこうと思います。</p>\n<h2 data-sourcepos=\"6:1-6:9\">\n<span id=\"目次\" class=\"fragment\"></span><a href=\"#%E7%9B%AE%E6%AC%A1\"><i class=\"fa fa-link\"></i></a>目次</h2>\n<ul data-sourcepos=\"7:2-10:0\">\n<li data-sourcepos=\"7:2-7:38\">Linuxターミナルを起動する</li>\n<li data-sourcepos=\"8:2-8:27\">nvmをインストール</li>\n<li data-sourcepos=\"9:2-10:0\">Node.jsをインストール</li>\n</ul>\n<h2 data-sourcepos=\"11:1-11:40\">\n<span id=\"1linuxターミナルを起動する\" class=\"fragment\"></span><a href=\"#1linux%E3%82%BF%E3%83%BC%E3%83%9F%E3%83%8A%E3%83%AB%E3%82%92%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>1.Linuxターミナルを起動する</h2>\n<h3 data-sourcepos=\"12:1-12:35\">\n<span id=\"linuxcrostiniを有効化\" class=\"fragment\"></span><a href=\"#linuxcrostini%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96\"><i class=\"fa fa-link\"></i></a>Linux（Crostini）を有効化</h3>\n<p data-sourcepos=\"14:1-16:130\">1.Chromebook右下の時刻をクリックし、「設定」を開きます。<br>\n2.「デベロッパー」&gt;「Linux開発環境」&gt;「ON」<br>\n私のChromebookでは「ChromeOSについて」&gt;「デベロッパー」&gt;「Linux開発環境」&gt;「ON」となっていました</p>\n<h2 data-sourcepos=\"18:1-18:29\">\n<span id=\"2nvmのインストール\" class=\"fragment\"></span><a href=\"#2nvm%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"><i class=\"fa fa-link\"></i></a>2.nvmのインストール</h2>\n<h3 data-sourcepos=\"19:1-19:35\">\n<span id=\"1linuxパッケージの更新\" class=\"fragment\"></span><a href=\"#1linux%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E6%9B%B4%E6%96%B0\"><i class=\"fa fa-link\"></i></a>1.Linuxパッケージの更新</h3>\n<p data-sourcepos=\"20:1-20:57\">まずターミナルを開いてこれを実行します</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"21:1-24:3\">\n<div class=\"code-lang\"><span class=\"bold\">bash.</span></div>\n<div class=\"highlight\"><pre><code>sudo apt update\nsudo apt upgrade -y\n</code></pre></div>\n</div>\n<h3 data-sourcepos=\"25:1-25:31\">\n<span id=\"2nvm-をインストール\" class=\"fragment\"></span><a href=\"#2nvm-%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"><i class=\"fa fa-link\"></i></a>2.nvm をインストール</h3>\n<p data-sourcepos=\"26:1-26:52\">nvm のインストールは、この1行だけでOK</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"27:1-29:3\">\n<div class=\"code-lang\"><span class=\"bold\">bash.</span></div>\n<div class=\"highlight\"><pre><code>curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash\n</code></pre></div>\n</div>\n<h3 data-sourcepos=\"30:1-30:44\">\n<span id=\"3シェルに-nvm-を読み込ませる\" class=\"fragment\"></span><a href=\"#3%E3%82%B7%E3%82%A7%E3%83%AB%E3%81%AB-nvm-%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BE%E3%81%9B%E3%82%8B\"><i class=\"fa fa-link\"></i></a>3.シェルに nvm を読み込ませる</h3>\n<p data-sourcepos=\"31:1-31:104\">ターミナルをいったん閉じて開き直すか、以下を実行して nvm を有効にします</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"32:1-34:3\">\n<div class=\"code-lang\"><span class=\"bold\">bash.</span></div>\n<div class=\"highlight\"><pre><code>source ~/.bashrc\n</code></pre></div>\n</div>\n<h3 data-sourcepos=\"35:1-35:31\">\n<span id=\"4nvm-が入ったか確認\" class=\"fragment\"></span><a href=\"#4nvm-%E3%81%8C%E5%85%A5%E3%81%A3%E3%81%9F%E3%81%8B%E7%A2%BA%E8%AA%8D\"><i class=\"fa fa-link\"></i></a>4.nvm が入ったか確認</h3>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"36:1-38:3\"><div class=\"highlight\"><pre><code>nvm --version\n</code></pre></div></div>\n<p data-sourcepos=\"39:1-39:60\">バージョン番号（例：0.39.7）が出れば成功！</p>\n<h2 data-sourcepos=\"41:1-41:33\">\n<span id=\"3nodejsをインストール\" class=\"fragment\"></span><a href=\"#3nodejs%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"><i class=\"fa fa-link\"></i></a>3.Node.jsをインストール</h2>\n<p data-sourcepos=\"42:1-42:27\">最新の安定版（LTS）</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"43:1-45:3\"><div class=\"highlight\"><pre><code>nvm install --lts\n</code></pre></div></div>\n<p data-sourcepos=\"46:1-46:29\">Node.js が入ったか確認</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"47:1-50:3\"><div class=\"highlight\"><pre><code>node -v\nnpm -v\n</code></pre></div></div>\n<p data-sourcepos=\"51:1-52:121\">バージョン番号が出れば成功！<br>\n<a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F547658%2Fbe29f815-06a5-43be-8c8a-00c08999cc86.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=931fefa1974776f14193209b61dc6d74\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F547658%2Fbe29f815-06a5-43be-8c8a-00c08999cc86.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=931fefa1974776f14193209b61dc6d74\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F547658%2Fbe29f815-06a5-43be-8c8a-00c08999cc86.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4c9b88e69084b40665bcba3e934a4a4c 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/547658/be29f815-06a5-43be-8c8a-00c08999cc86.png\" loading=\"lazy\"></a></p>\n<h2 data-sourcepos=\"54:1-54:12\">\n<span id=\"まとめ\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>まとめ</h2>\n<p data-sourcepos=\"55:1-56:59\">結構簡単にできました。<br>\n次回はReactの環境構築についてまとめます。</p>\n",
      "body": "## 概要\n最近、AmazonのブラックフライデーセールでChromebookを購入しました。\nちょうど復職に向けて動いていることもあり、ChatGPTを使ってReactを勉強してみようと思い立ちました。\nその環境構築手順を、備忘録としてここにまとめておこうと思います。\n\n## 目次\n - Linuxターミナルを起動する\n - nvmをインストール\n - Node.jsをインストール\n\n## 1.Linuxターミナルを起動する\n### Linux（Crostini）を有効化\n\n1.Chromebook右下の時刻をクリックし、「設定」を開きます。\n2.「デベロッパー」>「Linux開発環境」>「ON」\n私のChromebookでは「ChromeOSについて」>「デベロッパー」>「Linux開発環境」>「ON」となっていました\n\n## 2.nvmのインストール\n### 1.Linuxパッケージの更新\nまずターミナルを開いてこれを実行します\n``` bash.\nsudo apt update\nsudo apt upgrade -y\n```\n### 2.nvm をインストール\nnvm のインストールは、この1行だけでOK\n```bash.\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash\n```\n### 3.シェルに nvm を読み込ませる\nターミナルをいったん閉じて開き直すか、以下を実行して nvm を有効にします\n```bash.\nsource ~/.bashrc\n```\n### 4.nvm が入ったか確認\n```\nnvm --version\n```\nバージョン番号（例：0.39.7）が出れば成功！\n\n## 3.Node.jsをインストール\n最新の安定版（LTS）\n```\nnvm install --lts\n```\nNode.js が入ったか確認\n```\nnode -v\nnpm -v\n```\nバージョン番号が出れば成功！\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/547658/be29f815-06a5-43be-8c8a-00c08999cc86.png)\n\n## まとめ\n結構簡単にできました。\n次回はReactの環境構築についてまとめます。\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:39:18+09:00",
      "group": null,
      "id": "2089573b1ab4f3d499df",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Linux",
          "versions": []
        },
        {
          "name": "Node.js",
          "versions": []
        },
        {
          "name": "nvm",
          "versions": []
        },
        {
          "name": "Chromebook",
          "versions": []
        }
      ],
      "title": "ChromebookのLinuxにNode.jsをいれてみた",
      "updated_at": "2025-12-11T13:39:36+09:00",
      "url": "https://qiita.com/_puumi_moon8233/items/2089573b1ab4f3d499df",
      "user": {
        "description": "",
        "facebook_id": "",
        "followees_count": 0,
        "followers_count": 0,
        "github_login_name": null,
        "id": "_puumi_moon8233",
        "items_count": 5,
        "linkedin_id": "",
        "location": "日本",
        "name": "ぷーみー",
        "organization": "",
        "permanent_id": 547658,
        "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/547658/profile-images/1644568613",
        "team_only": false,
        "twitter_screen_name": "mireimaekawa",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"2:1-15:3\"><div class=\"highlight\"><pre><code>名前        2の累乗での表現          10進数の値\nSHRT_MIN    -2^15                    -32768\nSHRT_MAX    2^15 - 1                 32767\nUSHRT_MAX   2^16 - 1                 65535\n\nINT_MIN     -2^31                    -2147483648\nINT_MAX     2^31 - 1                 2147483647\nUINT_MAX    2^32 - 1                 4294967295\n\nLLONG_MIN   -2^63                    -9223372036854775808\nLLONG_MAX   2^63 - 1                 9223372036854775807\nULLONG_MAX  2^64 - 1                 18446744073709551615\n</code></pre></div></div>\n",
      "body": "\n```text\n名前        2の累乗での表現          10進数の値\nSHRT_MIN    -2^15                    -32768\nSHRT_MAX    2^15 - 1                 32767\nUSHRT_MAX   2^16 - 1                 65535\n\nINT_MIN     -2^31                    -2147483648\nINT_MAX     2^31 - 1                 2147483647\nUINT_MAX    2^32 - 1                 4294967295\n\nLLONG_MIN   -2^63                    -9223372036854775808\nLLONG_MAX   2^63 - 1                 9223372036854775807\nULLONG_MAX  2^64 - 1                 18446744073709551615\n```\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:37:44+09:00",
      "group": null,
      "id": "52231631f4152673c260",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "INT_MAX",
          "versions": []
        }
      ],
      "title": "よく使うMAX, MINのメモ",
      "updated_at": "2025-12-11T13:37:44+09:00",
      "url": "https://qiita.com/jiku0730/items/52231631f4152673c260",
      "user": {
        "description": null,
        "facebook_id": null,
        "followees_count": 6,
        "followers_count": 0,
        "github_login_name": "jiku0730",
        "id": "jiku0730",
        "items_count": 10,
        "linkedin_id": null,
        "location": null,
        "name": "",
        "organization": null,
        "permanent_id": 4091164,
        "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4091164/profile-images/1764986457",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": null
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<h2 data-sourcepos=\"1:1-1:15\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h2>\n<p data-sourcepos=\"2:1-3:137\">みなさん、年末の大掃除やPCの買い替え、捗っていますか？🧹<br>\n使わなくなったPCを「メルカリで売ろうかな」「友人に譲ろうかな」と思ったとき、ふとよぎる不安。</p>\n<p data-sourcepos=\"5:1-5:145\"><strong>「これ、普通に初期化しただけで大丈夫……？ データ復元されたりしない……？私の黒歴史が……」</strong> 😱</p>\n<p data-sourcepos=\"7:1-7:236\">そんな不安とおさらばするために、今日はWindowsの奥底（コマンドプロンプト）に潜って、ディスクの中身を「0」で埋め尽くす <strong>完全抹消の儀式</strong> を執り行いたいと思います。</p>\n<p data-sourcepos=\"9:1-9:113\">BitLocker解除？ そんな面倒な手順も不要です。さあ、すべてを無に帰しましょう！🚀</p>\n<hr data-sourcepos=\"11:1-12:0\">\n<h2 data-sourcepos=\"13:1-13:38\">\n<span id=\"1-回復環境winreの起動\" class=\"fragment\"></span><a href=\"#1-%E5%9B%9E%E5%BE%A9%E7%92%B0%E5%A2%83winre%E3%81%AE%E8%B5%B7%E5%8B%95\"><i class=\"fa fa-link\"></i></a>1. 回復環境（WinRE）の起動</h2>\n<p data-sourcepos=\"14:1-14:91\">Windowsが起動している状態から、以下の手順で回復環境に入ります。</p>\n<ol data-sourcepos=\"16:1-18:0\">\n<li data-sourcepos=\"16:1-16:78\">スタートメニューの <strong>電源マーク</strong> をクリックします。</li>\n<li data-sourcepos=\"17:1-18:0\">キーボードの <strong>[Shift] キーを押しながら</strong> 「<strong>再起動</strong>」をクリックします。</li>\n</ol>\n<hr data-sourcepos=\"19:1-20:0\">\n<h2 data-sourcepos=\"21:1-21:42\">\n<span id=\"2-コマンドプロンプトの起動\" class=\"fragment\"></span><a href=\"#2-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%97%E3%83%AD%E3%83%B3%E3%83%97%E3%83%88%E3%81%AE%E8%B5%B7%E5%8B%95\"><i class=\"fa fa-link\"></i></a>2. コマンドプロンプトの起動</h2>\n<p data-sourcepos=\"22:1-22:81\">再起動後、青い背景のオプション選択画面が表示されます。</p>\n<ol data-sourcepos=\"24:1-27:3\">\n<li data-sourcepos=\"24:1-24:68\">\n<strong>「トラブルシューティング」</strong> を選択します。</li>\n<li data-sourcepos=\"25:1-25:56\">\n<strong>「詳細オプション」</strong> を選択します。</li>\n<li data-sourcepos=\"26:1-26:62\">\n<strong>「コマンドプロンプト」</strong> を選択します。</li>\n<li data-sourcepos=\"27:1-27:3\">\n</ol>\n<p data-sourcepos=\"28:1-28:138\">※コマンドプロンプトが無い場合は、記事の最後にあるトラブルシューティングを参照してください。</p>\n<hr data-sourcepos=\"30:1-31:0\">\n<h2 data-sourcepos=\"32:1-32:47\">\n<span id=\"3-diskpartによる完全消去-clean-all\" class=\"fragment\"></span><a href=\"#3-diskpart%E3%81%AB%E3%82%88%E3%82%8B%E5%AE%8C%E5%85%A8%E6%B6%88%E5%8E%BB-clean-all\"><i class=\"fa fa-link\"></i></a>3. DiskPartによる完全消去 (clean all)</h2>\n<p data-sourcepos=\"33:1-33:123\">黒い画面（コマンドプロンプト）が立ち上がったら、以下の手順でコマンドを入力します。</p>\n<h3 data-sourcepos=\"35:1-35:29\">\n<span id=\"step-1-diskpartの起動\" class=\"fragment\"></span><a href=\"#step-1-diskpart%E3%81%AE%E8%B5%B7%E5%8B%95\"><i class=\"fa fa-link\"></i></a>Step 1: DiskPartの起動</h3>\n<div class=\"code-frame\" data-lang=\"cmd\" data-sourcepos=\"36:1-38:3\"><div class=\"highlight\"><pre><code>diskpart\n</code></pre></div></div>\n<h3 data-sourcepos=\"40:1-40:33\">\n<span id=\"step-2-ディスクの確認\" class=\"fragment\"></span><a href=\"#step-2-%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AF%E3%81%AE%E7%A2%BA%E8%AA%8D\"><i class=\"fa fa-link\"></i></a>Step 2: ディスクの確認</h3>\n<p data-sourcepos=\"41:1-41:161\">接続されているディスクの一覧を表示します。ここで消去対象のディスク番号（Disk 0, Disk 1など）を確認してください。</p>\n<div class=\"code-frame\" data-lang=\"cmd\" data-sourcepos=\"42:1-44:3\"><div class=\"highlight\"><pre><code>list disk\n</code></pre></div></div>\n<h3 data-sourcepos=\"46:1-46:33\">\n<span id=\"step-3-ディスクの選択\" class=\"fragment\"></span><a href=\"#step-3-%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AF%E3%81%AE%E9%81%B8%E6%8A%9E\"><i class=\"fa fa-link\"></i></a>Step 3: ディスクの選択</h3>\n<p data-sourcepos=\"47:1-47:157\">消去したいディスクを選択します。（通常、メインのディスクは <code>disk 0</code> ですが、必ず容量を見て確認してください）</p>\n<div class=\"code-frame\" data-lang=\"cmd\" data-sourcepos=\"48:1-50:3\"><div class=\"highlight\"><pre><code>select disk 0\n</code></pre></div></div>\n<h3 data-sourcepos=\"52:1-52:33\">\n<span id=\"step-4-完全消去の実行\" class=\"fragment\"></span><a href=\"#step-4-%E5%AE%8C%E5%85%A8%E6%B6%88%E5%8E%BB%E3%81%AE%E5%AE%9F%E8%A1%8C\"><i class=\"fa fa-link\"></i></a>Step 4: 完全消去の実行</h3>\n<p data-sourcepos=\"53:1-54:76\">ディスク全体をゼロで上書き（完全消去）します。<br>\n<strong>※容量によりますが、数時間かかる場合があります。</strong></p>\n<div class=\"code-frame\" data-lang=\"cmd\" data-sourcepos=\"56:1-58:3\"><div class=\"highlight\"><pre><code>clean all\n</code></pre></div></div>\n<div data-sourcepos=\"60:1-63:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"61:1-62:160\"><strong>注意</strong><br>\n<code>clean</code> ではなく <strong><code>clean all</code></strong> を実行することで、全セクタにゼロが書き込まれ、データの復元が極めて困難になります。</p>\n</div>\n</div>\n<h3 data-sourcepos=\"65:1-65:37\">\n<span id=\"複数ディスクがある場合\" class=\"fragment\"></span><a href=\"#%E8%A4%87%E6%95%B0%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AF%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88\"><i class=\"fa fa-link\"></i></a>複数ディスクがある場合</h3>\n<p data-sourcepos=\"66:1-66:147\"><code>list disk</code> で <code>disk 0</code> 以外（<code>disk 1</code>など）が表示され、それらも消去したい場合は、同様の手順を繰り返します。</p>\n<div class=\"code-frame\" data-lang=\"cmd\" data-sourcepos=\"68:1-71:3\"><div class=\"highlight\"><pre><code>select disk 1\nclean all\n</code></pre></div></div>\n<p data-sourcepos=\"73:1-73:112\">完了したら <code>exit</code> で終了し、PCの電源を切ってください。これにて儀式は完了です。</p>\n<hr data-sourcepos=\"75:1-76:0\">\n<h2 data-sourcepos=\"77:1-77:120\">\n<span id=\"warningトラブルシューティング詳細オプションにコマンドプロンプトがない場合\" class=\"fragment\"></span><a href=\"#warning%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E8%A9%B3%E7%B4%B0%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AB%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%97%E3%83%AD%E3%83%B3%E3%83%97%E3%83%88%E3%81%8C%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88\"><i class=\"fa fa-link\"></i></a><img alt=\":warning:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/26a0-fe0f.png\" title=\":warning:\" width=\"20\" loading=\"lazy\">トラブルシューティング：詳細オプションに「コマンドプロンプト」がない場合</h2>\n<p data-sourcepos=\"78:1-78:252\">詳細オプション画面に「コマンドプロンプト」等のメニューが表示されず、「スタートアップ設定」などしか出ない場合は、Windows回復環境（WinRE）が無効になっている可能性があります。</p>\n<p data-sourcepos=\"80:1-80:88\">その場合は一度Windowsにログインし、以下の手順で有効化します。</p>\n<h3 data-sourcepos=\"82:1-82:10\">\n<span id=\"手順\" class=\"fragment\"></span><a href=\"#%E6%89%8B%E9%A0%86\"><i class=\"fa fa-link\"></i></a>手順</h3>\n<ol data-sourcepos=\"83:1-85:0\">\n<li data-sourcepos=\"83:1-83:63\">\n<strong>PowerShell</strong> を <strong>管理者権限</strong> で起動します。</li>\n<li data-sourcepos=\"84:1-85:0\">以下のコマンドを実行します。</li>\n</ol>\n<div class=\"code-frame\" data-lang=\"powershell\" data-sourcepos=\"86:1-88:3\"><div class=\"highlight\"><pre><code><span class=\"n\">reagentc</span><span class=\"w\"> </span><span class=\"nx\">/enable</span><span class=\"w\">\n</span></code></pre></div></div>\n<div data-sourcepos=\"90:1-94:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"91:1-93:65\"><strong>Point</strong><br>\nなぜか1回では成功しない場合があるため、エラーが出なくても念のため <strong>2回実行</strong> してください。<br>\n<code>操作は成功しました。</code> と表示されればOKです。</p>\n</div>\n</div>\n<ol data-sourcepos=\"96:1-97:0\">\n<li data-sourcepos=\"96:1-97:0\">そのまま以下のコマンドを実行し、再度オプション画面へ再起動します。</li>\n</ol>\n<div class=\"code-frame\" data-lang=\"powershell\" data-sourcepos=\"98:1-100:3\"><div class=\"highlight\"><pre><code><span class=\"n\">shutdown</span><span class=\"w\"> </span><span class=\"nx\">/r</span><span class=\"w\"> </span><span class=\"nx\">/o</span><span class=\"w\"> </span><span class=\"nx\">/t</span><span class=\"w\"> </span><span class=\"nx\">0</span><span class=\"w\">\n</span></code></pre></div></div>\n<p data-sourcepos=\"102:1-102:102\">これで詳細オプションにコマンドプロンプトが表示されるようになります。</p>\n",
      "body": "## はじめに\nみなさん、年末の大掃除やPCの買い替え、捗っていますか？🧹\n使わなくなったPCを「メルカリで売ろうかな」「友人に譲ろうかな」と思ったとき、ふとよぎる不安。\n\n**「これ、普通に初期化しただけで大丈夫……？ データ復元されたりしない……？私の黒歴史が……」** 😱\n\nそんな不安とおさらばするために、今日はWindowsの奥底（コマンドプロンプト）に潜って、ディスクの中身を「0」で埋め尽くす **完全抹消の儀式** を執り行いたいと思います。\n\nBitLocker解除？ そんな面倒な手順も不要です。さあ、すべてを無に帰しましょう！🚀\n\n---\n\n## 1. 回復環境（WinRE）の起動\nWindowsが起動している状態から、以下の手順で回復環境に入ります。\n\n1. スタートメニューの **電源マーク** をクリックします。\n2. キーボードの **[Shift] キーを押しながら** 「**再起動**」をクリックします。\n\n---\n\n## 2. コマンドプロンプトの起動\n再起動後、青い背景のオプション選択画面が表示されます。\n\n1. **「トラブルシューティング」** を選択します。\n2. **「詳細オプション」** を選択します。\n3. **「コマンドプロンプト」** を選択します。\n3. \n※コマンドプロンプトが無い場合は、記事の最後にあるトラブルシューティングを参照してください。\n\n---\n\n## 3. DiskPartによる完全消去 (clean all)\n黒い画面（コマンドプロンプト）が立ち上がったら、以下の手順でコマンドを入力します。\n\n### Step 1: DiskPartの起動\n```cmd\ndiskpart\n```\n\n### Step 2: ディスクの確認\n接続されているディスクの一覧を表示します。ここで消去対象のディスク番号（Disk 0, Disk 1など）を確認してください。\n```cmd\nlist disk\n```\n\n### Step 3: ディスクの選択\n消去したいディスクを選択します。（通常、メインのディスクは `disk 0` ですが、必ず容量を見て確認してください）\n```cmd\nselect disk 0\n```\n\n### Step 4: 完全消去の実行\nディスク全体をゼロで上書き（完全消去）します。\n**※容量によりますが、数時間かかる場合があります。**\n\n```cmd\nclean all\n```\n\n:::note warning\n**注意**\n`clean` ではなく **`clean all`** を実行することで、全セクタにゼロが書き込まれ、データの復元が極めて困難になります。\n:::\n\n### 複数ディスクがある場合\n`list disk` で `disk 0` 以外（`disk 1`など）が表示され、それらも消去したい場合は、同様の手順を繰り返します。\n\n```cmd\nselect disk 1\nclean all\n```\n\n完了したら `exit` で終了し、PCの電源を切ってください。これにて儀式は完了です。\n\n---\n\n## :warning:トラブルシューティング：詳細オプションに「コマンドプロンプト」がない場合\n詳細オプション画面に「コマンドプロンプト」等のメニューが表示されず、「スタートアップ設定」などしか出ない場合は、Windows回復環境（WinRE）が無効になっている可能性があります。\n\nその場合は一度Windowsにログインし、以下の手順で有効化します。\n\n### 手順\n1. **PowerShell** を **管理者権限** で起動します。\n2. 以下のコマンドを実行します。\n\n```powershell\nreagentc /enable\n```\n\n:::note info\n**Point**\nなぜか1回では成功しない場合があるため、エラーが出なくても念のため **2回実行** してください。\n`操作は成功しました。` と表示されればOKです。\n:::\n\n3. そのまま以下のコマンドを実行し、再度オプション画面へ再起動します。\n\n```powershell\nshutdown /r /o /t 0\n```\n\nこれで詳細オプションにコマンドプロンプトが表示されるようになります。\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:36:14+09:00",
      "group": null,
      "id": "604e104377c513b4b38a",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Windows",
          "versions": []
        },
        {
          "name": "コマンドプロンプト",
          "versions": []
        },
        {
          "name": "初期化",
          "versions": []
        },
        {
          "name": "情シス",
          "versions": []
        },
        {
          "name": "完全消去",
          "versions": []
        }
      ],
      "title": "データ流出への不安を「完全抹消」で吹き飛ばす",
      "updated_at": "2025-12-11T13:43:50+09:00",
      "url": "https://qiita.com/Makochi777/items/604e104377c513b4b38a",
      "user": {
        "description": null,
        "facebook_id": null,
        "followees_count": 0,
        "followers_count": 2,
        "github_login_name": null,
        "id": "Makochi777",
        "items_count": 4,
        "linkedin_id": null,
        "location": null,
        "name": "",
        "organization": null,
        "permanent_id": 180147,
        "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/180147/profile-images/1741768790",
        "team_only": false,
        "twitter_screen_name": "Makoto_Asao",
        "website_url": null
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-3:84\">VirtualBox 上の Ubuntu で、<br>\n<strong>「Guest Additions CD イメージの挿入」をクリックしても反応しない問題</strong><br>\nに遭遇したので、解決までの手順を備忘録としてまとめます。</p>\n<h1 data-sourcepos=\"5:1-5:8\">\n<span id=\"結論\" class=\"fragment\"></span><a href=\"#%E7%B5%90%E8%AB%96\"><i class=\"fa fa-link\"></i></a>結論</h1>\n<ul data-sourcepos=\"6:1-11:0\">\n<li data-sourcepos=\"6:1-6:82\">光学ドライブにはすでに <code>VBoxGuestAdditions.iso</code> が挿さっていた</li>\n<li data-sourcepos=\"7:1-7:58\">しかし Ubuntu が自動実行してくれなかった</li>\n<li data-sourcepos=\"8:1-8:56\">\n<code>/media/$USER/VBoxLinuxAdditions.run</code> を 直接実行</li>\n<li data-sourcepos=\"9:1-9:49\">VirtualBox の設定で必要な項目を変更</li>\n<li data-sourcepos=\"10:1-11:0\">再起動して無事解決</li>\n</ul>\n<h1 data-sourcepos=\"12:1-12:8\">\n<span id=\"症状\" class=\"fragment\"></span><a href=\"#%E7%97%87%E7%8A%B6\"><i class=\"fa fa-link\"></i></a>症状</h1>\n<ul data-sourcepos=\"13:1-17:0\">\n<li data-sourcepos=\"13:1-14:42\">VirtualBox メニュー → デバイス → Guest Additions CD イメージの挿入<br>\nをクリックしても何も起きない</li>\n<li data-sourcepos=\"15:1-17:0\">ただし VirtualBox の「設定 → ストレージ」では<br>\nIDE コントローラに <code>VBoxGuestAdditions.iso</code> が挿さっている。</li>\n</ul>\n<p data-sourcepos=\"18:1-20:18\">つまり、<br>\n<strong>「ISO は刺さっているのに Ubuntu が認識・自動実行していない」</strong><br>\nという状態。</p>\n<h1 data-sourcepos=\"22:1-22:41\">\n<span id=\"対処法実際にやったこと\" class=\"fragment\"></span><a href=\"#%E5%AF%BE%E5%87%A6%E6%B3%95%E5%AE%9F%E9%9A%9B%E3%81%AB%E3%82%84%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>対処法（実際にやったこと）</h1>\n<h3 data-sourcepos=\"23:1-23:61\">\n<span id=\"-自動マウントされた-guest-additions-を確認\" class=\"fragment\"></span><a href=\"#-%E8%87%AA%E5%8B%95%E3%83%9E%E3%82%A6%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%9F-guest-additions-%E3%82%92%E7%A2%BA%E8%AA%8D\"><i class=\"fa fa-link\"></i></a>① 自動マウントされた Guest Additions を確認</h3>\n<p data-sourcepos=\"24:1-24:58\">Ubuntu では以下に自動マウントされていた：</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"25:1-27:3\"><div class=\"highlight\"><pre><code>/media/$USER/VBox_GAs_x.x.x/\n</code></pre></div></div>\n<p data-sourcepos=\"28:1-28:80\">この中に <code>VBoxLinuxAdditions.run</code> が入っていることを確認する。</p>\n<h3 data-sourcepos=\"30:1-30:31\">\n<span id=\"-run-を手動で実行\" class=\"fragment\"></span><a href=\"#-run-%E3%82%92%E6%89%8B%E5%8B%95%E3%81%A7%E5%AE%9F%E8%A1%8C\"><i class=\"fa fa-link\"></i></a>② .run を手動で実行</h3>\n<div class=\"code-frame\" data-lang=\"terminal\" data-sourcepos=\"31:1-33:3\"><div class=\"highlight\"><pre><code><span class=\"gp\">$</span><span class=\"w\"> </span><span class=\"nb\">sudo </span>sh /media/<span class=\"nv\">$USER</span>/VBoxLinuxAdditions.run\n</code></pre></div></div>\n<p data-sourcepos=\"34:1-34:62\">無事に Guest Additions のインストーラーが動作。</p>\n<h3 data-sourcepos=\"36:1-36:37\">\n<span id=\"-virtualbox-の設定を調整\" class=\"fragment\"></span><a href=\"#-virtualbox-%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92%E8%AA%BF%E6%95%B4\"><i class=\"fa fa-link\"></i></a>③ VirtualBox の設定を調整</h3>\n<p data-sourcepos=\"37:1-37:103\">今回は、メニューバーからデバイス &gt; クリップボードの共有 &gt; 双方 を選択。</p>\n<h3 data-sourcepos=\"39:1-39:27\">\n<span id=\"-ubuntu-を再起動\" class=\"fragment\"></span><a href=\"#-ubuntu-%E3%82%92%E5%86%8D%E8%B5%B7%E5%8B%95\"><i class=\"fa fa-link\"></i></a>④ Ubuntu を再起動</h3>\n<div class=\"code-frame\" data-lang=\"terminal\" data-sourcepos=\"40:1-42:3\"><div class=\"highlight\"><pre><code><span class=\"gp\">$</span><span class=\"w\"> </span><span class=\"nb\">sudo </span>reboot\n</code></pre></div></div>\n<p data-sourcepos=\"43:1-43:78\">これで、手順③で設定した機能が反映されるようになる。</p>\n<h1 data-sourcepos=\"45:1-45:11\">\n<span id=\"まとめ\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>まとめ</h1>\n<ul data-sourcepos=\"46:1-49:53\">\n<li data-sourcepos=\"46:1-46:67\">GUI が無反応でも、ISO が刺さっている場合がある</li>\n<li data-sourcepos=\"47:1-47:48\">\n<code>/media/$USER/</code> に自動マウントされる</li>\n<li data-sourcepos=\"48:1-48:75\">Guest Additions は .run を手動で叩けばインストールできる</li>\n<li data-sourcepos=\"49:1-49:53\">再起動すれば正しく機能が反映される</li>\n</ul>\n",
      "body": "VirtualBox 上の Ubuntu で、\n**「Guest Additions CD イメージの挿入」をクリックしても反応しない問題**\nに遭遇したので、解決までの手順を備忘録としてまとめます。\n\n# 結論\n- 光学ドライブにはすでに `VBoxGuestAdditions.iso` が挿さっていた\n- しかし Ubuntu が自動実行してくれなかった\n- `/media/$USER/VBoxLinuxAdditions.run` を 直接実行\n- VirtualBox の設定で必要な項目を変更\n- 再起動して無事解決\n\n# 症状\n- VirtualBox メニュー → デバイス → Guest Additions CD イメージの挿入\nをクリックしても何も起きない\n- ただし VirtualBox の「設定 → ストレージ」では\nIDE コントローラに `VBoxGuestAdditions.iso` が挿さっている。\n\nつまり、\n**「ISO は刺さっているのに Ubuntu が認識・自動実行していない」**\nという状態。\n\n# 対処法（実際にやったこと）\n### ① 自動マウントされた Guest Additions を確認\nUbuntu では以下に自動マウントされていた：\n```\n/media/$USER/VBox_GAs_x.x.x/\n```\nこの中に `VBoxLinuxAdditions.run` が入っていることを確認する。\n\n### ② .run を手動で実行\n```terminal\n$ sudo sh /media/$USER/VBoxLinuxAdditions.run\n```\n無事に Guest Additions のインストーラーが動作。\n\n### ③ VirtualBox の設定を調整\n今回は、メニューバーからデバイス > クリップボードの共有 > 双方 を選択。\n\n### ④ Ubuntu を再起動\n```terminal\n$ sudo reboot\n```\nこれで、手順③で設定した機能が反映されるようになる。\n\n# まとめ\n- GUI が無反応でも、ISO が刺さっている場合がある\n- `/media/$USER/` に自動マウントされる\n- Guest Additions は .run を手動で叩けばインストールできる\n- 再起動すれば正しく機能が反映される\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:35:25+09:00",
      "group": null,
      "id": "9ba9cae316dcf94e6673",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Ubuntu",
          "versions": []
        },
        {
          "name": "VirtualBox",
          "versions": []
        }
      ],
      "title": "【VirtualBox】Guest Additions CD イメージを挿入しても反応しない時の対処法（備忘録）",
      "updated_at": "2025-12-11T13:35:25+09:00",
      "url": "https://qiita.com/Feature_Seed/items/9ba9cae316dcf94e6673",
      "user": {
        "description": "",
        "facebook_id": "",
        "followees_count": 0,
        "followers_count": 4,
        "github_login_name": null,
        "id": "Feature_Seed",
        "items_count": 29,
        "linkedin_id": "",
        "location": "",
        "name": "",
        "organization": "",
        "permanent_id": 691539,
        "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/691539/profile-images/1756966474",
        "team_only": false,
        "twitter_screen_name": "Feature_Seed",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<h3 data-sourcepos=\"1:1-1:19\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>　はじめに</h3>\n<p data-sourcepos=\"3:1-3:172\">Python + trimesh で OBJ（テクスチャ付き）を扱っていて、「PLY に変換したら色が消えた」みたいな状況になっている方いませんか？</p>\n<p data-sourcepos=\"5:1-6:205\"><strong>概要</strong><br>\nOBJ 形式の 3D モデルを PLY に変換するとき、形状は正しく変換できるのに、なぜか色情報（テクスチャ）が反映されない……という状況にハマりました。</p>\n<p data-sourcepos=\"8:1-8:18\">本記事では、</p>\n<ul data-sourcepos=\"9:1-12:0\">\n<li data-sourcepos=\"9:1-9:84\">「OBJ(+MTL+テクスチャ) → 色付き PLY」変換が失敗していた原因</li>\n<li data-sourcepos=\"10:1-10:73\">trimesh での読み込み方法を変えることで解決した方法</li>\n<li data-sourcepos=\"11:1-12:0\">実際に使った Python コード</li>\n</ul>\n<p data-sourcepos=\"13:1-13:33\">を整理して共有します。</p>\n<h3 data-sourcepos=\"15:1-15:52\">\n<span id=\"背景obj--ply-でやりたかったこと\" class=\"fragment\"></span><a href=\"#%E8%83%8C%E6%99%AFobj--ply-%E3%81%A7%E3%82%84%E3%82%8A%E3%81%9F%E3%81%8B%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>背景：OBJ → PLY でやりたかったこと</h3>\n<blockquote data-sourcepos=\"16:1-17:84\">\n<p data-sourcepos=\"16:2-17:84\">やりたいことはシンプルで、OBJ + MTL + テクスチャ画像<br>\n→ 各頂点に色が焼き込まれた PLY を出力するという処理です。</p>\n</blockquote>\n<p data-sourcepos=\"19:1-20:17\">PLY 側では以下のような構造を想定しています。<br>\n<strong>vertex 要素</strong></p>\n<ul data-sourcepos=\"21:1-23:0\">\n<li data-sourcepos=\"21:1-21:28\">\n<code>x, y, z</code> … 頂点座標</li>\n<li data-sourcepos=\"22:1-23:0\">\n<code>red, green, blue</code> … 頂点色（0–255）</li>\n</ul>\n<p data-sourcepos=\"24:1-24:15\"><strong>face 要素</strong></p>\n<ul data-sourcepos=\"25:1-28:0\">\n<li data-sourcepos=\"25:1-28:0\">\n<code>vertex_indices</code> … 三角形の頂点インデックス（3つ）<br>\nここに、テクスチャ上の色情報を反映させたい、というのがゴールでした。</li>\n</ul>\n<h3 data-sourcepos=\"29:1-29:67\">\n<span id=\"ハマったポイントmeshvisualuv_faces-が無い問題\" class=\"fragment\"></span><a href=\"#%E3%83%8F%E3%83%9E%E3%81%A3%E3%81%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88meshvisualuv_faces-%E3%81%8C%E7%84%A1%E3%81%84%E5%95%8F%E9%A1%8C\"><i class=\"fa fa-link\"></i></a>ハマったポイント：mesh.visual.uv_faces が無い問題</h3>\n<p data-sourcepos=\"31:1-31:60\">最初は trimesh を次のように使っていました。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"32:1-34:3\"><div class=\"highlight\"><pre><code>mesh = trimesh.load(obj_path, force='mesh')\n</code></pre></div></div>\n<p data-sourcepos=\"36:1-36:88\">頂点への色転写のために、各面の UV インデックスを取りたくて、</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"37:1-39:3\"><div class=\"highlight\"><pre><code>mesh.visual.uv_faces\n</code></pre></div></div>\n<p data-sourcepos=\"41:1-41:87\">を参照しようとしたところ、以下のようなエラーに遭遇します。</p>\n<blockquote data-sourcepos=\"43:1-43:68\">\n<p data-sourcepos=\"43:2-43:68\">TextureVisuals オブジェクトには uv_faces が存在しない</p>\n</blockquote>\n<p data-sourcepos=\"45:1-45:12\">つまり、</p>\n<ul data-sourcepos=\"46:1-49:0\">\n<li data-sourcepos=\"46:1-46:94\">\n<code>trimesh.load(..., force='mesh')</code>で得られた <code>mesh.visual</code> は <code>TextureVisuals</code>だが、</li>\n<li data-sourcepos=\"47:1-49:0\">その中に 面ごとの UV インデックス (uv_faces) が用意されていない<br>\nという状態でした。</li>\n</ul>\n<p data-sourcepos=\"50:1-50:60\">本来、テクスチャから頂点色を計算するには</p>\n<ul data-sourcepos=\"51:1-57:0\">\n<li data-sourcepos=\"51:1-51:44\">\n<p data-sourcepos=\"51:3-51:44\">面を構成する頂点インデックス</p>\n</li>\n<li data-sourcepos=\"52:1-54:0\">\n<p data-sourcepos=\"52:3-53:42\">それぞれに対応する UV（テクスチャ座標）<br>\nが揃っている必要があります。</p>\n</li>\n<li data-sourcepos=\"55:1-57:0\">\n<p data-sourcepos=\"55:3-56:105\">しかし、この方法では<strong>UV と頂点インデックスの対応構造が欠落</strong>しており、<br>\nどの頂点がテクスチャのどの位置に対応するか辿ることができませんでした。</p>\n</li>\n</ul>\n<p data-sourcepos=\"58:1-58:21\">今振り返ると、</p>\n<blockquote data-sourcepos=\"60:1-60:76\">\n<p data-sourcepos=\"60:2-60:76\">「uv_faces が無い」という事実に最初に気づくべきだった</p>\n</blockquote>\n<p data-sourcepos=\"62:1-63:72\">のですが、しばらくこの前提のまま試行錯誤してしまい、<br>\n永遠に終わらないデバッグループに陥っていました。</p>\n<h3 data-sourcepos=\"65:1-65:49\">\n<span id=\"解決策scene-構造として読み込む\" class=\"fragment\"></span><a href=\"#%E8%A7%A3%E6%B1%BA%E7%AD%96scene-%E6%A7%8B%E9%80%A0%E3%81%A8%E3%81%97%E3%81%A6%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%82%80\"><i class=\"fa fa-link\"></i></a>解決策：Scene 構造として読み込む</h3>\n<p data-sourcepos=\"66:1-66:57\">問題を解決したポイントは、読み込み方を</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"67:1-69:3\"><div class=\"highlight\"><pre><code>force='mesh'\n</code></pre></div></div>\n<p data-sourcepos=\"70:1-70:6\">から</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"71:1-73:3\"><div class=\"highlight\"><pre><code>force='scene'\n</code></pre></div></div>\n<p data-sourcepos=\"74:1-74:27\">に変えたことです。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"75:1-77:3\"><div class=\"highlight\"><pre><code>scene = trimesh.load(obj_path, force='scene', process=False)\n</code></pre></div></div>\n<p data-sourcepos=\"78:1-78:24\">こうすることで、</p>\n<ul data-sourcepos=\"79:1-81:0\">\n<li data-sourcepos=\"79:1-79:60\">OBJ 全体が 1 つの <code>Scene</code> として読み込まれる</li>\n<li data-sourcepos=\"80:1-81:0\">\n<code>scene.geometry</code> から、<strong>マテリアル単位・オブジェクト単位のサブメッシュ</strong>を取り出せる</li>\n</ul>\n<p data-sourcepos=\"82:1-83:108\">ようになります。<br>\n各 <code>geometry</code> について、次の情報が正しく保持されていることが確認できました。</p>\n<ul data-sourcepos=\"84:1-88:0\">\n<li data-sourcepos=\"84:1-84:38\">\n<code>geometry.vertices</code> … 頂点座標</li>\n<li data-sourcepos=\"85:1-85:56\">\n<code>geometry.faces</code> … 面（頂点インデックス）</li>\n<li data-sourcepos=\"86:1-86:61\">\n<code>geometry.visual.uv</code> … 各頂点に対応する UV 座標</li>\n<li data-sourcepos=\"87:1-88:0\">\n<code>geometry.visual.material.image</code> … 対応するテクスチャ画像（PIL.Image）</li>\n</ul>\n<p data-sourcepos=\"89:1-89:29\"><code>uv_faces</code> は無くても、</p>\n<blockquote data-sourcepos=\"90:1-90:101\">\n<p data-sourcepos=\"90:2-90:101\">「頂点ごとの UV (<code>visual.uv</code>) を、<code>faces</code>の頂点インデックス経由で参照する」</p>\n</blockquote>\n<p data-sourcepos=\"92:1-92:78\">という形で、テクスチャ座標を引けるようになりました。</p>\n<h3 data-sourcepos=\"94:1-94:73\">\n<span id=\"頂点色の決め方uv-からテクスチャをサンプリング\" class=\"fragment\"></span><a href=\"#%E9%A0%82%E7%82%B9%E8%89%B2%E3%81%AE%E6%B1%BA%E3%82%81%E6%96%B9uv-%E3%81%8B%E3%82%89%E3%83%86%E3%82%AF%E3%82%B9%E3%83%81%E3%83%A3%E3%82%92%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0\"><i class=\"fa fa-link\"></i></a>頂点色の決め方：UV からテクスチャをサンプリング</h3>\n<p data-sourcepos=\"95:1-95:54\">頂点色を決定する流れは次の通りです。</p>\n<ol data-sourcepos=\"96:1-101:0\">\n<li data-sourcepos=\"96:1-96:49\">\n<code>geometry.faces</code>で全ての三角形を走査</li>\n<li data-sourcepos=\"97:1-97:87\">各面の頂点インデックス<code>idx</code>から<code>uv = geometry.visual.uv[idx] </code>を取得</li>\n<li data-sourcepos=\"98:1-99:55\">UV を使ってテクスチャ画像から色をサンプリング<br>\n→ バイリニア補間でなめらかに色を取る</li>\n<li data-sourcepos=\"100:1-101:0\">各頂点に対して、複数の面から集まる色を 平均 して頂点色とする</li>\n</ol>\n<p data-sourcepos=\"102:1-102:18\">これにより、</p>\n<ul data-sourcepos=\"103:1-105:0\">\n<li data-sourcepos=\"103:1-103:63\">面単位ではなく 頂点単位の RGB 値 が得られる</li>\n<li data-sourcepos=\"104:1-105:0\">それをそのまま PLY の vertex 要素に書き込める</li>\n</ul>\n<p data-sourcepos=\"106:1-106:33\">という構造になります。</p>\n<h3 data-sourcepos=\"107:1-107:61\">\n<span id=\"実装コードobjテクスチャ--色付きply\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E8%A3%85%E3%82%B3%E3%83%BC%E3%83%89obj%E3%83%86%E3%82%AF%E3%82%B9%E3%83%81%E3%83%A3--%E8%89%B2%E4%BB%98%E3%81%8Dply\"><i class=\"fa fa-link\"></i></a>実装コード（OBJ+テクスチャ → 色付きPLY）</h3>\n<p data-sourcepos=\"108:1-109:108\">以下が、実際に使用した Python スクリプトです。<br>\nパスの部分だけ自分の環境に合わせて変更すれば、そのまま動かせるはずです。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"110:1-259:4\"><div class=\"highlight\"><pre><code>import os\nimport numpy as np\nimport trimesh\nfrom PIL import Image\nfrom plyfile import PlyData, PlyElement\n\n# ============\n# 設定\n# ============\nobj_path = r'-/-.obj'\noutput_path = r'-/-..ply'\n\n\n# ============\n# テクスチャの色を取得する関数（バイリニア補間）\n# ============\ndef bilinear_sample(image, uv):\n    \"\"\"\n    image: PIL.Image (RGB or RGBA 想定)\n    uv: [u, v] in [0, 1]\n    return: [r, g, b] in [0, 1]\n    \"\"\"\n    u, v = np.clip(uv, 0.0, 1.0)\n    width, height = image.size\n\n    # UV(0,0) を左下、画像座標(0,0)を左上とみなすため v を 1 - v\n    x = u * (width - 1)\n    y = (1 - v) * (height - 1)\n\n    x0, y0 = int(x), int(y)\n    x1, y1 = min(x0 + 1, width - 1), min(y0 + 1, height - 1)\n    dx, dy = x - x0, y - y0\n\n    def get(px, py):\n        # RGBA の場合は RGB だけを使う\n        c = image.getpixel((px, py))\n        if isinstance(c, tuple) and len(c) == 4:\n            c = c[:3]\n        return np.array(c, dtype=np.float32)\n\n    # 4点の色\n    c00 = get(x0, y0)\n    c10 = get(x1, y0)\n    c01 = get(x0, y1)\n    c11 = get(x1, y1)\n\n    # x 方向 → y 方向の順で補間\n    top = c00 * (1 - dx) + c10 * dx\n    bottom = c01 * (1 - dx) + c11 * dx\n    rgb = top * (1 - dy) + bottom * dy\n\n    return rgb / 255.0\n\n\n# ============\n# シーンとして OBJ 読み込み\n# ============\nscene = trimesh.load(obj_path, force='scene', process=False)\n\nall_vertices = []\nall_colors = []\nall_faces = []\nvertex_offset = 0\n\n# ============\n# 各ジオメトリごとに処理\n# ============\nfor name, geom in scene.geometry.items():\n    print(f\"▶ 処理中: {name}\")\n\n    # UV が無いジオメトリはスキップ\n    if not hasattr(geom.visual, 'uv') or geom.visual.uv is None:\n        print(f\"⚠ UVなしスキップ: {name}\")\n        continue\n\n    uvs = geom.visual.uv\n    vertices = geom.vertices\n    faces = geom.faces\n    tex_img = geom.visual.material.image\n\n    # テクスチャ画像が無ければスキップ\n    if tex_img is None:\n        print(f\"⚠ テクスチャ画像なしスキップ: {name}\")\n        continue\n\n    vertex_colors = np.zeros((len(vertices), 3), dtype=np.float32)\n    vertex_counts = np.zeros((len(vertices), 1), dtype=np.int32)\n\n    # 各面ごとにUVから色を取得して頂点に加算\n    for face in faces:\n        for idx in face:\n            uv = uvs[idx]\n            color = bilinear_sample(tex_img, uv)\n            vertex_colors[idx] += color\n            vertex_counts[idx] += 1\n\n    # 平均化（1回もサンプリングされなかった頂点はそのまま）\n    valid = vertex_counts.squeeze() &gt; 0\n    vertex_colors[valid] /= vertex_counts[valid]\n\n    # 0–255 の uint8 に変換\n    colors_uint8 = (np.clip(vertex_colors, 0.0, 1.0) * 255).astype(np.uint8)\n\n    # 後で結合するためバッファに追加\n    all_vertices.append(vertices)\n    all_colors.append(colors_uint8)\n    all_faces.append(faces + vertex_offset)\n\n    vertex_offset += len(vertices)\n\n# ============\n# 全ジオメトリを連結\n# ============\nvertices = np.vstack(all_vertices)\ncolors = np.vstack(all_colors)\nfaces = np.vstack(all_faces)\n\n# ============\n# PLY形式のデータ構造を作成\n# ============\nvertex_data = np.empty(len(vertices), dtype=[\n    ('x', 'f4'), ('y', 'f4'), ('z', 'f4'),\n    ('red', 'u1'), ('green', 'u1'), ('blue', 'u1')\n])\n\nfor i in range(len(vertices)):\n    x, y, z = vertices[i]\n    r, g, b = colors[i]\n    vertex_data[i] = (x, y, z, r, g, b)\n\nface_data = np.empty(len(faces), dtype=[\n    ('vertex_indices', 'i4', (3,))\n])\n\nfor i in range(len(faces)):\n    face_data[i] = (faces[i],)\n\n# ============\n# PLYとして書き出し\n# ============\nply = PlyData([\n    PlyElement.describe(vertex_data, 'vertex'),\n    PlyElement.describe(face_data, 'face')\n], text=True)\n\nply.write(output_path)\n\nprint(\"✅ 色付きPLYファイルを出力しました:\", output_path)\n</code></pre></div></div>\n<h3 data-sourcepos=\"261:1-261:13\">\n<span id=\"まとめ\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>まとめ</h3>\n<ul data-sourcepos=\"262:1-267:0\">\n<li data-sourcepos=\"262:1-262:233\">\n<code>trimesh.load(..., force='mesh')</code>で OBJ を読み込んだ場合、必要な UV マッピング情報（特に uv_faces）を持たない場合があり、その状態で頂点へ色を転写しようとしてハマりました。</li>\n<li data-sourcepos=\"263:1-264:99\">\n<code>force='scene'</code>で <code>Scene</code> として読み込み、<code>geometry.visual.uv</code> と<code>geometry.visual.material.image</code>を用いることで、<br>\n各頂点に対応するテクスチャ座標から色を取得できるようになりました。</li>\n<li data-sourcepos=\"265:1-267:0\">テクスチャからバイリニア補間で色をサンプリングし、各頂点に対して複数の面からの色を平均することで、<br>\n<strong>色情報付き PLY</strong> を無事生成できました。</li>\n</ul>\n<hr data-sourcepos=\"268:1-268:3\">\n<p data-sourcepos=\"269:1-270:53\">同じように OBJ→PLY 変換で「形は出るのに色が出ない…」という方の<br>\nデバッグのヒントになれば幸いです 🙌</p>\n",
      "body": "### 　はじめに\n\nPython + trimesh で OBJ（テクスチャ付き）を扱っていて、「PLY に変換したら色が消えた」みたいな状況になっている方いませんか？\n\n**概要**\nOBJ 形式の 3D モデルを PLY に変換するとき、形状は正しく変換できるのに、なぜか色情報（テクスチャ）が反映されない……という状況にハマりました。\n\n本記事では、\n- 「OBJ(+MTL+テクスチャ) → 色付き PLY」変換が失敗していた原因\n- trimesh での読み込み方法を変えることで解決した方法\n- 実際に使った Python コード\n\nを整理して共有します。\n\n### 背景：OBJ → PLY でやりたかったこと\n>やりたいことはシンプルで、OBJ + MTL + テクスチャ画像\n→ 各頂点に色が焼き込まれた PLY を出力するという処理です。\n\nPLY 側では以下のような構造を想定しています。\n**vertex 要素**\n- `x, y, z` … 頂点座標\n- `red, green, blue` … 頂点色（0–255）\n\n**face 要素**\n- `vertex_indices` … 三角形の頂点インデックス（3つ）\nここに、テクスチャ上の色情報を反映させたい、というのがゴールでした。\n\n\n### ハマったポイント：mesh.visual.uv_faces が無い問題\n\n最初は trimesh を次のように使っていました。\n```\nmesh = trimesh.load(obj_path, force='mesh')\n```\n\n頂点への色転写のために、各面の UV インデックスを取りたくて、\n```\nmesh.visual.uv_faces\n```\n\nを参照しようとしたところ、以下のようなエラーに遭遇します。\n\n>TextureVisuals オブジェクトには uv_faces が存在しない\n\nつまり、\n- `trimesh.load(..., force='mesh')`で得られた `mesh.visual` は `TextureVisuals`だが、\n- その中に 面ごとの UV インデックス (uv_faces) が用意されていない\nという状態でした。\n\n本来、テクスチャから頂点色を計算するには\n- 面を構成する頂点インデックス\n- それぞれに対応する UV（テクスチャ座標）\nが揃っている必要があります。\n\n- しかし、この方法では**UV と頂点インデックスの対応構造が欠落**しており、\nどの頂点がテクスチャのどの位置に対応するか辿ることができませんでした。\n\n今振り返ると、\n\n>「uv_faces が無い」という事実に最初に気づくべきだった\n\nのですが、しばらくこの前提のまま試行錯誤してしまい、\n永遠に終わらないデバッグループに陥っていました。\n\n### 解決策：Scene 構造として読み込む\n問題を解決したポイントは、読み込み方を\n```\nforce='mesh'\n```\nから\n```\nforce='scene'\n```\nに変えたことです。\n```\nscene = trimesh.load(obj_path, force='scene', process=False)\n```\nこうすることで、\n- OBJ 全体が 1 つの `Scene` として読み込まれる\n- `scene.geometry` から、**マテリアル単位・オブジェクト単位のサブメッシュ**を取り出せる\n\nようになります。\n各 `geometry` について、次の情報が正しく保持されていることが確認できました。\n- `geometry.vertices` … 頂点座標\n- `geometry.faces` … 面（頂点インデックス）\n- `geometry.visual.uv` … 各頂点に対応する UV 座標\n- `geometry.visual.material.image` … 対応するテクスチャ画像（PIL.Image）\n\n`uv_faces` は無くても、\n>「頂点ごとの UV (`visual.uv`) を、`faces`の頂点インデックス経由で参照する」\n\nという形で、テクスチャ座標を引けるようになりました。\n\n### 頂点色の決め方：UV からテクスチャをサンプリング\n頂点色を決定する流れは次の通りです。\n1. `geometry.faces`で全ての三角形を走査\n1. 各面の頂点インデックス`idx`から`uv = geometry.visual.uv[idx] `を取得\n1. UV を使ってテクスチャ画像から色をサンプリング\n→ バイリニア補間でなめらかに色を取る\n4. 各頂点に対して、複数の面から集まる色を 平均 して頂点色とする\n\nこれにより、\n- 面単位ではなく 頂点単位の RGB 値 が得られる\n- それをそのまま PLY の vertex 要素に書き込める\n\nという構造になります。\n### 実装コード（OBJ+テクスチャ → 色付きPLY）\n以下が、実際に使用した Python スクリプトです。\nパスの部分だけ自分の環境に合わせて変更すれば、そのまま動かせるはずです。\n```\nimport os\nimport numpy as np\nimport trimesh\nfrom PIL import Image\nfrom plyfile import PlyData, PlyElement\n\n# ============\n# 設定\n# ============\nobj_path = r'-/-.obj'\noutput_path = r'-/-..ply'\n\n\n# ============\n# テクスチャの色を取得する関数（バイリニア補間）\n# ============\ndef bilinear_sample(image, uv):\n    \"\"\"\n    image: PIL.Image (RGB or RGBA 想定)\n    uv: [u, v] in [0, 1]\n    return: [r, g, b] in [0, 1]\n    \"\"\"\n    u, v = np.clip(uv, 0.0, 1.0)\n    width, height = image.size\n\n    # UV(0,0) を左下、画像座標(0,0)を左上とみなすため v を 1 - v\n    x = u * (width - 1)\n    y = (1 - v) * (height - 1)\n\n    x0, y0 = int(x), int(y)\n    x1, y1 = min(x0 + 1, width - 1), min(y0 + 1, height - 1)\n    dx, dy = x - x0, y - y0\n\n    def get(px, py):\n        # RGBA の場合は RGB だけを使う\n        c = image.getpixel((px, py))\n        if isinstance(c, tuple) and len(c) == 4:\n            c = c[:3]\n        return np.array(c, dtype=np.float32)\n\n    # 4点の色\n    c00 = get(x0, y0)\n    c10 = get(x1, y0)\n    c01 = get(x0, y1)\n    c11 = get(x1, y1)\n\n    # x 方向 → y 方向の順で補間\n    top = c00 * (1 - dx) + c10 * dx\n    bottom = c01 * (1 - dx) + c11 * dx\n    rgb = top * (1 - dy) + bottom * dy\n\n    return rgb / 255.0\n\n\n# ============\n# シーンとして OBJ 読み込み\n# ============\nscene = trimesh.load(obj_path, force='scene', process=False)\n\nall_vertices = []\nall_colors = []\nall_faces = []\nvertex_offset = 0\n\n# ============\n# 各ジオメトリごとに処理\n# ============\nfor name, geom in scene.geometry.items():\n    print(f\"▶ 処理中: {name}\")\n\n    # UV が無いジオメトリはスキップ\n    if not hasattr(geom.visual, 'uv') or geom.visual.uv is None:\n        print(f\"⚠ UVなしスキップ: {name}\")\n        continue\n\n    uvs = geom.visual.uv\n    vertices = geom.vertices\n    faces = geom.faces\n    tex_img = geom.visual.material.image\n\n    # テクスチャ画像が無ければスキップ\n    if tex_img is None:\n        print(f\"⚠ テクスチャ画像なしスキップ: {name}\")\n        continue\n\n    vertex_colors = np.zeros((len(vertices), 3), dtype=np.float32)\n    vertex_counts = np.zeros((len(vertices), 1), dtype=np.int32)\n\n    # 各面ごとにUVから色を取得して頂点に加算\n    for face in faces:\n        for idx in face:\n            uv = uvs[idx]\n            color = bilinear_sample(tex_img, uv)\n            vertex_colors[idx] += color\n            vertex_counts[idx] += 1\n\n    # 平均化（1回もサンプリングされなかった頂点はそのまま）\n    valid = vertex_counts.squeeze() > 0\n    vertex_colors[valid] /= vertex_counts[valid]\n\n    # 0–255 の uint8 に変換\n    colors_uint8 = (np.clip(vertex_colors, 0.0, 1.0) * 255).astype(np.uint8)\n\n    # 後で結合するためバッファに追加\n    all_vertices.append(vertices)\n    all_colors.append(colors_uint8)\n    all_faces.append(faces + vertex_offset)\n\n    vertex_offset += len(vertices)\n\n# ============\n# 全ジオメトリを連結\n# ============\nvertices = np.vstack(all_vertices)\ncolors = np.vstack(all_colors)\nfaces = np.vstack(all_faces)\n\n# ============\n# PLY形式のデータ構造を作成\n# ============\nvertex_data = np.empty(len(vertices), dtype=[\n    ('x', 'f4'), ('y', 'f4'), ('z', 'f4'),\n    ('red', 'u1'), ('green', 'u1'), ('blue', 'u1')\n])\n\nfor i in range(len(vertices)):\n    x, y, z = vertices[i]\n    r, g, b = colors[i]\n    vertex_data[i] = (x, y, z, r, g, b)\n\nface_data = np.empty(len(faces), dtype=[\n    ('vertex_indices', 'i4', (3,))\n])\n\nfor i in range(len(faces)):\n    face_data[i] = (faces[i],)\n\n# ============\n# PLYとして書き出し\n# ============\nply = PlyData([\n    PlyElement.describe(vertex_data, 'vertex'),\n    PlyElement.describe(face_data, 'face')\n], text=True)\n\nply.write(output_path)\n\nprint(\"✅ 色付きPLYファイルを出力しました:\", output_path)\n````\n\n### まとめ\n- `trimesh.load(..., force='mesh')`で OBJ を読み込んだ場合、必要な UV マッピング情報（特に uv_faces）を持たない場合があり、その状態で頂点へ色を転写しようとしてハマりました。\n- `force='scene'`で `Scene` として読み込み、`geometry.visual.uv` と`geometry.visual.material.image`を用いることで、\n各頂点に対応するテクスチャ座標から色を取得できるようになりました。\n- テクスチャからバイリニア補間で色をサンプリングし、各頂点に対して複数の面からの色を平均することで、\n**色情報付き PLY** を無事生成できました。\n\n---\n同じように OBJ→PLY 変換で「形は出るのに色が出ない…」という方の\nデバッグのヒントになれば幸いです 🙌\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:27:06+09:00",
      "group": null,
      "id": "302219ea62d9dd642a61",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Python",
          "versions": []
        },
        {
          "name": "備忘録",
          "versions": []
        },
        {
          "name": "obj",
          "versions": []
        },
        {
          "name": "ply",
          "versions": []
        }
      ],
      "title": "OBJ→PLY変換における色情報の喪失原因と、その解決までのメモ",
      "updated_at": "2025-12-11T13:27:06+09:00",
      "url": "https://qiita.com/gin_ta24/items/302219ea62d9dd642a61",
      "user": {
        "description": "農学系の学生です。\r\n記録としても活用させて頂いてます。",
        "facebook_id": "",
        "followees_count": 1,
        "followers_count": 0,
        "github_login_name": null,
        "id": "gin_ta24",
        "items_count": 7,
        "linkedin_id": "",
        "location": "",
        "name": "tuna right",
        "organization": "",
        "permanent_id": 4288039,
        "profile_image_url": "https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/4288039/25d6c579a84967e1211591363b663b25cdde334d/x_large.png?1765328598",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-2:63\">Raspberry Pi 4 model Bを使った小型ロボット開発の準備を行います。<br>\nどんな準備が必要なのかを簡単にまとめます。</p>\n<p data-sourcepos=\"4:1-4:71\">この記事は Tuton Advent Calender 2025 の7日目の記事です。</p>\n<p data-sourcepos=\"6:1-6:44\"><iframe id=\"qiita-embed-content__4276da4e7fb9ee7da015d203120c563a\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__4276da4e7fb9ee7da015d203120c563a\" data-content=\"https%3A%2F%2Fqiita.com%2Fadvent-calendar%2F2025%2Ftuton\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<h1 data-sourcepos=\"9:1-9:13\">\n<span id=\"osの準備\" class=\"fragment\"></span><a href=\"#os%E3%81%AE%E6%BA%96%E5%82%99\"><i class=\"fa fa-link\"></i></a>OSの準備</h1>\n<p data-sourcepos=\"10:1-10:67\">SDカードを用意し、OSのイメージを書き込みます。</p>\n<p data-sourcepos=\"12:1-12:122\"><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F3124670%2F567efea0-3e09-4253-869b-c34e7aa292d3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c9623bb7288f4a20ce747b77e98e60d3\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F3124670%2F567efea0-3e09-4253-869b-c34e7aa292d3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c9623bb7288f4a20ce747b77e98e60d3\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F3124670%2F567efea0-3e09-4253-869b-c34e7aa292d3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=db6ef6656167325b9a655f4a35020ea8 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3124670/567efea0-3e09-4253-869b-c34e7aa292d3.png\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"14:1-15:122\">次へを押すとこのような画面になり、いくつかの設定を行うことができます。<br>\n<a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F3124670%2Fc14d1cb0-ea55-47ce-b0d5-88032f3eef14.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=398fb2a40d9bbf88bd49ca9bd44521b2\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F3124670%2Fc14d1cb0-ea55-47ce-b0d5-88032f3eef14.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=398fb2a40d9bbf88bd49ca9bd44521b2\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F3124670%2Fc14d1cb0-ea55-47ce-b0d5-88032f3eef14.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a011cc88deaa8d4120f5f69d08a0b77b 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3124670/c14d1cb0-ea55-47ce-b0d5-88032f3eef14.png\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"17:1-18:119\">ユーザー名・パスワード、Wi-Fiなどを設定しておきます。ここでWi-Fiの設定をしておくことで、そのWi-Fiが飛んでいれば勝手に接続してくれるため最初から無線で開発することができます。<br>\nPCのモバイルホットスポットを登録しておくと、場所を選ばず開発できるので便利です。</p>\n<p data-sourcepos=\"20:1-20:92\">書き込みが終わったらSDカードをRaspberry Piに差して電源を入れます。</p>\n<h1 data-sourcepos=\"22:1-22:29\">\n<span id=\"ロボットに組み込む\" class=\"fragment\"></span><a href=\"#%E3%83%AD%E3%83%9C%E3%83%83%E3%83%88%E3%81%AB%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80\"><i class=\"fa fa-link\"></i></a>ロボットに組み込む</h1>\n<p data-sourcepos=\"23:1-23:219\">Raspberry Pi 4 model Bは5Vピンから電源供給できます。3A供給できる電源を用意しておくとよいと思います（最大1.25～1.5A程度なので2Aくらいでもいいかもしれません）。</p>\n<div data-sourcepos=\"25:1-27:3\" class=\"note warn\">\n<span class=\"fa fa-fw fa-exclamation-circle\"></span><div>\n<p data-sourcepos=\"26:1-26:87\">Raspberry Pi 5は消費電力が大きいのでGPIOからの供給は非推奨です。</p>\n</div>\n</div>\n<p data-sourcepos=\"29:1-29:236\">Raspberry Pi 5に比べると発熱は少ないですが、最低限のファンやヒートシンクはつけましょう。また、Raspberry Piの周囲はスペースを確保して空気の流れを作っておくとよいです。</p>\n<h1 data-sourcepos=\"31:1-31:20\">\n<span id=\"sshでログイン\" class=\"fragment\"></span><a href=\"#ssh%E3%81%A7%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3\"><i class=\"fa fa-link\"></i></a>SSHでログイン</h1>\n<p data-sourcepos=\"32:1-32:44\">Raspberry PiがWi-Fiにつながったら、</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"33:1-35:3\"><div class=\"highlight\"><pre><code>ssh {username}@raspberrypi.local\n</code></pre></div></div>\n<p data-sourcepos=\"36:1-36:30\">でログインできます。</p>\n<p data-sourcepos=\"38:1-38:132\">ターミナルで操作しても良いですが、開発のことを考えるとVSCodeからSSHするのが良いと思います。</p>\n<p data-sourcepos=\"40:1-40:159\">VSCodeの以下の拡張機能をインストールして使用します。詳細はネットに記事がたくさんあるので調べてみてください。</p>\n<p data-sourcepos=\"42:1-42:96\"><iframe id=\"qiita-embed-content__6f81226c0db172732441c2326f1256ea\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__6f81226c0db172732441c2326f1256ea\" data-content=\"https%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3Dms-vscode-remote.vscode-remote-extensionpack\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<h1 data-sourcepos=\"47:1-47:29\">\n<span id=\"ソースコードを書く\" class=\"fragment\"></span><a href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\"><i class=\"fa fa-link\"></i></a>ソースコードを書く</h1>\n<p data-sourcepos=\"48:1-50:84\">Pythonでプログラムを書くことを想定しています。<br>\n開発用に新規ディレクトリを作成し、仮想環境を構築しましょう。<br>\n仮想環境を使った方が安全にライブラリなどを管理できます。</p>\n<p data-sourcepos=\"52:1-52:48\">以下の記事などが参考になります。</p>\n<p data-sourcepos=\"54:1-54:57\"><iframe id=\"qiita-embed-content__95e7788decc01100ee94c3cde1c54610\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__95e7788decc01100ee94c3cde1c54610\" data-content=\"https%3A%2F%2Fqiita.com%2Ffiftystorm36%2Fitems%2Fb2fd47cf32c7694adc2e\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<p data-sourcepos=\"56:1-56:111\">仮想環境を構築したらPythonファイルを作ってプログラムを書いていけばよいです。</p>\n<p data-sourcepos=\"58:1-59:51\">ソースコードはGit管理するとよいです。<br>\nVSCodeのGUIでGitを操作するのが楽です。</p>\n<h1 data-sourcepos=\"62:1-62:30\">\n<span id=\"複数uartの有効化など\" class=\"fragment\"></span><a href=\"#%E8%A4%87%E6%95%B0uart%E3%81%AE%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%AA%E3%81%A9\"><i class=\"fa fa-link\"></i></a>複数UARTの有効化など</h1>\n<p data-sourcepos=\"63:1-64:108\">Raspberry Piには6つのUARTがありますが、初期設定では制限されています。<br>\n複数使用したい場合は、以下の記事などを参考にして有効化しておきましょう。</p>\n<p data-sourcepos=\"66:1-66:53\"><iframe id=\"qiita-embed-content__2d86534a4451d49f64d546f3edb813f6\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__2d86534a4451d49f64d546f3edb813f6\" data-content=\"https%3A%2F%2Ftshell.hatenablog.com%2Fentry%2F2021%2F03%2F04%2F205346\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<p data-sourcepos=\"68:1-68:56\">(Ubuntuでなくても同じように設定できます)</p>\n<h1 data-sourcepos=\"70:1-70:47\">\n<span id=\"起動時プログラム自動実行の設定\" class=\"fragment\"></span><a href=\"#%E8%B5%B7%E5%8B%95%E6%99%82%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E8%87%AA%E5%8B%95%E5%AE%9F%E8%A1%8C%E3%81%AE%E8%A8%AD%E5%AE%9A\"><i class=\"fa fa-link\"></i></a>起動時プログラム自動実行の設定</h1>\n<p data-sourcepos=\"72:1-72:105\">ロボットの電源を入れたら特定のプログラムを実行するようにしたいですね。</p>\n<p data-sourcepos=\"74:1-74:56\"><code>systemd</code>というものを使って設定します。</p>\n<p data-sourcepos=\"76:1-76:45\">こちらの記事が参考になります。</p>\n<p data-sourcepos=\"78:1-78:53\"><iframe id=\"qiita-embed-content__8e09a0e1cb09064a2c0f58e07bd45352\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__8e09a0e1cb09064a2c0f58e07bd45352\" data-content=\"https%3A%2F%2Fqiita.com%2Fmolchiro%2Fitems%2Fee32a11b81fa1dc2fd8d\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<p data-sourcepos=\"80:1-81:184\">ロボット競技会の本番などでは自動実行したいですが、開発中は自動実行されると困りますよね。<br>\nスライドスイッチなどをGPIOにつなげておいて、プログラム実行時にそれを読んで実行するか終了するかを判断させるとよいと思います。</p>\n<h1 data-sourcepos=\"83:1-83:14\">\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h1>\n<p data-sourcepos=\"84:1-84:174\">普通のマイコンと違って小型ロボットの用途で使いこなすには少し癖があるので早めにいろいろなことを確認しておきましょう。</p>\n",
      "body": "Raspberry Pi 4 model Bを使った小型ロボット開発の準備を行います。\nどんな準備が必要なのかを簡単にまとめます。\n\nこの記事は Tuton Advent Calender 2025 の7日目の記事です。\n\nhttps://qiita.com/advent-calendar/2025/tuton\n\n\n# OSの準備\nSDカードを用意し、OSのイメージを書き込みます。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3124670/567efea0-3e09-4253-869b-c34e7aa292d3.png)\n\n次へを押すとこのような画面になり、いくつかの設定を行うことができます。\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3124670/c14d1cb0-ea55-47ce-b0d5-88032f3eef14.png)\n\nユーザー名・パスワード、Wi-Fiなどを設定しておきます。ここでWi-Fiの設定をしておくことで、そのWi-Fiが飛んでいれば勝手に接続してくれるため最初から無線で開発することができます。\nPCのモバイルホットスポットを登録しておくと、場所を選ばず開発できるので便利です。\n\n書き込みが終わったらSDカードをRaspberry Piに差して電源を入れます。\n\n# ロボットに組み込む\nRaspberry Pi 4 model Bは5Vピンから電源供給できます。3A供給できる電源を用意しておくとよいと思います（最大1.25～1.5A程度なので2Aくらいでもいいかもしれません）。\n\n:::note warn\nRaspberry Pi 5は消費電力が大きいのでGPIOからの供給は非推奨です。\n:::\n\nRaspberry Pi 5に比べると発熱は少ないですが、最低限のファンやヒートシンクはつけましょう。また、Raspberry Piの周囲はスペースを確保して空気の流れを作っておくとよいです。\n\n# SSHでログイン\nRaspberry PiがWi-Fiにつながったら、\n```\nssh {username}@raspberrypi.local\n```\nでログインできます。\n\nターミナルで操作しても良いですが、開発のことを考えるとVSCodeからSSHするのが良いと思います。\n\nVSCodeの以下の拡張機能をインストールして使用します。詳細はネットに記事がたくさんあるので調べてみてください。\n\nhttps://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack\n\n\n\n\n# ソースコードを書く\nPythonでプログラムを書くことを想定しています。\n開発用に新規ディレクトリを作成し、仮想環境を構築しましょう。\n仮想環境を使った方が安全にライブラリなどを管理できます。\n\n以下の記事などが参考になります。\n\nhttps://qiita.com/fiftystorm36/items/b2fd47cf32c7694adc2e\n\n仮想環境を構築したらPythonファイルを作ってプログラムを書いていけばよいです。\n\nソースコードはGit管理するとよいです。\nVSCodeのGUIでGitを操作するのが楽です。\n\n\n# 複数UARTの有効化など\nRaspberry Piには6つのUARTがありますが、初期設定では制限されています。\n複数使用したい場合は、以下の記事などを参考にして有効化しておきましょう。\n\nhttps://tshell.hatenablog.com/entry/2021/03/04/205346\n\n(Ubuntuでなくても同じように設定できます)\n\n# 起動時プログラム自動実行の設定\n\nロボットの電源を入れたら特定のプログラムを実行するようにしたいですね。\n\n``systemd``というものを使って設定します。\n\nこちらの記事が参考になります。\n\nhttps://qiita.com/molchiro/items/ee32a11b81fa1dc2fd8d\n\nロボット競技会の本番などでは自動実行したいですが、開発中は自動実行されると困りますよね。\nスライドスイッチなどをGPIOにつなげておいて、プログラム実行時にそれを読んで実行するか終了するかを判断させるとよいと思います。\n\n# おわりに\n普通のマイコンと違って小型ロボットの用途で使いこなすには少し癖があるので早めにいろいろなことを確認しておきましょう。\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:25:13+09:00",
      "group": null,
      "id": "a93f84a13b5d22a94baf",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "RaspberryPi",
          "versions": []
        },
        {
          "name": "ロボット",
          "versions": []
        }
      ],
      "title": "Raspberry Pi 4 model Bでのロボット開発準備",
      "updated_at": "2025-12-11T13:25:13+09:00",
      "url": "https://qiita.com/shuji4649/items/a93f84a13b5d22a94baf",
      "user": {
        "description": "プログラミング・電子工作。\r\n競プロやロボカップジュニアをやっています。",
        "facebook_id": "",
        "followees_count": 9,
        "followers_count": 11,
        "github_login_name": null,
        "id": "shuji4649",
        "items_count": 37,
        "linkedin_id": "",
        "location": "",
        "name": "",
        "organization": "",
        "permanent_id": 3124670,
        "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3124670/profile-images/1707472761",
        "team_only": false,
        "twitter_screen_name": "shuji_4649",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"3:1-3:174\">この記事は、<strong><a href=\"https://adventar.org/calendars/12615\" rel=\"nofollow noopener\" target=\"_blank\">ひとりでつくるSaaS - 設計・実装・運用の記録 Advent Calendar 2025</a></strong> の11日目の記事です。</p>\n<p data-sourcepos=\"5:1-5:211\">昨日の記事では「App Routerのディレクトリ設計」について書きました。この記事では、MPAからSPAへの移行を実践した理由と具体的な実装について解説します。</p>\n<h2 data-sourcepos=\"7:1-7:35\">\n<span id=\"-この記事で使う用語\" class=\"fragment\"></span><a href=\"#-%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%A7%E4%BD%BF%E3%81%86%E7%94%A8%E8%AA%9E\"><i class=\"fa fa-link\"></i></a>📝 この記事で使う用語</h2>\n<ul data-sourcepos=\"9:1-12:0\">\n<li data-sourcepos=\"9:1-9:145\">\n<strong>MPA（Multi Page Application）</strong>: ページ遷移のたびにサーバーからHTMLを取得し、画面全体を再読み込みする方式</li>\n<li data-sourcepos=\"10:1-10:149\">\n<strong>SPA（Single Page Application）</strong>: 初回読み込み後はJavaScriptでページを切り替え、画面全体を再読み込みしない方式</li>\n<li data-sourcepos=\"11:1-12:0\">\n<strong>クライアントサイドナビゲーション</strong>: ブラウザ側でURLを変更し、必要なデータだけを取得してページを更新する方式</li>\n</ul>\n<h2 data-sourcepos=\"13:1-13:38\">\n<span id=\"-なぜspaに移行したのか\" class=\"fragment\"></span><a href=\"#-%E3%81%AA%E3%81%9Cspa%E3%81%AB%E7%A7%BB%E8%A1%8C%E3%81%97%E3%81%9F%E3%81%AE%E3%81%8B\"><i class=\"fa fa-link\"></i></a>🎯 なぜSPAに移行したのか</h2>\n<p data-sourcepos=\"15:1-15:238\">App Routerを採用した当初は、Server Componentsの恩恵を最大化するため、MPA的な構成にしていました。ページ遷移のたびにサーバーでHTMLを生成し、新しいページを表示する方式です。</p>\n<p data-sourcepos=\"17:1-17:81\">しかし、開発を進めるうちに以下の課題が見えてきました。</p>\n<h3 data-sourcepos=\"19:1-19:28\">\n<span id=\"mpa的な構成の課題\" class=\"fragment\"></span><a href=\"#mpa%E7%9A%84%E3%81%AA%E6%A7%8B%E6%88%90%E3%81%AE%E8%AA%B2%E9%A1%8C\"><i class=\"fa fa-link\"></i></a>MPA的な構成の課題</h3>\n<p data-sourcepos=\"21:1-21:58\"><strong>1. ナビゲーションメニューの再読み込み</strong></p>\n<p data-sourcepos=\"23:1-23:261\">サイドバーにナビゲーションメニューを配置していますが、ページ遷移のたびに再読み込みされていました。展開状態がリセットされたり、一瞬ちらついたりして、体験が損なわれていました。</p>\n<p data-sourcepos=\"25:1-25:43\"><strong>2. スクロール位置のリセット</strong></p>\n<p data-sourcepos=\"27:1-27:201\">一覧画面でスクロールして詳細画面に遷移し、戻ると最初の位置に戻ってしまう。フィルタ条件もリセットされ、再度設定し直す必要がありました。</p>\n<p data-sourcepos=\"29:1-29:31\"><strong>3. 遷移時のちらつき</strong></p>\n<p data-sourcepos=\"31:1-31:171\">ページ遷移のたびに画面全体が再描画されるため、レイアウトが一瞬崩れたり、ローディング状態が目立ったりしていました。</p>\n<h2 data-sourcepos=\"33:1-33:38\">\n<span id=\"-spa移行で実現したこと\" class=\"fragment\"></span><a href=\"#-spa%E7%A7%BB%E8%A1%8C%E3%81%A7%E5%AE%9F%E7%8F%BE%E3%81%97%E3%81%9F%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>🔧 SPA移行で実現したこと</h2>\n<h3 data-sourcepos=\"35:1-35:37\">\n<span id=\"1-スクロール位置の復元\" class=\"fragment\"></span><a href=\"#1-%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E4%BD%8D%E7%BD%AE%E3%81%AE%E5%BE%A9%E5%85%83\"><i class=\"fa fa-link\"></i></a>1. スクロール位置の復元</h3>\n<p data-sourcepos=\"37:1-37:93\">詳細画面から一覧に戻ったとき、元のスクロール位置を復元します。</p>\n<div class=\"code-frame\" data-lang=\"typescript\" data-sourcepos=\"39:1-76:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">// useScrollRestoration.ts</span>\n<span class=\"kd\">const</span> <span class=\"nx\">SCROLL_CACHE_KEY</span> <span class=\"o\">=</span> <span class=\"dl\">'</span><span class=\"s1\">app_scroll_cache</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n<span class=\"kd\">const</span> <span class=\"nx\">CACHE_EXPIRY</span> <span class=\"o\">=</span> <span class=\"mi\">5</span> <span class=\"o\">*</span> <span class=\"mi\">60</span> <span class=\"o\">*</span> <span class=\"mi\">1000</span><span class=\"p\">;</span> <span class=\"c1\">// 5分</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">function</span> <span class=\"nf\">useScrollRestoration</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// スクロール位置を保存</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">saveScroll</span> <span class=\"o\">=</span> <span class=\"nf\">useCallback</span><span class=\"p\">(()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"kd\">const</span> <span class=\"nx\">cache</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n      <span class=\"na\">scrollY</span><span class=\"p\">:</span> <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">scrollY</span><span class=\"p\">,</span>\n      <span class=\"na\">pathname</span><span class=\"p\">:</span> <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">location</span><span class=\"p\">.</span><span class=\"nx\">pathname</span><span class=\"p\">,</span>\n      <span class=\"na\">timestamp</span><span class=\"p\">:</span> <span class=\"nb\">Date</span><span class=\"p\">.</span><span class=\"nf\">now</span><span class=\"p\">(),</span>\n    <span class=\"p\">};</span>\n    <span class=\"nx\">sessionStorage</span><span class=\"p\">.</span><span class=\"nf\">setItem</span><span class=\"p\">(</span><span class=\"nx\">SCROLL_CACHE_KEY</span><span class=\"p\">,</span> <span class=\"nx\">JSON</span><span class=\"p\">.</span><span class=\"nf\">stringify</span><span class=\"p\">(</span><span class=\"nx\">cache</span><span class=\"p\">));</span>\n  <span class=\"p\">},</span> <span class=\"p\">[]);</span>\n\n  <span class=\"c1\">// スクロール位置を復元</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">restoreScroll</span> <span class=\"o\">=</span> <span class=\"nf\">useCallback</span><span class=\"p\">(()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"kd\">const</span> <span class=\"nx\">stored</span> <span class=\"o\">=</span> <span class=\"nx\">sessionStorage</span><span class=\"p\">.</span><span class=\"nf\">getItem</span><span class=\"p\">(</span><span class=\"nx\">SCROLL_CACHE_KEY</span><span class=\"p\">);</span>\n    <span class=\"k\">if </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"nx\">stored</span><span class=\"p\">)</span> <span class=\"k\">return</span><span class=\"p\">;</span>\n\n    <span class=\"kd\">const</span> <span class=\"nx\">cache</span> <span class=\"o\">=</span> <span class=\"nx\">JSON</span><span class=\"p\">.</span><span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"nx\">stored</span><span class=\"p\">);</span>\n\n    <span class=\"c1\">// 有効期限チェック</span>\n    <span class=\"k\">if </span><span class=\"p\">(</span><span class=\"nb\">Date</span><span class=\"p\">.</span><span class=\"nf\">now</span><span class=\"p\">()</span> <span class=\"o\">-</span> <span class=\"nx\">cache</span><span class=\"p\">.</span><span class=\"nx\">timestamp</span> <span class=\"o\">&gt;</span> <span class=\"nx\">CACHE_EXPIRY</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"nx\">sessionStorage</span><span class=\"p\">.</span><span class=\"nf\">removeItem</span><span class=\"p\">(</span><span class=\"nx\">SCROLL_CACHE_KEY</span><span class=\"p\">);</span>\n      <span class=\"k\">return</span><span class=\"p\">;</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"c1\">// 同じパスなら復元</span>\n    <span class=\"k\">if </span><span class=\"p\">(</span><span class=\"nx\">cache</span><span class=\"p\">.</span><span class=\"nx\">pathname</span> <span class=\"o\">===</span> <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">location</span><span class=\"p\">.</span><span class=\"nx\">pathname</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nf\">scrollTo</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nx\">cache</span><span class=\"p\">.</span><span class=\"nx\">scrollY</span><span class=\"p\">);</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">},</span> <span class=\"p\">[]);</span>\n\n  <span class=\"k\">return</span> <span class=\"p\">{</span> <span class=\"nx\">saveScroll</span><span class=\"p\">,</span> <span class=\"nx\">restoreScroll</span> <span class=\"p\">};</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n<h3 data-sourcepos=\"78:1-78:37\">\n<span id=\"2-フィルタ状態のurl同期\" class=\"fragment\"></span><a href=\"#2-%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E7%8A%B6%E6%85%8B%E3%81%AEurl%E5%90%8C%E6%9C%9F\"><i class=\"fa fa-link\"></i></a>2. フィルタ状態のURL同期</h3>\n<p data-sourcepos=\"80:1-80:268\">フィルタやソート条件をURLパラメータに保存し、ブラウザの履歴と連携させています。ここではnuqsというライブラリを使っています。nuqsは、URLパラメータをReactの状態として扱えるライブラリです。</p>\n<p data-sourcepos=\"82:1-82:17\"><iframe id=\"qiita-embed-content__26653564cfb479fc38b8084cbdbf4561\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__26653564cfb479fc38b8084cbdbf4561\" data-content=\"https%3A%2F%2Fnuqs.dev%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<div class=\"code-frame\" data-lang=\"typescript\" data-sourcepos=\"84:1-102:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">// useListFilters.ts</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">parseAsString</span><span class=\"p\">,</span> <span class=\"nx\">parseAsStringEnum</span><span class=\"p\">,</span> <span class=\"nx\">useQueryStates</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">nuqs</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">listFilterParsers</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"na\">category</span><span class=\"p\">:</span> <span class=\"nx\">parseAsString</span><span class=\"p\">,</span>\n  <span class=\"na\">tag</span><span class=\"p\">:</span> <span class=\"nx\">parseAsString</span><span class=\"p\">,</span>\n  <span class=\"na\">sort</span><span class=\"p\">:</span> <span class=\"nf\">parseAsStringEnum</span><span class=\"p\">([</span><span class=\"dl\">'</span><span class=\"s1\">newest</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">oldest</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">popular</span><span class=\"dl\">'</span><span class=\"p\">]</span> <span class=\"kd\">as const</span><span class=\"p\">)</span>\n    <span class=\"p\">.</span><span class=\"nf\">withDefault</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">newest</span><span class=\"dl\">'</span><span class=\"p\">),</span>\n  <span class=\"na\">search</span><span class=\"p\">:</span> <span class=\"nx\">parseAsString</span><span class=\"p\">,</span>\n<span class=\"p\">};</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">function</span> <span class=\"nf\">useListFilters</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n  <span class=\"k\">return</span> <span class=\"nf\">useQueryStates</span><span class=\"p\">(</span><span class=\"nx\">listFilterParsers</span><span class=\"p\">,</span> <span class=\"p\">{</span>\n    <span class=\"na\">history</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">push</span><span class=\"dl\">'</span><span class=\"p\">,</span>   <span class=\"c1\">// ブラウザ履歴に追加</span>\n    <span class=\"na\">shallow</span><span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">,</span>     <span class=\"c1\">// サーバー再取得なし</span>\n  <span class=\"p\">});</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n<p data-sourcepos=\"104:1-104:63\">これにより、以下のようなURLが生成されます。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"106:1-108:3\"><div class=\"highlight\"><pre><code>/articles?category=tech&amp;sort=popular&amp;search=Next.js\n</code></pre></div></div>\n<p data-sourcepos=\"110:1-110:99\">URLをコピーしてシェアすれば、同じフィルタ状態で一覧を表示できます。</p>\n<h2 data-sourcepos=\"112:1-112:29\">\n<span id=\"-状態管理の設計\" class=\"fragment\"></span><a href=\"#-%E7%8A%B6%E6%85%8B%E7%AE%A1%E7%90%86%E3%81%AE%E8%A8%AD%E8%A8%88\"><i class=\"fa fa-link\"></i></a>📦 状態管理の設計</h2>\n<p data-sourcepos=\"114:1-114:57\">SPA化にあたり、状態管理を整理しました。</p>\n<h3 data-sourcepos=\"116:1-116:44\">\n<span id=\"zustandでグローバル状態を管理\" class=\"fragment\"></span><a href=\"#zustand%E3%81%A7%E3%82%B0%E3%83%AD%E3%83%BC%E3%83%90%E3%83%AB%E7%8A%B6%E6%85%8B%E3%82%92%E7%AE%A1%E7%90%86\"><i class=\"fa fa-link\"></i></a>Zustandでグローバル状態を管理</h3>\n<p data-sourcepos=\"118:1-118:185\">Zustandは、シンプルで軽量な状態管理ライブラリです。Reduxより設定が少なく、Providerでラップする必要もないため、手軽に導入できます。</p>\n<p data-sourcepos=\"120:1-120:29\"><iframe id=\"qiita-embed-content__b5468774103c09b6ede4e049a9bb530e\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__b5468774103c09b6ede4e049a9bb530e\" data-content=\"https%3A%2F%2Fzustand.docs.pmnd.rs%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<p data-sourcepos=\"122:1-122:85\">一覧データやローディング状態をZustandで一元管理しています。</p>\n<div class=\"code-frame\" data-lang=\"typescript\" data-sourcepos=\"124:1-151:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">// articleStore.ts</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">create</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">zustand</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n\n<span class=\"kr\">interface</span> <span class=\"nx\">Article</span> <span class=\"p\">{</span>\n  <span class=\"nl\">id</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">;</span>\n  <span class=\"nl\">title</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">;</span>\n  <span class=\"nl\">category</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">;</span>\n  <span class=\"nl\">createdAt</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"kr\">interface</span> <span class=\"nx\">ArticleStore</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// 記事一覧</span>\n  <span class=\"nl\">articles</span><span class=\"p\">:</span> <span class=\"nx\">Article</span><span class=\"p\">[];</span>\n  <span class=\"nl\">setArticles</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"nx\">articles</span><span class=\"p\">:</span> <span class=\"nx\">Article</span><span class=\"p\">[])</span> <span class=\"o\">=&gt;</span> <span class=\"k\">void</span><span class=\"p\">;</span>\n\n  <span class=\"c1\">// ローディング状態</span>\n  <span class=\"nl\">isLoading</span><span class=\"p\">:</span> <span class=\"nx\">boolean</span><span class=\"p\">;</span>\n  <span class=\"nl\">setIsLoading</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"nx\">loading</span><span class=\"p\">:</span> <span class=\"nx\">boolean</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"k\">void</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">useArticleStore</span> <span class=\"o\">=</span> <span class=\"nx\">create</span><span class=\"o\">&lt;</span><span class=\"nx\">ArticleStore</span><span class=\"o\">&gt;</span><span class=\"p\">(</span><span class=\"kd\">set</span> <span class=\"o\">=&gt;</span> <span class=\"p\">({</span>\n  <span class=\"na\">articles</span><span class=\"p\">:</span> <span class=\"p\">[],</span>\n  <span class=\"na\">setArticles</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"nx\">articles</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">set</span><span class=\"p\">({</span> <span class=\"nx\">articles</span> <span class=\"p\">}),</span>\n  <span class=\"na\">isLoading</span><span class=\"p\">:</span> <span class=\"kc\">false</span><span class=\"p\">,</span>\n  <span class=\"na\">setIsLoading</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"nx\">isLoading</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">set</span><span class=\"p\">({</span> <span class=\"nx\">isLoading</span> <span class=\"p\">}),</span>\n<span class=\"p\">}));</span>\n</code></pre></div></div>\n<h3 data-sourcepos=\"153:1-153:40\">\n<span id=\"urlを単一情報源として活用\" class=\"fragment\"></span><a href=\"#url%E3%82%92%E5%8D%98%E4%B8%80%E6%83%85%E5%A0%B1%E6%BA%90%E3%81%A8%E3%81%97%E3%81%A6%E6%B4%BB%E7%94%A8\"><i class=\"fa fa-link\"></i></a>URLを単一情報源として活用</h3>\n<p data-sourcepos=\"155:1-155:106\">フィルタ条件はURLパラメータを単一情報源（Single Source of Truth）としています。</p>\n<div class=\"code-frame\" data-lang=\"typescript\" data-sourcepos=\"157:1-174:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">// FilterContext.tsx</span>\n<span class=\"k\">export</span> <span class=\"kd\">function</span> <span class=\"nf\">FilterProvider</span><span class=\"p\">({</span> <span class=\"nx\">children</span> <span class=\"p\">}:</span> <span class=\"p\">{</span> <span class=\"nl\">children</span><span class=\"p\">:</span> <span class=\"nx\">ReactNode</span> <span class=\"p\">})</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// URLからフィルタ状態を取得（nuqs）</span>\n  <span class=\"kd\">const</span> <span class=\"p\">[</span><span class=\"nx\">filters</span><span class=\"p\">,</span> <span class=\"nx\">setFilters</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"nf\">useListFilters</span><span class=\"p\">();</span>\n\n  <span class=\"c1\">// 派生状態はURLから計算</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">hasActiveFilters</span> <span class=\"o\">=</span> <span class=\"nf\">useMemo</span><span class=\"p\">(()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"k\">return</span> <span class=\"o\">!!</span><span class=\"p\">(</span><span class=\"nx\">filters</span><span class=\"p\">.</span><span class=\"nx\">category</span> <span class=\"o\">||</span> <span class=\"nx\">filters</span><span class=\"p\">.</span><span class=\"nx\">tag</span> <span class=\"o\">||</span> <span class=\"nx\">filters</span><span class=\"p\">.</span><span class=\"nx\">search</span><span class=\"p\">);</span>\n  <span class=\"p\">},</span> <span class=\"p\">[</span><span class=\"nx\">filters</span><span class=\"p\">]);</span>\n\n  <span class=\"k\">return </span><span class=\"p\">(</span>\n    <span class=\"o\">&lt;</span><span class=\"nx\">FilterContext</span><span class=\"p\">.</span><span class=\"nx\">Provider</span> <span class=\"nx\">value</span><span class=\"o\">=</span><span class=\"p\">{{</span> <span class=\"nx\">filters</span><span class=\"p\">,</span> <span class=\"nx\">setFilters</span><span class=\"p\">,</span> <span class=\"nx\">hasActiveFilters</span> <span class=\"p\">}}</span><span class=\"o\">&gt;</span>\n      <span class=\"p\">{</span><span class=\"nx\">children</span><span class=\"p\">}</span>\n    <span class=\"o\">&lt;</span><span class=\"sr\">/FilterContext.Provider</span><span class=\"err\">&gt;\n</span>  <span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n<h2 data-sourcepos=\"176:1-176:38\">\n<span id=\"️-レイアウト層の工夫\" class=\"fragment\"></span><a href=\"#%EF%B8%8F-%E3%83%AC%E3%82%A4%E3%82%A2%E3%82%A6%E3%83%88%E5%B1%A4%E3%81%AE%E5%B7%A5%E5%A4%AB\"><i class=\"fa fa-link\"></i></a>🖥️ レイアウト層の工夫</h2>\n<p data-sourcepos=\"178:1-178:93\">SPA化で重要なのは、レイアウト層でのデータ取得を避けることです。</p>\n<h3 data-sourcepos=\"180:1-180:45\">\n<span id=\"before-レイアウトでデータ取得\" class=\"fragment\"></span><a href=\"#before-%E3%83%AC%E3%82%A4%E3%82%A2%E3%82%A6%E3%83%88%E3%81%A7%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97\"><i class=\"fa fa-link\"></i></a>Before: レイアウトでデータ取得</h3>\n<div class=\"code-frame\" data-lang=\"tsx\" data-sourcepos=\"182:1-194:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">// ❌ ページ遷移のたびにデータを再取得してしまう</span>\n<span class=\"kd\">function</span> <span class=\"nf\">MainLayout</span><span class=\"p\">({</span> <span class=\"nx\">children</span> <span class=\"p\">}:</span> <span class=\"p\">{</span> <span class=\"nl\">children</span><span class=\"p\">:</span> <span class=\"nx\">ReactNode</span> <span class=\"p\">})</span> <span class=\"p\">{</span>\n  <span class=\"kd\">const</span> <span class=\"p\">{</span> <span class=\"nx\">data</span><span class=\"p\">,</span> <span class=\"nx\">isLoading</span> <span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"nf\">useArticles</span><span class=\"p\">();</span>  <span class=\"c1\">// ここでデータ取得</span>\n\n  <span class=\"k\">return </span><span class=\"p\">(</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">div</span> <span class=\"na\">className</span><span class=\"p\">=</span><span class=\"s\">\"flex\"</span><span class=\"p\">&gt;</span>\n      <span class=\"p\">&lt;</span><span class=\"nc\">Sidebar</span> <span class=\"na\">articles</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">data</span><span class=\"si\">}</span> <span class=\"na\">isLoading</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">isLoading</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n      <span class=\"p\">&lt;</span><span class=\"nt\">main</span><span class=\"p\">&gt;</span><span class=\"si\">{</span><span class=\"nx\">children</span><span class=\"si\">}</span><span class=\"p\">&lt;/</span><span class=\"nt\">main</span><span class=\"p\">&gt;</span>\n    <span class=\"p\">&lt;/</span><span class=\"nt\">div</span><span class=\"p\">&gt;</span>\n  <span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n<h3 data-sourcepos=\"196:1-196:59\">\n<span id=\"after-レイアウトはストアを参照するだけ\" class=\"fragment\"></span><a href=\"#after-%E3%83%AC%E3%82%A4%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AF%E3%82%B9%E3%83%88%E3%82%A2%E3%82%92%E5%8F%82%E7%85%A7%E3%81%99%E3%82%8B%E3%81%A0%E3%81%91\"><i class=\"fa fa-link\"></i></a>After: レイアウトはストアを参照するだけ</h3>\n<div class=\"code-frame\" data-lang=\"tsx\" data-sourcepos=\"198:1-212:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">// ✅ レイアウト層ではZustandの状態を参照するだけ</span>\n<span class=\"kd\">function</span> <span class=\"nf\">MainLayout</span><span class=\"p\">({</span> <span class=\"nx\">children</span> <span class=\"p\">}:</span> <span class=\"p\">{</span> <span class=\"nl\">children</span><span class=\"p\">:</span> <span class=\"nx\">ReactNode</span> <span class=\"p\">})</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// Zustandから状態を取得（データ取得はしない）</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">articles</span> <span class=\"o\">=</span> <span class=\"nf\">useArticleStore</span><span class=\"p\">(</span><span class=\"nx\">state</span> <span class=\"o\">=&gt;</span> <span class=\"nx\">state</span><span class=\"p\">.</span><span class=\"nx\">articles</span><span class=\"p\">);</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">isLoading</span> <span class=\"o\">=</span> <span class=\"nf\">useArticleStore</span><span class=\"p\">(</span><span class=\"nx\">state</span> <span class=\"o\">=&gt;</span> <span class=\"nx\">state</span><span class=\"p\">.</span><span class=\"nx\">isLoading</span><span class=\"p\">);</span>\n\n  <span class=\"k\">return </span><span class=\"p\">(</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">div</span> <span class=\"na\">className</span><span class=\"p\">=</span><span class=\"s\">\"flex\"</span><span class=\"p\">&gt;</span>\n      <span class=\"p\">&lt;</span><span class=\"nc\">Sidebar</span> <span class=\"na\">articles</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">articles</span><span class=\"si\">}</span> <span class=\"na\">isLoading</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">isLoading</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n      <span class=\"p\">&lt;</span><span class=\"nt\">main</span><span class=\"p\">&gt;</span><span class=\"si\">{</span><span class=\"nx\">children</span><span class=\"si\">}</span><span class=\"p\">&lt;/</span><span class=\"nt\">main</span><span class=\"p\">&gt;</span>\n    <span class=\"p\">&lt;/</span><span class=\"nt\">div</span><span class=\"p\">&gt;</span>\n  <span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n<p data-sourcepos=\"214:1-214:220\">データ取得は各ページコンポーネントで行い、結果をZustandに保存します。レイアウト層はその状態を参照するだけなので、ページ遷移時に再取得が発生しません。</p>\n<h2 data-sourcepos=\"216:1-216:56\">\n<span id=\"-クライアントサイドナビゲーション\" class=\"fragment\"></span><a href=\"#-%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%82%B5%E3%82%A4%E3%83%89%E3%83%8A%E3%83%93%E3%82%B2%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3\"><i class=\"fa fa-link\"></i></a>🔀 クライアントサイドナビゲーション</h2>\n<p data-sourcepos=\"218:1-218:108\">Next.jsの<code>useRouter</code>を使ってクライアントサイドナビゲーションを実装しています。</p>\n<div class=\"code-frame\" data-lang=\"typescript\" data-sourcepos=\"220:1-238:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">// useSPANavigation.ts</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">useRouter</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">next/navigation</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">useCallback</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">react</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">useSPANavigation</span> <span class=\"o\">=</span> <span class=\"p\">()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">router</span> <span class=\"o\">=</span> <span class=\"nf\">useRouter</span><span class=\"p\">();</span>\n\n  <span class=\"kd\">const</span> <span class=\"nx\">navigateTo</span> <span class=\"o\">=</span> <span class=\"nf\">useCallback</span><span class=\"p\">((</span><span class=\"na\">path</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"nx\">router</span><span class=\"p\">.</span><span class=\"nf\">push</span><span class=\"p\">(</span><span class=\"nx\">path</span><span class=\"p\">);</span>\n  <span class=\"p\">},</span> <span class=\"p\">[</span><span class=\"nx\">router</span><span class=\"p\">]);</span>\n\n  <span class=\"kd\">const</span> <span class=\"nx\">navigateBack</span> <span class=\"o\">=</span> <span class=\"nf\">useCallback</span><span class=\"p\">(()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"nx\">router</span><span class=\"p\">.</span><span class=\"nf\">back</span><span class=\"p\">();</span>\n  <span class=\"p\">},</span> <span class=\"p\">[</span><span class=\"nx\">router</span><span class=\"p\">]);</span>\n\n  <span class=\"k\">return</span> <span class=\"p\">{</span> <span class=\"nx\">navigateTo</span><span class=\"p\">,</span> <span class=\"nx\">navigateBack</span> <span class=\"p\">};</span>\n<span class=\"p\">};</span>\n</code></pre></div></div>\n<p data-sourcepos=\"240:1-240:156\"><code>router.push()</code>を使うことで、ページ全体を再読み込みせずにURLを変更し、必要なコンポーネントだけを更新できます。</p>\n<h2 data-sourcepos=\"242:1-242:29\">\n<span id=\"-移行のポイント\" class=\"fragment\"></span><a href=\"#-%E7%A7%BB%E8%A1%8C%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\"><i class=\"fa fa-link\"></i></a>🎯 移行のポイント</h2>\n<h3 data-sourcepos=\"244:1-244:31\">\n<span id=\"1-段階的に移行する\" class=\"fragment\"></span><a href=\"#1-%E6%AE%B5%E9%9A%8E%E7%9A%84%E3%81%AB%E7%A7%BB%E8%A1%8C%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>1. 段階的に移行する</h3>\n<p data-sourcepos=\"246:1-246:117\">最初から完全なSPAを目指すのではなく、課題が顕著な画面から段階的に移行しました。</p>\n<ul data-sourcepos=\"248:1-251:0\">\n<li data-sourcepos=\"248:1-248:62\">第1段階: ナビゲーションメニューの状態保持</li>\n<li data-sourcepos=\"249:1-249:53\">第2段階: 一覧↔詳細のスクロール復元</li>\n<li data-sourcepos=\"250:1-251:0\">第3段階: フィルタ条件のURL同期</li>\n</ul>\n<h3 data-sourcepos=\"252:1-252:34\">\n<span id=\"2-ssrの恩恵は維持する\" class=\"fragment\"></span><a href=\"#2-ssr%E3%81%AE%E6%81%A9%E6%81%B5%E3%81%AF%E7%B6%AD%E6%8C%81%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>2. SSRの恩恵は維持する</h3>\n<p data-sourcepos=\"254:1-254:198\">SPA化しても、初回表示はSSRで行っています。App RouterのServer Componentsを活かし、初回表示は高速に、遷移後はクライアントサイドで処理しています。</p>\n<h3 data-sourcepos=\"256:1-256:31\">\n<span id=\"3-永続化を意識する\" class=\"fragment\"></span><a href=\"#3-%E6%B0%B8%E7%B6%9A%E5%8C%96%E3%82%92%E6%84%8F%E8%AD%98%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>3. 永続化を意識する</h3>\n<p data-sourcepos=\"258:1-258:132\">スクロール位置、フィルタ条件、メニュー展開状態など、復元したい状態は適切に永続化します。</p>\n<table data-sourcepos=\"260:1-265:70\">\n<thead>\n<tr data-sourcepos=\"260:1-260:31\">\n<th data-sourcepos=\"260:2-260:9\">状態</th>\n<th data-sourcepos=\"260:11-260:21\">保存先</th>\n<th data-sourcepos=\"260:23-260:30\">理由</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"262:1-262:61\">\n<td data-sourcepos=\"262:2-262:21\">フィルタ条件</td>\n<td data-sourcepos=\"262:23-262:27\">URL</td>\n<td data-sourcepos=\"262:29-262:60\">シェア可能、履歴連携</td>\n</tr>\n<tr data-sourcepos=\"263:1-263:63\">\n<td data-sourcepos=\"263:2-263:24\">スクロール位置</td>\n<td data-sourcepos=\"263:26-263:41\">sessionStorage</td>\n<td data-sourcepos=\"263:43-263:62\">タブ内で復元</td>\n</tr>\n<tr data-sourcepos=\"264:1-264:82\">\n<td data-sourcepos=\"264:2-264:27\">メニュー展開状態</td>\n<td data-sourcepos=\"264:29-264:42\">localStorage</td>\n<td data-sourcepos=\"264:44-264:81\">ユーザー設定として永続化</td>\n</tr>\n<tr data-sourcepos=\"265:1-265:70\">\n<td data-sourcepos=\"265:2-265:15\">表示形式</td>\n<td data-sourcepos=\"265:17-265:30\">localStorage</td>\n<td data-sourcepos=\"265:32-265:69\">ユーザー設定として永続化</td>\n</tr>\n</tbody>\n</table>\n<h2 data-sourcepos=\"267:1-267:16\">\n<span id=\"-まとめ\" class=\"fragment\"></span><a href=\"#-%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>✅ まとめ</h2>\n<p data-sourcepos=\"269:1-269:66\">MPAからSPAへの移行で実現したことをまとめます。</p>\n<p data-sourcepos=\"271:1-271:23\"><strong>解決した課題:</strong></p>\n<ul data-sourcepos=\"272:1-276:0\">\n<li data-sourcepos=\"272:1-272:83\">ナビゲーションメニューの再読み込み → Zustandで状態を保持</li>\n<li data-sourcepos=\"273:1-273:66\">スクロール位置のリセット → sessionStorageで復元</li>\n<li data-sourcepos=\"274:1-274:70\">フィルタ条件のリセット → URLパラメータで永続化</li>\n<li data-sourcepos=\"275:1-276:0\">画面遷移時のちらつき → クライアントサイドナビゲーション</li>\n</ul>\n<p data-sourcepos=\"277:1-277:26\"><strong>設計のポイント:</strong></p>\n<ul data-sourcepos=\"278:1-282:0\">\n<li data-sourcepos=\"278:1-278:42\">Zustandでグローバル状態を管理</li>\n<li data-sourcepos=\"279:1-279:38\">URLを単一情報源として活用</li>\n<li data-sourcepos=\"280:1-280:53\">レイアウト層でのデータ取得を避ける</li>\n<li data-sourcepos=\"281:1-282:0\">SSRの恩恵は維持する</li>\n</ul>\n<p data-sourcepos=\"283:1-283:165\">App Routerを使いながらSPA的な体験を実現することで、Server Componentsの恩恵とクライアントサイドの快適さを両立できました。</p>\n<p data-sourcepos=\"285:1-285:79\">明日は「Next.js Route HandlerからHonoへ」について解説します。</p>\n<hr data-sourcepos=\"287:1-288:0\">\n<p data-sourcepos=\"289:1-289:31\"><strong>シリーズの他の記事</strong></p>\n<ul data-sourcepos=\"291:1-292:79\">\n<li data-sourcepos=\"291:1-291:86\">12/10: App Routerのディレクトリ設計：Next.jsプロジェクトの構成術</li>\n<li data-sourcepos=\"292:1-292:79\">12/12: Next.js Route HandlerからHonoへ：API設計が楽になった理由</li>\n</ul>\n",
      "body": "\n\nこの記事は、**[ひとりでつくるSaaS - 設計・実装・運用の記録 Advent Calendar 2025](https://adventar.org/calendars/12615)** の11日目の記事です。\n\n昨日の記事では「App Routerのディレクトリ設計」について書きました。この記事では、MPAからSPAへの移行を実践した理由と具体的な実装について解説します。\n\n## 📝 この記事で使う用語\n\n- **MPA（Multi Page Application）**: ページ遷移のたびにサーバーからHTMLを取得し、画面全体を再読み込みする方式\n- **SPA（Single Page Application）**: 初回読み込み後はJavaScriptでページを切り替え、画面全体を再読み込みしない方式\n- **クライアントサイドナビゲーション**: ブラウザ側でURLを変更し、必要なデータだけを取得してページを更新する方式\n\n## 🎯 なぜSPAに移行したのか\n\nApp Routerを採用した当初は、Server Componentsの恩恵を最大化するため、MPA的な構成にしていました。ページ遷移のたびにサーバーでHTMLを生成し、新しいページを表示する方式です。\n\nしかし、開発を進めるうちに以下の課題が見えてきました。\n\n### MPA的な構成の課題\n\n**1. ナビゲーションメニューの再読み込み**\n\nサイドバーにナビゲーションメニューを配置していますが、ページ遷移のたびに再読み込みされていました。展開状態がリセットされたり、一瞬ちらついたりして、体験が損なわれていました。\n\n**2. スクロール位置のリセット**\n\n一覧画面でスクロールして詳細画面に遷移し、戻ると最初の位置に戻ってしまう。フィルタ条件もリセットされ、再度設定し直す必要がありました。\n\n**3. 遷移時のちらつき**\n\nページ遷移のたびに画面全体が再描画されるため、レイアウトが一瞬崩れたり、ローディング状態が目立ったりしていました。\n\n## 🔧 SPA移行で実現したこと\n\n### 1. スクロール位置の復元\n\n詳細画面から一覧に戻ったとき、元のスクロール位置を復元します。\n\n```typescript\n// useScrollRestoration.ts\nconst SCROLL_CACHE_KEY = 'app_scroll_cache';\nconst CACHE_EXPIRY = 5 * 60 * 1000; // 5分\n\nexport function useScrollRestoration() {\n  // スクロール位置を保存\n  const saveScroll = useCallback(() => {\n    const cache = {\n      scrollY: window.scrollY,\n      pathname: window.location.pathname,\n      timestamp: Date.now(),\n    };\n    sessionStorage.setItem(SCROLL_CACHE_KEY, JSON.stringify(cache));\n  }, []);\n\n  // スクロール位置を復元\n  const restoreScroll = useCallback(() => {\n    const stored = sessionStorage.getItem(SCROLL_CACHE_KEY);\n    if (!stored) return;\n\n    const cache = JSON.parse(stored);\n\n    // 有効期限チェック\n    if (Date.now() - cache.timestamp > CACHE_EXPIRY) {\n      sessionStorage.removeItem(SCROLL_CACHE_KEY);\n      return;\n    }\n\n    // 同じパスなら復元\n    if (cache.pathname === window.location.pathname) {\n      window.scrollTo(0, cache.scrollY);\n    }\n  }, []);\n\n  return { saveScroll, restoreScroll };\n}\n```\n\n### 2. フィルタ状態のURL同期\n\nフィルタやソート条件をURLパラメータに保存し、ブラウザの履歴と連携させています。ここではnuqsというライブラリを使っています。nuqsは、URLパラメータをReactの状態として扱えるライブラリです。\n\nhttps://nuqs.dev/\n\n```typescript\n// useListFilters.ts\nimport { parseAsString, parseAsStringEnum, useQueryStates } from 'nuqs';\n\nexport const listFilterParsers = {\n  category: parseAsString,\n  tag: parseAsString,\n  sort: parseAsStringEnum(['newest', 'oldest', 'popular'] as const)\n    .withDefault('newest'),\n  search: parseAsString,\n};\n\nexport function useListFilters() {\n  return useQueryStates(listFilterParsers, {\n    history: 'push',   // ブラウザ履歴に追加\n    shallow: true,     // サーバー再取得なし\n  });\n}\n```\n\nこれにより、以下のようなURLが生成されます。\n\n```\n/articles?category=tech&sort=popular&search=Next.js\n```\n\nURLをコピーしてシェアすれば、同じフィルタ状態で一覧を表示できます。\n\n## 📦 状態管理の設計\n\nSPA化にあたり、状態管理を整理しました。\n\n### Zustandでグローバル状態を管理\n\nZustandは、シンプルで軽量な状態管理ライブラリです。Reduxより設定が少なく、Providerでラップする必要もないため、手軽に導入できます。\n\nhttps://zustand.docs.pmnd.rs/\n\n一覧データやローディング状態をZustandで一元管理しています。\n\n```typescript\n// articleStore.ts\nimport { create } from 'zustand';\n\ninterface Article {\n  id: string;\n  title: string;\n  category: string;\n  createdAt: string;\n}\n\ninterface ArticleStore {\n  // 記事一覧\n  articles: Article[];\n  setArticles: (articles: Article[]) => void;\n\n  // ローディング状態\n  isLoading: boolean;\n  setIsLoading: (loading: boolean) => void;\n}\n\nexport const useArticleStore = create<ArticleStore>(set => ({\n  articles: [],\n  setArticles: (articles) => set({ articles }),\n  isLoading: false,\n  setIsLoading: (isLoading) => set({ isLoading }),\n}));\n```\n\n### URLを単一情報源として活用\n\nフィルタ条件はURLパラメータを単一情報源（Single Source of Truth）としています。\n\n```typescript\n// FilterContext.tsx\nexport function FilterProvider({ children }: { children: ReactNode }) {\n  // URLからフィルタ状態を取得（nuqs）\n  const [filters, setFilters] = useListFilters();\n\n  // 派生状態はURLから計算\n  const hasActiveFilters = useMemo(() => {\n    return !!(filters.category || filters.tag || filters.search);\n  }, [filters]);\n\n  return (\n    <FilterContext.Provider value={{ filters, setFilters, hasActiveFilters }}>\n      {children}\n    </FilterContext.Provider>\n  );\n}\n```\n\n## 🖥️ レイアウト層の工夫\n\nSPA化で重要なのは、レイアウト層でのデータ取得を避けることです。\n\n### Before: レイアウトでデータ取得\n\n```tsx\n// ❌ ページ遷移のたびにデータを再取得してしまう\nfunction MainLayout({ children }: { children: ReactNode }) {\n  const { data, isLoading } = useArticles();  // ここでデータ取得\n\n  return (\n    <div className=\"flex\">\n      <Sidebar articles={data} isLoading={isLoading} />\n      <main>{children}</main>\n    </div>\n  );\n}\n```\n\n### After: レイアウトはストアを参照するだけ\n\n```tsx\n// ✅ レイアウト層ではZustandの状態を参照するだけ\nfunction MainLayout({ children }: { children: ReactNode }) {\n  // Zustandから状態を取得（データ取得はしない）\n  const articles = useArticleStore(state => state.articles);\n  const isLoading = useArticleStore(state => state.isLoading);\n\n  return (\n    <div className=\"flex\">\n      <Sidebar articles={articles} isLoading={isLoading} />\n      <main>{children}</main>\n    </div>\n  );\n}\n```\n\nデータ取得は各ページコンポーネントで行い、結果をZustandに保存します。レイアウト層はその状態を参照するだけなので、ページ遷移時に再取得が発生しません。\n\n## 🔀 クライアントサイドナビゲーション\n\nNext.jsの`useRouter`を使ってクライアントサイドナビゲーションを実装しています。\n\n```typescript\n// useSPANavigation.ts\nimport { useRouter } from 'next/navigation';\nimport { useCallback } from 'react';\n\nexport const useSPANavigation = () => {\n  const router = useRouter();\n\n  const navigateTo = useCallback((path: string) => {\n    router.push(path);\n  }, [router]);\n\n  const navigateBack = useCallback(() => {\n    router.back();\n  }, [router]);\n\n  return { navigateTo, navigateBack };\n};\n```\n\n`router.push()`を使うことで、ページ全体を再読み込みせずにURLを変更し、必要なコンポーネントだけを更新できます。\n\n## 🎯 移行のポイント\n\n### 1. 段階的に移行する\n\n最初から完全なSPAを目指すのではなく、課題が顕著な画面から段階的に移行しました。\n\n- 第1段階: ナビゲーションメニューの状態保持\n- 第2段階: 一覧↔詳細のスクロール復元\n- 第3段階: フィルタ条件のURL同期\n\n### 2. SSRの恩恵は維持する\n\nSPA化しても、初回表示はSSRで行っています。App RouterのServer Componentsを活かし、初回表示は高速に、遷移後はクライアントサイドで処理しています。\n\n### 3. 永続化を意識する\n\nスクロール位置、フィルタ条件、メニュー展開状態など、復元したい状態は適切に永続化します。\n\n| 状態 | 保存先 | 理由 |\n|------|--------|------|\n| フィルタ条件 | URL | シェア可能、履歴連携 |\n| スクロール位置 | sessionStorage | タブ内で復元 |\n| メニュー展開状態 | localStorage | ユーザー設定として永続化 |\n| 表示形式 | localStorage | ユーザー設定として永続化 |\n\n## ✅ まとめ\n\nMPAからSPAへの移行で実現したことをまとめます。\n\n**解決した課題:**\n- ナビゲーションメニューの再読み込み → Zustandで状態を保持\n- スクロール位置のリセット → sessionStorageで復元\n- フィルタ条件のリセット → URLパラメータで永続化\n- 画面遷移時のちらつき → クライアントサイドナビゲーション\n\n**設計のポイント:**\n- Zustandでグローバル状態を管理\n- URLを単一情報源として活用\n- レイアウト層でのデータ取得を避ける\n- SSRの恩恵は維持する\n\nApp Routerを使いながらSPA的な体験を実現することで、Server Componentsの恩恵とクライアントサイドの快適さを両立できました。\n\n明日は「Next.js Route HandlerからHonoへ」について解説します。\n\n---\n\n**シリーズの他の記事**\n\n- 12/10: App Routerのディレクトリ設計：Next.jsプロジェクトの構成術\n- 12/12: Next.js Route HandlerからHonoへ：API設計が楽になった理由\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:19:33+09:00",
      "group": null,
      "id": "480b9656ba817dce49b0",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "SPA",
          "versions": []
        },
        {
          "name": "Next.js",
          "versions": []
        },
        {
          "name": "zustand",
          "versions": []
        },
        {
          "name": "AppRouter",
          "versions": []
        }
      ],
      "title": "なぜMPAからSPAに移行したのか：App Routerリファクタリング実践",
      "updated_at": "2025-12-11T13:19:33+09:00",
      "url": "https://qiita.com/pipipi-dev/items/480b9656ba817dce49b0",
      "user": {
        "description": "くまさんがAIを使った開発にチャレンジする様子をゆるく記録していきます。",
        "facebook_id": "",
        "followees_count": 1,
        "followers_count": 1,
        "github_login_name": "pipipi-dev",
        "id": "pipipi-dev",
        "items_count": 13,
        "linkedin_id": "",
        "location": "森",
        "name": "くまさんのAI開発日記",
        "organization": "こぐまグループ",
        "permanent_id": 4180218,
        "profile_image_url": "https://avatars.githubusercontent.com/u/217142528?v=4",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": "https://bento.me/pipipi-dev"
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<h1 data-sourcepos=\"1:1-1:14\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n<p data-sourcepos=\"2:1-2:175\">以前に使用していたTwitterアカウントにログインできなくなったため、下記のアカウントに移行しました。フォローお願いします。</p>\n<p data-sourcepos=\"4:1-4:26\"><iframe id=\"qiita-embed-content__c7e146532d59e19866ffb7ca328bc484\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__c7e146532d59e19866ffb7ca328bc484\" data-content=\"https%3A%2F%2Fx.com%2Fshisha_panda\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<h1 data-sourcepos=\"6:1-6:14\">\n<span id=\"自己紹介\" class=\"fragment\"></span><a href=\"#%E8%87%AA%E5%B7%B1%E7%B4%B9%E4%BB%8B\"><i class=\"fa fa-link\"></i></a>自己紹介</h1>\n<p data-sourcepos=\"7:1-7:108\">横浜駅徒歩圏内でシーシャバーを経営しているエンジニア出身のオーナーです。</p>\n<h2 data-sourcepos=\"9:1-9:9\">\n<span id=\"略歴\" class=\"fragment\"></span><a href=\"#%E7%95%A5%E6%AD%B4\"><i class=\"fa fa-link\"></i></a>略歴</h2>\n<ul data-sourcepos=\"10:1-14:0\">\n<li data-sourcepos=\"10:1-10:131\">渋谷のメガベンチャーでライブ配信アプリケーションのインフラ・サーバー・Webフロントを担当</li>\n<li data-sourcepos=\"11:1-11:50\">ベンチャー企業を何社か起業→退職</li>\n<li data-sourcepos=\"12:1-12:133\">フリーランスとして活動(BtoB SaaSのマーケティング周りなど、多くの経験をさせていただきました)</li>\n<li data-sourcepos=\"13:1-14:0\">月のシーシャ代とダーツ代が高すぎたことをきっかけに、自分でダーツとシーシャができるバーをオープン</li>\n</ul>\n<h2 data-sourcepos=\"15:1-15:18\">\n<span id=\"現在の事業\" class=\"fragment\"></span><a href=\"#%E7%8F%BE%E5%9C%A8%E3%81%AE%E4%BA%8B%E6%A5%AD\"><i class=\"fa fa-link\"></i></a>現在の事業</h2>\n<p data-sourcepos=\"16:1-16:84\"><strong>シーシャ&amp;ダーツ&amp;カラオケ&amp;ボードゲームバー 黒猫 横浜本店</strong></p>\n<p data-sourcepos=\"18:1-18:21\"><iframe id=\"qiita-embed-content__21c98a571b18fbc53d8f2255220d5c94\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__21c98a571b18fbc53d8f2255220d5c94\" data-content=\"https%3A%2F%2Fkuroneko.bar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<p data-sourcepos=\"20:1-20:63\"><strong>シーシャ カフェ &amp; バー 黒猫 横浜駅前店(仮)</strong></p>\n<p data-sourcepos=\"22:1-24:77\">リモートワークもできるように<br>\nNuro ビジネスの高速ネットをゲストWi-Fiで提供<br>\n(自分がシーシャ吸いながら使えるように整備しました。)</p>\n<p data-sourcepos=\"26:1-26:29\">2026年2月オープン予定</p>\n<h1 data-sourcepos=\"28:1-28:38\">\n<span id=\"これから書く記事について\" class=\"fragment\"></span><a href=\"#%E3%81%93%E3%82%8C%E3%81%8B%E3%82%89%E6%9B%B8%E3%81%8F%E8%A8%98%E4%BA%8B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"><i class=\"fa fa-link\"></i></a>これから書く記事について</h1>\n<p data-sourcepos=\"29:1-29:162\">エンジニアとして培った知識とツールを活用しながら飲食店を経営してきた経験を、以下の記事でシェアしていきます。</p>\n<p data-sourcepos=\"31:1-31:114\"><strong>元BtoB SaaSのマーケティング系エンジニアがシーシャバーをオープンして話</strong>(執筆中)</p>\n<p data-sourcepos=\"33:1-33:103\"><strong>Notion + Nuxt.jsで経営している飲食店のオーダーシステムを作った話</strong>(執筆中)</p>\n<p data-sourcepos=\"35:1-35:137\"><strong>Notion + Nuxt.js + LINE(Liff + Bot)で経営している飲食店のマニュアル &amp; チェック表を電子化した話</strong>(執筆中)</p>\n",
      "body": "# はじめに\n以前に使用していたTwitterアカウントにログインできなくなったため、下記のアカウントに移行しました。フォローお願いします。\n\nhttps://x.com/shisha_panda\n\n# 自己紹介\n横浜駅徒歩圏内でシーシャバーを経営しているエンジニア出身のオーナーです。\n\n## 略歴\n- 渋谷のメガベンチャーでライブ配信アプリケーションのインフラ・サーバー・Webフロントを担当\n- ベンチャー企業を何社か起業→退職\n- フリーランスとして活動(BtoB SaaSのマーケティング周りなど、多くの経験をさせていただきました)\n- 月のシーシャ代とダーツ代が高すぎたことをきっかけに、自分でダーツとシーシャができるバーをオープン\n\n## 現在の事業\n**シーシャ&ダーツ&カラオケ&ボードゲームバー 黒猫 横浜本店**\n\nhttps://kuroneko.bar/\n\n**シーシャ カフェ & バー 黒猫 横浜駅前店(仮)**\n\nリモートワークもできるように\nNuro ビジネスの高速ネットをゲストWi-Fiで提供\n(自分がシーシャ吸いながら使えるように整備しました。)\n\n2026年2月オープン予定\n\n# これから書く記事について\nエンジニアとして培った知識とツールを活用しながら飲食店を経営してきた経験を、以下の記事でシェアしていきます。\n\n**元BtoB SaaSのマーケティング系エンジニアがシーシャバーをオープンして話**(執筆中)\n\n**Notion + Nuxt.jsで経営している飲食店のオーダーシステムを作った話**(執筆中)\n\n**Notion + Nuxt.js + LINE(Liff + Bot)で経営している飲食店のマニュアル & チェック表を電子化した話**(執筆中)\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:17:01+09:00",
      "group": null,
      "id": "b931a287aca8694dc491",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "AI",
          "versions": []
        },
        {
          "name": "Nuxt",
          "versions": []
        },
        {
          "name": "Notion",
          "versions": []
        },
        {
          "name": "NotionAPI",
          "versions": []
        },
        {
          "name": "AI活用",
          "versions": []
        }
      ],
      "title": "元エンジニアがシーシャバーをオープンした話",
      "updated_at": "2025-12-11T13:17:01+09:00",
      "url": "https://qiita.com/sk_hiropanda/items/b931a287aca8694dc491",
      "user": {
        "description": null,
        "facebook_id": null,
        "followees_count": 1,
        "followers_count": 0,
        "github_login_name": null,
        "id": "sk_hiropanda",
        "items_count": 1,
        "linkedin_id": null,
        "location": null,
        "name": "",
        "organization": null,
        "permanent_id": 4295462,
        "profile_image_url": "https://abs.twimg.com/sticky/default_profile_images/default_profile_bigger.png",
        "team_only": false,
        "twitter_screen_name": "sk_hiropanda",
        "website_url": null
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<h2 data-sourcepos=\"1:1-1:18\">\n<span id=\"0-はじめに\" class=\"fragment\"></span><a href=\"#0-%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>0. はじめに</h2>\n<p data-sourcepos=\"3:1-3:160\">この記事は、<strong>JTCのIT部門で働きながら、漠然とした不安を抱えているあなた</strong> や <strong>転職後の自分</strong> に向けて書きます。</p>\n<p data-sourcepos=\"5:1-5:251\">私は201X年にプライム上場の大手メーカー系列会社(以下、A社)に入社。全社横断のデータ分析組織にて、データ基盤構築やBI開発、AIモデル構築など複数のプロジェクトをリードしました。</p>\n<p data-sourcepos=\"7:1-7:212\">基幹システムの刷新や全社データ基盤構築プロジェクトに参画し、順調なキャリアに見えましたが、<strong>JTCを離れ、SaaS企業(以下、B社)へ転職を決意しました。</strong></p>\n<p data-sourcepos=\"9:1-9:144\">理由は多くありますが、例えば以下の理由からでした。このような事業会社は多いのではないでしょうか。</p>\n<ul data-sourcepos=\"11:1-21:0\">\n<li data-sourcepos=\"11:1-14:60\">\n<strong>「SIベンダー任せで、決して自分で触らない(作る技術がない)」IT部門</strong>\n<ul data-sourcepos=\"12:5-14:60\">\n<li data-sourcepos=\"12:5-12:62\">ベンダへ投資した金額 ≠ システムの価値</li>\n<li data-sourcepos=\"13:5-13:102\">営業が汗水流して上げた売上を、湯水のようにコンサル,SIベンダに流す</li>\n<li data-sourcepos=\"14:5-14:60\">自分で触って自社内製するつもりはない</li>\n</ul>\n</li>\n<li data-sourcepos=\"15:1-17:151\">\n<strong>SaaS製品の利用にウォーターフォールを適用し、利用開始に2年以上を要するスピード感</strong>\n<ul data-sourcepos=\"16:5-17:151\">\n<li data-sourcepos=\"16:5-16:93\">そのサービスで何ができるか誰もわからずに進む要件定義、設計</li>\n<li data-sourcepos=\"17:5-17:151\">従量課金の予算取りに5年後の見積もりを求め、予算確保後のモニタリングは行わないレガシーなコスト管理</li>\n</ul>\n</li>\n<li data-sourcepos=\"18:1-21:0\">\n<strong>「事業の最前線から遠い」という距離感</strong>\n<ul data-sourcepos=\"19:5-21:0\">\n<li data-sourcepos=\"19:5-19:66\">数十年前のスクラッチ開発のシステムの模倣</li>\n<li data-sourcepos=\"20:5-21:0\">事業が欲しいシステムとの要件定義の乖離</li>\n</ul>\n</li>\n</ul>\n<p data-sourcepos=\"22:1-22:180\">この記事では、転職活動の全記録を書いています。同じ悩みを抱える人が、自分のキャリアを見つめ直すきっかけになれば幸いです。</p>\n<hr data-sourcepos=\"24:1-25:0\">\n<h2 data-sourcepos=\"26:1-26:74\">\n<span id=\"1-転職を決意するまでjtcのit部門で見た限界\" class=\"fragment\"></span><a href=\"#1-%E8%BB%A2%E8%81%B7%E3%82%92%E6%B1%BA%E6%84%8F%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7jtc%E3%81%AEit%E9%83%A8%E9%96%80%E3%81%A7%E8%A6%8B%E3%81%9F%E9%99%90%E7%95%8C\"><i class=\"fa fa-link\"></i></a>1. 転職を決意するまで──JTCのIT部門で見た「限界」</h2>\n<h3 data-sourcepos=\"28:1-28:51\">\n<span id=\"1-1-社内転職からデータ分析の道へ\" class=\"fragment\"></span><a href=\"#1-1-%E7%A4%BE%E5%86%85%E8%BB%A2%E8%81%B7%E3%81%8B%E3%82%89%E3%83%87%E3%83%BC%E3%82%BF%E5%88%86%E6%9E%90%E3%81%AE%E9%81%93%E3%81%B8\"><i class=\"fa fa-link\"></i></a>1-1. 社内転職からデータ分析の道へ</h3>\n<p data-sourcepos=\"30:1-30:118\">入社後3年間、別部門で業務を経験した後、社内公募でデータ分析組織に異動しました。</p>\n<p data-sourcepos=\"32:1-32:49\">異動後は複数のプロジェクトを経験:</p>\n<ul data-sourcepos=\"33:1-36:0\">\n<li data-sourcepos=\"33:1-33:59\">部門横断のデータ統合による分析基盤構築</li>\n<li data-sourcepos=\"34:1-34:50\">機械学習を用いた予測モデルの構築</li>\n<li data-sourcepos=\"35:1-36:0\">大規模な全社データ基盤構築PJの推進</li>\n</ul>\n<h3 data-sourcepos=\"37:1-37:67\">\n<span id=\"1-2-このままではマズイと感じた3つの瞬間\" class=\"fragment\"></span><a href=\"#1-2-%E3%81%93%E3%81%AE%E3%81%BE%E3%81%BE%E3%81%A7%E3%81%AF%E3%83%9E%E3%82%BA%E3%82%A4%E3%81%A8%E6%84%9F%E3%81%98%E3%81%9F3%E3%81%A4%E3%81%AE%E7%9E%AC%E9%96%93\"><i class=\"fa fa-link\"></i></a>1-2. 「このままではマズイ」と感じた3つの瞬間</h3>\n<h4 data-sourcepos=\"39:1-39:78\">\n<span id=\"-ベンダー依存が当たり前の組織で感じた危機感\" class=\"fragment\"></span><a href=\"#-%E3%83%99%E3%83%B3%E3%83%80%E3%83%BC%E4%BE%9D%E5%AD%98%E3%81%8C%E5%BD%93%E3%81%9F%E3%82%8A%E5%89%8D%E3%81%AE%E7%B5%84%E7%B9%94%E3%81%A7%E6%84%9F%E3%81%98%E3%81%9F%E5%8D%B1%E6%A9%9F%E6%84%9F\"><i class=\"fa fa-link\"></i></a>① ベンダー依存が「当たり前」の組織で感じた危機感</h4>\n<p data-sourcepos=\"41:1-42:103\">大規模プロジェクトで製品選定からフィジビリティ検証を実施する際、<strong>自社の環境では何も行いません</strong>でした。<br>\nクラウド基盤の実装はSIベンダー頼み、本番環境での検証もSIベンダー経由。</p>\n<p data-sourcepos=\"44:1-44:133\">そして、さらに衝撃的だったのは──<strong>周囲の誰も、それを問題だと思っていなかったこと</strong>です。</p>\n<p data-sourcepos=\"46:1-46:230\">「要件を整理してベンダーに渡す」が当たり前。自分で作ろうとする人もいないし、作れる人もいない。上司に相談したところ、<strong>「それはベンダーの仕事だから」</strong> と。</p>\n<p data-sourcepos=\"48:1-48:167\"><strong>「このままでは、自分は『要件を日本語で書き、各所と調整するだけの人』になってしまう」</strong> という恐怖を感じました。</p>\n<h4 data-sourcepos=\"50:1-50:70\">\n<span id=\"-ステークホルダー調整に6ヶ月かかる意思決定\" class=\"fragment\"></span><a href=\"#-%E3%82%B9%E3%83%86%E3%83%BC%E3%82%AF%E3%83%9B%E3%83%AB%E3%83%80%E3%83%BC%E8%AA%BF%E6%95%B4%E3%81%AB6%E3%83%B6%E6%9C%88%E3%81%8B%E3%81%8B%E3%82%8B%E6%84%8F%E6%80%9D%E6%B1%BA%E5%AE%9A\"><i class=\"fa fa-link\"></i></a>② ステークホルダー調整に6ヶ月かかる意思決定</h4>\n<p data-sourcepos=\"52:1-52:214\">あるダッシュボード機能の追加は技術的には1,2週間で実装できる内容でしたが、関係部署への説明会、根回し、役員報告で意思決定まで約6ヶ月かかりました。</p>\n<p data-sourcepos=\"54:1-54:89\"><strong>「このスピード感で、本当に事業成長に貢献できているのか?」</strong></p>\n<h4 data-sourcepos=\"56:1-56:48\">\n<span id=\"-キャリアの天井が見えた瞬間\" class=\"fragment\"></span><a href=\"#-%E3%82%AD%E3%83%A3%E3%83%AA%E3%82%A2%E3%81%AE%E5%A4%A9%E4%BA%95%E3%81%8C%E8%A6%8B%E3%81%88%E3%81%9F%E7%9E%AC%E9%96%93\"><i class=\"fa fa-link\"></i></a>③ キャリアの天井が見えた瞬間</h4>\n<p data-sourcepos=\"58:1-58:181\">プロジェクトの設計フェーズが完了し、今後2年間はベンダーの進捗管理と運用設計が主な業務。技術的な挑戦はほとんどありません。</p>\n<p data-sourcepos=\"60:1-60:272\"><strong>社内のロールモデルを見渡しても、「自分で手を動かして価値を生み出し続けている人」がいませんでした。</strong>「技術 × ビジネス」の両方に関わり続けるキャリアパスが、この組織には存在しません。</p>\n<p data-sourcepos=\"62:1-62:65\"><strong>「動くなら、今しかない」</strong> と確信しました。</p>\n<h3 data-sourcepos=\"64:1-64:54\">\n<span id=\"1-3-それでも迷った安定との天秤\" class=\"fragment\"></span><a href=\"#1-3-%E3%81%9D%E3%82%8C%E3%81%A7%E3%82%82%E8%BF%B7%E3%81%A3%E3%81%9F%E5%AE%89%E5%AE%9A%E3%81%A8%E3%81%AE%E5%A4%A9%E7%A7%A4\"><i class=\"fa fa-link\"></i></a>1-3. それでも迷った「安定」との天秤</h3>\n<p data-sourcepos=\"66:1-66:196\">最も躊躇したのは、<strong>安定した給与を手放すこと</strong>でした。年功序列の昇給、手厚い福利厚生、ライフイベントを考えると不安は大きかったです。</p>\n<p data-sourcepos=\"68:1-68:83\"><strong>それでも決断できた理由──技術的挑戦の「2年間の空白」</strong></p>\n<p data-sourcepos=\"70:1-70:65\"><strong>「2年後の32歳、自分は何ができる人なのか?」</strong></p>\n<p data-sourcepos=\"72:1-72:210\">モダンなツールは触れない、実装経験は積めない、事業貢献の実感も得られない──市場で求められているスキルとのギャップは、どんどん広がっていく。</p>\n<p data-sourcepos=\"74:1-74:121\">天秤にかけた結果、<strong>「30歳を前に動かなければ、後悔する」</strong> という結論に至りました。</p>\n<p data-sourcepos=\"76:1-77:290\">また、データ分析組織にいながら、気づけば大規模システム刷新プロジェクトに専従していました。<br>\n本来やりたかったのは、データから事業課題を発見し、アクションに繋げる仕事。でも実際は要件定義、ベンダー管理、報告── <strong>「プロジェクトを進めること」「ベンダーを動かすこと」が目的化</strong>していました。</p>\n<hr data-sourcepos=\"79:1-80:0\">\n<h2 data-sourcepos=\"81:1-81:60\">\n<span id=\"2-転職活動の全記録準備から内定まで\" class=\"fragment\"></span><a href=\"#2-%E8%BB%A2%E8%81%B7%E6%B4%BB%E5%8B%95%E3%81%AE%E5%85%A8%E8%A8%98%E9%8C%B2%E6%BA%96%E5%82%99%E3%81%8B%E3%82%89%E5%86%85%E5%AE%9A%E3%81%BE%E3%81%A7\"><i class=\"fa fa-link\"></i></a>2. 転職活動の全記録──準備から内定まで</h2>\n<h3 data-sourcepos=\"83:1-83:54\">\n<span id=\"2-1-準備フェーズ活動開始の1ヶ月前\" class=\"fragment\"></span><a href=\"#2-1-%E6%BA%96%E5%82%99%E3%83%95%E3%82%A7%E3%83%BC%E3%82%BA%E6%B4%BB%E5%8B%95%E9%96%8B%E5%A7%8B%E3%81%AE1%E3%83%B6%E6%9C%88%E5%89%8D\"><i class=\"fa fa-link\"></i></a>2-1. 準備フェーズ(活動開始の1ヶ月前)</h3>\n<h4 data-sourcepos=\"85:1-85:41\">\n<span id=\"職務経歴書の翻訳作業\" class=\"fragment\"></span><a href=\"#%E8%81%B7%E5%8B%99%E7%B5%8C%E6%AD%B4%E6%9B%B8%E3%81%AE%E7%BF%BB%E8%A8%B3%E4%BD%9C%E6%A5%AD\"><i class=\"fa fa-link\"></i></a>職務経歴書の「翻訳」作業</h4>\n<p data-sourcepos=\"87:1-87:82\">週末を使って約3週間、職務経歴書を何度も書き直しました。</p>\n<p data-sourcepos=\"89:1-89:32\">意識したのは以下の3点:</p>\n<ol data-sourcepos=\"90:1-93:0\">\n<li data-sourcepos=\"90:1-90:73\">技術スタックを明記(クラウドサービス、BIツール等)</li>\n<li data-sourcepos=\"91:1-91:83\">規模感を数字で示す(数十名規模のステークホルダー調整等)</li>\n<li data-sourcepos=\"92:1-93:0\">ビジネスインパクトを定量化(業務時間削減率等)</li>\n</ol>\n<p data-sourcepos=\"94:1-94:263\">特に「調整業務」は、そのまま書くと「ベンダーコントロールだけ」と思われるリスクがあるため、裏にある本質的なスキル(技術検証、優先度設計、段階的合意形成)を具体的に言語化しました。</p>\n<p data-sourcepos=\"96:1-97:169\"><strong>年収レンジ:</strong><br>\n提示されたレンジは700〜900万円。「データ分析者で、PL経験がある20代後半なら、このレンジは十分狙える」とのことでした。</p>\n<h3 data-sourcepos=\"99:1-99:53\">\n<span id=\"2-2-活動フェーズ15ヶ月の集中活動\" class=\"fragment\"></span><a href=\"#2-2-%E6%B4%BB%E5%8B%95%E3%83%95%E3%82%A7%E3%83%BC%E3%82%BA15%E3%83%B6%E6%9C%88%E3%81%AE%E9%9B%86%E4%B8%AD%E6%B4%BB%E5%8B%95\"><i class=\"fa fa-link\"></i></a>2-2. 活動フェーズ(1.5ヶ月の集中活動)</h3>\n<h4 data-sourcepos=\"101:1-101:26\">\n<span id=\"リアルな活動量\" class=\"fragment\"></span><a href=\"#%E3%83%AA%E3%82%A2%E3%83%AB%E3%81%AA%E6%B4%BB%E5%8B%95%E9%87%8F\"><i class=\"fa fa-link\"></i></a>リアルな活動量</h4>\n<ul data-sourcepos=\"103:1-109:0\">\n<li data-sourcepos=\"103:1-103:24\"><strong>応募社数:23社</strong></li>\n<li data-sourcepos=\"104:1-104:41\"><strong>書類通過率:50%程度(約11社)</strong></li>\n<li data-sourcepos=\"105:1-105:58\">\n<strong>面接実施:6社程度</strong>(途中で辞退したため)</li>\n<li data-sourcepos=\"106:1-106:23\"><strong>最終面接:4社</strong></li>\n<li data-sourcepos=\"107:1-107:40\"><strong>内定:2社(途中で活動終了)</strong></li>\n<li data-sourcepos=\"108:1-109:0\"><strong>活動期間:1.5ヶ月</strong></li>\n</ul>\n<p data-sourcepos=\"110:1-110:23\"><strong>在職中の工夫:</strong></p>\n<ul data-sourcepos=\"111:1-113:0\">\n<li data-sourcepos=\"111:1-111:38\">平日夜:18時以降で面接設定</li>\n<li data-sourcepos=\"112:1-113:0\">有給休暇:半休を大いに活用（時には業務時間中に調整したものも...)</li>\n</ul>\n<p data-sourcepos=\"114:1-114:166\">正直、1.5ヶ月は体力的にも精神的にもきつかったですが、<strong>短期集中だったからこそ、モチベーションを維持できました。</strong></p>\n<h4 data-sourcepos=\"116:1-116:29\">\n<span id=\"応募企業の選定軸\" class=\"fragment\"></span><a href=\"#%E5%BF%9C%E5%8B%9F%E4%BC%81%E6%A5%AD%E3%81%AE%E9%81%B8%E5%AE%9A%E8%BB%B8\"><i class=\"fa fa-link\"></i></a>応募企業の選定軸</h4>\n<p data-sourcepos=\"118:1-118:17\"><strong>必須条件:</strong></p>\n<ul data-sourcepos=\"119:1-121:0\">\n<li data-sourcepos=\"119:1-119:65\">プライム上場企業(急成長 × ある程度の安定性)</li>\n<li data-sourcepos=\"120:1-121:0\">職種がデータエンジニア/サイエンティストのいずれか</li>\n</ul>\n<p data-sourcepos=\"122:1-122:29\"><strong>柔軟に考えた条件:</strong></p>\n<ul data-sourcepos=\"123:1-125:0\">\n<li data-sourcepos=\"123:1-123:42\">業界・プロダクト領域:問わず</li>\n<li data-sourcepos=\"124:1-125:0\">データ組織の形態:問わず</li>\n</ul>\n<p data-sourcepos=\"126:1-126:23\"><strong>判断の優先度:</strong></p>\n<ol data-sourcepos=\"127:1-131:0\">\n<li data-sourcepos=\"127:1-127:95\">技術スキルが伸びる環境か(モダンツール、自分で手を動かせる裁量)</li>\n<li data-sourcepos=\"128:1-128:30\">スピード感はあるか</li>\n<li data-sourcepos=\"129:1-129:30\">カルチャーフィット</li>\n<li data-sourcepos=\"130:1-131:0\">年収・待遇</li>\n</ol>\n<h4 data-sourcepos=\"132:1-132:56\">\n<span id=\"応募を見送った途中で辞退した企業\" class=\"fragment\"></span><a href=\"#%E5%BF%9C%E5%8B%9F%E3%82%92%E8%A6%8B%E9%80%81%E3%81%A3%E3%81%9F%E9%80%94%E4%B8%AD%E3%81%A7%E8%BE%9E%E9%80%80%E3%81%97%E3%81%9F%E4%BC%81%E6%A5%AD\"><i class=\"fa fa-link\"></i></a>応募を見送った・途中で辞退した企業</h4>\n<ul data-sourcepos=\"134:1-138:0\">\n<li data-sourcepos=\"134:1-134:47\">データ活用が成熟していない企業</li>\n<li data-sourcepos=\"135:1-135:94\">自分のスキルが伸びなさそう(集計作業メイン、技術スタックが古い)</li>\n<li data-sourcepos=\"136:1-136:56\">「またベンダー任せ」になりそうな環境</li>\n<li data-sourcepos=\"137:1-138:0\">スピード感への不安(意思決定プロセスが複雑)</li>\n</ul>\n<h3 data-sourcepos=\"139:1-139:76\">\n<span id=\"2-3-選考フェーズjtc出身者が突かれる3大質問\" class=\"fragment\"></span><a href=\"#2-3-%E9%81%B8%E8%80%83%E3%83%95%E3%82%A7%E3%83%BC%E3%82%BAjtc%E5%87%BA%E8%BA%AB%E8%80%85%E3%81%8C%E7%AA%81%E3%81%8B%E3%82%8C%E3%82%8B3%E5%A4%A7%E8%B3%AA%E5%95%8F\"><i class=\"fa fa-link\"></i></a>2-3. 選考フェーズ──JTC出身者が突かれる「3大質問」</h3>\n<h4 data-sourcepos=\"141:1-141:64\">\n<span id=\"-本当に自分で手を動かしてるの問題\" class=\"fragment\"></span><a href=\"#-%E6%9C%AC%E5%BD%93%E3%81%AB%E8%87%AA%E5%88%86%E3%81%A7%E6%89%8B%E3%82%92%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%82%8B%E3%81%AE%E5%95%8F%E9%A1%8C\"><i class=\"fa fa-link\"></i></a>① 「本当に自分で手を動かしてるの?」問題</h4>\n<p data-sourcepos=\"143:1-143:32\"><strong>実際に聞かれた質問:</strong></p>\n<ul data-sourcepos=\"144:1-147:0\">\n<li data-sourcepos=\"144:1-144:42\">「SQLはどの程度書けますか?」</li>\n<li data-sourcepos=\"145:1-145:68\">「Pythonでの実装経験を具体的に教えてください」</li>\n<li data-sourcepos=\"146:1-147:0\">「BIツールは自分で設計していますか?」</li>\n</ul>\n<p data-sourcepos=\"148:1-148:89\"><strong>私の回答戦略:正直に「できること」「できないこと」を伝える</strong></p>\n<p data-sourcepos=\"150:1-150:203\">できないことを「できる」と言っても、技術面接で簡単にバレます。正直に答えつつ、業務外での学習(Kaggle、個人プロジェクト)をアピールしました。</p>\n<p data-sourcepos=\"152:1-152:66\"><strong>「ベンダーコントロールだけでは?」への対処:</strong></p>\n<p data-sourcepos=\"154:1-154:300\">「現在の大規模プロジェクトは実装の多くをベンダー依頼していますが、それ以前のプロジェクトでは自分で設計から実装まで行いました」と説明。小〜中規模で「自分で実装した」プロジェクトを具体的に提示しました。</p>\n<h4 data-sourcepos=\"156:1-156:58\">\n<span id=\"-スピード感についてこれる問題\" class=\"fragment\"></span><a href=\"#-%E3%82%B9%E3%83%94%E3%83%BC%E3%83%89%E6%84%9F%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%93%E3%82%8C%E3%82%8B%E5%95%8F%E9%A1%8C\"><i class=\"fa fa-link\"></i></a>② 「スピード感についてこれる?」問題</h4>\n<p data-sourcepos=\"158:1-158:187\">意外だったのは、<strong>スピード感については、ほとんど聞かれなかった</strong>ことです。JTCの意思決定の遅さは、面接官も理解していたようです。</p>\n<p data-sourcepos=\"160:1-160:153\">むしろ、「スピード感を求めて転職している」ことを自分から伝えることで、ポジティブに捉えてもらえました。</p>\n<h4 data-sourcepos=\"162:1-162:43\">\n<span id=\"-技術力大丈夫問題\" class=\"fragment\"></span><a href=\"#-%E6%8A%80%E8%A1%93%E5%8A%9B%E5%A4%A7%E4%B8%88%E5%A4%AB%E5%95%8F%E9%A1%8C\"><i class=\"fa fa-link\"></i></a>③ 「技術力、大丈夫?」問題</h4>\n<p data-sourcepos=\"164:1-164:47\"><strong>モダンツールの未経験について:</strong></p>\n<p data-sourcepos=\"166:1-166:244\">「業務では使ったことがありません。ただし、公式ドキュメント・チュートリアルを学習中、個人プロジェクトで環境を構築中です。入社後、3ヶ月でキャッチアップする計画です」</p>\n<p data-sourcepos=\"168:1-168:150\"><strong>ポイント:</strong> できないことを隠さず、「学習中」であることを具体的に示し、キャッチアップの計画を伝える。</p>\n<h3 data-sourcepos=\"170:1-170:54\">\n<span id=\"2-4-面接で実際に聞かれた質問リスト\" class=\"fragment\"></span><a href=\"#2-4-%E9%9D%A2%E6%8E%A5%E3%81%A7%E5%AE%9F%E9%9A%9B%E3%81%AB%E8%81%9E%E3%81%8B%E3%82%8C%E3%81%9F%E8%B3%AA%E5%95%8F%E3%83%AA%E3%82%B9%E3%83%88\"><i class=\"fa fa-link\"></i></a>2-4. 面接で実際に聞かれた質問リスト</h3>\n<h4 data-sourcepos=\"172:1-172:17\">\n<span id=\"技術面接\" class=\"fragment\"></span><a href=\"#%E6%8A%80%E8%A1%93%E9%9D%A2%E6%8E%A5\"><i class=\"fa fa-link\"></i></a>技術面接</h4>\n<ul data-sourcepos=\"174:1-177:0\">\n<li data-sourcepos=\"174:1-174:50\">職務経歴書ベースの技術的な深掘り</li>\n<li data-sourcepos=\"175:1-175:62\">一部企業では事前課題やコーディングテスト</li>\n<li data-sourcepos=\"176:1-177:0\">ライブコーディングはなし</li>\n</ul>\n<h4 data-sourcepos=\"178:1-178:38\">\n<span id=\"カルチャーフィット面接\" class=\"fragment\"></span><a href=\"#%E3%82%AB%E3%83%AB%E3%83%81%E3%83%A3%E3%83%BC%E3%83%95%E3%82%A3%E3%83%83%E3%83%88%E9%9D%A2%E6%8E%A5\"><i class=\"fa fa-link\"></i></a>カルチャーフィット面接</h4>\n<p data-sourcepos=\"180:1-180:40\">ほぼすべての企業で似た質問:</p>\n<ol data-sourcepos=\"181:1-186:0\">\n<li data-sourcepos=\"181:1-181:45\">転職理由の深掘り(100%聞かれる)</li>\n<li data-sourcepos=\"182:1-182:15\">志望動機</li>\n<li data-sourcepos=\"183:1-183:27\">キャリアビジョン</li>\n<li data-sourcepos=\"184:1-184:33\">過去の失敗・挫折経験</li>\n<li data-sourcepos=\"185:1-186:0\">チームワーク・コミュニケーション</li>\n</ol>\n<h4 data-sourcepos=\"187:1-187:32\">\n<span id=\"効果的だった逆質問\" class=\"fragment\"></span><a href=\"#%E5%8A%B9%E6%9E%9C%E7%9A%84%E3%81%A0%E3%81%A3%E3%81%9F%E9%80%86%E8%B3%AA%E5%95%8F\"><i class=\"fa fa-link\"></i></a>効果的だった逆質問</h4>\n<ul data-sourcepos=\"189:1-193:0\">\n<li data-sourcepos=\"189:1-189:86\">「データ組織の現在の課題と今後の方向性を教えてください」</li>\n<li data-sourcepos=\"190:1-190:66\">「入社後、最初に期待される成果は何ですか?」</li>\n<li data-sourcepos=\"191:1-191:84\">「現在のチームが抱えている、最も大きな課題は何ですか?」</li>\n<li data-sourcepos=\"192:1-193:0\">「入社後、3ヶ月でどんな成果を出せば『良い採用だった』と思ってもらえますか?」</li>\n</ul>\n<h3 data-sourcepos=\"194:1-194:36\">\n<span id=\"2-5-オファー意思決定\" class=\"fragment\"></span><a href=\"#2-5-%E3%82%AA%E3%83%95%E3%82%A1%E3%83%BC%E6%84%8F%E6%80%9D%E6%B1%BA%E5%AE%9A\"><i class=\"fa fa-link\"></i></a>2-5. オファー・意思決定</h3>\n<h4 data-sourcepos=\"196:1-196:24\">\n<span id=\"2社からの内定\" class=\"fragment\"></span><a href=\"#2%E7%A4%BE%E3%81%8B%E3%82%89%E3%81%AE%E5%86%85%E5%AE%9A\"><i class=\"fa fa-link\"></i></a>2社からの内定</h4>\n<p data-sourcepos=\"198:1-198:148\">どちらもプライム上場のSaaS企業、技術力が高いと評価されている企業、従業員のほとんどがキャリア採用者。</p>\n<p data-sourcepos=\"200:1-200:21\"><strong>内定企業A社:</strong></p>\n<ul data-sourcepos=\"201:1-206:0\">\n<li data-sourcepos=\"201:1-201:24\">事業領域:BtoB SaaS</li>\n<li data-sourcepos=\"202:1-202:33\">データ組織:中央集権型</li>\n<li data-sourcepos=\"203:1-203:33\">オファー年収:約700万円</li>\n<li data-sourcepos=\"204:1-204:57\">魅力:高度なデータ分析基盤、技術的挑戦</li>\n<li data-sourcepos=\"205:1-206:0\">懸念:全社横断組織で事業部門との距離が遠い</li>\n</ul>\n<p data-sourcepos=\"207:1-207:41\"><strong>内定企業B社(最終的に選択):</strong></p>\n<ul data-sourcepos=\"208:1-213:0\">\n<li data-sourcepos=\"208:1-208:24\">事業領域:BtoB SaaS</li>\n<li data-sourcepos=\"209:1-209:36\">データ組織:事業部配属型</li>\n<li data-sourcepos=\"210:1-210:33\">オファー年収:約800万円</li>\n<li data-sourcepos=\"211:1-211:132\">魅力:事業部の最前線、カルチャーへの強い共感。全社横断と事業それぞれにデータ組織をもつ。</li>\n<li data-sourcepos=\"212:1-213:0\">懸念:全社的なデータ基盤に関わるには社内異動の必要</li>\n</ul>\n<h4 data-sourcepos=\"214:1-214:42\">\n<span id=\"最終的にb社を選んだ決め手\" class=\"fragment\"></span><a href=\"#%E6%9C%80%E7%B5%82%E7%9A%84%E3%81%ABb%E7%A4%BE%E3%82%92%E9%81%B8%E3%82%93%E3%81%A0%E6%B1%BA%E3%82%81%E6%89%8B\"><i class=\"fa fa-link\"></i></a>最終的にB社を選んだ決め手</h4>\n<p data-sourcepos=\"216:1-216:35\"><strong>① カルチャーフィット</strong></p>\n<p data-sourcepos=\"218:1-218:360\">B社の企業理念を聞いた時、<strong>「データは手段であって目的じゃない」</strong> という自分の価値観と完全に一致しました。特に、ユーザの課題解決を最優先するバリュー、自分でものを作ることへの自責というバリューが、自分が転職で実現したかったことそのものでした。</p>\n<p data-sourcepos=\"220:1-220:23\"><strong>② 年収アップ</strong></p>\n<p data-sourcepos=\"222:1-222:142\">現職から<strong>100万円以上の年収アップ</strong>は、市場価値が評価された証であり、決断を後押ししてくれました。</p>\n<p data-sourcepos=\"224:1-224:56\"><strong>③ 事業の最前線でデータ活用ができる</strong></p>\n<p data-sourcepos=\"226:1-226:285\">事業部配属型のデータ組織で、事業部門と直接連携しながら仕事ができ、データ分析の結果がすぐにビジネスアクションに繋がる──JTCで感じていた「事業の最前線から遠い」という距離感を感じませんでした。</p>\n<h4 data-sourcepos=\"228:1-228:50\">\n<span id=\"年収交渉内定承諾から入社まで\" class=\"fragment\"></span><a href=\"#%E5%B9%B4%E5%8F%8E%E4%BA%A4%E6%B8%89%E5%86%85%E5%AE%9A%E6%89%BF%E8%AB%BE%E3%81%8B%E3%82%89%E5%85%A5%E7%A4%BE%E3%81%BE%E3%81%A7\"><i class=\"fa fa-link\"></i></a>年収交渉・内定承諾から入社まで</h4>\n<p data-sourcepos=\"230:1-230:108\">提示された年収が期待を大きく上回っていたため、年収交渉はしませんでした。</p>\n<p data-sourcepos=\"232:1-233:67\">退職交渉では<strong>1.5ヶ月の引き継ぎ期間</strong>で合意しました。<br>\n<strong>自身のキャリアは自身しか責任を持てません</strong>。</p>\n<hr data-sourcepos=\"235:1-236:0\">\n<h2 data-sourcepos=\"237:1-237:57\">\n<span id=\"3-jtc出身者の強みと弱み客観的分析\" class=\"fragment\"></span><a href=\"#3-jtc%E5%87%BA%E8%BA%AB%E8%80%85%E3%81%AE%E5%BC%B7%E3%81%BF%E3%81%A8%E5%BC%B1%E3%81%BF%E5%AE%A2%E8%A6%B3%E7%9A%84%E5%88%86%E6%9E%90\"><i class=\"fa fa-link\"></i></a>3. JTC出身者の強みと弱み──客観的分析</h2>\n<h3 data-sourcepos=\"239:1-239:58\">\n<span id=\"3-1-思ったより評価された3つの強み\" class=\"fragment\"></span><a href=\"#3-1-%E6%80%9D%E3%81%A3%E3%81%9F%E3%82%88%E3%82%8A%E8%A9%95%E4%BE%A1%E3%81%95%E3%82%8C%E3%81%9F3%E3%81%A4%E3%81%AE%E5%BC%B7%E3%81%BF\"><i class=\"fa fa-link\"></i></a>3-1. 思ったより評価された「3つの強み」</h3>\n<p data-sourcepos=\"241:1-241:50\"><strong>① 複雑なステークホルダー調整力</strong></p>\n<p data-sourcepos=\"243:1-243:246\">複数部門の調整経験は、スケールフェーズの企業に刺さりました。特に、役員への説明・承認プロセスの設計、複数部門の利害調整と段階的合意形成、優先度設計が評価されました。</p>\n<p data-sourcepos=\"245:1-245:56\"><strong>② ドキュメンテーション・標準化意識</strong></p>\n<p data-sourcepos=\"247:1-247:162\">ウォーターフォールで鍛えられた設計書文化、属人化排除への執着は、スケールフェーズの企業には必須スキルでした。</p>\n<p data-sourcepos=\"249:1-249:53\"><strong>③ データ品質・ガバナンスへの感度</strong></p>\n<p data-sourcepos=\"251:1-251:177\">コンプライアンス・セキュリティへの理解、データ品質への意識は、急成長企業が「次に整備すべき領域」として注目されました。</p>\n<h3 data-sourcepos=\"253:1-253:60\">\n<span id=\"3-2-思ったより評価されなかった弱み\" class=\"fragment\"></span><a href=\"#3-2-%E6%80%9D%E3%81%A3%E3%81%9F%E3%82%88%E3%82%8A%E8%A9%95%E4%BE%A1%E3%81%95%E3%82%8C%E3%81%AA%E3%81%8B%E3%81%A3%E3%81%9F%E5%BC%B1%E3%81%BF\"><i class=\"fa fa-link\"></i></a>3-2. 思ったより評価されなかった「弱み」</h3>\n<p data-sourcepos=\"255:1-255:35\"><strong>① 技術スタックの古さ</strong></p>\n<p data-sourcepos=\"257:1-257:123\">モダンツール未経験は正直マイナス。ただし「キャッチアップ意欲」でカバー可能でした。</p>\n<p data-sourcepos=\"259:1-259:177\"><strong>対処法:</strong> 「業務では未経験だが、独学で学習中」と正直に伝え、具体的な学習内容を示し、入社後のキャッチアップ計画を提示。</p>\n<p data-sourcepos=\"261:1-261:53\"><strong>② 「自分で手を動かす」実績の薄さ</strong></p>\n<p data-sourcepos=\"263:1-263:208\"><strong>対処法:</strong> 大規模PJだけでなく、小〜中規模で「自分で実装した」プロジェクトを強調。業務外での技術的取り組み(Kaggle、個人プロジェクト)をアピール。</p>\n<p data-sourcepos=\"265:1-265:41\"><strong>③ スピード感への適応不安</strong></p>\n<p data-sourcepos=\"267:1-267:159\"><strong>対処法:</strong> JTCのスピード感に不満を持ち、改善したいと明確に伝える。入社後のキャッチアップ計画を具体的に示す。</p>\n<p data-sourcepos=\"269:1-269:180\"><strong>ポイント:</strong> JTC経験は「調整力だけ」では厳しいが、<strong>「調整力 × 技術理解 × 学習意欲」の掛け算</strong>なら十分に市場価値があります。</p>\n<hr data-sourcepos=\"271:1-272:0\">\n<h2 data-sourcepos=\"273:1-273:45\">\n<span id=\"4-転職活動を通じて学んだこと\" class=\"fragment\"></span><a href=\"#4-%E8%BB%A2%E8%81%B7%E6%B4%BB%E5%8B%95%E3%82%92%E9%80%9A%E3%81%98%E3%81%A6%E5%AD%A6%E3%82%93%E3%81%A0%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>4. 転職活動を通じて学んだこと</h2>\n<h3 data-sourcepos=\"275:1-275:30\">\n<span id=\"4-1-jtc経験の再評価\" class=\"fragment\"></span><a href=\"#4-1-jtc%E7%B5%8C%E9%A8%93%E3%81%AE%E5%86%8D%E8%A9%95%E4%BE%A1\"><i class=\"fa fa-link\"></i></a>4-1. JTC経験の再評価</h3>\n<p data-sourcepos=\"277:1-277:196\"><strong>やはり足りなかったこと:</strong> **「内製で作る意識・技術」が圧倒的に不足していました。**この不足が、転職活動で最も苦労したポイントでした。</p>\n<p data-sourcepos=\"279:1-279:73\"><strong>今だから言える「JTCでやっておけばよかったこと」</strong></p>\n<p data-sourcepos=\"281:1-281:361\">JTCにいる間、**ワークライフバランスは保たれていました。**その余剰時間を使って、市場で求められているスキルの把握、モダンツールの学習、Kaggleや個人プロジェクトでの実装経験、GitHubでのアウトプットをもっと積極的にやっておけばよかったと後悔しています。</p>\n<p data-sourcepos=\"283:1-283:112\">**「業務でできないなら、業務外でやればよかった」**──これが最大の学びです。</p>\n<h3 data-sourcepos=\"285:1-285:30\">\n<span id=\"4-2-転職タイミング\" class=\"fragment\"></span><a href=\"#4-2-%E8%BB%A2%E8%81%B7%E3%82%BF%E3%82%A4%E3%83%9F%E3%83%B3%E3%82%B0\"><i class=\"fa fa-link\"></i></a>4-2. 転職タイミング</h3>\n<p data-sourcepos=\"287:1-287:88\">結論から言うと、<strong>もっと早く動いてよかった</strong>と思っています。</p>\n<p data-sourcepos=\"289:1-290:148\">タイミングの難しさはありますが、重要なのは年齢より「何を経験してきたか」です。<br>\n今後のキャリアを見据え、現職に停滞感があった1年前に決断しても結果はあまり変わらなかったと思います。</p>\n<h3 data-sourcepos=\"292:1-292:39\">\n<span id=\"4-3-マインドセットの転換\" class=\"fragment\"></span><a href=\"#4-3-%E3%83%9E%E3%82%A4%E3%83%B3%E3%83%89%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E8%BB%A2%E6%8F%9B\"><i class=\"fa fa-link\"></i></a>4-3. マインドセットの転換</h3>\n<p data-sourcepos=\"294:1-294:103\">転職活動を通じて、最も大きく変わったのは<strong>転職に対する考え方</strong>でした。</p>\n<p data-sourcepos=\"296:1-296:25\"><strong>転職は怖くない</strong></p>\n<p data-sourcepos=\"298:1-298:210\">実際に転職活動をしてみて、自分の市場価値を客観的に知ることができ、複数の企業から評価されることで自信がつき、選択肢があることが分かりました。</p>\n<p data-sourcepos=\"300:1-300:125\"><strong>「とりあえず動いて、自分の価値を確かめることが大事」</strong> ──これが最大の学びでした。</p>\n<p data-sourcepos=\"302:1-302:243\">転職活動は「転職すること」が目的ではありません。自分の市場価値を知る、今の環境を相対化する、キャリアの選択肢を広げるという意味で、定期的に行うべきだと感じました。</p>\n<p data-sourcepos=\"304:1-304:109\">重要なのは、<strong>「今の環境しか知らない」という状態から抜け出すこと</strong>　です。</p>\n<hr data-sourcepos=\"306:1-307:0\">\n<h2 data-sourcepos=\"308:1-308:79\">\n<span id=\"5-これから転職を考える人へ5つの具体的アドバイス\" class=\"fragment\"></span><a href=\"#5-%E3%81%93%E3%82%8C%E3%81%8B%E3%82%89%E8%BB%A2%E8%81%B7%E3%82%92%E8%80%83%E3%81%88%E3%82%8B%E4%BA%BA%E3%81%B85%E3%81%A4%E3%81%AE%E5%85%B7%E4%BD%93%E7%9A%84%E3%82%A2%E3%83%89%E3%83%90%E3%82%A4%E3%82%B9\"><i class=\"fa fa-link\"></i></a>5. これから転職を考える人へ──5つの具体的アドバイス</h2>\n<h3 data-sourcepos=\"310:1-310:39\">\n<span id=\"5-1-いつ動き始めるべきか\" class=\"fragment\"></span><a href=\"#5-1-%E3%81%84%E3%81%A4%E5%8B%95%E3%81%8D%E5%A7%8B%E3%82%81%E3%82%8B%E3%81%B9%E3%81%8D%E3%81%8B\"><i class=\"fa fa-link\"></i></a>5-1. いつ動き始めるべきか</h3>\n<p data-sourcepos=\"312:1-312:62\">結論:<strong>思い立ったら、すぐに動くべき</strong>です。</p>\n<p data-sourcepos=\"314:1-314:131\"><strong>自分のキャリアは自分しか考えてくれません。</strong> 会社はあなたのキャリアに責任を持ちません。</p>\n<p data-sourcepos=\"316:1-316:111\">「もっとスキルをつけてから」と考えているうちに、時間だけが過ぎていきます。</p>\n<p data-sourcepos=\"318:1-318:100\"><strong>まずは動いてみる。それで市場の反応を見る。これが最初の一歩です。</strong></p>\n<h3 data-sourcepos=\"320:1-320:39\">\n<span id=\"5-2-何から始めればいいか\" class=\"fragment\"></span><a href=\"#5-2-%E4%BD%95%E3%81%8B%E3%82%89%E5%A7%8B%E3%82%81%E3%82%8C%E3%81%B0%E3%81%84%E3%81%84%E3%81%8B\"><i class=\"fa fa-link\"></i></a>5-2. 何から始めればいいか</h3>\n<p data-sourcepos=\"322:1-322:97\">最初にやるべきことは、<strong>職務経歴書の作成とキャリアの棚卸し</strong>です。</p>\n<p data-sourcepos=\"324:1-324:111\">ただし、一人で悩む必要はありません。<strong>生成AIを使って理詰めで考えましょう。</strong></p>\n<p data-sourcepos=\"326:1-326:16\">具体的には:</p>\n<ol data-sourcepos=\"327:1-330:0\">\n<li data-sourcepos=\"327:1-327:54\">これまでの業務内容を箇条書きで整理</li>\n<li data-sourcepos=\"328:1-328:106\">ChatGPTやClaudeに「この経験を職務経歴書に書くならどう表現すべきか」と相談</li>\n<li data-sourcepos=\"329:1-330:0\">複数の表現パターンを生成AIで作ってもらい、最適なものを選ぶ</li>\n</ol>\n<p data-sourcepos=\"331:1-331:35\"><strong>並行してやるべきこと:</strong></p>\n<ul data-sourcepos=\"332:1-334:0\">\n<li data-sourcepos=\"332:1-332:61\">転職エージェントへの登録(まずは情報収集)</li>\n<li data-sourcepos=\"333:1-334:0\">転職サイトで求人を眺める(市場感覚を掴む)</li>\n</ul>\n<p data-sourcepos=\"335:1-335:118\">完璧な準備ができてから動くのではなく、<strong>動きながら準備を整える</strong>のが効率的です。</p>\n<h3 data-sourcepos=\"337:1-337:42\">\n<span id=\"5-3-準備期間にやるべきこと\" class=\"fragment\"></span><a href=\"#5-3-%E6%BA%96%E5%82%99%E6%9C%9F%E9%96%93%E3%81%AB%E3%82%84%E3%82%8B%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>5-3. 準備期間にやるべきこと</h3>\n<ul data-sourcepos=\"339:1-342:0\">\n<li data-sourcepos=\"339:1-339:41\">SPIの対策(事前に問題集を1冊)</li>\n<li data-sourcepos=\"340:1-340:92\">プログラミング試験の対策(AtCoderなどで基礎的なアルゴリズム問題)</li>\n<li data-sourcepos=\"341:1-342:0\">技術キャッチアップ(市場で求められているツールに合わせた基礎学習)</li>\n</ul>\n<h3 data-sourcepos=\"343:1-343:36\">\n<span id=\"5-4-やってよかったこと\" class=\"fragment\"></span><a href=\"#5-4-%E3%82%84%E3%81%A3%E3%81%A6%E3%82%88%E3%81%8B%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>5-4. やってよかったこと</h3>\n<p data-sourcepos=\"345:1-345:259\"><strong>生成AIを使って理詰めで準備したこと</strong>です。想定質問に対する回答、志望動機の複数パターン作成、面接後の振り返りなど、<strong>用意周到に準備することで、面接での自信につながりました。</strong></p>\n<h3 data-sourcepos=\"347:1-347:42\">\n<span id=\"5-5-やらなくてよかったこと\" class=\"fragment\"></span><a href=\"#5-5-%E3%82%84%E3%82%89%E3%81%AA%E3%81%8F%E3%81%A6%E3%82%88%E3%81%8B%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>5-5. やらなくてよかったこと</h3>\n<p data-sourcepos=\"349:1-349:58\"><strong>現職に過度なリソースを割くこと</strong>です。</p>\n<p data-sourcepos=\"351:1-351:141\">どうせ転職するなら、残業は最小限に、新しい大きな仕事は引き受けず、プロジェクトの区切りで動く。</p>\n<p data-sourcepos=\"353:1-353:142\"><strong>「もう辞める会社」に全力を注ぐより、「これから入る会社」のための準備に時間を使うべき</strong>でした。</p>\n<hr data-sourcepos=\"355:1-356:0\">\n<h2 data-sourcepos=\"357:1-357:57\">\n<span id=\"6-転職しないという選択肢について\" class=\"fragment\"></span><a href=\"#6-%E8%BB%A2%E8%81%B7%E3%81%97%E3%81%AA%E3%81%84%E3%81%A8%E3%81%84%E3%81%86%E9%81%B8%E6%8A%9E%E8%82%A2%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"><i class=\"fa fa-link\"></i></a>6. 「転職しない」という選択肢について</h2>\n<h3 data-sourcepos=\"359:1-359:45\">\n<span id=\"6-1-jtcに残るメリットの再確認\" class=\"fragment\"></span><a href=\"#6-1-jtc%E3%81%AB%E6%AE%8B%E3%82%8B%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88%E3%81%AE%E5%86%8D%E7%A2%BA%E8%AA%8D\"><i class=\"fa fa-link\"></i></a>6-1. JTCに残るメリットの再確認</h3>\n<p data-sourcepos=\"361:1-361:35\"><strong>最大のメリット:安定性</strong></p>\n<p data-sourcepos=\"363:1-363:174\">年功序列の昇給、手厚い福利厚生、雇用の安定性。特にライフイベントを控えている場合、この安定性は大きな価値があります。</p>\n<p data-sourcepos=\"365:1-365:29\"><strong>その他のメリット:</strong></p>\n<ul data-sourcepos=\"366:1-369:0\">\n<li data-sourcepos=\"366:1-366:68\">大規模プロジェクトのマネジメント経験が積める</li>\n<li data-sourcepos=\"367:1-367:47\">複雑な組織での調整力が身につく</li>\n<li data-sourcepos=\"368:1-369:0\">ワークライフバランスが保たれている</li>\n</ul>\n<p data-sourcepos=\"370:1-370:132\">転職が全てではありません。自分の価値観と照らし合わせて、JTCに残る選択も十分にありえます。</p>\n<h3 data-sourcepos=\"372:1-372:46\">\n<span id=\"6-2-社内異動という第3の選択肢\" class=\"fragment\"></span><a href=\"#6-2-%E7%A4%BE%E5%86%85%E7%95%B0%E5%8B%95%E3%81%A8%E3%81%84%E3%81%86%E7%AC%AC3%E3%81%AE%E9%81%B8%E6%8A%9E%E8%82%A2\"><i class=\"fa fa-link\"></i></a>6-2. 社内異動という第3の選択肢</h3>\n<p data-sourcepos=\"374:1-374:63\">私自身、社内公募で異動した経験があります。</p>\n<p data-sourcepos=\"376:1-376:32\"><strong>社内異動のメリット:</strong></p>\n<ul data-sourcepos=\"377:1-380:0\">\n<li data-sourcepos=\"377:1-377:55\">リスクが低い(給与・雇用は維持される)</li>\n<li data-sourcepos=\"378:1-378:89\">\n<strong>スキル面はポテンシャルで見られる</strong>(未経験でも挑戦しやすい)</li>\n<li data-sourcepos=\"379:1-380:0\">転職に比べてハードルが低い</li>\n</ul>\n<p data-sourcepos=\"381:1-381:112\">特に重要なのは、<strong>全くの未経験からいきなり転職するのは難しい</strong>という点です。</p>\n<p data-sourcepos=\"383:1-383:35\"><strong>社内異動のデメリット:</strong></p>\n<ul data-sourcepos=\"384:1-387:0\">\n<li data-sourcepos=\"384:1-384:72\"><strong>環境変化によって得られるスキルには天井がある</strong></li>\n<li data-sourcepos=\"385:1-385:47\">ベンダー依存の体質は変わらない</li>\n<li data-sourcepos=\"386:1-387:0\">意思決定のスピード感は変わらない</li>\n</ul>\n<p data-sourcepos=\"388:1-388:256\"><strong>戦略的には:</strong> まず社内異動で希望職種の経験を積む → 2〜3年経験を積んだら転職市場での評価を確認 → 市場価値が上がったタイミングで転職、という2ステップが現実的かもしれません。</p>\n<h3 data-sourcepos=\"390:1-390:57\">\n<span id=\"6-3-転職すべき人しないほうがいい人\" class=\"fragment\"></span><a href=\"#6-3-%E8%BB%A2%E8%81%B7%E3%81%99%E3%81%B9%E3%81%8D%E4%BA%BA%E3%81%97%E3%81%AA%E3%81%84%E3%81%BB%E3%81%86%E3%81%8C%E3%81%84%E3%81%84%E4%BA%BA\"><i class=\"fa fa-link\"></i></a>6-3. 転職すべき人・しないほうがいい人</h3>\n<p data-sourcepos=\"392:1-392:23\"><strong>転職すべき人:</strong></p>\n<ol data-sourcepos=\"394:1-397:0\">\n<li data-sourcepos=\"394:1-394:87\">「自分で手を動かせない」ことに強いストレスを感じている人</li>\n<li data-sourcepos=\"395:1-395:54\">事業成長への直接貢献を実感したい人</li>\n<li data-sourcepos=\"396:1-397:0\">市場価値を高めたい・キャリアの選択肢を広げたい人</li>\n</ol>\n<p data-sourcepos=\"398:1-398:38\"><strong>転職しないほうがいい人:</strong></p>\n<ol data-sourcepos=\"400:1-403:0\">\n<li data-sourcepos=\"400:1-400:45\">安定・福利厚生を最優先する人</li>\n<li data-sourcepos=\"401:1-401:60\">大規模調整業務にやりがいを感じている人</li>\n<li data-sourcepos=\"402:1-403:0\">まだ経験が浅い人(入社3年未満)</li>\n</ol>\n<p data-sourcepos=\"404:1-404:142\"><strong>最も重要なのは:</strong> 転職するかしないかではなく、**「自分のキャリアを主体的に考えているか」**です。</p>\n<hr data-sourcepos=\"406:1-407:0\">\n<h2 data-sourcepos=\"408:1-408:18\">\n<span id=\"7-おわりに\" class=\"fragment\"></span><a href=\"#7-%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>7. おわりに</h2>\n<h3 data-sourcepos=\"410:1-410:30\">\n<span id=\"7-1-転職活動の総括\" class=\"fragment\"></span><a href=\"#7-1-%E8%BB%A2%E8%81%B7%E6%B4%BB%E5%8B%95%E3%81%AE%E7%B7%8F%E6%8B%AC\"><i class=\"fa fa-link\"></i></a>7-1. 転職活動の総括</h3>\n<p data-sourcepos=\"412:1-412:48\">1.5ヶ月の転職活動を振り返って──</p>\n<p data-sourcepos=\"414:1-414:85\"><strong>非常に晴々とした気持ちです。次が楽しみでしょうがない。</strong></p>\n<p data-sourcepos=\"416:1-416:133\"><strong>自分で選択した未来に向かって進んでいる</strong>という実感が、何よりも大きな自信になっています。</p>\n<h3 data-sourcepos=\"418:1-418:30\">\n<span id=\"7-2-新天地での抱負\" class=\"fragment\"></span><a href=\"#7-2-%E6%96%B0%E5%A4%A9%E5%9C%B0%E3%81%A7%E3%81%AE%E6%8A%B1%E8%B2%A0\"><i class=\"fa fa-link\"></i></a>7-2. 新天地での抱負</h3>\n<p data-sourcepos=\"420:1-420:33\"><strong>短期的な目標(1〜2年):</strong></p>\n<p data-sourcepos=\"422:1-422:286\"><strong>自身のキャリアを主体的に選択できるだけのポータブルスキルを身につけたい</strong>です。モダンなツールの実装経験、データモデリングの実践、自分で手を動かして価値を生み出す経験を積み上げたいと思います。</p>\n<p data-sourcepos=\"424:1-424:35\"><strong>中長期的な目標(3年〜):</strong></p>\n<p data-sourcepos=\"426:1-426:217\"><strong>優秀な仲間と刺激的な仕事を行なっていきたい</strong>です。データ活用の仕組み化・標準化を推進し、属人化しない持続可能なデータ組織の構築に貢献したいです。</p>\n<p data-sourcepos=\"428:1-428:174\">JTCで培った「調整力」「仕組み化への執着」に「技術力」を掛け合わせることで、より大きな価値を生み出せると信じています。</p>\n<h3 data-sourcepos=\"430:1-430:33\">\n<span id=\"7-3-最後のメッセージ\" class=\"fragment\"></span><a href=\"#7-3-%E6%9C%80%E5%BE%8C%E3%81%AE%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8\"><i class=\"fa fa-link\"></i></a>7-3. 最後のメッセージ</h3>\n<p data-sourcepos=\"432:1-432:57\">この記事を読んでくださった、あなたへ。</p>\n<p data-sourcepos=\"434:1-434:46\"><strong>自分のキャリアは自分で作る。</strong></p>\n<p data-sourcepos=\"436:1-436:72\">これが、転職活動を通じて最も強く感じたことです。</p>\n<p data-sourcepos=\"438:1-438:103\"><strong>人生のなかで仕事の時間は長い。どうせやるなら、より刺激のある方へ。</strong></p>\n<p data-sourcepos=\"440:1-440:67\"><strong>まずは動いてみる。それで市場の反応を見る。</strong></p>\n<p data-sourcepos=\"442:1-442:240\">転職活動は「転職すること」が目的ではありません。自分の市場価値を知る、今の環境を相対化する、キャリアの選択肢を広げるという意味で、定期的に行うべきだと思います。</p>\n<p data-sourcepos=\"444:1-444:106\">重要なのは、<strong>「今の環境しか知らない」という状態から抜け出すこと</strong>です。</p>\n<hr data-sourcepos=\"446:1-447:0\">\n<h2 data-sourcepos=\"448:1-448:22\">\n<span id=\"補足参考情報\" class=\"fragment\"></span><a href=\"#%E8%A3%9C%E8%B6%B3%E5%8F%82%E8%80%83%E6%83%85%E5%A0%B1\"><i class=\"fa fa-link\"></i></a>補足:参考情報</h2>\n<h3 data-sourcepos=\"450:1-450:31\">\n<span id=\"使った転職サービス\" class=\"fragment\"></span><a href=\"#%E4%BD%BF%E3%81%A3%E3%81%9F%E8%BB%A2%E8%81%B7%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9\"><i class=\"fa fa-link\"></i></a>使った転職サービス</h3>\n<p data-sourcepos=\"452:1-452:23\"><strong>メインで利用:</strong></p>\n<ul data-sourcepos=\"453:1-455:0\">\n<li data-sourcepos=\"453:1-455:0\">\n<strong>doda(総合型エージェント)</strong>\n<ul data-sourcepos=\"454:3-455:0\">\n<li data-sourcepos=\"454:3-455:0\">データ職の求人数が豊富、担当エージェントが親身、面接対策・日程調整が手厚い</li>\n</ul>\n</li>\n</ul>\n<p data-sourcepos=\"456:1-456:20\"><strong>サブで利用:</strong></p>\n<ul data-sourcepos=\"457:1-461:0\">\n<li data-sourcepos=\"457:1-458:55\">\n<strong>ビズリーチ(ダイレクトリクルーティング)</strong>\n<ul data-sourcepos=\"458:3-458:55\">\n<li data-sourcepos=\"458:3-458:55\">企業からのスカウトで市場価値を確認</li>\n</ul>\n</li>\n<li data-sourcepos=\"459:1-461:0\">\n<strong>リファラル</strong>\n<ul data-sourcepos=\"460:3-461:0\">\n<li data-sourcepos=\"460:3-461:0\">カルチャーフィットが事前にわかる</li>\n</ul>\n</li>\n</ul>\n<h3 data-sourcepos=\"462:1-462:34\">\n<span id=\"その他の学習リソース\" class=\"fragment\"></span><a href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E5%AD%A6%E7%BF%92%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9\"><i class=\"fa fa-link\"></i></a>その他の学習リソース</h3>\n<p data-sourcepos=\"464:1-464:17\"><strong>技術学習:</strong></p>\n<ul data-sourcepos=\"465:1-469:0\">\n<li data-sourcepos=\"465:1-465:36\">Udemy(モダンツールの講座)</li>\n<li data-sourcepos=\"466:1-466:26\">公式ドキュメント</li>\n<li data-sourcepos=\"467:1-467:34\">Kaggle(データ分析コンペ)</li>\n<li data-sourcepos=\"468:1-469:0\">AtCoder(プログラミング試験対策)</li>\n</ul>\n<p data-sourcepos=\"470:1-470:17\"><strong>情報収集:</strong></p>\n<ul data-sourcepos=\"471:1-473:0\">\n<li data-sourcepos=\"471:1-471:46\">Qiita、Zenn(データ分析者の体験記)</li>\n<li data-sourcepos=\"472:1-473:0\">各社のテックブログ</li>\n</ul>\n<p data-sourcepos=\"474:1-474:17\"><strong>面接対策:</strong></p>\n<ul data-sourcepos=\"475:1-477:0\">\n<li data-sourcepos=\"475:1-475:61\">生成AI(ChatGPT、Claude)での想定質問・回答作成</li>\n<li data-sourcepos=\"476:1-477:0\">転職会議、OpenWork(企業の口コミ確認)</li>\n</ul>\n<hr data-sourcepos=\"478:1-479:0\">\n<p data-sourcepos=\"480:1-480:58\"><strong>以上で、この転職体験記は終わりです。</strong></p>\n<p data-sourcepos=\"482:1-483:87\">最後まで読んでいただき、ありがとうございました。<br>\nあなたのキャリアが、より良い方向に進むことを願っています。</p>\n",
      "body": "## 0. はじめに\n\nこの記事は、**JTCのIT部門で働きながら、漠然とした不安を抱えているあなた** や **転職後の自分** に向けて書きます。\n\n私は201X年にプライム上場の大手メーカー系列会社(以下、A社)に入社。全社横断のデータ分析組織にて、データ基盤構築やBI開発、AIモデル構築など複数のプロジェクトをリードしました。\n\n基幹システムの刷新や全社データ基盤構築プロジェクトに参画し、順調なキャリアに見えましたが、**JTCを離れ、SaaS企業(以下、B社)へ転職を決意しました。**\n\n理由は多くありますが、例えば以下の理由からでした。このような事業会社は多いのではないでしょうか。\n\n- **「SIベンダー任せで、決して自分で触らない(作る技術がない)」IT部門**\n    - ベンダへ投資した金額 ≠ システムの価値\n    - 営業が汗水流して上げた売上を、湯水のようにコンサル,SIベンダに流す\n    - 自分で触って自社内製するつもりはない\n- **SaaS製品の利用にウォーターフォールを適用し、利用開始に2年以上を要するスピード感**\n    - そのサービスで何ができるか誰もわからずに進む要件定義、設計\n    - 従量課金の予算取りに5年後の見積もりを求め、予算確保後のモニタリングは行わないレガシーなコスト管理\n- **「事業の最前線から遠い」という距離感**\n    - 数十年前のスクラッチ開発のシステムの模倣\n    - 事業が欲しいシステムとの要件定義の乖離\n\nこの記事では、転職活動の全記録を書いています。同じ悩みを抱える人が、自分のキャリアを見つめ直すきっかけになれば幸いです。\n\n---\n\n## 1. 転職を決意するまで──JTCのIT部門で見た「限界」\n\n### 1-1. 社内転職からデータ分析の道へ\n\n入社後3年間、別部門で業務を経験した後、社内公募でデータ分析組織に異動しました。\n\n異動後は複数のプロジェクトを経験:\n- 部門横断のデータ統合による分析基盤構築\n- 機械学習を用いた予測モデルの構築\n- 大規模な全社データ基盤構築PJの推進\n\n### 1-2. 「このままではマズイ」と感じた3つの瞬間\n\n#### ① ベンダー依存が「当たり前」の組織で感じた危機感\n\n大規模プロジェクトで製品選定からフィジビリティ検証を実施する際、**自社の環境では何も行いません**でした。\nクラウド基盤の実装はSIベンダー頼み、本番環境での検証もSIベンダー経由。\n\nそして、さらに衝撃的だったのは──**周囲の誰も、それを問題だと思っていなかったこと**です。\n\n「要件を整理してベンダーに渡す」が当たり前。自分で作ろうとする人もいないし、作れる人もいない。上司に相談したところ、**「それはベンダーの仕事だから」** と。\n\n**「このままでは、自分は『要件を日本語で書き、各所と調整するだけの人』になってしまう」** という恐怖を感じました。\n\n#### ② ステークホルダー調整に6ヶ月かかる意思決定\n\nあるダッシュボード機能の追加は技術的には1,2週間で実装できる内容でしたが、関係部署への説明会、根回し、役員報告で意思決定まで約6ヶ月かかりました。\n\n**「このスピード感で、本当に事業成長に貢献できているのか?」**\n\n#### ③ キャリアの天井が見えた瞬間\n\nプロジェクトの設計フェーズが完了し、今後2年間はベンダーの進捗管理と運用設計が主な業務。技術的な挑戦はほとんどありません。\n\n**社内のロールモデルを見渡しても、「自分で手を動かして価値を生み出し続けている人」がいませんでした。**「技術 × ビジネス」の両方に関わり続けるキャリアパスが、この組織には存在しません。\n\n**「動くなら、今しかない」** と確信しました。\n\n### 1-3. それでも迷った「安定」との天秤\n\n最も躊躇したのは、**安定した給与を手放すこと**でした。年功序列の昇給、手厚い福利厚生、ライフイベントを考えると不安は大きかったです。\n\n**それでも決断できた理由──技術的挑戦の「2年間の空白」**\n\n**「2年後の32歳、自分は何ができる人なのか?」**\n\nモダンなツールは触れない、実装経験は積めない、事業貢献の実感も得られない──市場で求められているスキルとのギャップは、どんどん広がっていく。\n\n天秤にかけた結果、**「30歳を前に動かなければ、後悔する」** という結論に至りました。\n\nまた、データ分析組織にいながら、気づけば大規模システム刷新プロジェクトに専従していました。\n本来やりたかったのは、データから事業課題を発見し、アクションに繋げる仕事。でも実際は要件定義、ベンダー管理、報告── **「プロジェクトを進めること」「ベンダーを動かすこと」が目的化**していました。\n\n---\n\n## 2. 転職活動の全記録──準備から内定まで\n\n### 2-1. 準備フェーズ(活動開始の1ヶ月前)\n\n#### 職務経歴書の「翻訳」作業\n\n週末を使って約3週間、職務経歴書を何度も書き直しました。\n\n意識したのは以下の3点:\n1. 技術スタックを明記(クラウドサービス、BIツール等)\n2. 規模感を数字で示す(数十名規模のステークホルダー調整等)\n3. ビジネスインパクトを定量化(業務時間削減率等)\n\n特に「調整業務」は、そのまま書くと「ベンダーコントロールだけ」と思われるリスクがあるため、裏にある本質的なスキル(技術検証、優先度設計、段階的合意形成)を具体的に言語化しました。\n\n**年収レンジ:**\n提示されたレンジは700〜900万円。「データ分析者で、PL経験がある20代後半なら、このレンジは十分狙える」とのことでした。\n\n### 2-2. 活動フェーズ(1.5ヶ月の集中活動)\n\n#### リアルな活動量\n\n- **応募社数:23社**\n- **書類通過率:50%程度(約11社)**\n- **面接実施:6社程度**(途中で辞退したため)\n- **最終面接:4社**\n- **内定:2社(途中で活動終了)**\n- **活動期間:1.5ヶ月**\n\n**在職中の工夫:**\n- 平日夜:18時以降で面接設定\n- 有給休暇:半休を大いに活用（時には業務時間中に調整したものも...)\n\n正直、1.5ヶ月は体力的にも精神的にもきつかったですが、**短期集中だったからこそ、モチベーションを維持できました。**\n\n#### 応募企業の選定軸\n\n**必須条件:**\n- プライム上場企業(急成長 × ある程度の安定性)\n- 職種がデータエンジニア/サイエンティストのいずれか\n\n**柔軟に考えた条件:**\n- 業界・プロダクト領域:問わず\n- データ組織の形態:問わず\n\n**判断の優先度:**\n1. 技術スキルが伸びる環境か(モダンツール、自分で手を動かせる裁量)\n2. スピード感はあるか\n3. カルチャーフィット\n4. 年収・待遇\n\n#### 応募を見送った・途中で辞退した企業\n\n- データ活用が成熟していない企業\n- 自分のスキルが伸びなさそう(集計作業メイン、技術スタックが古い)\n- 「またベンダー任せ」になりそうな環境\n- スピード感への不安(意思決定プロセスが複雑)\n\n### 2-3. 選考フェーズ──JTC出身者が突かれる「3大質問」\n\n#### ① 「本当に自分で手を動かしてるの?」問題\n\n**実際に聞かれた質問:**\n- 「SQLはどの程度書けますか?」\n- 「Pythonでの実装経験を具体的に教えてください」\n- 「BIツールは自分で設計していますか?」\n\n**私の回答戦略:正直に「できること」「できないこと」を伝える**\n\nできないことを「できる」と言っても、技術面接で簡単にバレます。正直に答えつつ、業務外での学習(Kaggle、個人プロジェクト)をアピールしました。\n\n**「ベンダーコントロールだけでは?」への対処:**\n\n「現在の大規模プロジェクトは実装の多くをベンダー依頼していますが、それ以前のプロジェクトでは自分で設計から実装まで行いました」と説明。小〜中規模で「自分で実装した」プロジェクトを具体的に提示しました。\n\n#### ② 「スピード感についてこれる?」問題\n\n意外だったのは、**スピード感については、ほとんど聞かれなかった**ことです。JTCの意思決定の遅さは、面接官も理解していたようです。\n\nむしろ、「スピード感を求めて転職している」ことを自分から伝えることで、ポジティブに捉えてもらえました。\n\n#### ③ 「技術力、大丈夫?」問題\n\n**モダンツールの未経験について:**\n\n「業務では使ったことがありません。ただし、公式ドキュメント・チュートリアルを学習中、個人プロジェクトで環境を構築中です。入社後、3ヶ月でキャッチアップする計画です」\n\n**ポイント:** できないことを隠さず、「学習中」であることを具体的に示し、キャッチアップの計画を伝える。\n\n### 2-4. 面接で実際に聞かれた質問リスト\n\n#### 技術面接\n\n- 職務経歴書ベースの技術的な深掘り\n- 一部企業では事前課題やコーディングテスト\n- ライブコーディングはなし\n\n#### カルチャーフィット面接\n\nほぼすべての企業で似た質問:\n1. 転職理由の深掘り(100%聞かれる)\n2. 志望動機\n3. キャリアビジョン\n4. 過去の失敗・挫折経験\n5. チームワーク・コミュニケーション\n\n#### 効果的だった逆質問\n\n- 「データ組織の現在の課題と今後の方向性を教えてください」\n- 「入社後、最初に期待される成果は何ですか?」\n- 「現在のチームが抱えている、最も大きな課題は何ですか?」\n- 「入社後、3ヶ月でどんな成果を出せば『良い採用だった』と思ってもらえますか?」\n\n### 2-5. オファー・意思決定\n\n#### 2社からの内定\n\nどちらもプライム上場のSaaS企業、技術力が高いと評価されている企業、従業員のほとんどがキャリア採用者。\n\n**内定企業A社:**\n- 事業領域:BtoB SaaS\n- データ組織:中央集権型\n- オファー年収:約700万円\n- 魅力:高度なデータ分析基盤、技術的挑戦\n- 懸念:全社横断組織で事業部門との距離が遠い\n\n**内定企業B社(最終的に選択):**\n- 事業領域:BtoB SaaS\n- データ組織:事業部配属型\n- オファー年収:約800万円\n- 魅力:事業部の最前線、カルチャーへの強い共感。全社横断と事業それぞれにデータ組織をもつ。\n- 懸念:全社的なデータ基盤に関わるには社内異動の必要\n\n#### 最終的にB社を選んだ決め手\n\n**① カルチャーフィット**\n\nB社の企業理念を聞いた時、**「データは手段であって目的じゃない」** という自分の価値観と完全に一致しました。特に、ユーザの課題解決を最優先するバリュー、自分でものを作ることへの自責というバリューが、自分が転職で実現したかったことそのものでした。\n\n**② 年収アップ**\n\n現職から**100万円以上の年収アップ**は、市場価値が評価された証であり、決断を後押ししてくれました。\n\n**③ 事業の最前線でデータ活用ができる**\n\n事業部配属型のデータ組織で、事業部門と直接連携しながら仕事ができ、データ分析の結果がすぐにビジネスアクションに繋がる──JTCで感じていた「事業の最前線から遠い」という距離感を感じませんでした。\n\n#### 年収交渉・内定承諾から入社まで\n\n提示された年収が期待を大きく上回っていたため、年収交渉はしませんでした。\n\n退職交渉では**1.5ヶ月の引き継ぎ期間**で合意しました。\n**自身のキャリアは自身しか責任を持てません**。\n\n---\n\n## 3. JTC出身者の強みと弱み──客観的分析\n\n### 3-1. 思ったより評価された「3つの強み」\n\n**① 複雑なステークホルダー調整力**\n\n複数部門の調整経験は、スケールフェーズの企業に刺さりました。特に、役員への説明・承認プロセスの設計、複数部門の利害調整と段階的合意形成、優先度設計が評価されました。\n\n**② ドキュメンテーション・標準化意識**\n\nウォーターフォールで鍛えられた設計書文化、属人化排除への執着は、スケールフェーズの企業には必須スキルでした。\n\n**③ データ品質・ガバナンスへの感度**\n\nコンプライアンス・セキュリティへの理解、データ品質への意識は、急成長企業が「次に整備すべき領域」として注目されました。\n\n### 3-2. 思ったより評価されなかった「弱み」\n\n**① 技術スタックの古さ**\n\nモダンツール未経験は正直マイナス。ただし「キャッチアップ意欲」でカバー可能でした。\n\n**対処法:** 「業務では未経験だが、独学で学習中」と正直に伝え、具体的な学習内容を示し、入社後のキャッチアップ計画を提示。\n\n**② 「自分で手を動かす」実績の薄さ**\n\n**対処法:** 大規模PJだけでなく、小〜中規模で「自分で実装した」プロジェクトを強調。業務外での技術的取り組み(Kaggle、個人プロジェクト)をアピール。\n\n**③ スピード感への適応不安**\n\n**対処法:** JTCのスピード感に不満を持ち、改善したいと明確に伝える。入社後のキャッチアップ計画を具体的に示す。\n\n**ポイント:** JTC経験は「調整力だけ」では厳しいが、**「調整力 × 技術理解 × 学習意欲」の掛け算**なら十分に市場価値があります。\n\n---\n\n## 4. 転職活動を通じて学んだこと\n\n### 4-1. JTC経験の再評価\n\n**やはり足りなかったこと:** **「内製で作る意識・技術」が圧倒的に不足していました。**この不足が、転職活動で最も苦労したポイントでした。\n\n**今だから言える「JTCでやっておけばよかったこと」**\n\nJTCにいる間、**ワークライフバランスは保たれていました。**その余剰時間を使って、市場で求められているスキルの把握、モダンツールの学習、Kaggleや個人プロジェクトでの実装経験、GitHubでのアウトプットをもっと積極的にやっておけばよかったと後悔しています。\n\n**「業務でできないなら、業務外でやればよかった」**──これが最大の学びです。\n\n### 4-2. 転職タイミング\n\n結論から言うと、**もっと早く動いてよかった**と思っています。\n\nタイミングの難しさはありますが、重要なのは年齢より「何を経験してきたか」です。\n今後のキャリアを見据え、現職に停滞感があった1年前に決断しても結果はあまり変わらなかったと思います。\n\n### 4-3. マインドセットの転換\n\n転職活動を通じて、最も大きく変わったのは**転職に対する考え方**でした。\n\n**転職は怖くない**\n\n実際に転職活動をしてみて、自分の市場価値を客観的に知ることができ、複数の企業から評価されることで自信がつき、選択肢があることが分かりました。\n\n**「とりあえず動いて、自分の価値を確かめることが大事」** ──これが最大の学びでした。\n\n転職活動は「転職すること」が目的ではありません。自分の市場価値を知る、今の環境を相対化する、キャリアの選択肢を広げるという意味で、定期的に行うべきだと感じました。\n\n重要なのは、**「今の環境しか知らない」という状態から抜け出すこと**　です。\n\n---\n\n## 5. これから転職を考える人へ──5つの具体的アドバイス\n\n### 5-1. いつ動き始めるべきか\n\n結論:**思い立ったら、すぐに動くべき**です。\n\n**自分のキャリアは自分しか考えてくれません。** 会社はあなたのキャリアに責任を持ちません。\n\n「もっとスキルをつけてから」と考えているうちに、時間だけが過ぎていきます。\n\n**まずは動いてみる。それで市場の反応を見る。これが最初の一歩です。**\n\n### 5-2. 何から始めればいいか\n\n最初にやるべきことは、**職務経歴書の作成とキャリアの棚卸し**です。\n\nただし、一人で悩む必要はありません。**生成AIを使って理詰めで考えましょう。**\n\n具体的には:\n1. これまでの業務内容を箇条書きで整理\n2. ChatGPTやClaudeに「この経験を職務経歴書に書くならどう表現すべきか」と相談\n3. 複数の表現パターンを生成AIで作ってもらい、最適なものを選ぶ\n\n**並行してやるべきこと:**\n- 転職エージェントへの登録(まずは情報収集)\n- 転職サイトで求人を眺める(市場感覚を掴む)\n\n完璧な準備ができてから動くのではなく、**動きながら準備を整える**のが効率的です。\n\n### 5-3. 準備期間にやるべきこと\n\n- SPIの対策(事前に問題集を1冊)\n- プログラミング試験の対策(AtCoderなどで基礎的なアルゴリズム問題)\n- 技術キャッチアップ(市場で求められているツールに合わせた基礎学習)\n\n### 5-4. やってよかったこと\n\n**生成AIを使って理詰めで準備したこと**です。想定質問に対する回答、志望動機の複数パターン作成、面接後の振り返りなど、**用意周到に準備することで、面接での自信につながりました。**\n\n### 5-5. やらなくてよかったこと\n\n**現職に過度なリソースを割くこと**です。\n\nどうせ転職するなら、残業は最小限に、新しい大きな仕事は引き受けず、プロジェクトの区切りで動く。\n\n**「もう辞める会社」に全力を注ぐより、「これから入る会社」のための準備に時間を使うべき**でした。\n\n---\n\n## 6. 「転職しない」という選択肢について\n\n### 6-1. JTCに残るメリットの再確認\n\n**最大のメリット:安定性**\n\n年功序列の昇給、手厚い福利厚生、雇用の安定性。特にライフイベントを控えている場合、この安定性は大きな価値があります。\n\n**その他のメリット:**\n- 大規模プロジェクトのマネジメント経験が積める\n- 複雑な組織での調整力が身につく\n- ワークライフバランスが保たれている\n\n転職が全てではありません。自分の価値観と照らし合わせて、JTCに残る選択も十分にありえます。\n\n### 6-2. 社内異動という第3の選択肢\n\n私自身、社内公募で異動した経験があります。\n\n**社内異動のメリット:**\n- リスクが低い(給与・雇用は維持される)\n- **スキル面はポテンシャルで見られる**(未経験でも挑戦しやすい)\n- 転職に比べてハードルが低い\n\n特に重要なのは、**全くの未経験からいきなり転職するのは難しい**という点です。\n\n**社内異動のデメリット:**\n- **環境変化によって得られるスキルには天井がある**\n- ベンダー依存の体質は変わらない\n- 意思決定のスピード感は変わらない\n\n**戦略的には:** まず社内異動で希望職種の経験を積む → 2〜3年経験を積んだら転職市場での評価を確認 → 市場価値が上がったタイミングで転職、という2ステップが現実的かもしれません。\n\n### 6-3. 転職すべき人・しないほうがいい人\n\n**転職すべき人:**\n\n1. 「自分で手を動かせない」ことに強いストレスを感じている人\n2. 事業成長への直接貢献を実感したい人\n3. 市場価値を高めたい・キャリアの選択肢を広げたい人\n\n**転職しないほうがいい人:**\n\n1. 安定・福利厚生を最優先する人\n2. 大規模調整業務にやりがいを感じている人\n3. まだ経験が浅い人(入社3年未満)\n\n**最も重要なのは:** 転職するかしないかではなく、**「自分のキャリアを主体的に考えているか」**です。\n\n---\n\n## 7. おわりに\n\n### 7-1. 転職活動の総括\n\n1.5ヶ月の転職活動を振り返って──\n\n**非常に晴々とした気持ちです。次が楽しみでしょうがない。**\n\n**自分で選択した未来に向かって進んでいる**という実感が、何よりも大きな自信になっています。\n\n### 7-2. 新天地での抱負\n\n**短期的な目標(1〜2年):**\n\n**自身のキャリアを主体的に選択できるだけのポータブルスキルを身につけたい**です。モダンなツールの実装経験、データモデリングの実践、自分で手を動かして価値を生み出す経験を積み上げたいと思います。\n\n**中長期的な目標(3年〜):**\n\n**優秀な仲間と刺激的な仕事を行なっていきたい**です。データ活用の仕組み化・標準化を推進し、属人化しない持続可能なデータ組織の構築に貢献したいです。\n\nJTCで培った「調整力」「仕組み化への執着」に「技術力」を掛け合わせることで、より大きな価値を生み出せると信じています。\n\n### 7-3. 最後のメッセージ\n\nこの記事を読んでくださった、あなたへ。\n\n**自分のキャリアは自分で作る。**\n\nこれが、転職活動を通じて最も強く感じたことです。\n\n**人生のなかで仕事の時間は長い。どうせやるなら、より刺激のある方へ。**\n\n**まずは動いてみる。それで市場の反応を見る。**\n\n転職活動は「転職すること」が目的ではありません。自分の市場価値を知る、今の環境を相対化する、キャリアの選択肢を広げるという意味で、定期的に行うべきだと思います。\n\n重要なのは、**「今の環境しか知らない」という状態から抜け出すこと**です。\n\n---\n\n## 補足:参考情報\n\n### 使った転職サービス\n\n**メインで利用:**\n- **doda(総合型エージェント)**\n  - データ職の求人数が豊富、担当エージェントが親身、面接対策・日程調整が手厚い\n\n**サブで利用:**\n- **ビズリーチ(ダイレクトリクルーティング)**\n  - 企業からのスカウトで市場価値を確認\n- **リファラル**\n  - カルチャーフィットが事前にわかる\n\n### その他の学習リソース\n\n**技術学習:**\n- Udemy(モダンツールの講座)\n- 公式ドキュメント\n- Kaggle(データ分析コンペ)\n- AtCoder(プログラミング試験対策)\n\n**情報収集:**\n- Qiita、Zenn(データ分析者の体験記)\n- 各社のテックブログ\n\n**面接対策:**\n- 生成AI(ChatGPT、Claude)での想定質問・回答作成\n- 転職会議、OpenWork(企業の口コミ確認)\n\n---\n\n**以上で、この転職体験記は終わりです。**\n\n最後まで読んでいただき、ありがとうございました。\nあなたのキャリアが、より良い方向に進むことを願っています。\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:12:27+09:00",
      "group": null,
      "id": "5cba114f9aea99aa3c1e",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 1,
      "tags": [
        {
          "name": "ポエム",
          "versions": []
        },
        {
          "name": "転職",
          "versions": []
        }
      ],
      "title": "30歳を前に決断した、JTCデータ分析組織からSaaS企業への転職記録",
      "updated_at": "2025-12-11T13:16:00+09:00",
      "url": "https://qiita.com/ebimontblanc/items/5cba114f9aea99aa3c1e",
      "user": {
        "description": "",
        "facebook_id": "",
        "followees_count": 3,
        "followers_count": 1,
        "github_login_name": null,
        "id": "ebimontblanc",
        "items_count": 11,
        "linkedin_id": "",
        "location": "",
        "name": "きみょー",
        "organization": "",
        "permanent_id": 2355769,
        "profile_image_url": "https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/2355769/50e6c4b20c6bb31e02aa0b1a1ad6ec9b6c5cc00a/x_large.png?1752253988",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-4:157\">ソフトウェア開発では既存のクラスに新しい機能を追加したいという場面がよくあります。 しかし、単純に継承を重ねていくとクラスが増えすぎてしまい、保守性が低下するという問題に直面します。<br>\nそんなときに役立つのが<code>デコレータパターン</code>です。<br>\n<code>デコレータパターン</code>を使えば、オブジェクトをラップすることで柔軟に機能を追加でき、拡張性と保守性を両立できます。<br>\n本記事ではゲーム風のコードを用いて、コンソールでできる<code>デコレータパターン</code>のチュートリアルを紹介します。</p>\n<h1 data-sourcepos=\"5:1-5:14\">\n<span id=\"前提知識\" class=\"fragment\"></span><a href=\"#%E5%89%8D%E6%8F%90%E7%9F%A5%E8%AD%98\"><i class=\"fa fa-link\"></i></a>前提知識</h1>\n<ul data-sourcepos=\"6:1-6:45\">\n<li data-sourcepos=\"6:1-6:45\">\n<code>C++</code>の基礎文法を理解している</li>\n</ul>\n<h1 data-sourcepos=\"7:1-7:35\">\n<span id=\"デコレータパターンとは\" class=\"fragment\"></span><a href=\"#%E3%83%87%E3%82%B3%E3%83%AC%E3%83%BC%E3%82%BF%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%A8%E3%81%AF\"><i class=\"fa fa-link\"></i></a>デコレータパターンとは</h1>\n<p data-sourcepos=\"8:1-10:214\"><code>デコレータパターン</code>とは、既存のオブジェクトを<code>ラップ</code>して機能を追加するデザインパターンです。<br>\n<code>継承</code>を使わずに柔軟に拡張できることが長所です。<br>\nその一方で、単に<code>継承</code>で機能を追加するよりもオブジェクト生成のロジックが煩雑になり、可読性が低下する可能性があるといったデメリットがあります。</p>\n<h1 data-sourcepos=\"11:1-11:47\">\n<span id=\"デコレータパターンの構成と用語\" class=\"fragment\"></span><a href=\"#%E3%83%87%E3%82%B3%E3%83%AC%E3%83%BC%E3%82%BF%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%AE%E6%A7%8B%E6%88%90%E3%81%A8%E7%94%A8%E8%AA%9E\"><i class=\"fa fa-link\"></i></a>デコレータパターンの構成と用語</h1>\n<p data-sourcepos=\"12:1-12:91\"><code>デコレータパターン</code>は、以下のようクラスで構成されています。</p>\n<ul data-sourcepos=\"14:1-22:0\">\n<li data-sourcepos=\"14:1-15:73\">\n<strong>Component（コンポーネント）</strong>\n<ul data-sourcepos=\"15:5-15:73\">\n<li data-sourcepos=\"15:5-15:73\">抽象的な「インターフェース」や「基底クラス」</li>\n</ul>\n</li>\n<li data-sourcepos=\"16:1-17:82\">\n<strong>ConcreteComponent（具象コンポーネント）</strong>\n<ul data-sourcepos=\"17:5-17:82\">\n<li data-sourcepos=\"17:5-17:82\">そのインターフェースを 実際に実装した具体的なクラス</li>\n</ul>\n</li>\n<li data-sourcepos=\"18:1-19:75\">\n<strong>Decorator（抽象デコレータ）</strong>\n<ul data-sourcepos=\"19:5-19:75\">\n<li data-sourcepos=\"19:5-19:75\">機能追加のためのラップ構造を定義する抽象クラス</li>\n</ul>\n</li>\n<li data-sourcepos=\"20:1-22:0\">\n<strong>ConcreteDecorator（具象デコレータ）</strong>\n<ul data-sourcepos=\"21:5-22:0\">\n<li data-sourcepos=\"21:5-22:0\">実際に<code>Component</code>に効果などを追加する 具体的な拡張クラス</li>\n</ul>\n</li>\n</ul>\n<p data-sourcepos=\"23:1-24:125\"><code>デザインパターン</code>の文脈で、<code>Concrete</code>という言葉は、具体的な実装を持つクラス という意味で使用される言葉です。<br>\n<code>Decorator</code>は、<code>Component</code>をラップして機能を追加する仕組みと理解してもらえるとよいです。</p>\n<div data-sourcepos=\"26:1-28:3\" class=\"note warn\">\n<span class=\"fa fa-fw fa-exclamation-circle\"></span><div>\n<p data-sourcepos=\"27:1-27:183\">ここでいう<code>Component</code>は<code>Unity</code>の<code>Component</code>のような部品という意味ではなく「<code>ラップ</code>される対象の抽象型」という意味合いなので注意</p>\n</div>\n</div>\n<h3 data-sourcepos=\"29:1-29:19\">\n<span id=\"構造の図解\" class=\"fragment\"></span><a href=\"#%E6%A7%8B%E9%80%A0%E3%81%AE%E5%9B%B3%E8%A7%A3\"><i class=\"fa fa-link\"></i></a>構造の図解</h3>\n<iframe id=\"qiita-embed-content__8ae30c6a68f55993ab303bd3bf53bb5c\" src=\"https://qiita.com/embed-contents/mermaid#qiita-embed-content__8ae30c6a68f55993ab303bd3bf53bb5c\" style=\"width:100%;\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-content='{\"data\":\"classDiagram\\n class Component {\\n &lt;&lt;インターフェース&gt;&gt;\\n +operation()\\n // 共通インターフェース。基本機能を定義する\\n }\\n\\n class ConcreteComponent {\\n +operation()\\n // 具象コンポーネント。実際の基本機能を持つクラス\\n }\\n\\n class Decorator {\\n &lt;&lt;抽象クラス&gt;&gt;\\n -Component component\\n +operation()\\n // 抽象デコレータ。Componentを保持し、処理を委譲する仕組みを持つ\\n }\\n\\n class ConcreteDecorator {\\n +operation()\\n +addedBehavior()\\n // 具象デコレータ。追加機能を実装するクラス\\n // 必要に応じて複数組み合わせ可能\\n }\\n\\n Component &lt;|.. ConcreteComponent\\n Component &lt;|.. Decorator\\n Decorator &lt;|-- ConcreteDecorator\\n Decorator o--&gt; Component\",\"key\":\"afe2cc08a9a3a48ec76801bddd509441\"}'>\n</iframe>\n\n<h1 data-sourcepos=\"62:1-62:14\">\n<span id=\"コード例\" class=\"fragment\"></span><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>コード例</h1>\n<h3 data-sourcepos=\"63:1-63:61\">\n<span id=\"ラーメンにトッピングを乗せていくコード\" class=\"fragment\"></span><a href=\"#%E3%83%A9%E3%83%BC%E3%83%A1%E3%83%B3%E3%81%AB%E3%83%88%E3%83%83%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E4%B9%97%E3%81%9B%E3%81%A6%E3%81%84%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89\"><i class=\"fa fa-link\"></i></a>ラーメンにトッピングを乗せていくコード</h3>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"64:1-89:3\">\n<div class=\"code-lang\"><span class=\"bold\">IRamen.h</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file   IRamen.h</span>\n<span class=\"c1\">//! @brief  ラーメンの基本インターフェースを定義するヘッダファイル</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#pragma once\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class  ラーメンの基本インターフェース</span>\n<span class=\"c1\">//! @note   DecoratorパターンのComponent(コンポーネント)の役割を担うクラス</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">IRamen</span> <span class=\"p\">{</span>\n<span class=\"nl\">public:</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">//! @brief ラーメンを確認する処理</span>\n\t<span class=\"c1\">//! @note  デザインパターンの文脈でいう「operation」関数に相当する</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"k\">virtual</span> <span class=\"kt\">void</span> <span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">//! @brief 仮想デストラクタ</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"k\">virtual</span> <span class=\"o\">~</span><span class=\"n\">IRamen</span><span class=\"p\">()</span> <span class=\"o\">=</span> <span class=\"k\">default</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"90:1-110:3\">\n<div class=\"code-lang\"><span class=\"bold\">RamenBase.h</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file\tRamenBase.h</span>\n<span class=\"c1\">//! @brief  基本ラーメンのクラス定義</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#pragma once\n#include</span> <span class=\"cpf\">\"IRamen.h\"</span><span class=\"cp\">\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class  基本ラーメンのクラス</span>\n<span class=\"c1\">//! @note   DecoratorパターンのConcreteComponent(具象コンポーネント)の役割を担うクラス</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">RamenBase</span> <span class=\"o\">:</span> <span class=\"k\">public</span> <span class=\"n\">IRamen</span> <span class=\"p\">{</span>\n<span class=\"nl\">public:</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// ラーメンを確認する処理</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"kt\">void</span> <span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"k\">override</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"111:1-126:3\">\n<div class=\"code-lang\"><span class=\"bold\">RamenBase.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file\tRamenBase.cpp</span>\n<span class=\"c1\">//! @brief  基本ラーメンのクラス実装</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">\"RamenBase.h\"</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">&lt;iostream&gt;</span><span class=\"cp\">\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief  基本内容のラーメンを確認する処理の</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"kt\">void</span> <span class=\"n\">RamenBase</span><span class=\"o\">::</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"c1\">// ラーメンの基本内容を表示</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"現在のラーメン : ラーメン + スープ\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">flush</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"127:1-156:3\">\n<div class=\"code-lang\"><span class=\"bold\">ToppingDecorator.h</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file   ToppingDecorator.h</span>\n<span class=\"c1\">//! @brief  トッピングデコレータのクラス定義</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#pragma once\n#include</span> <span class=\"cpf\">\"IRamen.h\"</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">&lt;memory&gt;</span><span class=\"cp\">\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class トッピングデコレータのクラス</span>\n<span class=\"c1\">//! @note  DecoratorパターンのDecorator(抽象デコレータ)の役割を担うクラス</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">ToppingDecorator</span> <span class=\"o\">:</span> <span class=\"k\">public</span> <span class=\"n\">IRamen</span> <span class=\"p\">{</span>\n<span class=\"nl\">protected:</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">inner_ramen_</span><span class=\"p\">;</span> <span class=\"c1\">// ラップ対象のラーメン</span>\n<span class=\"nl\">public:</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// コンストラクタ</span>\n\t<span class=\"c1\">//! @param ramen [in] ラップ対象のラーメン</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"n\">ToppingDecorator</span><span class=\"p\">(</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">ramen</span><span class=\"p\">);</span>\n\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// ラーメンを確認する処理</span>\n\t<span class=\"c1\">//! @note  ラップして対象のラーメンから確認処理を委譲する</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"kt\">void</span> <span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"k\">override</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"157:1-177:3\">\n<div class=\"code-lang\"><span class=\"bold\">ToppingDecorator.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file   ToppingDecorator.cpp</span>\n<span class=\"c1\">//! @brief  トッピングデコレータのクラス実装</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">\"ToppingDecorator.h\"</span><span class=\"cp\">\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief コンストラクタ</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"n\">ToppingDecorator</span><span class=\"o\">::</span><span class=\"n\">ToppingDecorator</span><span class=\"p\">(</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">ramen</span><span class=\"p\">)</span>\n\t<span class=\"o\">:</span> <span class=\"n\">inner_ramen_</span><span class=\"p\">(</span><span class=\"n\">ramen</span><span class=\"p\">)</span> <span class=\"p\">{</span>\t\t<span class=\"c1\">// ラップ対象のラーメンを保存</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief ラーメンを確認する処理</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"kt\">void</span> <span class=\"n\">ToppingDecorator</span><span class=\"o\">::</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"n\">inner_ramen_</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t<span class=\"c1\">// ラップして対象のラーメンから確認処理を委譲</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"178:1-204:3\">\n<div class=\"code-lang\"><span class=\"bold\">EggDecorator.h</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file   EggDecorator.h</span>\n<span class=\"c1\">//! @brief  味玉追加デコレータのクラス定義</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#pragma once\n#include</span> <span class=\"cpf\">\"ToppingDecorator.h\"</span><span class=\"cp\">\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class 味玉追加デコレータのクラス</span>\n<span class=\"c1\">//! @note  DecoratorパターンのConcreteDecorator(具体的デコレータ)の役割を担うクラス</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">EggDecorator</span> <span class=\"o\">:</span> <span class=\"k\">public</span> <span class=\"n\">ToppingDecorator</span> <span class=\"p\">{</span>\n<span class=\"nl\">public:</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// コンストラクタ</span>\n\t<span class=\"c1\">//! @param ramen [in] ラップ対象のラーメン</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"n\">EggDecorator</span><span class=\"p\">(</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">ramen</span><span class=\"p\">);</span>\n\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// ラーメンを確認する処理</span>\n\t<span class=\"c1\">//! @note  ラップ対象のラーメンに味玉を追加して確認</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"kt\">void</span> <span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"k\">override</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"205:1-227:3\">\n<div class=\"code-lang\"><span class=\"bold\">EggDecorator.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file\tEggDecorator.cpp</span>\n<span class=\"c1\">//! @brief  味玉追加デコレータのクラス実装</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">\"EggDecorator.h\"</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">&lt;iostream&gt;</span><span class=\"cp\">\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief コンストラクタ</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"n\">EggDecorator</span><span class=\"o\">::</span><span class=\"n\">EggDecorator</span><span class=\"p\">(</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">ramen</span><span class=\"p\">)</span>\n\t<span class=\"o\">:</span> <span class=\"n\">ToppingDecorator</span><span class=\"p\">(</span><span class=\"n\">ramen</span><span class=\"p\">)</span> <span class=\"p\">{</span>\t\t<span class=\"c1\">// 抽象デコレータクラスのコンストラクタを呼び出す</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief ラーメンを確認する処理</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"kt\">void</span> <span class=\"n\">EggDecorator</span><span class=\"o\">::</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"n\">inner_ramen_</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t\t\t\t<span class=\"c1\">// ラップした対象のラーメンから確認処理を委譲</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\" + 味玉\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">flush</span><span class=\"p\">;</span>\t<span class=\"c1\">// 味玉を追加表示</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"228:1-254:3\">\n<div class=\"code-lang\"><span class=\"bold\">RoastPorkDecorator.h</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file   RoastPorkDecorator.h</span>\n<span class=\"c1\">//! @brief  チャーシュー追加デコレータのクラス定義</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#pragma once\n#include</span> <span class=\"cpf\">\"ToppingDecorator.h\"</span><span class=\"cp\">\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class チャーシュー追加デコレータのクラス</span>\n<span class=\"c1\">//! @note  DecoratorパターンのConcreteDecorator(具体的デコレータ)の役割を担うクラス</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">RoastPorkDecorator</span> <span class=\"o\">:</span> <span class=\"k\">public</span> <span class=\"n\">ToppingDecorator</span> <span class=\"p\">{</span>\n<span class=\"nl\">public:</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// コンストラクタ</span>\n\t<span class=\"c1\">//! @param ramen [in] ラップ対象のラーメン</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n    <span class=\"n\">RoastPorkDecorator</span><span class=\"p\">(</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">ramen</span><span class=\"p\">);</span>\n\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// ラーメンを確認する処理</span>\n\t<span class=\"c1\">//! @note  ラップ対象のラーメンにチャーシューを追加して確認</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n    <span class=\"kt\">void</span> <span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"k\">override</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"255:1-277:3\">\n<div class=\"code-lang\"><span class=\"bold\">RoastPorkDecorator.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file   RoastPorkDecorator.cpp</span>\n<span class=\"c1\">//! @brief  チャーシュー追加デコレータのクラス実装</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">\"RoastPorkDecorator.h\"</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">&lt;iostream&gt;</span><span class=\"cp\">\n</span><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief コンストラクタ</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"n\">RoastPorkDecorator</span><span class=\"o\">::</span><span class=\"n\">RoastPorkDecorator</span><span class=\"p\">(</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">ramen</span><span class=\"p\">)</span>\n\t<span class=\"o\">:</span> <span class=\"n\">ToppingDecorator</span><span class=\"p\">(</span><span class=\"n\">ramen</span><span class=\"p\">)</span> <span class=\"p\">{</span>\t\t<span class=\"c1\">// 抽象デコレータクラスのコンストラクタを呼び出す</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief ラーメンを確認する処理</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"kt\">void</span> <span class=\"n\">RoastPorkDecorator</span><span class=\"o\">::</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"n\">inner_ramen_</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t\t\t\t\t\t<span class=\"c1\">// ラップした対象のラーメンから確認処理を委譲</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\" + チャーシュー\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">flush</span><span class=\"p\">;</span>\t<span class=\"c1\">// チャーシューを追加表示</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"278:1-322:3\">\n<div class=\"code-lang\"><span class=\"bold\">main.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @file\tmain.cpp</span>\n<span class=\"c1\">//! @brief  デコレータパターンによるラーメン確認処理の実装例</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">\"IRamen.h\"</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">\"RamenBase.h\"</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">\"EggDecorator.h\"</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">\"RoastPorkDecorator.h\"</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">&lt;memory&gt;</span><span class=\"cp\">\n#include</span> <span class=\"cpf\">&lt;iostream&gt;</span><span class=\"cp\">\n</span><span class=\"c1\">//エントリポイント</span>\n<span class=\"kt\">int</span> <span class=\"nf\">main</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// 基本ラーメンを作成して確認</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">ramen</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">make_shared</span><span class=\"o\">&lt;</span><span class=\"n\">RamenBase</span><span class=\"o\">&gt;</span><span class=\"p\">();</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"スープと麺だけのラーメンが完成\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">ramen</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t<span class=\"c1\">// 現在のラーメンを確認</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// 味玉デコレータでラップ</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"n\">ramen</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">make_shared</span><span class=\"o\">&lt;</span><span class=\"n\">EggDecorator</span><span class=\"o\">&gt;</span><span class=\"p\">(</span><span class=\"n\">ramen</span><span class=\"p\">);</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"味玉を追加\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">ramen</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t<span class=\"c1\">// 現在のラーメンを確認</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// チャーシューデコレータでラップ</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"n\">ramen</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">make_shared</span><span class=\"o\">&lt;</span><span class=\"n\">RoastPorkDecorator</span><span class=\"o\">&gt;</span><span class=\"p\">(</span><span class=\"n\">ramen</span><span class=\"p\">);</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"チャーシューを追加\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">ramen</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t<span class=\"c1\">// 現在のラーメンを確認</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"c1\">//終了</span>\n\t<span class=\"k\">return</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"\" data-sourcepos=\"323:1-336:3\">\n<div class=\"code-lang\"><span class=\"bold\">result</span></div>\n<div class=\"highlight\"><pre><code>--------------------------------------------\nスープと麺だけのラーメンが完成\n--------------------------------------------\n現在のラーメン : ラーメン + スープ\n--------------------------------------------\n味玉を追加\n--------------------------------------------\n現在のラーメン : ラーメン + スープ + 味玉\n--------------------------------------------\nチャーシューを追加\n--------------------------------------------\n現在のラーメン : ラーメン + スープ + 味玉 + チャーシュー\n</code></pre></div>\n</div>\n<p data-sourcepos=\"337:1-337:81\">ラーメンにトッピングを追加していくことに成功しました。</p>\n<h3 data-sourcepos=\"338:1-338:16\">\n<span id=\"クラス図\" class=\"fragment\"></span><a href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E5%9B%B3\"><i class=\"fa fa-link\"></i></a>クラス図</h3>\n<iframe id=\"qiita-embed-content__db0e84e36e609c2f9841a11dfc46cd7f\" src=\"https://qiita.com/embed-contents/mermaid#qiita-embed-content__db0e84e36e609c2f9841a11dfc46cd7f\" style=\"width:100%;\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-content='{\"data\":\"classDiagram\\n class IRamen {\\n &lt;&lt;共通インターフェース(Component)&gt;&gt;\\n +check() ラーメンを確認する処理 (operationに相当)\\n }\\n\\n class RamenBase {\\n +check() 基本ラーメンを確認する処理\\n }\\n\\n class ToppingDecorator {\\n &lt;&lt;抽象デコレータ&gt;&gt;\\n -IRamen inner_ramen_ ラップ対象のラーメン\\n +check() 内側のラーメンに処理を委譲\\n }\\n\\n class EggDecorator {\\n +check() 味玉を追加して確認\\n }\\n\\n class RoastPorkDecorator {\\n +check() チャーシューを追加して確認\\n }\\n\\n %% 関係の矢印\\n IRamen &lt;|.. RamenBase : 実装 (ConcreteComponent)\\n IRamen &lt;|.. ToppingDecorator : 継承 (Decorator)\\n ToppingDecorator &lt;|-- EggDecorator : 具体的デコレータ\\n ToppingDecorator &lt;|-- RoastPorkDecorator : 具体的デコレータ\\n ToppingDecorator o--&gt; IRamen : ラップ対象を保持\",\"key\":\"0b38561c39979b4e4b9f23e79d05f386\"}'>\n</iframe>\n\n<h3 data-sourcepos=\"371:1-371:15\">\n<span id=\"operation\" class=\"fragment\"></span><a href=\"#operation\"><i class=\"fa fa-link\"></i></a>operation()</h3>\n<p data-sourcepos=\"372:1-373:139\"><code>IRamen</code>にある<code>check()</code>は<code>デザインパターンの文脈</code>でよく<code>operation()</code>とよばれる関数にあたり、ラップしたオブジェクトの同名の関数を呼び出してから処理を追加します。<br>\nこの仕組みによって実行中に柔軟に機能を追加でき、<code>継承</code>を使わずに拡張性を保つことができます。</p>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"374:1-380:3\">\n<div class=\"code-lang\"><span class=\"bold\">IRamen.h</span></div>\n<div class=\"highlight\"><pre><code>\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">//! @brief ラーメンを確認する処理</span>\n\t<span class=\"c1\">//! @note  デザインパターンの文脈でいう「operation」関数に相当する</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"k\">virtual</span> <span class=\"kt\">void</span> <span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"c++\" data-sourcepos=\"381:1-389:3\">\n<div class=\"code-lang\"><span class=\"bold\">RamenBase.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief  基本内容のラーメンを確認する処理の</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"kt\">void</span> <span class=\"n\">RamenBase</span><span class=\"o\">::</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"c1\">// ラーメンの基本内容を表示</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"現在のラーメン : ラーメン + スープ\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">flush</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"390:1-397:3\">\n<div class=\"code-lang\"><span class=\"bold\">ToppingDecorator.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief ラーメンを確認する処理</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"kt\">void</span> <span class=\"n\">ToppingDecorator</span><span class=\"o\">::</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"n\">inner_ramen_</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t<span class=\"c1\">// ラップして対象のラーメンから確認処理を委譲</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"398:1-406:3\">\n<div class=\"code-lang\"><span class=\"bold\">EggDecorator.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief ラーメンを確認する処理</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"kt\">void</span> <span class=\"n\">EggDecorator</span><span class=\"o\">::</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"n\">inner_ramen_</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t\t\t\t<span class=\"c1\">// ラップした対象のラーメンから確認処理を委譲</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\" + 味玉\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">flush</span><span class=\"p\">;</span>\t<span class=\"c1\">// 味玉を追加表示</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"407:1-415:3\">\n<div class=\"code-lang\"><span class=\"bold\">RoastPorkDecorator.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @brief ラーメンを確認する処理</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"kt\">void</span> <span class=\"n\">RoastPorkDecorator</span><span class=\"o\">::</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\t<span class=\"n\">inner_ramen_</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t\t\t\t\t\t<span class=\"c1\">// ラップした対象のラーメンから確認処理を委譲</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\" + チャーシュー\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">flush</span><span class=\"p\">;</span>\t<span class=\"c1\">// チャーシューを追加表示</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n<h1 data-sourcepos=\"416:1-416:27\">\n<span id=\"decoratorデコレータ\" class=\"fragment\"></span><a href=\"#decorator%E3%83%87%E3%82%B3%E3%83%AC%E3%83%BC%E3%82%BF\"><i class=\"fa fa-link\"></i></a>Decorator/デコレータ</h1>\n<p data-sourcepos=\"417:1-417:339\"><code>Decoratorパターン</code>では、<code>デコレータ</code>にも<code>ConcreteComponent/具象コンポーネント</code>が<code>継承</code>している<code>共通インターフェース/Component</code>を<code>継承</code>することで、<code>アップキャスト</code>を使用して<code>具象デコレータ</code>から<code>operation()</code>を呼べる仕組みとなっています。</p>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"418:1-428:3\">\n<div class=\"code-lang\"><span class=\"bold\">RamenBase.h</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class  基本ラーメンのクラス</span>\n<span class=\"c1\">//! @note   DecoratorパターンのConcreteComponent(具象コンポーネント)の役割を担うクラス</span>\n<span class=\"c1\">//! @author つきの</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">RamenBase</span> <span class=\"o\">:</span> <span class=\"k\">public</span> <span class=\"n\">IRamen</span> <span class=\"p\">{</span>\n<span class=\"nl\">public:</span>\n\t<span class=\"c1\">// 中略</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"429:1-437:3\">\n<div class=\"code-lang\"><span class=\"bold\">ToppingDecorator.h</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class トッピングデコレータのクラス</span>\n<span class=\"c1\">//! @note  DecoratorパターンのDecorator(抽象デコレータ)の役割を担うクラス</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">ToppingDecorator</span> <span class=\"o\">:</span> <span class=\"k\">public</span> <span class=\"n\">IRamen</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// 中略</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"438:1-446:3\">\n<div class=\"code-lang\"><span class=\"bold\">EggDecorator.cpp</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class 味玉追加デコレータのクラス</span>\n<span class=\"c1\">//! @note  DecoratorパターンのConcreteDecorator(具体的デコレータ)の役割を担うクラス</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">EggDecorator</span> <span class=\"o\">:</span> <span class=\"k\">public</span> <span class=\"n\">ToppingDecorator</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// 中略</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"447:1-455:3\">\n<div class=\"code-lang\"><span class=\"bold\">RoastPorkDecorator.h</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"c1\">//! @class チャーシュー追加デコレータのクラス</span>\n<span class=\"c1\">//! @note  DecoratorパターンのConcreteDecorator(具体的デコレータ)の役割を担うクラス</span>\n<span class=\"c1\">//-------------------------------------------------------------</span>\n<span class=\"k\">class</span> <span class=\"nc\">RoastPorkDecorator</span> <span class=\"o\">:</span> <span class=\"k\">public</span> <span class=\"n\">ToppingDecorator</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// 中略</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n<div class=\"code-frame\" data-lang=\"cpp\" data-sourcepos=\"456:1-484:3\">\n<div class=\"code-lang\"><span class=\"bold\">main.cpp</span></div>\n<div class=\"highlight\"><pre><code>\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// 基本ラーメンを作成して確認</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">IRamen</span><span class=\"o\">&gt;</span> <span class=\"n\">ramen</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">make_shared</span><span class=\"o\">&lt;</span><span class=\"n\">RamenBase</span><span class=\"o\">&gt;</span><span class=\"p\">();</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"スープと麺だけのラーメンが完成\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">ramen</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t<span class=\"c1\">// 現在のラーメンを確認</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// 味玉デコレータでラップ</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"n\">ramen</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">make_shared</span><span class=\"o\">&lt;</span><span class=\"n\">EggDecorator</span><span class=\"o\">&gt;</span><span class=\"p\">(</span><span class=\"n\">ramen</span><span class=\"p\">);</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"味玉を追加\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">ramen</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t<span class=\"c1\">// 現在のラーメンを確認</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"c1\">// チャーシューデコレータでラップ</span>\n\t<span class=\"c1\">//-------------------------------------------------------------</span>\n\t<span class=\"n\">ramen</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">make_shared</span><span class=\"o\">&lt;</span><span class=\"n\">RoastPorkDecorator</span><span class=\"o\">&gt;</span><span class=\"p\">(</span><span class=\"n\">ramen</span><span class=\"p\">);</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"チャーシューを追加\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"--------------------------------------------\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\t<span class=\"n\">ramen</span><span class=\"o\">-&gt;</span><span class=\"n\">check</span><span class=\"p\">();</span>\t\t<span class=\"c1\">// 現在のラーメンを確認</span>\n\t<span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n</code></pre></div>\n</div>\n<h1 data-sourcepos=\"485:1-485:8\">\n<span id=\"総括\" class=\"fragment\"></span><a href=\"#%E7%B7%8F%E6%8B%AC\"><i class=\"fa fa-link\"></i></a>総括</h1>\n<ul data-sourcepos=\"486:1-487:134\">\n<li data-sourcepos=\"486:1-486:120\">\n<code>Decoratorパターン</code>を使用することで、実行中に柔軟に機能を追加することが可能となる</li>\n<li data-sourcepos=\"487:1-487:134\">ラップしたオブジェクトの<code>operation()</code>に機能を追加していくといったイメージで運用するのが適切</li>\n</ul>\n",
      "body": "ソフトウェア開発では既存のクラスに新しい機能を追加したいという場面がよくあります。 しかし、単純に継承を重ねていくとクラスが増えすぎてしまい、保守性が低下するという問題に直面します。\nそんなときに役立つのが``デコレータパターン``です。\n``デコレータパターン``を使えば、オブジェクトをラップすることで柔軟に機能を追加でき、拡張性と保守性を両立できます。\n本記事ではゲーム風のコードを用いて、コンソールでできる``デコレータパターン``のチュートリアルを紹介します。\n# 前提知識\n- ``C++``の基礎文法を理解している\n# デコレータパターンとは\n``デコレータパターン``とは、既存のオブジェクトを``ラップ``して機能を追加するデザインパターンです。\n``継承``を使わずに柔軟に拡張できることが長所です。\nその一方で、単に``継承``で機能を追加するよりもオブジェクト生成のロジックが煩雑になり、可読性が低下する可能性があるといったデメリットがあります。\n# デコレータパターンの構成と用語\n``デコレータパターン``は、以下のようクラスで構成されています。\n\n- **Component（コンポーネント）**\n    -  抽象的な「インターフェース」や「基底クラス」\n- **ConcreteComponent（具象コンポーネント）**\n    - そのインターフェースを 実際に実装した具体的なクラス\n- **Decorator（抽象デコレータ）**\n    - 機能追加のためのラップ構造を定義する抽象クラス\n- **ConcreteDecorator（具象デコレータ）**\n    - 実際に``Component``に効果などを追加する 具体的な拡張クラス\n\n``デザインパターン``の文脈で、``Concrete``という言葉は、具体的な実装を持つクラス という意味で使用される言葉です。\n``Decorator``は、``Component``をラップして機能を追加する仕組みと理解してもらえるとよいです。\n\n:::note warn\nここでいう``Component``は``Unity``の``Component``のような部品という意味ではなく「``ラップ``される対象の抽象型」という意味合いなので注意\n:::\n### 構造の図解\n```mermaid\nclassDiagram\n    class Component {\n        <<インターフェース>>\n        +operation()\n        // 共通インターフェース。基本機能を定義する\n    }\n\n    class ConcreteComponent {\n        +operation()\n        // 具象コンポーネント。実際の基本機能を持つクラス\n    }\n\n    class Decorator {\n        <<抽象クラス>>\n        -Component component\n        +operation()\n        // 抽象デコレータ。Componentを保持し、処理を委譲する仕組みを持つ\n    }\n\n    class ConcreteDecorator {\n        +operation()\n        +addedBehavior()\n        // 具象デコレータ。追加機能を実装するクラス\n        // 必要に応じて複数組み合わせ可能\n    }\n\n    Component <|.. ConcreteComponent\n    Component <|.. Decorator\n    Decorator <|-- ConcreteDecorator\n    Decorator o--> Component\n```\n# コード例\n### ラーメンにトッピングを乗せていくコード\n```cpp:IRamen.h\n//-------------------------------------------------------------\n//! @file   IRamen.h\n//! @brief  ラーメンの基本インターフェースを定義するヘッダファイル\n//! @author つきの\n//-------------------------------------------------------------\n#pragma once\n//-------------------------------------------------------------\n//! @class  ラーメンの基本インターフェース\n//! @note   DecoratorパターンのComponent(コンポーネント)の役割を担うクラス\n//! @author つきの\n//-------------------------------------------------------------\nclass IRamen {\npublic:\n\t//-------------------------------------------------------------\n\t//! @brief ラーメンを確認する処理\n\t//! @note  デザインパターンの文脈でいう「operation」関数に相当する\n\t//-------------------------------------------------------------\n\tvirtual void check() = 0;\n\n\t//-------------------------------------------------------------\n\t//! @brief 仮想デストラクタ\n\t//-------------------------------------------------------------\n\tvirtual ~IRamen() = default;\n};\n```\n```cpp:RamenBase.h\n//-------------------------------------------------------------\n//! @file\tRamenBase.h\n//! @brief  基本ラーメンのクラス定義\n//! @author つきの\n//-------------------------------------------------------------\n#pragma once\n#include \"IRamen.h\"\n//-------------------------------------------------------------\n//! @class  基本ラーメンのクラス\n//! @note   DecoratorパターンのConcreteComponent(具象コンポーネント)の役割を担うクラス\n//! @author つきの\n//-------------------------------------------------------------\nclass RamenBase : public IRamen {\npublic:\n\t//-------------------------------------------------------------\n\t// ラーメンを確認する処理\n\t//-------------------------------------------------------------\n\tvoid check() override;\n};\n```\n```cpp:RamenBase.cpp\n//-------------------------------------------------------------\n//! @file\tRamenBase.cpp\n//! @brief  基本ラーメンのクラス実装\n//! @author つきの\n//-------------------------------------------------------------\n#include \"RamenBase.h\"\n#include <iostream>\n//-------------------------------------------------------------\n//! @brief  基本内容のラーメンを確認する処理の\n//-------------------------------------------------------------\nvoid RamenBase::check() {\n\t// ラーメンの基本内容を表示\n\tstd::cout << \"現在のラーメン : ラーメン + スープ\" << std::flush;\n}\n```\n```cpp:ToppingDecorator.h\n//-------------------------------------------------------------\n//! @file   ToppingDecorator.h\n//! @brief  トッピングデコレータのクラス定義\n//! @author つきの\n//-------------------------------------------------------------\n#pragma once\n#include \"IRamen.h\"\n#include <memory>\n//-------------------------------------------------------------\n//! @class トッピングデコレータのクラス\n//! @note  DecoratorパターンのDecorator(抽象デコレータ)の役割を担うクラス\n//-------------------------------------------------------------\nclass ToppingDecorator : public IRamen {\nprotected:\n\tstd::shared_ptr<IRamen> inner_ramen_; // ラップ対象のラーメン\npublic:\n\t//-------------------------------------------------------------\n\t// コンストラクタ\n\t//! @param ramen [in] ラップ対象のラーメン\n\t//-------------------------------------------------------------\n\tToppingDecorator(std::shared_ptr<IRamen> ramen);\n\n\t//-------------------------------------------------------------\n\t// ラーメンを確認する処理\n\t//! @note  ラップして対象のラーメンから確認処理を委譲する\n\t//-------------------------------------------------------------\n\tvoid check() override;\n};\n```\n```cpp:ToppingDecorator.cpp\n//-------------------------------------------------------------\n//! @file   ToppingDecorator.cpp\n//! @brief  トッピングデコレータのクラス実装\n//! @author つきの\n//-------------------------------------------------------------\n#include \"ToppingDecorator.h\"\n//-------------------------------------------------------------\n//! @brief コンストラクタ\n//-------------------------------------------------------------\nToppingDecorator::ToppingDecorator(std::shared_ptr<IRamen> ramen)\n\t: inner_ramen_(ramen) {\t\t// ラップ対象のラーメンを保存\n}\n\n//-------------------------------------------------------------\n//! @brief ラーメンを確認する処理\n//-------------------------------------------------------------\nvoid ToppingDecorator::check() {\n\tinner_ramen_->check();\t// ラップして対象のラーメンから確認処理を委譲\n}\n```\n```cpp:EggDecorator.h\n//-------------------------------------------------------------\n//! @file   EggDecorator.h\n//! @brief  味玉追加デコレータのクラス定義\n//! @author つきの\n//-------------------------------------------------------------\n#pragma once\n#include \"ToppingDecorator.h\"\n//-------------------------------------------------------------\n//! @class 味玉追加デコレータのクラス\n//! @note  DecoratorパターンのConcreteDecorator(具体的デコレータ)の役割を担うクラス\n//-------------------------------------------------------------\nclass EggDecorator : public ToppingDecorator {\npublic:\n\t//-------------------------------------------------------------\n\t// コンストラクタ\n\t//! @param ramen [in] ラップ対象のラーメン\n\t//-------------------------------------------------------------\n\tEggDecorator(std::shared_ptr<IRamen> ramen);\n\n\t//-------------------------------------------------------------\n\t// ラーメンを確認する処理\n\t//! @note  ラップ対象のラーメンに味玉を追加して確認\n\t//-------------------------------------------------------------\n\tvoid check() override;\n};\n```\n```cpp:EggDecorator.cpp\n//-------------------------------------------------------------\n//! @file\tEggDecorator.cpp\n//! @brief  味玉追加デコレータのクラス実装\n//! @author つきの\n//-------------------------------------------------------------\n#include \"EggDecorator.h\"\n#include <iostream>\n//-------------------------------------------------------------\n//! @brief コンストラクタ\n//-------------------------------------------------------------\nEggDecorator::EggDecorator(std::shared_ptr<IRamen> ramen)\n\t: ToppingDecorator(ramen) {\t\t// 抽象デコレータクラスのコンストラクタを呼び出す\n}\n\n//-------------------------------------------------------------\n//! @brief ラーメンを確認する処理\n//-------------------------------------------------------------\nvoid EggDecorator::check() {\n\tinner_ramen_->check();\t\t\t\t\t// ラップした対象のラーメンから確認処理を委譲\n\tstd::cout << \" + 味玉\" << std::flush;\t// 味玉を追加表示\n}\n```\n```cpp:RoastPorkDecorator.h\n//-------------------------------------------------------------\n//! @file   RoastPorkDecorator.h\n//! @brief  チャーシュー追加デコレータのクラス定義\n//! @author つきの\n//-------------------------------------------------------------\n#pragma once\n#include \"ToppingDecorator.h\"\n//-------------------------------------------------------------\n//! @class チャーシュー追加デコレータのクラス\n//! @note  DecoratorパターンのConcreteDecorator(具体的デコレータ)の役割を担うクラス\n//-------------------------------------------------------------\nclass RoastPorkDecorator : public ToppingDecorator {\npublic:\n\t//-------------------------------------------------------------\n\t// コンストラクタ\n\t//! @param ramen [in] ラップ対象のラーメン\n\t//-------------------------------------------------------------\n    RoastPorkDecorator(std::shared_ptr<IRamen> ramen);\n\n\t//-------------------------------------------------------------\n\t// ラーメンを確認する処理\n\t//! @note  ラップ対象のラーメンにチャーシューを追加して確認\n\t//-------------------------------------------------------------\n    void check() override;\n};\n```\n```cpp:RoastPorkDecorator.cpp\n//-------------------------------------------------------------\n//! @file   RoastPorkDecorator.cpp\n//! @brief  チャーシュー追加デコレータのクラス実装\n//! @author つきの\n//-------------------------------------------------------------\n#include \"RoastPorkDecorator.h\"\n#include <iostream>\n//-------------------------------------------------------------\n//! @brief コンストラクタ\n//-------------------------------------------------------------\nRoastPorkDecorator::RoastPorkDecorator(std::shared_ptr<IRamen> ramen)\n\t: ToppingDecorator(ramen) {\t\t// 抽象デコレータクラスのコンストラクタを呼び出す\n}\n\n//-------------------------------------------------------------\n//! @brief ラーメンを確認する処理\n//-------------------------------------------------------------\nvoid RoastPorkDecorator::check() {\n\tinner_ramen_->check();\t\t\t\t\t\t\t// ラップした対象のラーメンから確認処理を委譲\n\tstd::cout << \" + チャーシュー\" << std::flush;\t// チャーシューを追加表示\n}\n```\n```cpp:main.cpp\n//-------------------------------------------------------------\n//! @file\tmain.cpp\n//! @brief  デコレータパターンによるラーメン確認処理の実装例\n//! @author つきの\n//-------------------------------------------------------------\n#include \"IRamen.h\"\n#include \"RamenBase.h\"\n#include \"EggDecorator.h\"\n#include \"RoastPorkDecorator.h\"\n#include <memory>\n#include <iostream>\n//エントリポイント\nint main() {\n\t//-------------------------------------------------------------\n\t// 基本ラーメンを作成して確認\n\t//-------------------------------------------------------------\n\tstd::shared_ptr<IRamen> ramen = std::make_shared<RamenBase>();\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tstd::cout << \"スープと麺だけのラーメンが完成\" << std::endl;\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tramen->check();\t\t// 現在のラーメンを確認\n\tstd::cout << std::endl;\n\t//-------------------------------------------------------------\n\t// 味玉デコレータでラップ\n\t//-------------------------------------------------------------\n\tramen = std::make_shared<EggDecorator>(ramen);\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tstd::cout << \"味玉を追加\" << std::endl;\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tramen->check();\t\t// 現在のラーメンを確認\n\tstd::cout << std::endl;\n\t//-------------------------------------------------------------\n\t// チャーシューデコレータでラップ\n\t//-------------------------------------------------------------\n\tramen = std::make_shared<RoastPorkDecorator>(ramen);\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tstd::cout << \"チャーシューを追加\" << std::endl;\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tramen->check();\t\t// 現在のラーメンを確認\n\tstd::cout << std::endl;\n\t//終了\n\treturn 0;\n}\n```\n```:result\n--------------------------------------------\nスープと麺だけのラーメンが完成\n--------------------------------------------\n現在のラーメン : ラーメン + スープ\n--------------------------------------------\n味玉を追加\n--------------------------------------------\n現在のラーメン : ラーメン + スープ + 味玉\n--------------------------------------------\nチャーシューを追加\n--------------------------------------------\n現在のラーメン : ラーメン + スープ + 味玉 + チャーシュー\n```\nラーメンにトッピングを追加していくことに成功しました。\n### クラス図\n```mermaid\nclassDiagram\n    class IRamen {\n        <<共通インターフェース(Component)>>\n        +check()  ラーメンを確認する処理 (operationに相当)\n    }\n\n    class RamenBase {\n        +check()  基本ラーメンを確認する処理\n    }\n\n    class ToppingDecorator {\n        <<抽象デコレータ>>\n        -IRamen inner_ramen_  ラップ対象のラーメン\n        +check()  内側のラーメンに処理を委譲\n    }\n\n    class EggDecorator {\n        +check()  味玉を追加して確認\n    }\n\n    class RoastPorkDecorator {\n        +check()  チャーシューを追加して確認\n    }\n\n    %% 関係の矢印\n    IRamen <|.. RamenBase : 実装 (ConcreteComponent)\n    IRamen <|.. ToppingDecorator : 継承 (Decorator)\n    ToppingDecorator <|-- EggDecorator : 具体的デコレータ\n    ToppingDecorator <|-- RoastPorkDecorator : 具体的デコレータ\n    ToppingDecorator o--> IRamen : ラップ対象を保持\n```\n### operation()\n``IRamen``にある``check()``は``デザインパターンの文脈``でよく``operation()``とよばれる関数にあたり、ラップしたオブジェクトの同名の関数を呼び出してから処理を追加します。\nこの仕組みによって実行中に柔軟に機能を追加でき、``継承``を使わずに拡張性を保つことができます。\n```cpp:IRamen.h\n\t//-------------------------------------------------------------\n\t//! @brief ラーメンを確認する処理\n\t//! @note  デザインパターンの文脈でいう「operation」関数に相当する\n\t//-------------------------------------------------------------\n\tvirtual void check() = 0;\n```\n```RamenBase.cpp\n//-------------------------------------------------------------\n//! @brief  基本内容のラーメンを確認する処理の\n//-------------------------------------------------------------\nvoid RamenBase::check() {\n\t// ラーメンの基本内容を表示\n\tstd::cout << \"現在のラーメン : ラーメン + スープ\" << std::flush;\n}\n```\n```cpp:ToppingDecorator.cpp\n//-------------------------------------------------------------\n//! @brief ラーメンを確認する処理\n//-------------------------------------------------------------\nvoid ToppingDecorator::check() {\n\tinner_ramen_->check();\t// ラップして対象のラーメンから確認処理を委譲\n}\n```\n```cpp:EggDecorator.cpp\n//-------------------------------------------------------------\n//! @brief ラーメンを確認する処理\n//-------------------------------------------------------------\nvoid EggDecorator::check() {\n\tinner_ramen_->check();\t\t\t\t\t// ラップした対象のラーメンから確認処理を委譲\n\tstd::cout << \" + 味玉\" << std::flush;\t// 味玉を追加表示\n}\n```\n```cpp:RoastPorkDecorator.cpp\n//-------------------------------------------------------------\n//! @brief ラーメンを確認する処理\n//-------------------------------------------------------------\nvoid RoastPorkDecorator::check() {\n\tinner_ramen_->check();\t\t\t\t\t\t\t// ラップした対象のラーメンから確認処理を委譲\n\tstd::cout << \" + チャーシュー\" << std::flush;\t// チャーシューを追加表示\n}\n```\n# Decorator/デコレータ\n``Decoratorパターン``では、``デコレータ``にも``ConcreteComponent/具象コンポーネント``が``継承``している``共通インターフェース/Component``を``継承``することで、``アップキャスト``を使用して``具象デコレータ``から``operation()``を呼べる仕組みとなっています。\n```cpp:RamenBase.h\n//-------------------------------------------------------------\n//! @class  基本ラーメンのクラス\n//! @note   DecoratorパターンのConcreteComponent(具象コンポーネント)の役割を担うクラス\n//! @author つきの\n//-------------------------------------------------------------\nclass RamenBase : public IRamen {\npublic:\n\t// 中略\n};\n```\n```cpp:ToppingDecorator.h\n//-------------------------------------------------------------\n//! @class トッピングデコレータのクラス\n//! @note  DecoratorパターンのDecorator(抽象デコレータ)の役割を担うクラス\n//-------------------------------------------------------------\nclass ToppingDecorator : public IRamen {\n    // 中略\n};\n```\n```cpp:EggDecorator.cpp\n//-------------------------------------------------------------\n//! @class 味玉追加デコレータのクラス\n//! @note  DecoratorパターンのConcreteDecorator(具体的デコレータ)の役割を担うクラス\n//-------------------------------------------------------------\nclass EggDecorator : public ToppingDecorator {\n    // 中略\n};\n```\n```cpp:RoastPorkDecorator.h\n//-------------------------------------------------------------\n//! @class チャーシュー追加デコレータのクラス\n//! @note  DecoratorパターンのConcreteDecorator(具体的デコレータ)の役割を担うクラス\n//-------------------------------------------------------------\nclass RoastPorkDecorator : public ToppingDecorator {\n    // 中略\n};\n```\n```cpp:main.cpp\n\t//-------------------------------------------------------------\n\t// 基本ラーメンを作成して確認\n\t//-------------------------------------------------------------\n\tstd::shared_ptr<IRamen> ramen = std::make_shared<RamenBase>();\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tstd::cout << \"スープと麺だけのラーメンが完成\" << std::endl;\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tramen->check();\t\t// 現在のラーメンを確認\n\tstd::cout << std::endl;\n\t//-------------------------------------------------------------\n\t// 味玉デコレータでラップ\n\t//-------------------------------------------------------------\n\tramen = std::make_shared<EggDecorator>(ramen);\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tstd::cout << \"味玉を追加\" << std::endl;\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tramen->check();\t\t// 現在のラーメンを確認\n\tstd::cout << std::endl;\n\t//-------------------------------------------------------------\n\t// チャーシューデコレータでラップ\n\t//-------------------------------------------------------------\n\tramen = std::make_shared<RoastPorkDecorator>(ramen);\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tstd::cout << \"チャーシューを追加\" << std::endl;\n\tstd::cout << \"--------------------------------------------\" << std::endl;\n\tramen->check();\t\t// 現在のラーメンを確認\n\tstd::cout << std::endl;\n```\n# 総括\n- ``Decoratorパターン``を使用することで、実行中に柔軟に機能を追加することが可能となる\n- ラップしたオブジェクトの``operation()``に機能を追加していくといったイメージで運用するのが適切\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:10:51+09:00",
      "group": null,
      "id": "469fcd707a2b4772a373",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "C++",
          "versions": []
        },
        {
          "name": "デザインパターン",
          "versions": []
        },
        {
          "name": "GoF",
          "versions": []
        },
        {
          "name": "gamedev",
          "versions": []
        },
        {
          "name": "DecoratorPattern",
          "versions": []
        }
      ],
      "title": "【C++】デコレータパターンで拡張性のある設計を",
      "updated_at": "2025-12-11T13:10:51+09:00",
      "url": "https://qiita.com/tsukino_/items/469fcd707a2b4772a373",
      "user": {
        "description": "かけだし個人ゲーム開発者です。",
        "facebook_id": "",
        "followees_count": 5,
        "followers_count": 7,
        "github_login_name": "tsukinokun",
        "id": "tsukino_",
        "items_count": 48,
        "linkedin_id": "",
        "location": "",
        "name": "",
        "organization": "",
        "permanent_id": 3943148,
        "profile_image_url": "https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/3943148/dba9282b99ae4d86acb280954ea4acc26df2834e/large.png?1750141033",
        "team_only": false,
        "twitter_screen_name": "kyosu_kosaikin",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-1:57\">ハマクラ Advent Calendar 2025 10日目の記事です</p>\n<p data-sourcepos=\"3:1-3:46\"><iframe id=\"qiita-embed-content__7d28f691ce39abdb8cf7363a48a28bd1\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__7d28f691ce39abdb8cf7363a48a28bd1\" data-content=\"https%3A%2F%2Fqiita.com%2Fadvent-calendar%2F2025%2Fhamacra\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<h1 data-sourcepos=\"5:1-5:14\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n<p data-sourcepos=\"7:1-8:100\">コマンドを書いていると、プレイヤーのmcidを使いたいと思うことがあるだろう。しかし、プレイヤーのmcidは<code>data</code>コマンドでプレイヤーから持ってくることはできず、一工夫加える必要がある。<br>\n今回はプレイヤー(実行者)のmcidをstorageに保存する方法について解説する。</p>\n<h1 data-sourcepos=\"10:1-10:11\">\n<span id=\"仕組み\" class=\"fragment\"></span><a href=\"#%E4%BB%95%E7%B5%84%E3%81%BF\"><i class=\"fa fa-link\"></i></a>仕組み</h1>\n<p data-sourcepos=\"12:1-15:115\"><code>/give @s minecraft:player_head[profile={name:\"syk9\"}]</code><br>\nでsyk9の頭が入手できるように、プレイヤーの頭は内部にプレイヤーのmcidを持っている。<br>\nということは、どうにかして実行者の頭を用意できれば、そこからmcidを取得することができる。<br>\nloot_tableを使うことで実行者の頭を出すことができるので、これを利用して実装する。</p>\n<h1 data-sourcepos=\"17:1-17:17\">\n<span id=\"実際に作る\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E4%BD%9C%E3%82%8B\"><i class=\"fa fa-link\"></i></a>実際に作る</h1>\n<div class=\"code-frame\" data-lang=\"json\" data-sourcepos=\"19:1-40:3\">\n<div class=\"code-lang\"><span class=\"bold\">loot_table/getmcid.json</span></div>\n<div class=\"highlight\"><pre><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"nl\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"minecraft:empty\"</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"nl\">\"pools\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n    </span><span class=\"p\">{</span><span class=\"w\">\n      </span><span class=\"nl\">\"rolls\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"nl\">\"entries\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n          </span><span class=\"nl\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"minecraft:item\"</span><span class=\"p\">,</span><span class=\"w\">\n          </span><span class=\"nl\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"minecraft:player_head\"</span><span class=\"p\">,</span><span class=\"w\">\n          </span><span class=\"nl\">\"functions\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n              </span><span class=\"nl\">\"function\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"minecraft:fill_player_head\"</span><span class=\"p\">,</span><span class=\"w\">\n              </span><span class=\"nl\">\"entity\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"this\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n          </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n      </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">}</span><span class=\"w\">\n  </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div>\n</div>\n<p data-sourcepos=\"41:1-43:90\">実行者の頭を用意するためのルートテーブル<br>\n<code>/loot give @s loot namespace:getmcid</code><br>\nとチャット欄で実行してみると自身の頭が手に入ることがわかる。</p>\n<div class=\"code-frame\" data-lang=\"mcfunction\" data-sourcepos=\"44:1-50:3\">\n<div class=\"code-lang\"><span class=\"bold\">getmcid.mcfunction</span></div>\n<div class=\"highlight\"><pre><code>execute unless entity @s[type=player] run return fail\nexecute at @s run summon armor_stand ~ ~500 ~ {Tags:[\"getmcid\"]}\nexecute at @s positioned ~ ~500 ~ run loot replace entity @n[type=armor_stand,tag=getmcid,distance=..1] armor.head loot namespace:getmcid\nexecute at @s positioned ~ ~500 ~ run data modify storage namespace: mcid set from entity @n[type=armor_stand,tag=getmcid,distance=..0.01] equipment.head.components.\"minecraft:profile\".name\nexecute at @s positioned ~ ~500 ~ run kill @n[type=armor_stand,tag=getmcid]\n</code></pre></div>\n</div>\n<p data-sourcepos=\"51:1-51:75\">実行すると、<code>namespace: mcid</code>に実行者のmcidが保存される。</p>\n<p data-sourcepos=\"53:1-55:50\">実行者はプレイヤーである必要があるため、1行目で実行者がプレイヤーでないときは処理を終了する。<br>\n2行目以降で、実行者の500ブロック上にタグ付きの防具立てを召喚し、その防具立てに実行者の頭を装備、防具立てが頭に装備しているアイテムのmcidをstorageに保存、という流れでstorageに実行者のmcidを保存している。<br>\n5行目は召喚した防具立てをkillする。</p>\n<p data-sourcepos=\"57:1-57:270\">500マス上で処理しているのはプレイヤーの上であれば常に読み込まれているためである。読み込まれてさえいればどこでもいいので、<code>forceload</code>で<code>0,0</code>を読み込んでおき、<code>0,0</code>で処理するという手もある。</p>\n<h1 data-sourcepos=\"59:1-59:14\">\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h1>\n<p data-sourcepos=\"60:1-61:111\">プレイヤーのmcidをstorageに保存することができれば、マクロ関数などで色々なところに代入して活用することができる。<br>\n仕組みさえわかってしまえば簡単に実装できるため、是非試してみてもらいたい。</p>\n<p data-sourcepos=\"63:1-63:78\">誤字、脱字を見つけたら教えていただけますと幸いです。</p>\n",
      "body": "ハマクラ Advent Calendar 2025 10日目の記事です\n\nhttps://qiita.com/advent-calendar/2025/hamacra\n\n# はじめに\n\nコマンドを書いていると、プレイヤーのmcidを使いたいと思うことがあるだろう。しかし、プレイヤーのmcidは`data`コマンドでプレイヤーから持ってくることはできず、一工夫加える必要がある。\n今回はプレイヤー(実行者)のmcidをstorageに保存する方法について解説する。\n\n# 仕組み\n\n`/give @s minecraft:player_head[profile={name:\"syk9\"}]`\nでsyk9の頭が入手できるように、プレイヤーの頭は内部にプレイヤーのmcidを持っている。\nということは、どうにかして実行者の頭を用意できれば、そこからmcidを取得することができる。\nloot_tableを使うことで実行者の頭を出すことができるので、これを利用して実装する。\n\n# 実際に作る\n\n```json:loot_table/getmcid.json\n{\n  \"type\": \"minecraft:empty\",\n  \"pools\": [\n    {\n      \"rolls\": 1,\n      \"entries\": [\n        {\n          \"type\": \"minecraft:item\",\n          \"name\": \"minecraft:player_head\",\n          \"functions\": [\n            {\n              \"function\": \"minecraft:fill_player_head\",\n              \"entity\": \"this\"\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n```\n実行者の頭を用意するためのルートテーブル\n`/loot give @s loot namespace:getmcid`\nとチャット欄で実行してみると自身の頭が手に入ることがわかる。\n```getmcid.mcfunction\nexecute unless entity @s[type=player] run return fail\nexecute at @s run summon armor_stand ~ ~500 ~ {Tags:[\"getmcid\"]}\nexecute at @s positioned ~ ~500 ~ run loot replace entity @n[type=armor_stand,tag=getmcid,distance=..1] armor.head loot namespace:getmcid\nexecute at @s positioned ~ ~500 ~ run data modify storage namespace: mcid set from entity @n[type=armor_stand,tag=getmcid,distance=..0.01] equipment.head.components.\"minecraft:profile\".name\nexecute at @s positioned ~ ~500 ~ run kill @n[type=armor_stand,tag=getmcid]\n```\n実行すると、`namespace: mcid`に実行者のmcidが保存される。\n\n実行者はプレイヤーである必要があるため、1行目で実行者がプレイヤーでないときは処理を終了する。\n2行目以降で、実行者の500ブロック上にタグ付きの防具立てを召喚し、その防具立てに実行者の頭を装備、防具立てが頭に装備しているアイテムのmcidをstorageに保存、という流れでstorageに実行者のmcidを保存している。\n5行目は召喚した防具立てをkillする。\n\n500マス上で処理しているのはプレイヤーの上であれば常に読み込まれているためである。読み込まれてさえいればどこでもいいので、`forceload`で`0,0`を読み込んでおき、`0,0`で処理するという手もある。\n\n# おわりに\nプレイヤーのmcidをstorageに保存することができれば、マクロ関数などで色々なところに代入して活用することができる。\n仕組みさえわかってしまえば簡単に実装できるため、是非試してみてもらいたい。\n\n誤字、脱字を見つけたら教えていただけますと幸いです。\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:08:16+09:00",
      "group": null,
      "id": "1a3f7be36879c4794ae9",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "minecraft",
          "versions": []
        },
        {
          "name": "mcfunction",
          "versions": []
        },
        {
          "name": "datapack",
          "versions": []
        }
      ],
      "title": "プレイヤーのmcidをstorageに保存する",
      "updated_at": "2025-12-11T13:08:16+09:00",
      "url": "https://qiita.com/syk9/items/1a3f7be36879c4794ae9",
      "user": {
        "description": "見たな",
        "facebook_id": "",
        "followees_count": 0,
        "followers_count": 0,
        "github_login_name": "9syk",
        "id": "syk9",
        "items_count": 4,
        "linkedin_id": "",
        "location": "",
        "name": "",
        "organization": "",
        "permanent_id": 4264993,
        "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4264993/profile-images/1763697470",
        "team_only": false,
        "twitter_screen_name": "syk9_",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-1:171\">UnityではなくGodotで、しかもLaTeXを使いたいとかいう超超マニアックな需要を抱えたあなたへ、僕の半日の調査記録を贈ります。</p>\n<h1 data-sourcepos=\"3:1-3:16\">\n<span id=\"なぜgodot\" class=\"fragment\"></span><a href=\"#%E3%81%AA%E3%81%9Cgodot\"><i class=\"fa fa-link\"></i></a>なぜGodot？</h1>\n<p data-sourcepos=\"4:1-4:30\">A. タダだから。以上。</p>\n<h1 data-sourcepos=\"6:1-6:18\">\n<span id=\"godotex使うよ\" class=\"fragment\"></span><a href=\"#godotex%E4%BD%BF%E3%81%86%E3%82%88\"><i class=\"fa fa-link\"></i></a>GodoTeX使うよ</h1>\n<p data-sourcepos=\"7:1-7:40\"><iframe id=\"qiita-embed-content__f6d7f722de88d744176fe55e80b3897e\" src=\"https://qiita.com/embed-contents/link-card#qiita-embed-content__f6d7f722de88d744176fe55e80b3897e\" data-content=\"https%3A%2F%2Fgithub.com%2Flennart-finke%2FGodoTeX\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" style=\"width:100%;\" height=\"29\">\n</iframe>\n</p>\n<p data-sourcepos=\"9:1-10:51\">アセットライブラリで<code>GodoTeX</code>を検索してダウンロード。ちなみにMono版(C#で書く奴)じゃないと動きません。<br>\n以下ドキュメントに書いてある準備。</p>\n<p data-sourcepos=\"12:1-12:176\">適当なシーンに適当な <strong>「C#」</strong> スクリプトをアタッチ。すると右上の再生ボタンの隣にトンカチが生えてくるので押してビルド。</p>\n<p data-sourcepos=\"14:1-14:227\">エクスプローラーでプロジェクトのディレクトリ開いて、<code>GodoTeX.csproj</code>じゃない「プロジェクトの<code>csproj</code>ファイル」をメモ帳で開き、以下を<code>&lt;Project&gt;</code>タグの中に入れます。</p>\n<div class=\"code-frame\" data-lang=\"xml\" data-sourcepos=\"16:1-21:3\"><div class=\"highlight\"><pre><code>  <span class=\"nt\">&lt;ItemGroup&gt;</span>\n    <span class=\"nt\">&lt;PackageReference</span> <span class=\"na\">Include=</span><span class=\"s\">\"CSharpMath\"</span> <span class=\"na\">Version=</span><span class=\"s\">\"0.5.1\"</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;PackageReference</span> <span class=\"na\">Include=</span><span class=\"s\">\"CSharpMath.SkiaSharp\"</span> <span class=\"na\">Version=</span><span class=\"s\">\"0.5.1\"</span> <span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/ItemGroup&gt;</span>\n</code></pre></div></div>\n<p data-sourcepos=\"23:1-23:36\">そしたらもっかいビルド。</p>\n<p data-sourcepos=\"25:1-25:93\">最後にプロジェクトの設定から<code>GodoTeX</code>のプラグインを有効化します。</p>\n<h1 data-sourcepos=\"27:1-27:38\">\n<span id=\"日本語を使わせてください\" class=\"fragment\"></span><a href=\"#%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%82%92%E4%BD%BF%E3%82%8F%E3%81%9B%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84\"><i class=\"fa fa-link\"></i></a>日本語を使わせてください</h1>\n<p data-sourcepos=\"28:1-29:294\">これは<code>GodoTeX</code>のソースコードをちょっといじる必要があります。具体的には<code>CSharpMath</code>に日本語を扱えるフォントを設定します。<br>\nまず、予め適当に使いたいフォントをダウンロードしておいてください。あと<a href=\"https://ctan.org/tex-archive/fonts/lm-math/opentype\" rel=\"nofollow noopener\" target=\"_blank\">latinmodern-math</a>も。（<code>GodoTeX</code>のデフォルトフォントです。）<code>Fonts</code>ディレクトリにでもいれてください。</p>\n<p data-sourcepos=\"31:1-31:80\"><code>GodoTeX</code>の<code>LaTeXture.cs</code>という面白い名前のファイルの以下の行</p>\n<div class=\"code-frame\" data-lang=\"cs\" data-sourcepos=\"32:1-34:3\"><div class=\"highlight\"><pre><code>\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Painter</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">MathPainter</span> <span class=\"p\">{</span><span class=\"n\">AntiAlias</span> <span class=\"p\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">AntiAliasing</span><span class=\"p\">,</span> <span class=\"n\">TextColor</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">SKColor</span><span class=\"p\">(</span><span class=\"n\">r</span><span class=\"p\">,</span> <span class=\"n\">g</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">a</span><span class=\"p\">),</span> <span class=\"n\">FontSize</span> <span class=\"p\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">FontSize</span><span class=\"p\">,</span> <span class=\"n\">LaTeX</span> <span class=\"p\">=</span> <span class=\"s\">@\"\\raisebox{40mu}{}\\raisebox{-40mu}{}\"</span> <span class=\"p\">+</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">LatexExpression</span> <span class=\"p\">+</span> <span class=\"s\">@\"\\:\\raisebox{1mu}\"</span><span class=\"p\">,</span> <span class=\"n\">DisplayErrorInline</span> <span class=\"p\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">ShowError</span><span class=\"p\">,</span> <span class=\"n\">PaintStyle</span> <span class=\"p\">=</span> <span class=\"n\">paintStyle</span><span class=\"p\">};</span>\n</code></pre></div></div>\n<p data-sourcepos=\"35:1-35:3\">を</p>\n<div class=\"code-frame\" data-lang=\"cs\" data-sourcepos=\"36:1-38:3\"><div class=\"highlight\"><pre><code>\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Painter</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">MathPainter</span> <span class=\"p\">{</span><span class=\"n\">AntiAlias</span> <span class=\"p\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">AntiAliasing</span><span class=\"p\">,</span> <span class=\"n\">TextColor</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">SKColor</span><span class=\"p\">(</span><span class=\"n\">r</span><span class=\"p\">,</span> <span class=\"n\">g</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">a</span><span class=\"p\">),</span> <span class=\"n\">FontSize</span> <span class=\"p\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">FontSize</span><span class=\"p\">,</span> <span class=\"n\">LaTeX</span> <span class=\"p\">=</span> <span class=\"s\">@\"\\raisebox{40mu}{}\\raisebox{-40mu}{}\"</span> <span class=\"p\">+</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">LatexExpression</span> <span class=\"p\">+</span> <span class=\"s\">@\"\\:\\raisebox{1mu}\"</span><span class=\"p\">,</span> <span class=\"n\">DisplayErrorInline</span> <span class=\"p\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">ShowError</span><span class=\"p\">,</span> <span class=\"n\">PaintStyle</span> <span class=\"p\">=</span> <span class=\"n\">paintStyle</span><span class=\"p\">,</span> <span class=\"n\">LocalTypefaces</span> <span class=\"p\">=</span> <span class=\"k\">new</span><span class=\"p\">[]{</span> <span class=\"k\">new</span> <span class=\"nf\">OpenFontReader</span><span class=\"p\">().</span><span class=\"nf\">Read</span><span class=\"p\">(</span><span class=\"n\">File</span><span class=\"p\">.</span><span class=\"nf\">OpenRead</span><span class=\"p\">(</span><span class=\"s\">\"Fonts/latinmodern-math.otf\"</span><span class=\"p\">)),</span>  <span class=\"k\">new</span> <span class=\"nf\">OpenFontReader</span><span class=\"p\">().</span><span class=\"nf\">Read</span><span class=\"p\">(</span><span class=\"n\">File</span><span class=\"p\">.</span><span class=\"nf\">OpenRead</span><span class=\"p\">(</span><span class=\"s\">\"プロジェクトのルートからのフォントファイルの相対パス\"</span><span class=\"p\">))</span> <span class=\"p\">}</span> <span class=\"p\">};</span>\n</code></pre></div></div>\n<p data-sourcepos=\"39:1-39:33\">に書き換えてください。</p>\n<p data-sourcepos=\"41:1-41:243\">多分ですが、インデックスが若い方からフォント対応してるか判定されていくので、今回の場合数式は<code>latinmodern-math</code>、日本語は対応してないので後の方のフォントが適用されます。</p>\n<h1 data-sourcepos=\"43:1-43:8\">\n<span id=\"以上\" class=\"fragment\"></span><a href=\"#%E4%BB%A5%E4%B8%8A\"><i class=\"fa fa-link\"></i></a>以上</h1>\n<p data-sourcepos=\"44:1-44:108\">変なことやろうとすると文献無いので、自分で開拓していくしかないのが辛い...</p>\n<h1 data-sourcepos=\"46:1-46:8\">\n<span id=\"余談\" class=\"fragment\"></span><a href=\"#%E4%BD%99%E8%AB%87\"><i class=\"fa fa-link\"></i></a>余談</h1>\n<div class=\"code-frame\" data-lang=\"cs\" data-sourcepos=\"47:1-49:3\"><div class=\"highlight\"><pre><code><span class=\"p\">{</span> <span class=\"m\">1</span><span class=\"p\">};</span>\n</code></pre></div></div>\n<p data-sourcepos=\"50:1-50:3\">と</p>\n<div class=\"code-frame\" data-lang=\"cs\" data-sourcepos=\"51:1-53:3\"><div class=\"highlight\"><pre><code><span class=\"k\">new</span><span class=\"p\">[]{</span> <span class=\"m\">1</span><span class=\"p\">};</span>\n</code></pre></div></div>\n<p data-sourcepos=\"54:1-54:128\">って違うんですね。てっきり型が自明なら<code>new</code>省略できると思ってました。これで半日沼った。</p>\n",
      "body": "UnityではなくGodotで、しかもLaTeXを使いたいとかいう超超マニアックな需要を抱えたあなたへ、僕の半日の調査記録を贈ります。\n\n# なぜGodot？\nA. タダだから。以上。\n\n# GodoTeX使うよ\nhttps://github.com/lennart-finke/GodoTeX\n\nアセットライブラリで`GodoTeX`を検索してダウンロード。ちなみにMono版(C#で書く奴)じゃないと動きません。\n以下ドキュメントに書いてある準備。\n\n適当なシーンに適当な __「C#」__ スクリプトをアタッチ。すると右上の再生ボタンの隣にトンカチが生えてくるので押してビルド。\n\nエクスプローラーでプロジェクトのディレクトリ開いて、`GodoTeX.csproj`じゃない「プロジェクトの`csproj`ファイル」をメモ帳で開き、以下を`<Project>`タグの中に入れます。\n\n```xml\n  <ItemGroup>\n    <PackageReference Include=\"CSharpMath\" Version=\"0.5.1\" />\n    <PackageReference Include=\"CSharpMath.SkiaSharp\" Version=\"0.5.1\" />\n  </ItemGroup>\n```\n\nそしたらもっかいビルド。\n\n最後にプロジェクトの設定から`GodoTeX`のプラグインを有効化します。\n\n# 日本語を使わせてください\nこれは`GodoTeX`のソースコードをちょっといじる必要があります。具体的には`CSharpMath`に日本語を扱えるフォントを設定します。\nまず、予め適当に使いたいフォントをダウンロードしておいてください。あと[latinmodern-math](https://ctan.org/tex-archive/fonts/lm-math/opentype)も。（`GodoTeX`のデフォルトフォントです。）`Fonts`ディレクトリにでもいれてください。\n\n`GodoTeX`の`LaTeXture.cs`という面白い名前のファイルの以下の行\n```cs\n\t\tthis.Painter = new MathPainter {AntiAlias = this.AntiAliasing, TextColor = new SKColor(r, g, b, a), FontSize = this.FontSize, LaTeX = @\"\\raisebox{40mu}{}\\raisebox{-40mu}{}\" + this.LatexExpression + @\"\\:\\raisebox{1mu}\", DisplayErrorInline = this.ShowError, PaintStyle = paintStyle};\n```\nを\n```cs\n\t\tthis.Painter = new MathPainter {AntiAlias = this.AntiAliasing, TextColor = new SKColor(r, g, b, a), FontSize = this.FontSize, LaTeX = @\"\\raisebox{40mu}{}\\raisebox{-40mu}{}\" + this.LatexExpression + @\"\\:\\raisebox{1mu}\", DisplayErrorInline = this.ShowError, PaintStyle = paintStyle, LocalTypefaces = new[]{ new OpenFontReader().Read(File.OpenRead(\"Fonts/latinmodern-math.otf\")),  new OpenFontReader().Read(File.OpenRead(\"プロジェクトのルートからのフォントファイルの相対パス\")) } };\n```\nに書き換えてください。\n\n多分ですが、インデックスが若い方からフォント対応してるか判定されていくので、今回の場合数式は`latinmodern-math`、日本語は対応してないので後の方のフォントが適用されます。\n\n# 以上\n変なことやろうとすると文献無いので、自分で開拓していくしかないのが辛い...\n\n# 余談\n```cs\n{ 1};\n```\nと\n```cs\nnew[]{ 1};\n```\nって違うんですね。てっきり型が自明なら`new`省略できると思ってました。これで半日沼った。\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:05:57+09:00",
      "group": null,
      "id": "c440d2636befc45ee773",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "LaTeX",
          "versions": []
        },
        {
          "name": "C#",
          "versions": []
        },
        {
          "name": "備忘録",
          "versions": []
        },
        {
          "name": "Godot",
          "versions": []
        }
      ],
      "title": "GodotでLaTeXを使う",
      "updated_at": "2025-12-11T13:08:11+09:00",
      "url": "https://qiita.com/midry3125/items/c440d2636befc45ee773",
      "user": {
        "description": "大体C#かPythonかGo\r\nZenn: https://zenn.dev/midry3125",
        "facebook_id": "",
        "followees_count": 1,
        "followers_count": 0,
        "github_login_name": "midry3",
        "id": "midry3125",
        "items_count": 9,
        "linkedin_id": "",
        "location": "Dドライブ",
        "name": "遠瀬 緑",
        "organization": "",
        "permanent_id": 2918907,
        "profile_image_url": "https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/2918907/661c9884a2c6b15eb1c6b99dcdbabd68b64bc8bd/x_large.png?1764384141",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": "https://midry3.github.io/"
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-1:208\">GenSpark開発で頻繁に使う外部ツールを紹介。Cloudflare、GitHub、Cronの基本から、ジェンスパークから直接デプロイする効率的な方法まで実践的に解説します。</p>\n<p data-sourcepos=\"3:1-3:38\"><strong>■ この記事でわかること</strong></p>\n<ul data-sourcepos=\"4:1-11:0\">\n<li data-sourcepos=\"4:1-4:14\">はじめに</li>\n<li data-sourcepos=\"5:1-5:66\">Cloudflare：フロントエンドからバックエンドまで</li>\n<li data-sourcepos=\"6:1-6:59\">GitHub：バージョン管理とコラボレーション</li>\n<li data-sourcepos=\"7:1-7:33\">Cron：定期実行の自動化</li>\n<li data-sourcepos=\"8:1-8:59\">ジェンスパークから直接デプロイする方法</li>\n<li data-sourcepos=\"9:1-9:29\">その他の便利ツール</li>\n<li data-sourcepos=\"10:1-11:0\">まとめ</li>\n</ul>\n<p data-sourcepos=\"12:1-13:123\"><strong>続きはこちらの記事で ↓</strong><br>\n<a href=\"https://genspark-dev-blog.pages.dev/articles/08-external_tools\" rel=\"nofollow noopener\" target=\"_blank\">ジェンスパークでよく使われる外部ツール</a></p>\n<hr data-sourcepos=\"15:1-16:0\">\n<p data-sourcepos=\"17:1-18:62\"><strong>【ジェンスパーク開発奮闘記】</strong><br>\nAI開発の日々の挑戦と学びを発信しています。</p>\n",
      "body": "GenSpark開発で頻繁に使う外部ツールを紹介。Cloudflare、GitHub、Cronの基本から、ジェンスパークから直接デプロイする効率的な方法まで実践的に解説します。\n\n**■ この記事でわかること**\n- はじめに\n- Cloudflare：フロントエンドからバックエンドまで\n- GitHub：バージョン管理とコラボレーション\n- Cron：定期実行の自動化\n- ジェンスパークから直接デプロイする方法\n- その他の便利ツール\n- まとめ\n\n**続きはこちらの記事で ↓**\n[ジェンスパークでよく使われる外部ツール](https://genspark-dev-blog.pages.dev/articles/08-external_tools)\n\n---\n\n**【ジェンスパーク開発奮闘記】**\nAI開発の日々の挑戦と学びを発信しています。\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T13:03:24+09:00",
      "group": null,
      "id": "ca9d016aa479b732a1c2",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Genspark",
          "versions": []
        }
      ],
      "title": "ジェンスパークでよく使われる外部ツール",
      "updated_at": "2025-12-11T13:03:24+09:00",
      "url": "https://qiita.com/kyamaguch905/items/ca9d016aa479b732a1c2",
      "user": {
        "description": null,
        "facebook_id": null,
        "followees_count": 1,
        "followers_count": 0,
        "github_login_name": null,
        "id": "kyamaguch905",
        "items_count": 8,
        "linkedin_id": null,
        "location": null,
        "name": "",
        "organization": null,
        "permanent_id": 4291439,
        "profile_image_url": "https://lh3.googleusercontent.com/a/ACg8ocKZmongdzDFyc7tGnLTR7tpLzGMeFfkZiQrgJw6kFK-jecSdg=s96-c",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": null
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-6:99\">2025年10月18日(土)に<br>\n<a href=\"https://www.sight-world.com/\" rel=\"nofollow noopener\" target=\"_blank\">視覚障害者向け総合イベント「サイトワールド」</a><br>\nで行われた<br>\n<a href=\"https://www.extra.co.jp/archive/archive-10406/\" rel=\"nofollow noopener\" target=\"_blank\"><strong>JAWS（じょーず）日本語版20周年記念フォーラム<br>\n自分たちの道具は自分たちで作る。AI時代のスクリーンリーダーの未来</strong></a><br>\nが大変よかったので、もっと多くの人に知っていただきたく投稿します。</p>\n<ul data-sourcepos=\"7:1-14:0\">\n<li data-sourcepos=\"7:1-7:41\">スクリーンリーダーとは何か</li>\n<li data-sourcepos=\"8:1-8:25\">WAI-ARIAとの関わり</li>\n<li data-sourcepos=\"9:1-14:0\">AIとスクリーンリーダー<br>\nといったテーマで行われたイベントですが、上記のテーマ以上に発見と学びが多かったというのが感想です。<br>\n私は普段JAWSは使っていませんが、それでもこのソフトが歩んできた歴史、開発にずっと関わっている視覚障害当事者の話、これからのスクリーンリーダー、とわくわくする話題がたくさんありました。<br>\n視覚障害当事者だけでなく開発者、アクセシビリティに関心のある方にもおすすめの内容です。<br>\nとくにJAWSの開発者と日本語ローカライズをずっとされている2名の対談は保存版の内容ですので、ぜひ視聴いただきたいです。</li>\n</ul>\n",
      "body": "2025年10月18日(土)に\n[視覚障害者向け総合イベント「サイトワールド」](https://www.sight-world.com/)\nで行われた\n[__JAWS（じょーず）日本語版20周年記念フォーラム\n自分たちの道具は自分たちで作る。AI時代のスクリーンリーダーの未来__](https://www.extra.co.jp/archive/archive-10406/)\nが大変よかったので、もっと多くの人に知っていただきたく投稿します。\n- スクリーンリーダーとは何か\n- WAI-ARIAとの関わり\n- AIとスクリーンリーダー\nといったテーマで行われたイベントですが、上記のテーマ以上に発見と学びが多かったというのが感想です。\n私は普段JAWSは使っていませんが、それでもこのソフトが歩んできた歴史、開発にずっと関わっている視覚障害当事者の話、これからのスクリーンリーダー、とわくわくする話題がたくさんありました。\n視覚障害当事者だけでなく開発者、アクセシビリティに関心のある方にもおすすめの内容です。\nとくにJAWSの開発者と日本語ローカライズをずっとされている2名の対談は保存版の内容ですので、ぜひ視聴いただきたいです。\n\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T12:58:56+09:00",
      "group": null,
      "id": "eb31a553925e4a1d8708",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "AI",
          "versions": []
        },
        {
          "name": "アクセシビリティ",
          "versions": []
        },
        {
          "name": "スクリーンリーダー",
          "versions": []
        },
        {
          "name": "視覚障害",
          "versions": []
        },
        {
          "name": "WA-ARIA",
          "versions": []
        }
      ],
      "title": "スクリーンリーダーJAWSの周年イベントが想定を超えてよかったのでシェアします",
      "updated_at": "2025-12-11T12:58:56+09:00",
      "url": "https://qiita.com/yama_1983/items/eb31a553925e4a1d8708",
      "user": {
        "description": "視覚に障害のあるプログラマーです。\r\n色は識別できますが、文字や輪郭は認識することはできません。\r\n画面読み上げソフト「スクリーンリーダー」を使い作業しています。\r\n画面を見ずにプログラミングをするためのメモを記載していきます。\r\nといってもほとんど独学でやっていますので知識は穴だらけかもしれませんが、よろしくお願いします。",
        "facebook_id": "yamaga.nobuyuki",
        "followees_count": 0,
        "followers_count": 17,
        "github_login_name": null,
        "id": "yama_1983",
        "items_count": 18,
        "linkedin_id": "",
        "location": "千葉県",
        "name": "",
        "organization": "NPO法人スラッシュ",
        "permanent_id": 137100,
        "profile_image_url": "https://qiita-image-store.s3.amazonaws.com/0/137100/profile-images/1473720170",
        "team_only": false,
        "twitter_screen_name": "yama_1983",
        "website_url": "http://yama3nomori.jp"
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<p data-sourcepos=\"1:1-1:120\"><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F52151%2F496eed12-63f1-4fde-bf6f-88f386894ad8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=58078be87b30e140413b17c8eb1e7458\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F52151%2F496eed12-63f1-4fde-bf6f-88f386894ad8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=58078be87b30e140413b17c8eb1e7458\" alt=\"image.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F52151%2F496eed12-63f1-4fde-bf6f-88f386894ad8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b1dae270a48557af5355010a3975e77f 1x\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/52151/496eed12-63f1-4fde-bf6f-88f386894ad8.png\" loading=\"lazy\"></a></p>\n<div data-sourcepos=\"4:1-7:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"5:1-6:48\">現在、Qiita Advent Calendar 2025を<strong>完走する</strong>ため猪突猛進しております<img alt=\":writing_hand:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/270d-fe0f.png\" title=\":writing_hand:\" width=\"20\" loading=\"lazy\"><br>\n12月25日まで、エッホエッホ <img alt=\":laughing:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f606.png\" title=\":laughing:\" width=\"20\" loading=\"lazy\"></p>\n</div>\n</div>\n<h1 data-sourcepos=\"9:1-9:14\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n<p data-sourcepos=\"11:1-12:111\">みなさん、IBM Videoというサイトをご存知でしょうか？<br>\nIBMが提供する製品をショート動画でわかりやすくご紹介している動画サイトです。</p>\n<ul data-sourcepos=\"13:1-16:0\">\n<li data-sourcepos=\"13:1-13:68\">スキルアップしたくてもなかなか時間が取れない</li>\n<li data-sourcepos=\"14:1-14:92\">気になる製品があるけど、マニュアルを読んで理解するのはきつい</li>\n<li data-sourcepos=\"15:1-16:0\">製品の特徴やメリットをクイックに知りたい</li>\n</ul>\n<p data-sourcepos=\"17:1-18:69\">という方には、うってつけの動画を提供するサイトです。<br>\n興味のある方はぜひご覧いただければと思います。</p>\n<h1 data-sourcepos=\"20:1-20:44\">\n<span id=\"今回ご紹介する動画へのリンク\" class=\"fragment\"></span><a href=\"#%E4%BB%8A%E5%9B%9E%E3%81%94%E7%B4%B9%E4%BB%8B%E3%81%99%E3%82%8B%E5%8B%95%E7%94%BB%E3%81%B8%E3%81%AE%E3%83%AA%E3%83%B3%E3%82%AF\"><i class=\"fa fa-link\"></i></a>今回ご紹介する動画へのリンク</h1>\n<p data-sourcepos=\"22:1-22:156\"><a href=\"https://video.ibm.com/recorded/134169467\" rel=\"nofollow noopener\" target=\"_blank\">SPSS Modeler 新バージョンで「日本語テキストマイニング機能」をサクッと触ってみる</a></p>\n<h2 data-sourcepos=\"24:1-24:9\">\n<span id=\"概要\" class=\"fragment\"></span><a href=\"#%E6%A6%82%E8%A6%81\"><i class=\"fa fa-link\"></i></a>概要</h2>\n<p data-sourcepos=\"25:1-26:265\">デモでは、<strong>Cloud Pak for Data 上のSPSS Modeler に新たに追加された日本語テキストアナリティクス機能</strong> を紹介しています。<br>\n2024年10月9日にリリースされたこの新機能により、これまで外部ツールや Python コードを用いて行う必要があった日本語テキストの形態素解析が <strong>SPSS Modeler 内だけで完結</strong> できるようになりました。</p>\n<p data-sourcepos=\"28:1-28:222\">英語では一般的だったテキスト分解・可視化処理（例：ワードクラウドなど）が、日本語でも簡単に実行できるようになり、データ分析の効率が大きく向上します。</p>\n<hr data-sourcepos=\"30:1-31:0\">\n<h2 data-sourcepos=\"32:1-32:27\">\n<span id=\"デモの流れと特徴\" class=\"fragment\"></span><a href=\"#%E3%83%87%E3%83%A2%E3%81%AE%E6%B5%81%E3%82%8C%E3%81%A8%E7%89%B9%E5%BE%B4\"><i class=\"fa fa-link\"></i></a>デモの流れと特徴</h2>\n<h3 data-sourcepos=\"33:1-33:47\">\n<span id=\"1-spss-modeler-プロジェクトの準備\" class=\"fragment\"></span><a href=\"#1-spss-modeler-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E6%BA%96%E5%82%99\"><i class=\"fa fa-link\"></i></a>1. SPSS Modeler プロジェクトの準備</h3>\n<p data-sourcepos=\"34:1-34:155\">Cloud Pak for Data のトップページから既存プロジェクトを開き、SPSS Modeler のフローを利用して分析環境を構築します。</p>\n<h3 data-sourcepos=\"36:1-36:64\">\n<span id=\"2-新機能日本語テキスト分析ノードの紹介\" class=\"fragment\"></span><a href=\"#2-%E6%96%B0%E6%A9%9F%E8%83%BD%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E5%88%86%E6%9E%90%E3%83%8E%E3%83%BC%E3%83%89%E3%81%AE%E7%B4%B9%E4%BB%8B\"><i class=\"fa fa-link\"></i></a>2. 新機能：日本語テキスト分析ノードの紹介</h3>\n<p data-sourcepos=\"37:1-37:75\">今回追加されたのは以下の2つのコンポーネントです。</p>\n<ul data-sourcepos=\"38:1-40:0\">\n<li data-sourcepos=\"38:1-38:35\"><strong>テキストリンク分析</strong></li>\n<li data-sourcepos=\"39:1-40:0\"><strong>テキストマイニング</strong></li>\n</ul>\n<p data-sourcepos=\"41:1-41:123\">これらをフローに配置することで、日本語テキストの分解と可視化が SPSS 内で完結します。</p>\n<h3 data-sourcepos=\"43:1-43:52\">\n<span id=\"3-日本語テキストの読み込みと分解\" class=\"fragment\"></span><a href=\"#3-%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%81%A8%E5%88%86%E8%A7%A3\"><i class=\"fa fa-link\"></i></a>3. 日本語テキストの読み込みと分解</h3>\n<p data-sourcepos=\"44:1-45:125\">デモでは、コメント列に日本語レビューが記載された Excel ファイルを読み込み、<br>\n<strong>テキストリンク分析</strong> ノードにて以下のように自動でコンセプト（語句）が抽出されます。</p>\n<p data-sourcepos=\"47:1-47:8\">例：</p>\n<ul data-sourcepos=\"48:1-53:0\">\n<li data-sourcepos=\"48:1-48:8\">部屋</li>\n<li data-sourcepos=\"49:1-49:10\">清潔</li>\n<li data-sourcepos=\"50:1-50:34\">コストパフォーマンス</li>\n<li data-sourcepos=\"51:1-51:10\">快適</li>\n<li data-sourcepos=\"52:1-53:0\">優れ、など</li>\n</ul>\n<p data-sourcepos=\"54:1-54:182\">従来は MeCab などの外部形態素解析ツールを Python 経経由で呼び出す必要がありましたが、今回は <strong>SPSS だけで分解が完了</strong> しています。</p>\n<h3 data-sourcepos=\"56:1-56:55\">\n<span id=\"4-可視化グラフワードクラウド\" class=\"fragment\"></span><a href=\"#4-%E5%8F%AF%E8%A6%96%E5%8C%96%E3%82%B0%E3%83%A9%E3%83%95%E3%83%AF%E3%83%BC%E3%83%89%E3%82%AF%E3%83%A9%E3%82%A6%E3%83%89\"><i class=\"fa fa-link\"></i></a>4. 可視化（グラフ・ワードクラウド）</h3>\n<p data-sourcepos=\"57:1-57:126\">分解された語句を SPSS のグラフノードで可視化すると、以下のような分析結果を得られます：</p>\n<ul data-sourcepos=\"59:1-61:0\">\n<li data-sourcepos=\"59:1-59:80\">出現回数の棒グラフ（例：部屋 51件、ホテル 27件 など）</li>\n<li data-sourcepos=\"60:1-61:0\">ワードクラウドによる視覚的表現</li>\n</ul>\n<p data-sourcepos=\"62:1-62:108\">これにより、テキストデータの特徴や傾向を直感的に把握することができます。</p>\n<h3 data-sourcepos=\"64:1-64:36\">\n<span id=\"5-watsonxai-との比較紹介\" class=\"fragment\"></span><a href=\"#5-watsonxai-%E3%81%A8%E3%81%AE%E6%AF%94%E8%BC%83%E7%B4%B9%E4%BB%8B\"><i class=\"fa fa-link\"></i></a>5. watsonx.ai との比較紹介</h3>\n<p data-sourcepos=\"65:1-66:61\">デモ後半では、watsonx.ai でも同様に日本語の形態素解析が可能であることに触れ、<br>\nSPSS Modeler との使い分け例を紹介しています。</p>\n<hr data-sourcepos=\"68:1-69:0\">\n<h2 data-sourcepos=\"70:1-70:12\">\n<span id=\"まとめ\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>まとめ</h2>\n<p data-sourcepos=\"71:1-71:254\">本デモでは、<strong>SPSS Modeler 18.6 における日本語テキストアナリティクス機能の強化</strong> により、形態素解析から可視化までの一連の処理が SPSS 内でシームレスに実行できることが示されました。</p>\n<p data-sourcepos=\"73:1-73:183\">外部ツール不要で日本語テキストの分析が完結するため、データサイエンス業務の効率化や迅速なインサイト発見に大きく貢献します。</p>\n<hr data-sourcepos=\"75:1-75:3\">\n",
      "body": "![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/52151/496eed12-63f1-4fde-bf6f-88f386894ad8.png)\n\n\n:::note\n現在、Qiita Advent Calendar 2025を**完走する**ため猪突猛進しております:writing_hand:\n12月25日まで、エッホエッホ :laughing:\n:::\n\n# はじめに\n\nみなさん、IBM Videoというサイトをご存知でしょうか？\nIBMが提供する製品をショート動画でわかりやすくご紹介している動画サイトです。\n* スキルアップしたくてもなかなか時間が取れない\n* 気になる製品があるけど、マニュアルを読んで理解するのはきつい\n* 製品の特徴やメリットをクイックに知りたい\n\nという方には、うってつけの動画を提供するサイトです。\n興味のある方はぜひご覧いただければと思います。\n\n# 今回ご紹介する動画へのリンク\n\n[SPSS Modeler 新バージョンで「日本語テキストマイニング機能」をサクッと触ってみる](https://video.ibm.com/recorded/134169467)\n\n## 概要\nデモでは、**Cloud Pak for Data 上のSPSS Modeler に新たに追加された日本語テキストアナリティクス機能** を紹介しています。  \n2024年10月9日にリリースされたこの新機能により、これまで外部ツールや Python コードを用いて行う必要があった日本語テキストの形態素解析が **SPSS Modeler 内だけで完結** できるようになりました。\n\n英語では一般的だったテキスト分解・可視化処理（例：ワードクラウドなど）が、日本語でも簡単に実行できるようになり、データ分析の効率が大きく向上します。\n\n---\n\n## デモの流れと特徴\n### 1. SPSS Modeler プロジェクトの準備  \nCloud Pak for Data のトップページから既存プロジェクトを開き、SPSS Modeler のフローを利用して分析環境を構築します。\n\n### 2. 新機能：日本語テキスト分析ノードの紹介  \n今回追加されたのは以下の2つのコンポーネントです。  \n- **テキストリンク分析**  \n- **テキストマイニング**\n\nこれらをフローに配置することで、日本語テキストの分解と可視化が SPSS 内で完結します。\n\n### 3. 日本語テキストの読み込みと分解  \nデモでは、コメント列に日本語レビューが記載された Excel ファイルを読み込み、  \n**テキストリンク分析** ノードにて以下のように自動でコンセプト（語句）が抽出されます。\n\n例：  \n- 部屋\n- 清潔  \n- コストパフォーマンス  \n- 快適  \n- 優れ、など\n\n従来は MeCab などの外部形態素解析ツールを Python 経経由で呼び出す必要がありましたが、今回は **SPSS だけで分解が完了** しています。\n\n### 4. 可視化（グラフ・ワードクラウド）\n分解された語句を SPSS のグラフノードで可視化すると、以下のような分析結果を得られます：\n\n- 出現回数の棒グラフ（例：部屋 51件、ホテル 27件 など）  \n- ワードクラウドによる視覚的表現\n\nこれにより、テキストデータの特徴や傾向を直感的に把握することができます。\n\n### 5. watsonx.ai との比較紹介  \nデモ後半では、watsonx.ai でも同様に日本語の形態素解析が可能であることに触れ、  \nSPSS Modeler との使い分け例を紹介しています。\n\n---\n\n## まとめ\n本デモでは、**SPSS Modeler 18.6 における日本語テキストアナリティクス機能の強化** により、形態素解析から可視化までの一連の処理が SPSS 内でシームレスに実行できることが示されました。\n\n外部ツール不要で日本語テキストの分析が完結するため、データサイエンス業務の効率化や迅速なインサイト発見に大きく貢献します。\n\n---\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T12:53:35+09:00",
      "group": null,
      "id": "a220549b353820804436",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "SPSS_Modeler",
          "versions": []
        },
        {
          "name": "IBMVideo",
          "versions": []
        },
        {
          "name": "textminig",
          "versions": []
        }
      ],
      "title": "ショート動画でクイックに知る！ 『SPSS Modeler 新バージョンで「日本語テキストマイニング機能」をサクッと触ってみる』",
      "updated_at": "2025-12-11T12:53:35+09:00",
      "url": "https://qiita.com/yanagih/items/a220549b353820804436",
      "user": {
        "description": "このサイトにおける掲載内容はあくまで私自身の見解であり、必ずしも私の所属団体・企業における立場、戦略、意見を代表するものではありません。",
        "facebook_id": "",
        "followees_count": 34,
        "followers_count": 59,
        "github_login_name": null,
        "id": "yanagih",
        "items_count": 95,
        "linkedin_id": "",
        "location": "",
        "name": "Hideo Yanagi",
        "organization": "日本アイ・ビー・エム株式会社",
        "permanent_id": 52151,
        "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/52151/profile-images/1669860896",
        "team_only": false,
        "twitter_screen_name": "life_check",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<h2 data-sourcepos=\"2:1-2:47\">\n<span id=\"この記事は何か\" class=\"fragment\"></span><a href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AF%E4%BD%95%E3%81%8B\"><i class=\"fa fa-link\"></i></a>この記事は何か？</h2>\n<p data-sourcepos=\"4:1-4:106\">Playwrightで別タブや別ウィンドウを開くテストの基本的な実装方法を解説する。</p>\n<h2 data-sourcepos=\"6:1-6:29\">\n<span id=\"目次\" class=\"fragment\"></span><a href=\"#%E7%9B%AE%E6%AC%A1\"><i class=\"fa fa-link\"></i></a>目次</h2>\n<ul data-sourcepos=\"8:1-12:0\">\n<li data-sourcepos=\"8:1-8:124\"><a href=\"#%E5%88%A5%E3%82%BF%E3%83%96%E5%88%A5%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%8C%E5%BF%85%E8%A6%81%E3%81%AA%E5%A0%B4%E9%9D%A2\">別タブ・別ウィンドウのテストが必要な場面</a></li>\n<li data-sourcepos=\"9:1-9:130\"><a href=\"#%E5%88%A5%E3%82%BF%E3%83%96%E5%88%A5%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%AE%9F%E8%A3%85%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\">別タブ・別ウィンドウのテストの実装について</a></li>\n<li data-sourcepos=\"10:1-10:67\"><a href=\"#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E5%AE%9F%E8%A3%85%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\">基本的な実装パターン</a></li>\n<li data-sourcepos=\"11:1-12:0\"><a href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\">参考資料</a></li>\n</ul>\n<h2 data-sourcepos=\"13:1-13:63\">\n<span id=\"別タブ別ウィンドウのテストが必要な場面\" class=\"fragment\"></span><a href=\"#%E5%88%A5%E3%82%BF%E3%83%96%E5%88%A5%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%8C%E5%BF%85%E8%A6%81%E3%81%AA%E5%A0%B4%E9%9D%A2\"><i class=\"fa fa-link\"></i></a>別タブ・別ウィンドウのテストが必要な場面</h2>\n<p data-sourcepos=\"15:1-15:66\">以下のような機能をテストする際に必要となる。</p>\n<ul data-sourcepos=\"17:1-21:0\">\n<li data-sourcepos=\"17:1-17:32\">外部サイトへのリンク</li>\n<li data-sourcepos=\"18:1-18:50\">ヘルプページやドキュメントの表示</li>\n<li data-sourcepos=\"19:1-19:32\">PDF・画像の別タブ表示</li>\n<li data-sourcepos=\"20:1-21:0\">etc.</li>\n</ul>\n<h2 data-sourcepos=\"22:1-22:66\">\n<span id=\"別タブ別ウィンドウのテストの実装について\" class=\"fragment\"></span><a href=\"#%E5%88%A5%E3%82%BF%E3%83%96%E5%88%A5%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%AE%9F%E8%A3%85%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"><i class=\"fa fa-link\"></i></a>別タブ・別ウィンドウのテストの実装について</h2>\n<p data-sourcepos=\"24:1-24:166\">別タブ・別ウィンドウの操作は非同期イベントであるため、Promise.all()を使用してイベント待機とトリガー操作を処理する。</p>\n<ol data-sourcepos=\"26:1-28:0\">\n<li data-sourcepos=\"26:1-26:73\">\n<code>waitForEvent('popup')</code>: 新しいページが開かれるのを待機</li>\n<li data-sourcepos=\"27:1-28:0\">クリックなどのトリガー操作: 実際にページを開く動作</li>\n</ol>\n<h2 data-sourcepos=\"29:1-29:33\">\n<span id=\"基本的な実装パターン\" class=\"fragment\"></span><a href=\"#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E5%AE%9F%E8%A3%85%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"><i class=\"fa fa-link\"></i></a>基本的な実装パターン</h2>\n<p data-sourcepos=\"31:1-31:78\">Playwrightでは別タブと別ウィンドウの扱いは同じである。</p>\n<h3 data-sourcepos=\"33:1-33:51\">\n<span id=\"別タブが開くテスト\" class=\"fragment\"></span><a href=\"#%E5%88%A5%E3%82%BF%E3%83%96%E3%81%8C%E9%96%8B%E3%81%8F%E3%83%86%E3%82%B9%E3%83%88\"><i class=\"fa fa-link\"></i></a>別タブが開くテスト</h3>\n<p data-sourcepos=\"35:1-35:95\"><code>target=\"_blank\"リンク</code>などで別タブが開く場合のテストの実装例である。</p>\n<div class=\"code-frame\" data-lang=\"typescript\" data-sourcepos=\"37:1-54:3\"><div class=\"highlight\"><pre><code><span class=\"nf\">test</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">別タブでページを開く</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"k\">async </span><span class=\"p\">({</span> <span class=\"nx\">page</span> <span class=\"p\">})</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"k\">await</span> <span class=\"nx\">page</span><span class=\"p\">.</span><span class=\"nf\">goto</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">https://example.com</span><span class=\"dl\">'</span><span class=\"p\">);</span>\n  \n  <span class=\"c1\">// 新しいページオブジェクトを取得</span>\n  <span class=\"kd\">const</span> <span class=\"p\">[</span><span class=\"nx\">newPage</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"nb\">Promise</span><span class=\"p\">.</span><span class=\"nf\">all</span><span class=\"p\">([</span>\n    <span class=\"nx\">page</span><span class=\"p\">.</span><span class=\"nf\">waitForEvent</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">popup</span><span class=\"dl\">'</span><span class=\"p\">),</span>\n    <span class=\"nx\">page</span><span class=\"p\">.</span><span class=\"nf\">getByRole</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">link</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"na\">name</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">外部ページを開く</span><span class=\"dl\">'</span> <span class=\"p\">}).</span><span class=\"nf\">click</span><span class=\"p\">()</span>\n  <span class=\"p\">]);</span>\n    \n  <span class=\"c1\">// ページが開いたか検証</span>\n  <span class=\"k\">await</span> <span class=\"nf\">expect</span><span class=\"p\">(</span><span class=\"nx\">newPage</span><span class=\"p\">).</span><span class=\"nf\">toHaveURL</span><span class=\"p\">(</span><span class=\"sr\">/external</span><span class=\"se\">\\.</span><span class=\"sr\">html$/</span><span class=\"p\">);</span>\n  <span class=\"k\">await</span> <span class=\"nf\">expect</span><span class=\"p\">(</span><span class=\"nx\">newPage</span><span class=\"p\">.</span><span class=\"nf\">getByRole</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">heading</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"na\">name</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">外部ページ</span><span class=\"dl\">'</span> <span class=\"p\">})).</span><span class=\"nf\">toBeVisible</span><span class=\"p\">();</span>\n  \n  <span class=\"c1\">// ページを閉じる</span>\n  <span class=\"k\">await</span> <span class=\"nx\">newPage</span><span class=\"p\">.</span><span class=\"nf\">close</span><span class=\"p\">();</span>\n<span class=\"p\">});</span>\n</code></pre></div></div>\n<h3 data-sourcepos=\"56:1-56:60\">\n<span id=\"別ウィンドウが開くテスト\" class=\"fragment\"></span><a href=\"#%E5%88%A5%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E3%81%8C%E9%96%8B%E3%81%8F%E3%83%86%E3%82%B9%E3%83%88\"><i class=\"fa fa-link\"></i></a>別ウィンドウが開くテスト</h3>\n<p data-sourcepos=\"58:1-58:93\"><code>window.open()</code>などで別ウィンドウが開く場合のテストの実装例である。</p>\n<div class=\"code-frame\" data-lang=\"typescript\" data-sourcepos=\"60:1-77:3\"><div class=\"highlight\"><pre><code><span class=\"nf\">test</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">別ウィンドウを開く</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"k\">async </span><span class=\"p\">({</span> <span class=\"nx\">page</span> <span class=\"p\">})</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"k\">await</span> <span class=\"nx\">page</span><span class=\"p\">.</span><span class=\"nf\">goto</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">https://example.com</span><span class=\"dl\">'</span><span class=\"p\">);</span>\n\n  <span class=\"c1\">// 新しいページオブジェクトを取得</span>\n  <span class=\"kd\">const</span> <span class=\"p\">[</span><span class=\"nx\">popup</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"nb\">Promise</span><span class=\"p\">.</span><span class=\"nf\">all</span><span class=\"p\">([</span>\n    <span class=\"nx\">page</span><span class=\"p\">.</span><span class=\"nf\">waitForEvent</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">popup</span><span class=\"dl\">'</span><span class=\"p\">),</span>\n    <span class=\"nx\">page</span><span class=\"p\">.</span><span class=\"nf\">getByRole</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">button</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"na\">name</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">ポップアップを開く</span><span class=\"dl\">'</span> <span class=\"p\">}).</span><span class=\"nf\">click</span><span class=\"p\">()</span>\n  <span class=\"p\">]);</span>\n    \n  <span class=\"c1\">// ページが開いたか検証</span>\n  <span class=\"k\">await</span> <span class=\"nf\">expect</span><span class=\"p\">(</span><span class=\"nx\">popup</span><span class=\"p\">).</span><span class=\"nf\">toHaveURL</span><span class=\"p\">(</span><span class=\"sr\">/popup</span><span class=\"se\">\\.</span><span class=\"sr\">html$/</span><span class=\"p\">);</span>\n  <span class=\"k\">await</span> <span class=\"nf\">expect</span><span class=\"p\">(</span><span class=\"nx\">popup</span><span class=\"p\">.</span><span class=\"nf\">getByRole</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">heading</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"na\">name</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">Popup Window</span><span class=\"dl\">'</span> <span class=\"p\">})).</span><span class=\"nf\">toBeVisible</span><span class=\"p\">();</span>\n  \n  <span class=\"c1\">// ページを閉じる</span>\n  <span class=\"k\">await</span> <span class=\"nx\">popup</span><span class=\"p\">.</span><span class=\"nf\">close</span><span class=\"p\">();</span>\n<span class=\"p\">});</span>\n</code></pre></div></div>\n<h2 data-sourcepos=\"79:1-79:15\">\n<span id=\"参考資料\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\"><i class=\"fa fa-link\"></i></a>参考資料</h2>\n<ul data-sourcepos=\"81:1-81:81\">\n<li data-sourcepos=\"81:1-81:81\"><a href=\"https://playwright.dev/docs/pages\" rel=\"nofollow noopener\" target=\"_blank\">Pages - Playwright公式ドキュメント</a></li>\n</ul>\n",
      "body": "\n## この記事は何か？<!-- omit in toc -->\n\nPlaywrightで別タブや別ウィンドウを開くテストの基本的な実装方法を解説する。\n\n## 目次<!-- omit in toc -->\n\n- [別タブ・別ウィンドウのテストが必要な場面](#別タブ別ウィンドウのテストが必要な場面)\n- [別タブ・別ウィンドウのテストの実装について](#別タブ別ウィンドウのテストの実装について)\n- [基本的な実装パターン](#基本的な実装パターン)\n- [参考資料](#参考資料)\n\n## 別タブ・別ウィンドウのテストが必要な場面\n\n以下のような機能をテストする際に必要となる。\n\n- 外部サイトへのリンク\n- ヘルプページやドキュメントの表示\n- PDF・画像の別タブ表示\n- etc.\n\n## 別タブ・別ウィンドウのテストの実装について\n\n別タブ・別ウィンドウの操作は非同期イベントであるため、Promise.all()を使用してイベント待機とトリガー操作を処理する。\n\n1. `waitForEvent('popup')`: 新しいページが開かれるのを待機\n1. クリックなどのトリガー操作: 実際にページを開く動作\n\n## 基本的な実装パターン\n\nPlaywrightでは別タブと別ウィンドウの扱いは同じである。  \n\n### 別タブが開くテスト<!-- omit in toc -->\n\n`target=\"_blank\"リンク`などで別タブが開く場合のテストの実装例である。\n\n```typescript\ntest('別タブでページを開く', async ({ page }) => {\n  await page.goto('https://example.com');\n  \n  // 新しいページオブジェクトを取得\n  const [newPage] = await Promise.all([\n    page.waitForEvent('popup'),\n    page.getByRole('link', { name: '外部ページを開く' }).click()\n  ]);\n    \n  // ページが開いたか検証\n  await expect(newPage).toHaveURL(/external\\.html$/);\n  await expect(newPage.getByRole('heading', { name: '外部ページ' })).toBeVisible();\n  \n  // ページを閉じる\n  await newPage.close();\n});\n```\n\n### 別ウィンドウが開くテスト<!-- omit in toc -->\n\n`window.open()`などで別ウィンドウが開く場合のテストの実装例である。\n\n```typescript\ntest('別ウィンドウを開く', async ({ page }) => {\n  await page.goto('https://example.com');\n\n  // 新しいページオブジェクトを取得\n  const [popup] = await Promise.all([\n    page.waitForEvent('popup'),\n    page.getByRole('button', { name: 'ポップアップを開く' }).click()\n  ]);\n    \n  // ページが開いたか検証\n  await expect(popup).toHaveURL(/popup\\.html$/);\n  await expect(popup.getByRole('heading', { name: 'Popup Window' })).toBeVisible();\n  \n  // ページを閉じる\n  await popup.close();\n});\n```\n\n## 参考資料\n\n- [Pages - Playwright公式ドキュメント](https://playwright.dev/docs/pages)\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-11T12:40:12+09:00",
      "group": null,
      "id": "284a06b5be906ab72e55",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 1,
      "tags": [
        {
          "name": "TypeScript",
          "versions": []
        },
        {
          "name": "テスト自動化",
          "versions": []
        },
        {
          "name": "Playwright",
          "versions": []
        }
      ],
      "title": "Playwrightで別タブ・別ウィンドウを扱う",
      "updated_at": "2025-12-11T12:40:12+09:00",
      "url": "https://qiita.com/errguess40/items/284a06b5be906ab72e55",
      "user": {
        "description": "SES企業でQAエンジニアとして働いてます。",
        "facebook_id": "",
        "followees_count": 1,
        "followers_count": 1,
        "github_login_name": "curryudon08",
        "id": "errguess40",
        "items_count": 35,
        "linkedin_id": "",
        "location": "",
        "name": "",
        "organization": "",
        "permanent_id": 4217933,
        "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4217933/profile-images/1759652853",
        "team_only": false,
        "twitter_screen_name": "errguess40",
        "website_url": ""
      },
      "page_views_count": null,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "trending_by_likes"
    },
    {
      "rendered_body": "<h1 data-sourcepos=\"1:1-1:138\">\n<span id=\"difyとgemini-llmを活用したバイオインフォマティクス向けragチャットボット構築とbigquery連携実装ガイド\" class=\"fragment\"></span><a href=\"#dify%E3%81%A8gemini-llm%E3%82%92%E6%B4%BB%E7%94%A8%E3%81%97%E3%81%9F%E3%83%90%E3%82%A4%E3%82%AA%E3%82%A4%E3%83%B3%E3%83%95%E3%82%A9%E3%83%9E%E3%83%86%E3%82%A3%E3%82%AF%E3%82%B9%E5%90%91%E3%81%91rag%E3%83%81%E3%83%A3%E3%83%83%E3%83%88%E3%83%9C%E3%83%83%E3%83%88%E6%A7%8B%E7%AF%89%E3%81%A8bigquery%E9%80%A3%E6%90%BA%E5%AE%9F%E8%A3%85%E3%82%AC%E3%82%A4%E3%83%89\"><i class=\"fa fa-link\"></i></a>DifyとGemini LLMを活用したバイオインフォマティクス向けRAGチャットボット構築とBigQuery連携実装ガイド</h1>\n<blockquote data-sourcepos=\"3:1-4:201\">\n<p data-sourcepos=\"3:3-4:201\"><strong>対象読者</strong><br>\nバイオインフォマティクス研究者・エンジニア、AIチャットボット開発者、クラウド技術者、Qiita記事自動投稿に関心のある中級以上のプログラマー</p>\n</blockquote>\n<blockquote data-sourcepos=\"6:1-13:95\">\n<p data-sourcepos=\"6:3-6:41\"><strong>動作確認環境 / 前提条件</strong></p>\n<ul data-sourcepos=\"7:3-13:95\">\n<li data-sourcepos=\"7:3-7:43\">OS: Ubuntu 22.04 LTS / macOS Monterey</li>\n<li data-sourcepos=\"8:3-8:22\">Python 3.9以上</li>\n<li data-sourcepos=\"9:3-9:43\">Google Cloud SDK最新バージョン</li>\n<li data-sourcepos=\"10:3-10:32\">BigQueryアクセス権限</li>\n<li data-sourcepos=\"11:3-11:49\">Difyアカウント（無料プラン可）</li>\n<li data-sourcepos=\"12:3-12:51\">Google Cloud Vertex AI Gemini LLM利用権限</li>\n<li data-sourcepos=\"13:3-13:95\">前提知識: Pythonプログラミング基礎、REST API利用経験、GCPの基本操作</li>\n</ul>\n</blockquote>\n<blockquote data-sourcepos=\"15:1-18:107\">\n<p data-sourcepos=\"15:3-15:41\"><strong>この記事で得られること</strong></p>\n<ol data-sourcepos=\"16:3-18:107\">\n<li data-sourcepos=\"16:3-16:110\">Difyノーコードプラットフォームでバイオ知識ナレッジベースを構築する手順</li>\n<li data-sourcepos=\"17:3-17:95\">PythonでのGemini LLM連携による埋め込み検索＋自然言語応答の実装例</li>\n<li data-sourcepos=\"18:3-18:107\">BigQueryでのチャットボットログ蓄積と分析基盤設計、Next.jsによるWeb最適化例</li>\n</ol>\n</blockquote>\n<hr data-sourcepos=\"20:1-21:0\">\n<h2 data-sourcepos=\"22:1-22:79\">\n<span id=\"-導入aiナレッジベースとragチャットボットの重要性\" class=\"fragment\"></span><a href=\"#-%E5%B0%8E%E5%85%A5ai%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8%E3%83%99%E3%83%BC%E3%82%B9%E3%81%A8rag%E3%83%81%E3%83%A3%E3%83%83%E3%83%88%E3%83%9C%E3%83%83%E3%83%88%E3%81%AE%E9%87%8D%E8%A6%81%E6%80%A7\"><i class=\"fa fa-link\"></i></a>🧭 導入：AIナレッジベースとRAGチャットボットの重要性</h2>\n<p data-sourcepos=\"24:1-24:373\">GEM Labの若手調査員として新大陸の未知生命の探索調査を進める中、「大量の研究論文や解析報告をどう効率的に活用・共有するか」が課題となりました。バイオインフォマティクス領域ではデータも知識も膨大で散逸しやすく、調査活動の迅速な意思決定に支障をきたします。</p>\n<p data-sourcepos=\"26:1-26:455\">こうした課題を解決してくれるのが、最新のAI大規模言語モデル（LLM）を用いた<strong>RAG（Retrieval-Augmented Generation）チャットボット</strong>です。RAGは知識検索機能を組み合わせLLMの生成力で自然言語応答を行います。特にDifyのようなノーコードプラットフォームと、Google CloudのGemini LLMの組み合わせは導入の敷居が低く、かつ高度な対話が可能です。</p>\n<p data-sourcepos=\"28:1-28:396\">本記事では、GEM Labの調査員の視点でバイオインフォマティクス特化型チャットボットの構築から、大規模評価ログの管理、WebUI最適化までの技術的ワークフローを具体的に紹介します。これにより、読者の皆さんにも自分の研究や事業に適用可能な汎用技術として習得できる内容としています。</p>\n<hr data-sourcepos=\"30:1-31:0\">\n<h2 data-sourcepos=\"32:1-32:88\">\n<span id=\"-トピックの概要difyとgemini-llmで実現するragチャットボット\" class=\"fragment\"></span><a href=\"#-%E3%83%88%E3%83%94%E3%83%83%E3%82%AF%E3%81%AE%E6%A6%82%E8%A6%81dify%E3%81%A8gemini-llm%E3%81%A7%E5%AE%9F%E7%8F%BE%E3%81%99%E3%82%8Brag%E3%83%81%E3%83%A3%E3%83%83%E3%83%88%E3%83%9C%E3%83%83%E3%83%88\"><i class=\"fa fa-link\"></i></a>📘 トピックの概要：DifyとGemini LLMで実現するRAGチャットボット</h2>\n<h3 data-sourcepos=\"34:1-34:38\">\n<span id=\"difyプラットフォームとは\" class=\"fragment\"></span><a href=\"#dify%E3%83%97%E3%83%A9%E3%83%83%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%81%A8%E3%81%AF\"><i class=\"fa fa-link\"></i></a>Difyプラットフォームとは</h3>\n<p data-sourcepos=\"35:1-35:332\">Difyはノーコードで文章のチャンク分割・埋め込み検索を実現できるクラウドサービスです。大量文書を小さな情報単位に分割（チャンク化）し、意味的に近い情報を高速検索できます。GEM Labの未知生命データ解析報告もこの方式で管理可能です。</p>\n<h3 data-sourcepos=\"37:1-37:23\">\n<span id=\"gemini-llmの特徴\" class=\"fragment\"></span><a href=\"#gemini-llm%E3%81%AE%E7%89%B9%E5%BE%B4\"><i class=\"fa fa-link\"></i></a>Gemini LLMの特徴</h3>\n<p data-sourcepos=\"38:1-38:251\">Google Cloud Vertex AIで提供されるGemini LLMは、膨大な科学論文や技術データを学習した強力な大規模言語モデルです。検索した文書チャンクを入力に文脈を理解し、自然な回答を生成します。</p>\n<h3 data-sourcepos=\"40:1-40:22\">\n<span id=\"ragの技術背景\" class=\"fragment\"></span><a href=\"#rag%E3%81%AE%E6%8A%80%E8%A1%93%E8%83%8C%E6%99%AF\"><i class=\"fa fa-link\"></i></a>RAGの技術背景</h3>\n<p data-sourcepos=\"41:1-41:49\">RAGは大まかに2段階に分けられます：</p>\n<ol data-sourcepos=\"43:1-45:0\">\n<li data-sourcepos=\"43:1-43:129\">\n<strong>Retrieval（検索）</strong>：ユーザーの質問に関連する文書チャンクを埋め込みベクトル検索で特定</li>\n<li data-sourcepos=\"44:1-45:0\">\n<strong>Augmented Generation（拡張生成）</strong>：Gemini LLMに検索結果を与え、質問への回答を生成</li>\n</ol>\n<p data-sourcepos=\"46:1-46:141\">こうしてLLMの大量知識保持に加え、最新のローカル知見を活用できるハイブリッド設計が成り立ちます。</p>\n<p data-sourcepos=\"48:1-49:153\">（文章で図解イメージ案：<br>\n「質問入力 → ベクトル埋め込み → Dify検索 → 関連文書チャンク抽出 → Gemini LLMへ提供 → 自然言語回答生成」）</p>\n<hr data-sourcepos=\"51:1-52:0\">\n<h2 data-sourcepos=\"53:1-53:73\">\n<span id=\"-技術的な仕組みragとbigquery評価ログ基盤の詳細\" class=\"fragment\"></span><a href=\"#-%E6%8A%80%E8%A1%93%E7%9A%84%E3%81%AA%E4%BB%95%E7%B5%84%E3%81%BFrag%E3%81%A8bigquery%E8%A9%95%E4%BE%A1%E3%83%AD%E3%82%B0%E5%9F%BA%E7%9B%A4%E3%81%AE%E8%A9%B3%E7%B4%B0\"><i class=\"fa fa-link\"></i></a>🔧 技術的な仕組み：RAGとBigQuery評価ログ基盤の詳細</h2>\n<h3 data-sourcepos=\"55:1-55:67\">\n<span id=\"1-文章チャンクの再帰分割と重複チャンク戦略\" class=\"fragment\"></span><a href=\"#1-%E6%96%87%E7%AB%A0%E3%83%81%E3%83%A3%E3%83%B3%E3%82%AF%E3%81%AE%E5%86%8D%E5%B8%B0%E5%88%86%E5%89%B2%E3%81%A8%E9%87%8D%E8%A4%87%E3%83%81%E3%83%A3%E3%83%B3%E3%82%AF%E6%88%A6%E7%95%A5\"><i class=\"fa fa-link\"></i></a>1. 文章チャンクの再帰分割と重複チャンク戦略</h3>\n<p data-sourcepos=\"56:1-57:103\">長大な論文や報告を単純に分割すると、切れ目で意味があいまいになることがあります。再帰的な分割アルゴリズムで小単位に分割しつつ、前後のチャンクを重複させることで文脈を保持。<br>\nこの手法はDifyプラットフォーム上でGUI操作もしくはAPI経由で設定可能です。</p>\n<h3 data-sourcepos=\"59:1-59:37\">\n<span id=\"2-埋め込みベクトル検索\" class=\"fragment\"></span><a href=\"#2-%E5%9F%8B%E3%82%81%E8%BE%BC%E3%81%BF%E3%83%99%E3%82%AF%E3%83%88%E3%83%AB%E6%A4%9C%E7%B4%A2\"><i class=\"fa fa-link\"></i></a>2. 埋め込みベクトル検索</h3>\n<p data-sourcepos=\"60:1-60:227\">チャンク文書はBERT系埋め込みモデルでベクトル化され、検索時はcos類似度等で関連度スコアを算出。高速な類似度検索はANNアルゴリズム（HNSWなど）でスケールします。</p>\n<h3 data-sourcepos=\"62:1-62:48\">\n<span id=\"3-bigquery上の推論評価ログ管理\" class=\"fragment\"></span><a href=\"#3-bigquery%E4%B8%8A%E3%81%AE%E6%8E%A8%E8%AB%96%E8%A9%95%E4%BE%A1%E3%83%AD%E3%82%B0%E7%AE%A1%E7%90%86\"><i class=\"fa fa-link\"></i></a>3. BigQuery上の推論・評価ログ管理</h3>\n<p data-sourcepos=\"63:1-63:102\">GEM Labの膨大な推論データを扱うためBigQueryに下記テーブルを設計しました：</p>\n<ul data-sourcepos=\"65:1-68:0\">\n<li data-sourcepos=\"65:1-65:95\">\n<strong>InferenceLog</strong>：質問文、検索チャンクID、Gemini応答文、タイムスタンプ</li>\n<li data-sourcepos=\"66:1-66:94\">\n<strong>ResponseMetadata</strong>：Geminiの生成パラメータ（温度、最大トークン数等）</li>\n<li data-sourcepos=\"67:1-68:0\">\n<strong>UserFeedback</strong>：調査員からの評価スコアやコメント</li>\n</ul>\n<p data-sourcepos=\"69:1-69:129\">これらを結合分析し、対話性能の継続的改善と異常検知、性能モニタリングに活用しています。</p>\n<hr data-sourcepos=\"71:1-72:0\">\n<h2 data-sourcepos=\"73:1-73:102\">\n<span id=\"-実践編difyでのナレッジベース構築とpythonによる関連検索応答生成\" class=\"fragment\"></span><a href=\"#-%E5%AE%9F%E8%B7%B5%E7%B7%A8dify%E3%81%A7%E3%81%AE%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8%E3%83%99%E3%83%BC%E3%82%B9%E6%A7%8B%E7%AF%89%E3%81%A8python%E3%81%AB%E3%82%88%E3%82%8B%E9%96%A2%E9%80%A3%E6%A4%9C%E7%B4%A2%E5%BF%9C%E7%AD%94%E7%94%9F%E6%88%90\"><i class=\"fa fa-link\"></i></a>🧪 実践編：Difyでのナレッジベース構築とPythonによる関連検索＋応答生成</h2>\n<h3 data-sourcepos=\"75:1-75:84\">\n<span id=\"1-dify-guiでのテキストアップロードチャンク識別設定手順\" class=\"fragment\"></span><a href=\"#1-dify-gui%E3%81%A7%E3%81%AE%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89%E3%83%81%E3%83%A3%E3%83%B3%E3%82%AF%E8%AD%98%E5%88%A5%E8%A8%AD%E5%AE%9A%E6%89%8B%E9%A0%86\"><i class=\"fa fa-link\"></i></a>1. Dify GUIでのテキストアップロード・チャンク識別設定手順</h3>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"77:1-85:3\"><div class=\"highlight\"><pre><code><span class=\"c\"># Difyへログイン後の基本操作概要</span>\n<span class=\"c\"># 1. ナレッジベース作成 → [新規作成]クリック</span>\n<span class=\"c\"># 2. バイオ関連文書をPDF・テキストでアップロード</span>\n<span class=\"c\"># 3. チャンクサイズ（例：500トークン）とオーバーラップ率（例：20%）を設定</span>\n<span class=\"c\"># 4. 自動チャンク生成ボタン押下 → 分割処理実行開始</span>\n<span class=\"c\"># 5. 埋め込みベクトル生成&amp;インデックス作成の進捗を待つ</span>\n<span class=\"c\"># 6. 検索設定で類似度閾値や結果取得件数を調整</span>\n</code></pre></div></div>\n<blockquote data-sourcepos=\"87:1-87:119\">\n<p data-sourcepos=\"87:3-87:119\">GUIのため細部ステップは画面キャプチャ付きの公式ドキュメント参照がおすすめです。</p>\n</blockquote>\n<h3 data-sourcepos=\"89:1-89:80\">\n<span id=\"2-python擬似コードでの埋め込み検索とgemini-api呼び出し例\" class=\"fragment\"></span><a href=\"#2-python%E6%93%AC%E4%BC%BC%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E3%81%AE%E5%9F%8B%E3%82%81%E8%BE%BC%E3%81%BF%E6%A4%9C%E7%B4%A2%E3%81%A8gemini-api%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>2. Python擬似コードでの埋め込み検索とGemini API呼び出し例</h3>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"91:1-142:3\"><div class=\"highlight\"><pre><code><span class=\"kn\">import</span> <span class=\"n\">requests</span>\n<span class=\"kn\">import</span> <span class=\"n\">json</span>\n\n<span class=\"c1\"># DifyのAPIキーとGemini LLMエンドポイント\n</span><span class=\"n\">DIFY_API_URL</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">https://api.dify.ai/v1/search</span><span class=\"sh\">\"</span>\n<span class=\"n\">DIFY_API_KEY</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">your_dify_api_key</span><span class=\"sh\">\"</span>\n\n<span class=\"n\">GEMINI_API_URL</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">https://vertexai.googleapis.com/v1/projects/{project_id}/locations/{location}/models/{model}:predict</span><span class=\"sh\">\"</span>\n<span class=\"n\">GEMINI_API_KEY</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">your_gemini_api_key</span><span class=\"sh\">\"</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">search_chunks</span><span class=\"p\">(</span><span class=\"n\">question</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">):</span>\n    <span class=\"n\">headers</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"sh\">\"</span><span class=\"s\">Authorization</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">Bearer </span><span class=\"si\">{</span><span class=\"n\">DIFY_API_KEY</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">,</span>\n        <span class=\"sh\">\"</span><span class=\"s\">Content-Type</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sh\">\"</span><span class=\"s\">application/json</span><span class=\"sh\">\"</span><span class=\"p\">,</span>\n    <span class=\"p\">}</span>\n    <span class=\"n\">payload</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"sh\">\"</span><span class=\"s\">query</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">question</span><span class=\"p\">,</span>\n        <span class=\"sh\">\"</span><span class=\"s\">top_k</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"mi\">5</span>\n    <span class=\"p\">}</span>\n    <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"n\">requests</span><span class=\"p\">.</span><span class=\"nf\">post</span><span class=\"p\">(</span><span class=\"n\">DIFY_API_URL</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"o\">=</span><span class=\"n\">headers</span><span class=\"p\">,</span> <span class=\"n\">json</span><span class=\"o\">=</span><span class=\"n\">payload</span><span class=\"p\">)</span>\n    <span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">raise_for_status</span><span class=\"p\">()</span>\n    <span class=\"k\">return</span> <span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">json</span><span class=\"p\">()</span>  <span class=\"c1\"># 検索チャンクの詳細リスト\n</span>\n<span class=\"k\">def</span> <span class=\"nf\">generate_answer</span><span class=\"p\">(</span><span class=\"n\">context_chunks</span><span class=\"p\">:</span> <span class=\"nb\">list</span><span class=\"p\">,</span> <span class=\"n\">question</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">):</span>\n    <span class=\"n\">prompt</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">以下の情報を参考に質問に回答してください：</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"sh\">''</span><span class=\"p\">.</span><span class=\"nf\">join</span><span class=\"p\">([</span><span class=\"n\">c</span><span class=\"p\">[</span><span class=\"sh\">'</span><span class=\"s\">text</span><span class=\"sh\">'</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">c</span> <span class=\"ow\">in</span> <span class=\"n\">context_chunks</span><span class=\"p\">])</span><span class=\"si\">}</span><span class=\"se\">\\n</span><span class=\"s\">質問：</span><span class=\"si\">{</span><span class=\"n\">question</span><span class=\"si\">}</span><span class=\"se\">\\n</span><span class=\"s\">回答：</span><span class=\"sh\">\"</span>\n    <span class=\"n\">headers</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"sh\">\"</span><span class=\"s\">Authorization</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">Bearer </span><span class=\"si\">{</span><span class=\"n\">GEMINI_API_KEY</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">,</span>\n        <span class=\"sh\">\"</span><span class=\"s\">Content-Type</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sh\">\"</span><span class=\"s\">application/json</span><span class=\"sh\">\"</span><span class=\"p\">,</span>\n    <span class=\"p\">}</span>\n    <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"sh\">\"</span><span class=\"s\">instances</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"sh\">\"</span><span class=\"s\">content</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">prompt</span><span class=\"p\">}],</span>\n        <span class=\"sh\">\"</span><span class=\"s\">parameters</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"sh\">\"</span><span class=\"s\">temperature</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"mf\">0.3</span><span class=\"p\">,</span>\n            <span class=\"sh\">\"</span><span class=\"s\">maxOutputTokens</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"mi\">512</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n    <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"n\">requests</span><span class=\"p\">.</span><span class=\"nf\">post</span><span class=\"p\">(</span><span class=\"n\">GEMINI_API_URL</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"o\">=</span><span class=\"n\">headers</span><span class=\"p\">,</span> <span class=\"n\">json</span><span class=\"o\">=</span><span class=\"n\">data</span><span class=\"p\">)</span>\n    <span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">raise_for_status</span><span class=\"p\">()</span>\n    <span class=\"n\">pred</span> <span class=\"o\">=</span> <span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">json</span><span class=\"p\">()</span>\n    <span class=\"k\">return</span> <span class=\"n\">pred</span><span class=\"p\">[</span><span class=\"sh\">'</span><span class=\"s\">predictions</span><span class=\"sh\">'</span><span class=\"p\">][</span><span class=\"mi\">0</span><span class=\"p\">][</span><span class=\"sh\">'</span><span class=\"s\">content</span><span class=\"sh\">'</span><span class=\"p\">]</span>\n\n<span class=\"k\">if</span> <span class=\"n\">__name__</span> <span class=\"o\">==</span> <span class=\"sh\">\"</span><span class=\"s\">__main__</span><span class=\"sh\">\"</span><span class=\"p\">:</span>\n    <span class=\"n\">user_question</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">RNA-seqデータの正規化方法は何ですか？</span><span class=\"sh\">\"</span>\n    <span class=\"n\">search_result</span> <span class=\"o\">=</span> <span class=\"nf\">search_chunks</span><span class=\"p\">(</span><span class=\"n\">user_question</span><span class=\"p\">)</span>\n    <span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">search_result</span><span class=\"p\">.</span><span class=\"nf\">get</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\">results</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"p\">[])</span>\n    <span class=\"n\">answer</span> <span class=\"o\">=</span> <span class=\"nf\">generate_answer</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">user_question</span><span class=\"p\">)</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\">=== 質問 ===</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">user_question</span><span class=\"p\">)</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\">=== 回答 ===</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">answer</span><span class=\"p\">)</span>\n</code></pre></div></div>\n<ul data-sourcepos=\"144:1-144:35\">\n<li data-sourcepos=\"144:1-144:35\"><strong>ディレクトリ構成例</strong></li>\n</ul>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"145:1-150:3\"><div class=\"highlight\"><pre><code>project-root/\n├── main.py             # 上記コード\n├── requirements.txt    # requestsやGCPクライアント記載\n└── README.md\n</code></pre></div></div>\n<ul data-sourcepos=\"152:1-152:20\">\n<li data-sourcepos=\"152:1-152:20\"><strong>依存関係</strong></li>\n</ul>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"153:1-155:3\"><div class=\"highlight\"><pre><code>requests==2.28.1\n</code></pre></div></div>\n<hr data-sourcepos=\"157:1-158:0\">\n<h2 data-sourcepos=\"159:1-159:92\">\n<span id=\"-応用発展実用例バイオデータ解析とnextjsによるui最適化\" class=\"fragment\"></span><a href=\"#-%E5%BF%9C%E7%94%A8%E7%99%BA%E5%B1%95%E5%AE%9F%E7%94%A8%E4%BE%8B%E3%83%90%E3%82%A4%E3%82%AA%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%A8nextjs%E3%81%AB%E3%82%88%E3%82%8Bui%E6%9C%80%E9%81%A9%E5%8C%96\"><i class=\"fa fa-link\"></i></a>🚀 応用・発展・実用例：バイオデータ解析とNext.jsによるUI最適化</h2>\n<h3 data-sourcepos=\"161:1-161:55\">\n<span id=\"バイオインフォメティクスへの適用例\" class=\"fragment\"></span><a href=\"#%E3%83%90%E3%82%A4%E3%82%AA%E3%82%A4%E3%83%B3%E3%83%95%E3%82%A9%E3%83%A1%E3%83%86%E3%82%A3%E3%82%AF%E3%82%B9%E3%81%B8%E3%81%AE%E9%81%A9%E7%94%A8%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>バイオインフォメティクスへの適用例</h3>\n<ul data-sourcepos=\"162:1-164:0\">\n<li data-sourcepos=\"162:1-162:176\">ゲノム・RNA-seq解析論文のRAG検索で、解析方法やパラメータの即時回答を実現。調査員は未知生命ゲノムの特徴把握に活用可能。</li>\n<li data-sourcepos=\"163:1-164:0\">BigQueryの推論・評価ログから、質問傾向やGemini応答品質を分析し継続的チューニング。</li>\n</ul>\n<h3 data-sourcepos=\"165:1-165:84\">\n<span id=\"bigqueryスキーマ設計例推論レスポンス評価テーブル\" class=\"fragment\"></span><a href=\"#bigquery%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E8%A8%AD%E8%A8%88%E4%BE%8B%E6%8E%A8%E8%AB%96%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9%E8%A9%95%E4%BE%A1%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB\"><i class=\"fa fa-link\"></i></a>BigQueryスキーマ設計例（推論・レスポンス・評価テーブル）</h3>\n<div class=\"code-frame\" data-lang=\"sql\" data-sourcepos=\"167:1-191:3\"><div class=\"highlight\"><pre><code><span class=\"k\">CREATE</span> <span class=\"k\">TABLE</span> <span class=\"n\">InferenceLog</span> <span class=\"p\">(</span>\n    <span class=\"n\">id</span> <span class=\"n\">STRING</span> <span class=\"k\">PRIMARY</span> <span class=\"k\">KEY</span><span class=\"p\">,</span>\n    <span class=\"n\">user_query</span> <span class=\"n\">STRING</span><span class=\"p\">,</span>\n    <span class=\"n\">retrieved_chunks</span> <span class=\"n\">ARRAY</span><span class=\"o\">&lt;</span><span class=\"n\">STRING</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n    <span class=\"n\">gemini_response</span> <span class=\"n\">STRING</span><span class=\"p\">,</span>\n    <span class=\"nb\">timestamp</span> <span class=\"nb\">TIMESTAMP</span>\n<span class=\"p\">);</span>\n\n<span class=\"k\">CREATE</span> <span class=\"k\">TABLE</span> <span class=\"n\">ResponseMetadata</span> <span class=\"p\">(</span>\n    <span class=\"n\">inference_id</span> <span class=\"n\">STRING</span><span class=\"p\">,</span>\n    <span class=\"n\">temperature</span> <span class=\"n\">FLOAT64</span><span class=\"p\">,</span>\n    <span class=\"n\">max_tokens</span> <span class=\"n\">INT64</span><span class=\"p\">,</span>\n    <span class=\"n\">model_version</span> <span class=\"n\">STRING</span><span class=\"p\">,</span>\n    <span class=\"k\">FOREIGN</span> <span class=\"k\">KEY</span> <span class=\"p\">(</span><span class=\"n\">inference_id</span><span class=\"p\">)</span> <span class=\"k\">REFERENCES</span> <span class=\"n\">InferenceLog</span><span class=\"p\">(</span><span class=\"n\">id</span><span class=\"p\">)</span>\n<span class=\"p\">);</span>\n\n<span class=\"k\">CREATE</span> <span class=\"k\">TABLE</span> <span class=\"n\">UserFeedback</span> <span class=\"p\">(</span>\n    <span class=\"n\">inference_id</span> <span class=\"n\">STRING</span><span class=\"p\">,</span>\n    <span class=\"n\">feedback_score</span> <span class=\"n\">INT64</span><span class=\"p\">,</span> <span class=\"c1\">-- 1-5評価</span>\n    <span class=\"k\">comment</span> <span class=\"n\">STRING</span><span class=\"p\">,</span>\n    <span class=\"nb\">timestamp</span> <span class=\"nb\">TIMESTAMP</span><span class=\"p\">,</span>\n    <span class=\"k\">FOREIGN</span> <span class=\"k\">KEY</span> <span class=\"p\">(</span><span class=\"n\">inference_id</span><span class=\"p\">)</span> <span class=\"k\">REFERENCES</span> <span class=\"n\">InferenceLog</span><span class=\"p\">(</span><span class=\"n\">id</span><span class=\"p\">)</span>\n<span class=\"p\">);</span>\n</code></pre></div></div>\n<h3 data-sourcepos=\"193:1-193:65\">\n<span id=\"nextjs-proxytsでのプリフェッチ制御コード抜粋\" class=\"fragment\"></span><a href=\"#nextjs-proxyts%E3%81%A7%E3%81%AE%E3%83%97%E3%83%AA%E3%83%95%E3%82%A7%E3%83%83%E3%83%81%E5%88%B6%E5%BE%A1%E3%82%B3%E3%83%BC%E3%83%89%E6%8A%9C%E7%B2%8B\"><i class=\"fa fa-link\"></i></a>Next.js proxy.tsでのプリフェッチ制御コード抜粋</h3>\n<div class=\"code-frame\" data-lang=\"typescript\" data-sourcepos=\"195:1-225:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">// proxy.ts: Next.js API routeでGemini API呼び出し簡略化かつプリフェッチ無効化設定</span>\n<span class=\"k\">import</span> <span class=\"kd\">type</span> <span class=\"p\">{</span> <span class=\"nx\">NextApiRequest</span><span class=\"p\">,</span> <span class=\"nx\">NextApiResponse</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">next</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">config</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"na\">api</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"na\">bodyParser</span><span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">,</span>\n    <span class=\"na\">externalResolver</span><span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">,</span>\n  <span class=\"p\">},</span>\n<span class=\"p\">};</span>\n\n<span class=\"k\">export</span> <span class=\"k\">default</span> <span class=\"k\">async</span> <span class=\"kd\">function</span> <span class=\"nf\">handler</span><span class=\"p\">(</span><span class=\"nx\">req</span><span class=\"p\">:</span> <span class=\"nx\">NextApiRequest</span><span class=\"p\">,</span> <span class=\"nx\">res</span><span class=\"p\">:</span> <span class=\"nx\">NextApiResponse</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// プリフェッチ制御：GETメソッド時の過剰呼出し防止</span>\n  <span class=\"k\">if </span><span class=\"p\">(</span><span class=\"nx\">req</span><span class=\"p\">.</span><span class=\"nx\">method</span> <span class=\"o\">===</span> <span class=\"dl\">'</span><span class=\"s1\">GET</span><span class=\"dl\">'</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nx\">req</span><span class=\"p\">.</span><span class=\"nx\">headers</span><span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">x-nextjs-data-prefetch</span><span class=\"dl\">'</span><span class=\"p\">]</span> <span class=\"o\">===</span> <span class=\"dl\">'</span><span class=\"s1\">1</span><span class=\"dl\">'</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"k\">return</span> <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nf\">status</span><span class=\"p\">(</span><span class=\"mi\">204</span><span class=\"p\">).</span><span class=\"nf\">end</span><span class=\"p\">();</span>\n  <span class=\"p\">}</span>\n  \n  <span class=\"c1\">// Gemini API呼び出し処理をここに記述</span>\n  <span class=\"c1\">// 例: fetchでPOST送信し結果を返す</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">response</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"nf\">fetch</span><span class=\"p\">(</span><span class=\"nx\">process</span><span class=\"p\">.</span><span class=\"nx\">env</span><span class=\"p\">.</span><span class=\"nx\">GEMINI_API_ENDPOINT</span><span class=\"o\">!</span><span class=\"p\">,</span> <span class=\"p\">{</span>\n    <span class=\"na\">method</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">POST</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n    <span class=\"na\">headers</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"dl\">'</span><span class=\"s1\">Content-Type</span><span class=\"dl\">'</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">application/json</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n      <span class=\"dl\">'</span><span class=\"s1\">Authorization</span><span class=\"dl\">'</span><span class=\"p\">:</span> <span class=\"s2\">`Bearer </span><span class=\"p\">${</span><span class=\"nx\">process</span><span class=\"p\">.</span><span class=\"nx\">env</span><span class=\"p\">.</span><span class=\"nx\">GEMINI_API_KEY</span><span class=\"p\">}</span><span class=\"s2\">`</span><span class=\"p\">,</span>\n    <span class=\"p\">},</span>\n    <span class=\"na\">body</span><span class=\"p\">:</span> <span class=\"nx\">JSON</span><span class=\"p\">.</span><span class=\"nf\">stringify</span><span class=\"p\">(</span><span class=\"nx\">req</span><span class=\"p\">.</span><span class=\"nx\">body</span><span class=\"p\">),</span>\n  <span class=\"p\">});</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">data</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"nx\">response</span><span class=\"p\">.</span><span class=\"nf\">json</span><span class=\"p\">();</span>\n  <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nf\">status</span><span class=\"p\">(</span><span class=\"nx\">response</span><span class=\"p\">.</span><span class=\"nx\">status</span><span class=\"p\">).</span><span class=\"nf\">json</span><span class=\"p\">(</span><span class=\"nx\">data</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n<hr data-sourcepos=\"227:1-228:0\">\n<h2 data-sourcepos=\"229:1-229:32\">\n<span id=\"-まとめtakeaways\" class=\"fragment\"></span><a href=\"#-%E3%81%BE%E3%81%A8%E3%82%81takeaways\"><i class=\"fa fa-link\"></i></a>📝 まとめ（Takeaways）</h2>\n<ul data-sourcepos=\"231:1-236:0\">\n<li data-sourcepos=\"231:1-231:156\">DifyとGemini LLMの連携で、バイオインフォマティクス領域の専門知識を活用したRAGチャットボットを手軽に構築可能</li>\n<li data-sourcepos=\"232:1-232:112\">文章チャンクの再帰分割・重複戦略と埋め込み検索により高度な文脈理解を実現</li>\n<li data-sourcepos=\"233:1-233:93\">BigQueryを用いた推論・評価ログ管理は継続的品質改善の基盤となる</li>\n<li data-sourcepos=\"234:1-234:91\">Next.jsのAPIルートを活用したWebUI最適化でユーザー体験向上が可能</li>\n<li data-sourcepos=\"235:1-236:0\">GEM Labの調査環境で得られた知見は将来的な未知生命の迅速解析・意思決定を後押しする</li>\n</ul>\n<hr data-sourcepos=\"237:1-238:0\">\n<h2 data-sourcepos=\"239:1-239:10\">\n<span id=\"-faq\" class=\"fragment\"></span><a href=\"#-faq\"><i class=\"fa fa-link\"></i></a>❓ FAQ</h2>\n<p data-sourcepos=\"241:1-241:59\"><strong>Q1: Gemini LLMを使う際に注意すべき点は？</strong></p>\n<ul data-sourcepos=\"242:1-244:0\">\n<li data-sourcepos=\"242:1-242:100\">セキュリティトークン管理を厳重にし、不正利用を防止してください。</li>\n<li data-sourcepos=\"243:1-244:0\">モデルの応答生成パラメータはケースに応じて調整し、無用な長文生成を避けることが重要です。</li>\n</ul>\n<p data-sourcepos=\"245:1-245:86\"><strong>Q2: Difyノーコードプラットフォームの無料プランで制限は？</strong></p>\n<ul data-sourcepos=\"246:1-247:0\">\n<li data-sourcepos=\"246:1-247:0\">一部機能制限や同時利用リクエスト数制限があります。大規模運用時は有料プラン検討を推奨します。</li>\n</ul>\n<p data-sourcepos=\"248:1-248:51\"><strong>Q3: BigQueryの料金を抑える工夫は？</strong></p>\n<ul data-sourcepos=\"249:1-250:0\">\n<li data-sourcepos=\"249:1-250:0\">ログは必要最小限に絞り、パーティショニングやクラスタリングを活用してクエリコスト低減を図ります。</li>\n</ul>\n<p data-sourcepos=\"251:1-251:61\"><strong>Q4: 他言語やフレームワークでの応用は？</strong></p>\n<ul data-sourcepos=\"252:1-253:0\">\n<li data-sourcepos=\"252:1-253:0\">REST APIベースなので、Python以外にNode.jsやGoなど任意言語からの連携が可能です。</li>\n</ul>\n<hr data-sourcepos=\"254:1-255:0\">\n<h2 data-sourcepos=\"256:1-256:35\">\n<span id=\"-参考文献リンク集\" class=\"fragment\"></span><a href=\"#-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%E3%83%AA%E3%83%B3%E3%82%AF%E9%9B%86\"><i class=\"fa fa-link\"></i></a>🔗 参考文献・リンク集</h2>\n<ul data-sourcepos=\"258:1-265:0\">\n<li data-sourcepos=\"258:1-258:48\"><a href=\"https://www.dify.ai/\" rel=\"nofollow noopener\" target=\"_blank\">Dify 公式サイト</a></li>\n<li data-sourcepos=\"259:1-259:114\"><a href=\"https://cloud.google.com/vertex-ai/docs/generative-ai/learn/gemini-models\" rel=\"nofollow noopener\" target=\"_blank\">Google Cloud Vertex AI Gemini LLM</a></li>\n<li data-sourcepos=\"260:1-260:79\"><a href=\"https://cloud.google.com/bigquery/docs\" rel=\"nofollow noopener\" target=\"_blank\">BigQuery 公式ドキュメント</a></li>\n<li data-sourcepos=\"261:1-261:73\"><a href=\"https://nextjs.org/docs/api-routes/introduction\" rel=\"nofollow noopener\" target=\"_blank\">Next.js API Routes</a></li>\n<li data-sourcepos=\"262:1-265:0\">過去の関連Qiita記事\n<ul data-sourcepos=\"263:3-265:0\">\n<li data-sourcepos=\"263:3-263:139\"><a href=\"https://qiita.com/cocokara_bioinfo/items/4bd415ef2f801497951e\" id=\"reference-63efa376bc2936534d07\">PythonでQiita記事投稿を自動化するパイプライン構築</a></li>\n<li data-sourcepos=\"264:3-265:0\"><a href=\"https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957\" id=\"reference-5883d22086266fd31595\">Python × GitHub Actions でのQiita自動投稿パイプライン</a></li>\n</ul>\n</li>\n</ul>\n<hr data-sourcepos=\"266:1-267:0\">\n<p data-sourcepos=\"268:1-268:265\">GEM Labの調査活動は今後もAIとクラウド技術を駆使した未知生命解析高度化を目指します。次回はGemini LLMのカスタムチューニングや多言語チャットボット展開に迫る予定です。乞うご期待ください。</p>\n",
      "body": "# DifyとGemini LLMを活用したバイオインフォマティクス向けRAGチャットボット構築とBigQuery連携実装ガイド\n\n> **対象読者**  \n> バイオインフォマティクス研究者・エンジニア、AIチャットボット開発者、クラウド技術者、Qiita記事自動投稿に関心のある中級以上のプログラマー\n\n> **動作確認環境 / 前提条件**  \n> - OS: Ubuntu 22.04 LTS / macOS Monterey  \n> - Python 3.9以上  \n> - Google Cloud SDK最新バージョン  \n> - BigQueryアクセス権限  \n> - Difyアカウント（無料プラン可）  \n> - Google Cloud Vertex AI Gemini LLM利用権限  \n> - 前提知識: Pythonプログラミング基礎、REST API利用経験、GCPの基本操作\n\n> **この記事で得られること**  \n> 1. Difyノーコードプラットフォームでバイオ知識ナレッジベースを構築する手順  \n> 2. PythonでのGemini LLM連携による埋め込み検索＋自然言語応答の実装例  \n> 3. BigQueryでのチャットボットログ蓄積と分析基盤設計、Next.jsによるWeb最適化例\n\n---\n\n## 🧭 導入：AIナレッジベースとRAGチャットボットの重要性\n\nGEM Labの若手調査員として新大陸の未知生命の探索調査を進める中、「大量の研究論文や解析報告をどう効率的に活用・共有するか」が課題となりました。バイオインフォマティクス領域ではデータも知識も膨大で散逸しやすく、調査活動の迅速な意思決定に支障をきたします。\n\nこうした課題を解決してくれるのが、最新のAI大規模言語モデル（LLM）を用いた**RAG（Retrieval-Augmented Generation）チャットボット**です。RAGは知識検索機能を組み合わせLLMの生成力で自然言語応答を行います。特にDifyのようなノーコードプラットフォームと、Google CloudのGemini LLMの組み合わせは導入の敷居が低く、かつ高度な対話が可能です。\n\n本記事では、GEM Labの調査員の視点でバイオインフォマティクス特化型チャットボットの構築から、大規模評価ログの管理、WebUI最適化までの技術的ワークフローを具体的に紹介します。これにより、読者の皆さんにも自分の研究や事業に適用可能な汎用技術として習得できる内容としています。\n\n---\n\n## 📘 トピックの概要：DifyとGemini LLMで実現するRAGチャットボット\n\n### Difyプラットフォームとは  \nDifyはノーコードで文章のチャンク分割・埋め込み検索を実現できるクラウドサービスです。大量文書を小さな情報単位に分割（チャンク化）し、意味的に近い情報を高速検索できます。GEM Labの未知生命データ解析報告もこの方式で管理可能です。\n\n### Gemini LLMの特徴  \nGoogle Cloud Vertex AIで提供されるGemini LLMは、膨大な科学論文や技術データを学習した強力な大規模言語モデルです。検索した文書チャンクを入力に文脈を理解し、自然な回答を生成します。\n\n### RAGの技術背景  \nRAGは大まかに2段階に分けられます：\n\n1. **Retrieval（検索）**：ユーザーの質問に関連する文書チャンクを埋め込みベクトル検索で特定  \n2. **Augmented Generation（拡張生成）**：Gemini LLMに検索結果を与え、質問への回答を生成\n\nこうしてLLMの大量知識保持に加え、最新のローカル知見を活用できるハイブリッド設計が成り立ちます。\n\n（文章で図解イメージ案：  \n「質問入力 → ベクトル埋め込み → Dify検索 → 関連文書チャンク抽出 → Gemini LLMへ提供 → 自然言語回答生成」）\n\n---\n\n## 🔧 技術的な仕組み：RAGとBigQuery評価ログ基盤の詳細\n\n### 1. 文章チャンクの再帰分割と重複チャンク戦略  \n長大な論文や報告を単純に分割すると、切れ目で意味があいまいになることがあります。再帰的な分割アルゴリズムで小単位に分割しつつ、前後のチャンクを重複させることで文脈を保持。  \nこの手法はDifyプラットフォーム上でGUI操作もしくはAPI経由で設定可能です。\n\n### 2. 埋め込みベクトル検索  \nチャンク文書はBERT系埋め込みモデルでベクトル化され、検索時はcos類似度等で関連度スコアを算出。高速な類似度検索はANNアルゴリズム（HNSWなど）でスケールします。\n\n### 3. BigQuery上の推論・評価ログ管理  \nGEM Labの膨大な推論データを扱うためBigQueryに下記テーブルを設計しました：\n\n- **InferenceLog**：質問文、検索チャンクID、Gemini応答文、タイムスタンプ\n- **ResponseMetadata**：Geminiの生成パラメータ（温度、最大トークン数等）\n- **UserFeedback**：調査員からの評価スコアやコメント\n\nこれらを結合分析し、対話性能の継続的改善と異常検知、性能モニタリングに活用しています。\n\n---\n\n## 🧪 実践編：Difyでのナレッジベース構築とPythonによる関連検索＋応答生成\n\n### 1. Dify GUIでのテキストアップロード・チャンク識別設定手順\n\n```bash\n# Difyへログイン後の基本操作概要\n# 1. ナレッジベース作成 → [新規作成]クリック\n# 2. バイオ関連文書をPDF・テキストでアップロード\n# 3. チャンクサイズ（例：500トークン）とオーバーラップ率（例：20%）を設定\n# 4. 自動チャンク生成ボタン押下 → 分割処理実行開始\n# 5. 埋め込みベクトル生成&インデックス作成の進捗を待つ\n# 6. 検索設定で類似度閾値や結果取得件数を調整\n```\n\n> GUIのため細部ステップは画面キャプチャ付きの公式ドキュメント参照がおすすめです。\n\n### 2. Python擬似コードでの埋め込み検索とGemini API呼び出し例\n\n```python\nimport requests\nimport json\n\n# DifyのAPIキーとGemini LLMエンドポイント\nDIFY_API_URL = \"https://api.dify.ai/v1/search\"\nDIFY_API_KEY = \"your_dify_api_key\"\n\nGEMINI_API_URL = \"https://vertexai.googleapis.com/v1/projects/{project_id}/locations/{location}/models/{model}:predict\"\nGEMINI_API_KEY = \"your_gemini_api_key\"\n\ndef search_chunks(question: str):\n    headers = {\n        \"Authorization\": f\"Bearer {DIFY_API_KEY}\",\n        \"Content-Type\": \"application/json\",\n    }\n    payload = {\n        \"query\": question,\n        \"top_k\": 5\n    }\n    response = requests.post(DIFY_API_URL, headers=headers, json=payload)\n    response.raise_for_status()\n    return response.json()  # 検索チャンクの詳細リスト\n\ndef generate_answer(context_chunks: list, question: str):\n    prompt = f\"以下の情報を参考に質問に回答してください：\\n{''.join([c['text'] for c in context_chunks])}\\n質問：{question}\\n回答：\"\n    headers = {\n        \"Authorization\": f\"Bearer {GEMINI_API_KEY}\",\n        \"Content-Type\": \"application/json\",\n    }\n    data = {\n        \"instances\": [{\"content\": prompt}],\n        \"parameters\": {\n            \"temperature\": 0.3,\n            \"maxOutputTokens\": 512\n        }\n    }\n    response = requests.post(GEMINI_API_URL, headers=headers, json=data)\n    response.raise_for_status()\n    pred = response.json()\n    return pred['predictions'][0]['content']\n\nif __name__ == \"__main__\":\n    user_question = \"RNA-seqデータの正規化方法は何ですか？\"\n    search_result = search_chunks(user_question)\n    context = search_result.get(\"results\", [])\n    answer = generate_answer(context, user_question)\n    print(\"=== 質問 ===\")\n    print(user_question)\n    print(\"=== 回答 ===\")\n    print(answer)\n```\n\n- **ディレクトリ構成例**  \n```\nproject-root/\n├── main.py             # 上記コード\n├── requirements.txt    # requestsやGCPクライアント記載\n└── README.md\n```\n\n- **依存関係**  \n```\nrequests==2.28.1\n```\n\n---\n\n## 🚀 応用・発展・実用例：バイオデータ解析とNext.jsによるUI最適化\n\n### バイオインフォメティクスへの適用例  \n- ゲノム・RNA-seq解析論文のRAG検索で、解析方法やパラメータの即時回答を実現。調査員は未知生命ゲノムの特徴把握に活用可能。  \n- BigQueryの推論・評価ログから、質問傾向やGemini応答品質を分析し継続的チューニング。  \n\n### BigQueryスキーマ設計例（推論・レスポンス・評価テーブル）\n\n```sql\nCREATE TABLE InferenceLog (\n    id STRING PRIMARY KEY,\n    user_query STRING,\n    retrieved_chunks ARRAY<STRING>,\n    gemini_response STRING,\n    timestamp TIMESTAMP\n);\n\nCREATE TABLE ResponseMetadata (\n    inference_id STRING,\n    temperature FLOAT64,\n    max_tokens INT64,\n    model_version STRING,\n    FOREIGN KEY (inference_id) REFERENCES InferenceLog(id)\n);\n\nCREATE TABLE UserFeedback (\n    inference_id STRING,\n    feedback_score INT64, -- 1-5評価\n    comment STRING,\n    timestamp TIMESTAMP,\n    FOREIGN KEY (inference_id) REFERENCES InferenceLog(id)\n);\n```\n\n### Next.js proxy.tsでのプリフェッチ制御コード抜粋\n\n```typescript\n// proxy.ts: Next.js API routeでGemini API呼び出し簡略化かつプリフェッチ無効化設定\nimport type { NextApiRequest, NextApiResponse } from 'next';\n\nexport const config = {\n  api: {\n    bodyParser: true,\n    externalResolver: true,\n  },\n};\n\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\n  // プリフェッチ制御：GETメソッド時の過剰呼出し防止\n  if (req.method === 'GET' && req.headers['x-nextjs-data-prefetch'] === '1') {\n    return res.status(204).end();\n  }\n  \n  // Gemini API呼び出し処理をここに記述\n  // 例: fetchでPOST送信し結果を返す\n  const response = await fetch(process.env.GEMINI_API_ENDPOINT!, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${process.env.GEMINI_API_KEY}`,\n    },\n    body: JSON.stringify(req.body),\n  });\n  const data = await response.json();\n  res.status(response.status).json(data);\n}\n```\n\n---\n\n## 📝 まとめ（Takeaways）\n\n- DifyとGemini LLMの連携で、バイオインフォマティクス領域の専門知識を活用したRAGチャットボットを手軽に構築可能  \n- 文章チャンクの再帰分割・重複戦略と埋め込み検索により高度な文脈理解を実現  \n- BigQueryを用いた推論・評価ログ管理は継続的品質改善の基盤となる  \n- Next.jsのAPIルートを活用したWebUI最適化でユーザー体験向上が可能  \n- GEM Labの調査環境で得られた知見は将来的な未知生命の迅速解析・意思決定を後押しする\n\n---\n\n## ❓ FAQ\n\n**Q1: Gemini LLMを使う際に注意すべき点は？**  \n- セキュリティトークン管理を厳重にし、不正利用を防止してください。  \n- モデルの応答生成パラメータはケースに応じて調整し、無用な長文生成を避けることが重要です。  \n\n**Q2: Difyノーコードプラットフォームの無料プランで制限は？**  \n- 一部機能制限や同時利用リクエスト数制限があります。大規模運用時は有料プラン検討を推奨します。  \n\n**Q3: BigQueryの料金を抑える工夫は？**  \n- ログは必要最小限に絞り、パーティショニングやクラスタリングを活用してクエリコスト低減を図ります。  \n\n**Q4: 他言語やフレームワークでの応用は？**  \n- REST APIベースなので、Python以外にNode.jsやGoなど任意言語からの連携が可能です。\n\n---\n\n## 🔗 参考文献・リンク集\n\n- [Dify 公式サイト](https://www.dify.ai/)  \n- [Google Cloud Vertex AI Gemini LLM](https://cloud.google.com/vertex-ai/docs/generative-ai/learn/gemini-models)  \n- [BigQuery 公式ドキュメント](https://cloud.google.com/bigquery/docs)  \n- [Next.js API Routes](https://nextjs.org/docs/api-routes/introduction)  \n- 過去の関連Qiita記事  \n  - [PythonでQiita記事投稿を自動化するパイプライン構築](https://qiita.com/cocokara_bioinfo/items/4bd415ef2f801497951e)  \n  - [Python × GitHub Actions でのQiita自動投稿パイプライン](https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957)  \n\n---\n\nGEM Labの調査活動は今後もAIとクラウド技術を駆使した未知生命解析高度化を目指します。次回はGemini LLMのカスタムチューニングや多言語チャットボット展開に迫る予定です。乞うご期待ください。\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-07T20:08:00+09:00",
      "group": null,
      "id": "0db33ffad46d14781952",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Python",
          "versions": []
        },
        {
          "name": "自動化",
          "versions": []
        }
      ],
      "title": "DifyとGemini LLMを活用したバイオインフォマティクス向けRAGチャットボット構築とBigQuery連携実装ガイド",
      "updated_at": "2025-12-07T20:08:00+09:00",
      "url": "https://qiita.com/cocokara_bioinfo/items/0db33ffad46d14781952",
      "user": {
        "description": "ポッケ村出身の名もなき若手生物学研究員です。\r\n現代の技術やエンジニア知識を学びながらモンスターハンターの生態・生物学研究に日々励んでおります！\r\nまだまだ勉強不足なところはありますが、皆さんに少しでも学びになるものをお届けできればとの思いで発信させていただきます\r\n\r\n※フィクションとして、時にTips記事として楽しんでいただければ幸いです",
        "facebook_id": "",
        "followees_count": 3,
        "followers_count": 0,
        "github_login_name": null,
        "id": "cocokara_bioinfo",
        "items_count": 4,
        "linkedin_id": "",
        "location": "",
        "name": "シャル・S 調査員",
        "organization": "Genome & Ecology Monster-Lab (架空)",
        "permanent_id": 4288059,
        "profile_image_url": "https://lh3.googleusercontent.com/a/ACg8ocLkgrrRuDzozKQ4XeInetzc0um1rPWRGXY2daT9pLIi1z1JdQ=s96-c",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": ""
      },
      "page_views_count": 188,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "my_popular"
    },
    {
      "rendered_body": "<hr data-sourcepos=\"1:1-2:0\">\n<blockquote data-sourcepos=\"3:1-7:93\">\n<p data-sourcepos=\"3:3-3:20\"><strong>対象読者</strong></p>\n<ul data-sourcepos=\"4:3-7:93\">\n<li data-sourcepos=\"4:3-4:97\">日々のコーディングやデータ解析を効率化したいエンジニア・研究者</li>\n<li data-sourcepos=\"5:3-5:65\">GitHub Copilotの次に試すAIツールを探している方</li>\n<li data-sourcepos=\"6:3-6:105\">バイオインフォマティクスに興味があり、AIをどう活用できるか知りたい方</li>\n<li data-sourcepos=\"7:3-7:93\">機密性の高いデータを扱うため、クラウドAIの利用に懸念がある方</li>\n</ul>\n</blockquote>\n<blockquote data-sourcepos=\"9:1-15:82\">\n<p data-sourcepos=\"9:3-9:41\"><strong>動作確認環境 / 前提条件</strong></p>\n<ul data-sourcepos=\"10:3-15:82\">\n<li data-sourcepos=\"10:3-10:46\">OS: macOS Sonoma (Apple M1) / Ubuntu 22.04</li>\n<li data-sourcepos=\"11:3-11:18\">Cursor: 0.33.1</li>\n<li data-sourcepos=\"12:3-12:18\">Ollama: 0.1.43</li>\n<li data-sourcepos=\"13:3-13:17\">Python: 3.10+</li>\n<li data-sourcepos=\"14:3-14:46\">Dockerが利用可能な環境（推奨）</li>\n<li data-sourcepos=\"15:3-15:82\">기본적인コマンドライン操作、Pythonプログラミングの知識</li>\n</ul>\n</blockquote>\n<blockquote data-sourcepos=\"17:1-20:162\">\n<p data-sourcepos=\"17:3-17:55\"><strong>この記事で得られること（3点程度）</strong></p>\n<ol data-sourcepos=\"18:3-20:162\">\n<li data-sourcepos=\"18:3-18:118\">AIネイティブエディタ「Cursor」の基本的な使い方と、開発効率を上げるための活用法</li>\n<li data-sourcepos=\"19:3-19:128\">ローカル環境で大規模言語モデル（LLM）を動かすツール「Ollama」のセットアップと利用方法</li>\n<li data-sourcepos=\"20:3-20:162\">クラウドAIとローカルLLMを使い分ける、セキュリティと利便性を両立した「ハイブリッドAI解析環境」の構築ノウハウ</li>\n</ol>\n</blockquote>\n<hr data-sourcepos=\"22:1-23:0\">\n<h2 data-sourcepos=\"24:1-24:50\">\n<span id=\"-導入背景課題なぜ重要か\" class=\"fragment\"></span><a href=\"#-%E5%B0%8E%E5%85%A5%E8%83%8C%E6%99%AF%E8%AA%B2%E9%A1%8C%E3%81%AA%E3%81%9C%E9%87%8D%E8%A6%81%E3%81%8B\"><i class=\"fa fa-link\"></i></a>🧭 導入：背景・課題・なぜ重要か</h2>\n<p data-sourcepos=\"26:1-26:628\">GEM Lab（遺伝生態モンスター研究所）の調査員として、我々は日々、未知のモンスター生命体から得られる膨大なゲノムデータと格闘しています。シーケンサーから出力されるテラバイト級のデータを処理し、生命の謎に迫る…聞こえは良いですが、その実態は地道な作業の連続です。解析パイプラインの構築、バグだらけのスクリプトのデバッグ、そして山のような結果の可視化。正直、解析の本質的な部分にたどり着く前に、力尽きてしまうこともしばしばです。</p>\n<p data-sourcepos=\"28:1-28:151\">以前の記事では、GitHub Actionsを使って調査報告（Qiita記事）の投稿を自動化し、「報告」の効率化を図りました。</p>\n<ul data-sourcepos=\"30:1-32:0\">\n<li data-sourcepos=\"30:1-30:183\"><a href=\"https://qiita.com/cocokara_bioinfo/items/4bd415ef2f801497951e\" id=\"reference-a3a720fd02c72cd0d1e0\">【ハマりどころ満載】PythonでQiita記事投稿を自動化するパイプライン構築で爆速改善！</a></li>\n<li data-sourcepos=\"31:1-32:0\"><a href=\"https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957\" id=\"reference-c6a1dcda5efdfdb270e0\">Python × GitHub Actions で始める！Qiita 自動投稿パイプライン構築術</a></li>\n</ul>\n<p data-sourcepos=\"33:1-33:165\">しかし、今回はさらに踏み込み、<strong>「解析」そのものをAIの力で加速させる</strong>ための開発・解析環境についてご紹介します。</p>\n<p data-sourcepos=\"35:1-35:302\">GitHub Copilotは既に多くの開発者にとって手放せないツールとなりましたが、時々「もっと文脈を理解してくれたら…」「このプロジェクト全体のことを分かってくれた上で提案してほしい…」と感じることはないでしょうか？</p>\n<p data-sourcepos=\"37:1-37:549\">この記事では、単なるコード補完ツールを超え、開発者の「思考のパートナー」となるAI駆動の開発環境を構築する方法を解説します。具体的には、AIネイティブエディタ<strong>Cursor</strong>と、ローカル環境でLLMを動かす<strong>Ollama</strong>を組み合わせ、利便性とセキュリティを両立させたハイブリッド環境を目指します。この環境があれば、複雑なモンスターの遺伝子解析も、もっと速く、もっと創造的に進められるはずです。</p>\n<hr data-sourcepos=\"39:1-40:0\">\n<h2 data-sourcepos=\"41:1-41:65\">\n<span id=\"-トピックの概要専門外にも分かる説明\" class=\"fragment\"></span><a href=\"#-%E3%83%88%E3%83%94%E3%83%83%E3%82%AF%E3%81%AE%E6%A6%82%E8%A6%81%E5%B0%82%E9%96%80%E5%A4%96%E3%81%AB%E3%82%82%E5%88%86%E3%81%8B%E3%82%8B%E8%AA%AC%E6%98%8E\"><i class=\"fa fa-link\"></i></a>📘 トピックの概要（専門外にも分かる説明）</h2>\n<h3 data-sourcepos=\"43:1-43:33\">\n<span id=\"ai駆動開発環境とは\" class=\"fragment\"></span><a href=\"#ai%E9%A7%86%E5%8B%95%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83%E3%81%A8%E3%81%AF\"><i class=\"fa fa-link\"></i></a>AI駆動開発環境とは？</h3>\n<p data-sourcepos=\"45:1-45:267\">「AI駆動開発環境」とは、AI（特に大規模言語モデル, LLM）が開発ワークフローのあらゆる側面に深く統合された環境のことです。これは、単にコードを補完する（Code Completion）だけではありません。</p>\n<ul data-sourcepos=\"47:1-51:0\">\n<li data-sourcepos=\"47:1-47:136\">\n<strong>対話型コーディング</strong>: チャット形式でAIに指示し、コードを生成・修正・リファクタリングする。</li>\n<li data-sourcepos=\"48:1-48:196\">\n<strong>コンテキスト理解</strong>: 開いているファイルだけでなく、プロジェクト全体のコードベースやドキュメントをAIが理解し、より的確な提案を行う。</li>\n<li data-sourcepos=\"49:1-49:139\">\n<strong>デバッグ支援</strong>: エラーメッセージをAIに貼り付けるだけで、原因の特定や修正案を提示してくれる。</li>\n<li data-sourcepos=\"50:1-51:0\">\n<strong>ドキュメント生成</strong>: 既存のコードから仕様書やコメントを自動で生成する。</li>\n</ul>\n<h3 data-sourcepos=\"52:1-52:67\">\n<span id=\"なぜバイオインフォマティクスで重要なのか\" class=\"fragment\"></span><a href=\"#%E3%81%AA%E3%81%9C%E3%83%90%E3%82%A4%E3%82%AA%E3%82%A4%E3%83%B3%E3%83%95%E3%82%A9%E3%83%9E%E3%83%86%E3%82%A3%E3%82%AF%E3%82%B9%E3%81%A7%E9%87%8D%E8%A6%81%E3%81%AA%E3%81%AE%E3%81%8B\"><i class=\"fa fa-link\"></i></a>なぜバイオインフォマティクスで重要なのか？</h3>\n<p data-sourcepos=\"54:1-54:226\">バイオインフォマティクスの世界は、専門的なツールやライブラリ（例: Biopython, Samtools, GATK）、そして複雑なデータフォーマット（FASTA, FASTQ, BAM, VCF）に溢れています。</p>\n<ul data-sourcepos=\"56:1-59:0\">\n<li data-sourcepos=\"56:1-56:241\">\n<strong>学習コストの削減</strong>: 「このライブラリでVCFファイルをパースするにはどう書けば？」といった初歩的な問いにAIが即座に答えてくれるため、学習コストを大幅に削減できます。</li>\n<li data-sourcepos=\"57:1-57:214\">\n<strong>定型作業の自動化</strong>: 塩基配列のクリーニングやフォーマット変換など、頻繁に発生する定型的な前処理スクリプトをAIに一瞬で生成させることができます。</li>\n<li data-sourcepos=\"58:1-59:0\">\n<strong>解析の再現性向上</strong>: AIに依頼して、解析手順をドキュメント化したり、Jupyter Notebookに適切なマークダウン説明を追加したりすることで、解析の再現性を高められます。</li>\n</ul>\n<h3 data-sourcepos=\"60:1-60:60\">\n<span id=\"今回構築するハイブリッドai解析環境\" class=\"fragment\"></span><a href=\"#%E4%BB%8A%E5%9B%9E%E6%A7%8B%E7%AF%89%E3%81%99%E3%82%8B%E3%83%8F%E3%82%A4%E3%83%96%E3%83%AA%E3%83%83%E3%83%89ai%E8%A7%A3%E6%9E%90%E7%92%B0%E5%A2%83\"><i class=\"fa fa-link\"></i></a>今回構築する「ハイブリッドAI解析環境」</h3>\n<p data-sourcepos=\"62:1-62:181\">この記事で提案するのは、クラウドベースの強力なAIと、手元のマシンで動くセキュアなAIを組み合わせた「ハイブリッド環境」です。</p>\n<p data-sourcepos=\"64:1-64:32\">[文章で図解イメージ案]</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"65:1-88:3\"><div class=\"highlight\"><pre><code>+-------------------------------------------------------------+\n|                     開発者 (GEM Lab 調査員)                   |\n+-------------------------------------------------------------+\n      |                                      |\n      | エディタ上で対話・コーディング         |\n      |                                      |\n+-------------------------------------------------------------+\n|                 Cursor (AIネイティブエディタ)                 |\n+-------------------------------------------------------------+\n      |                                      |\n      | (1) 一般的な質問/コード生成          | (2) 機密情報を含むコードの相談\n      | (インターネット経由)                 | (ローカルネットワーク内)\n      |                                      |\n+--------------------------+         +-------------------------+\n|   クラウドAI (GPT-4など)   |         |  ローカルLLM (Ollama)   |\n| (OpenAI API)             |         | (Llama3, CodeLlamaなど) |\n+--------------------------+         +-------------------------+\n                                           ^\n                                           |\n                               +-----------------------------+\n                               | モンスター遺伝子データ (機密) |\n                               +-----------------------------+\n</code></pre></div></div>\n<p data-sourcepos=\"90:1-90:108\">このアーキテクチャのポイントは、<strong>扱う情報に応じてAIを使い分ける</strong>点です。</p>\n<ol data-sourcepos=\"91:1-93:0\">\n<li data-sourcepos=\"91:1-91:302\">\n<strong>クラウドAI (Cursor経由)</strong>: 一般的なアルゴリズムの相談や、公開されているライブラリの使い方など、機密情報を含まないタスクに使用します。最新かつ非常に高性能なモデル（GPT-4など）の能力を最大限に活用できます。</li>\n<li data-sourcepos=\"92:1-93:0\">\n<strong>ローカルLLM (Ollama)</strong>: モンスターの遺伝子配列など、絶対に外部に送信できない機密データを含むコードのデバッグや解析ロジックの相談に使用します。これにより、セキュリティを確保しつつAIの支援を受けられます。</li>\n</ol>\n<hr data-sourcepos=\"94:1-95:0\">\n<h2 data-sourcepos=\"96:1-96:62\">\n<span id=\"-技術的な仕組み実装アーキテクチャ\" class=\"fragment\"></span><a href=\"#-%E6%8A%80%E8%A1%93%E7%9A%84%E3%81%AA%E4%BB%95%E7%B5%84%E3%81%BF%E5%AE%9F%E8%A3%85%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3\"><i class=\"fa fa-link\"></i></a>🔧 技術的な仕組み・実装・アーキテクチャ</h2>\n<h3 data-sourcepos=\"98:1-98:48\">\n<span id=\"1-aiネイティブエディタcursor\" class=\"fragment\"></span><a href=\"#1-ai%E3%83%8D%E3%82%A4%E3%83%86%E3%82%A3%E3%83%96%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BFcursor\"><i class=\"fa fa-link\"></i></a>1. AIネイティブエディタ「Cursor」</h3>\n<p data-sourcepos=\"100:1-101:297\"><strong>Cursorとは？</strong><br>\n<a href=\"https://cursor.sh/\" rel=\"nofollow noopener\" target=\"_blank\">Cursor</a>は、VSCodeをフォークして開発された、AI機能を第一に考えて設計されたコードエディタです。VSCodeの拡張機能エコシステムをそのまま利用できるため、既存のVSCodeユーザーはスムーズに移行できます。</p>\n<p data-sourcepos=\"103:1-103:56\"><strong>なぜVSCode + CopilotではなくCursorなのか？</strong></p>\n<ul data-sourcepos=\"104:1-107:0\">\n<li data-sourcepos=\"104:1-104:369\">\n<strong>深いコンテキスト理解</strong>: <code>@</code>シンボルを使って、特定のファイル（<code>@file.py</code>）やドキュメント（<code>@docs</code>）をAIのコンテキストに含めることができます。これにより、「このファイルの実装を参考にして、新しい関数を作って」といった、より精度の高い指示が可能になります。</li>\n<li data-sourcepos=\"105:1-105:308\">\n<strong>インラインでの編集・チャット</strong>: コードを選択して<code>Cmd+K</code>（Windows/Linuxでは<code>Ctrl+K</code>）を押すだけで、その場でAIと対話し、コードを直接編集させることができます。エディタとチャットウィンドウを行き来する必要がありません。</li>\n<li data-sourcepos=\"106:1-107:0\">\n<strong>AIによるリファクタリング</strong>: 「この関数の変数名を分かりやすくして」「このクラスにテストコードを書いて」といったリファクタリング作業をAIに一任できます。</li>\n</ul>\n<p data-sourcepos=\"108:1-108:34\"><strong>メリット／デメリット</strong></p>\n<ul data-sourcepos=\"109:1-111:0\">\n<li data-sourcepos=\"109:1-109:151\">\n<strong>メリット</strong>: 開発速度が劇的に向上する。複雑なコードベースの理解が容易になる。AIとの対話がシームレス。</li>\n<li data-sourcepos=\"110:1-111:0\">\n<strong>デメリット</strong>: デフォルトではCursorのサーバーを経由してOpenAIのAPIを利用するため、プライバシーポリシーの確認が必要。一部機能は有料。</li>\n</ul>\n<p data-sourcepos=\"112:1-113:506\"><strong>初心者がつまずくポイント</strong><br>\nプロンプトの書き方に少しコツが必要です。ただ「〇〇して」と書くのではなく、「あなたは経験豊富なバイオインフォマティシャンです。Biopythonを使って、FASTAファイルからGC含量を計算する関数を書いてください。エラーハンドリングも考慮してください。」のように、<strong>役割（ペルソナ）、文脈、詳細な要件</strong>を伝えることで、生成されるコードの質が格段に向上します。</p>\n<h3 data-sourcepos=\"115:1-115:46\">\n<span id=\"2-ローカルllm実行環境ollama\" class=\"fragment\"></span><a href=\"#2-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%ABllm%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83ollama\"><i class=\"fa fa-link\"></i></a>2. ローカルLLM実行環境「Ollama」</h3>\n<p data-sourcepos=\"117:1-118:296\"><strong>Ollamaとは？</strong><br>\n<a href=\"https://ollama.com/\" rel=\"nofollow noopener\" target=\"_blank\">Ollama</a>は、Llama 3, Code Llama, MistralといったオープンソースのLLMを、自分のPC上で驚くほど簡単に実行できるようにするツールです。複雑な環境構築は不要で、数個のコマンドを打つだけで準備が完了します。</p>\n<p data-sourcepos=\"120:1-121:404\"><strong>なぜローカルLLMが必要なのか？</strong><br>\n最大の理由は<strong>セキュリティ</strong>です。GEM Labが扱うモンスターの遺伝子情報は最高機密事項。これを外部のAPIに送信することは絶対に許されません。Ollamaを使えば、全ての処理がローカルマシン内で完結するため、情報漏洩のリスクをゼロにできます。オフライン環境でも動作するのも大きな利点です。</p>\n<p data-sourcepos=\"123:1-123:34\"><strong>メリット／デメリット</strong></p>\n<ul data-sourcepos=\"124:1-126:0\">\n<li data-sourcepos=\"124:1-124:131\">\n<strong>メリット</strong>: 高いセキュリティとプライバシー。オフライン利用可能。API利用料がかからない。</li>\n<li data-sourcepos=\"125:1-126:0\">\n<strong>デメリット</strong>: 高性能なモデルを動かすには、相応のマシンスペック（特にメモリとGPU）が必要。クラウドの最新モデル（GPT-4oなど）と比較すると性能が劣る場合がある。</li>\n</ul>\n<p data-sourcepos=\"127:1-127:40\"><strong>初心者がつまずくポイント</strong></p>\n<ul data-sourcepos=\"128:1-130:0\">\n<li data-sourcepos=\"128:1-128:288\">\n<strong>メモリ不足</strong>: 大規模なモデルを実行しようとすると、メモリ不足で動作が遅くなったり、エラーが発生したりします。まずは<code>llama3:8b</code>（80億パラメータ）のような比較的小さなモデルから試すのがおすすめです。</li>\n<li data-sourcepos=\"129:1-130:0\">\n<strong>モデルの選択</strong>: 用途に応じてモデルを選ぶ必要があります。コーディング支援なら<code>codellama</code>、汎用的な対話なら<code>llama3</code>、日本語性能を重視するなら<code>gemma:7b</code>など、様々な選択肢があります。Ollamaの<a href=\"https://ollama.com/library\" rel=\"nofollow noopener\" target=\"_blank\">ライブラリページ</a>で探してみましょう。</li>\n</ul>\n<hr data-sourcepos=\"131:1-132:0\">\n<h2 data-sourcepos=\"133:1-133:53\">\n<span id=\"-実践編動くコードコマンド例\" class=\"fragment\"></span><a href=\"#-%E5%AE%9F%E8%B7%B5%E7%B7%A8%E5%8B%95%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>🧪 実践編：動くコード／コマンド例</h2>\n<h3 data-sourcepos=\"135:1-135:19\">\n<span id=\"1-環境構築\" class=\"fragment\"></span><a href=\"#1-%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\"><i class=\"fa fa-link\"></i></a>1. 環境構築</h3>\n<h4 data-sourcepos=\"137:1-137:35\">\n<span id=\"a-cursorのインストール\" class=\"fragment\"></span><a href=\"#a-cursor%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"><i class=\"fa fa-link\"></i></a>a. Cursorのインストール</h4>\n<ol data-sourcepos=\"138:1-141:0\">\n<li data-sourcepos=\"138:1-138:133\">\n<a href=\"https://cursor.sh/\" rel=\"nofollow noopener\" target=\"_blank\">公式サイト</a>にアクセスし、お使いのOS用のインストーラをダウンロードします。</li>\n<li data-sourcepos=\"139:1-139:112\">ダウンロードしたファイルを実行し、アプリケーションをインストールします。</li>\n<li data-sourcepos=\"140:1-141:0\">起動するとVSCodeと非常によく似た画面が表示されます。既存のVSCode設定や拡張機能もインポートできます。</li>\n</ol>\n<h4 data-sourcepos=\"142:1-142:56\">\n<span id=\"b-ollamaのインストールとセットアップ\" class=\"fragment\"></span><a href=\"#b-ollama%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A8%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\"><i class=\"fa fa-link\"></i></a>b. Ollamaのインストールとセットアップ</h4>\n<p data-sourcepos=\"144:1-144:28\"><strong>macOS / Linux の場合:</strong></p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"145:1-148:3\"><div class=\"highlight\"><pre><code><span class=\"c\"># 公式サイトのインストールスクリプトを実行</span>\ncurl <span class=\"nt\">-fsSL</span> https://ollama.com/install.sh | sh\n</code></pre></div></div>\n<p data-sourcepos=\"150:1-151:115\"><strong>Windows の場合:</strong><br>\n<a href=\"https://ollama.com/download\" rel=\"nofollow noopener\" target=\"_blank\">公式サイト</a>からインストーラをダウンロードして実行します。</p>\n<p data-sourcepos=\"153:1-154:158\"><strong>Llama 3 (8B) モデルのダウンロード:</strong><br>\nインストール後、ターミナルで以下のコマンドを実行します。モデルのダウンロードが始まります（数GBあります）。</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"156:1-164:3\"><div class=\"highlight\"><pre><code><span class=\"c\"># Llama 3 (8B) instructモデルをプル</span>\nollama pull llama3:8b\n\n<span class=\"c\"># 成功ログの例</span>\n<span class=\"c\"># pulling manifest</span>\n<span class=\"c\"># pulling 2ab3b58f9049... 100% ▕██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████- 4.7g/s 4.7 GB</span>\n<span class=\"c\"># success</span>\n</code></pre></div></div>\n<h3 data-sourcepos=\"166:1-166:45\">\n<span id=\"2-cursorによるクラウドai活用例\" class=\"fragment\"></span><a href=\"#2-cursor%E3%81%AB%E3%82%88%E3%82%8B%E3%82%AF%E3%83%A9%E3%82%A6%E3%83%89ai%E6%B4%BB%E7%94%A8%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>2. CursorによるクラウドAI活用例</h3>\n<p data-sourcepos=\"168:1-168:111\">ここでは、一般的なバイオインフォマティクスのタスクをCursorに依頼してみます。</p>\n<p data-sourcepos=\"170:1-170:188\"><strong>シナリオ:</strong> <code>monster_sequences.fasta</code> というFASTA形式のファイルから、特定のID (<code>MONSTER_007</code>) を持つ配列を抽出するPythonスクリプトを作成します。</p>\n<ol data-sourcepos=\"172:1-185:0\">\n<li data-sourcepos=\"172:1-172:62\">\n<code>main.py</code> という空のファイルを作成します。</li>\n<li data-sourcepos=\"173:1-183:7\">\n<code>Cmd+L</code> (Windows/Linux: <code>Ctrl+L</code>) でチャットウィンドウを開き、以下のプロンプトを入力します。\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"174:5-183:7\"><div class=\"highlight\"><pre><code>あなたは熟練のPythonプログラマです。\nBiopythonライブラリを使って、FASTAファイルから特定のIDを持つシーケンスを抽出するコマンドラインツールを作成してください。\n\n要件：\n- 入力ファイルパスとシーケンスIDを引数として受け取ること。\n- 該当するIDが見つかった場合は、そのシーケンスを標準出力に出力すること。\n- 見つからなかった場合は、エラーメッセージを出力すること。\n- argparseを使って、使いやすいインターフェースにすること。\n</code></pre></div></div>\n</li>\n<li data-sourcepos=\"184:1-185:0\">AIがコードを生成します。以下はその一例です。</li>\n</ol>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"186:1-229:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># main.py (AIが生成したコード)\n</span><span class=\"kn\">import</span> <span class=\"n\">argparse</span>\n<span class=\"kn\">from</span> <span class=\"n\">Bio</span> <span class=\"kn\">import</span> <span class=\"n\">SeqIO</span>\n<span class=\"kn\">import</span> <span class=\"n\">sys</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">extract_sequence_by_id</span><span class=\"p\">(</span><span class=\"n\">fasta_file</span><span class=\"p\">,</span> <span class=\"n\">sequence_id</span><span class=\"p\">):</span>\n    <span class=\"sh\">\"\"\"</span><span class=\"s\">\n    Extracts a sequence from a FASTA file by its ID.\n\n    Args:\n        fasta_file (str): Path to the input FASTA file.\n        sequence_id (str): The ID of the sequence to extract.\n\n    Returns:\n        Bio.SeqRecord.SeqRecord or None: The found sequence record, or None if not found.\n    </span><span class=\"sh\">\"\"\"</span>\n    <span class=\"k\">try</span><span class=\"p\">:</span>\n        <span class=\"k\">for</span> <span class=\"n\">record</span> <span class=\"ow\">in</span> <span class=\"n\">SeqIO</span><span class=\"p\">.</span><span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"n\">fasta_file</span><span class=\"p\">,</span> <span class=\"sh\">\"</span><span class=\"s\">fasta</span><span class=\"sh\">\"</span><span class=\"p\">):</span>\n            <span class=\"k\">if</span> <span class=\"n\">record</span><span class=\"p\">.</span><span class=\"nb\">id</span> <span class=\"o\">==</span> <span class=\"n\">sequence_id</span><span class=\"p\">:</span>\n                <span class=\"k\">return</span> <span class=\"n\">record</span>\n        <span class=\"k\">return</span> <span class=\"bp\">None</span>\n    <span class=\"k\">except</span> <span class=\"nb\">FileNotFoundError</span><span class=\"p\">:</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">Error: The file </span><span class=\"sh\">'</span><span class=\"si\">{</span><span class=\"n\">fasta_file</span><span class=\"si\">}</span><span class=\"sh\">'</span><span class=\"s\"> was not found.</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"nb\">file</span><span class=\"o\">=</span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">stderr</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">None</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">parser</span> <span class=\"o\">=</span> <span class=\"n\">argparse</span><span class=\"p\">.</span><span class=\"nc\">ArgumentParser</span><span class=\"p\">(</span><span class=\"n\">description</span><span class=\"o\">=</span><span class=\"sh\">\"</span><span class=\"s\">Extract a specific sequence from a FASTA file.</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n    <span class=\"n\">parser</span><span class=\"p\">.</span><span class=\"nf\">add_argument</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\">fasta_file</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"nb\">help</span><span class=\"o\">=</span><span class=\"sh\">\"</span><span class=\"s\">Path to the input FASTA file.</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n    <span class=\"n\">parser</span><span class=\"p\">.</span><span class=\"nf\">add_argument</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\">sequence_id</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"nb\">help</span><span class=\"o\">=</span><span class=\"sh\">\"</span><span class=\"s\">The ID of the sequence to extract.</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n    <span class=\"n\">args</span> <span class=\"o\">=</span> <span class=\"n\">parser</span><span class=\"p\">.</span><span class=\"nf\">parse_args</span><span class=\"p\">()</span>\n\n    <span class=\"n\">found_record</span> <span class=\"o\">=</span> <span class=\"nf\">extract_sequence_by_id</span><span class=\"p\">(</span><span class=\"n\">args</span><span class=\"p\">.</span><span class=\"n\">fasta_file</span><span class=\"p\">,</span> <span class=\"n\">args</span><span class=\"p\">.</span><span class=\"n\">sequence_id</span><span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">found_record</span><span class=\"p\">:</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">&gt;</span><span class=\"si\">{</span><span class=\"n\">found_record</span><span class=\"p\">.</span><span class=\"n\">description</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">found_record</span><span class=\"p\">.</span><span class=\"n\">seq</span><span class=\"p\">)</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">Sequence with ID </span><span class=\"sh\">'</span><span class=\"si\">{</span><span class=\"n\">args</span><span class=\"p\">.</span><span class=\"n\">sequence_id</span><span class=\"si\">}</span><span class=\"sh\">'</span><span class=\"s\"> not found in </span><span class=\"sh\">'</span><span class=\"si\">{</span><span class=\"n\">args</span><span class=\"p\">.</span><span class=\"n\">fasta_file</span><span class=\"si\">}</span><span class=\"sh\">'</span><span class=\"s\">.</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"nb\">file</span><span class=\"o\">=</span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">stderr</span><span class=\"p\">)</span>\n        <span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"nf\">exit</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"n\">__name__</span> <span class=\"o\">==</span> <span class=\"sh\">\"</span><span class=\"s\">__main__</span><span class=\"sh\">\"</span><span class=\"p\">:</span>\n    <span class=\"nf\">main</span><span class=\"p\">()</span>\n</code></pre></div></div>\n<ol data-sourcepos=\"231:1-233:0\">\n<li data-sourcepos=\"231:1-233:0\">次に、このコードをリファクタリングしてみましょう。<code>extract_sequence_by_id</code>関数を選択して<code>Cmd+K</code> (Ctrl+K) を押し、こう指示します。<br>\n<code>この関数に型ヒントを追加し、docstringをGoogleスタイルに変更してください。</code>\n</li>\n</ol>\n<p data-sourcepos=\"234:1-234:86\">すると、AIが即座にコードを以下のように書き換えてくれます。</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"236:1-266:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># main.py (リファクタリング後のコード)\n</span><span class=\"kn\">import</span> <span class=\"n\">argparse</span>\n<span class=\"kn\">from</span> <span class=\"n\">Bio</span> <span class=\"kn\">import</span> <span class=\"n\">SeqIO</span>\n<span class=\"kn\">from</span> <span class=\"n\">Bio.SeqRecord</span> <span class=\"kn\">import</span> <span class=\"n\">SeqRecord</span>\n<span class=\"kn\">import</span> <span class=\"n\">sys</span>\n<span class=\"kn\">from</span> <span class=\"n\">typing</span> <span class=\"kn\">import</span> <span class=\"n\">Optional</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">extract_sequence_by_id</span><span class=\"p\">(</span><span class=\"n\">fasta_file</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">sequence_id</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"n\">SeqRecord</span><span class=\"p\">]:</span>\n    <span class=\"sh\">\"\"\"</span><span class=\"s\">Extracts a sequence from a FASTA file by its ID.\n\n    Args:\n        fasta_file (str): Path to the input FASTA file.\n        sequence_id (str): The ID of the sequence to extract.\n\n    Returns:\n        Optional[SeqRecord]: The found sequence record, or None if not found or\n                             if the file does not exist.\n    </span><span class=\"sh\">\"\"\"</span>\n    <span class=\"k\">try</span><span class=\"p\">:</span>\n        <span class=\"k\">for</span> <span class=\"n\">record</span> <span class=\"ow\">in</span> <span class=\"n\">SeqIO</span><span class=\"p\">.</span><span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"n\">fasta_file</span><span class=\"p\">,</span> <span class=\"sh\">\"</span><span class=\"s\">fasta</span><span class=\"sh\">\"</span><span class=\"p\">):</span>\n            <span class=\"k\">if</span> <span class=\"n\">record</span><span class=\"p\">.</span><span class=\"nb\">id</span> <span class=\"o\">==</span> <span class=\"n\">sequence_id</span><span class=\"p\">:</span>\n                <span class=\"k\">return</span> <span class=\"n\">record</span>\n        <span class=\"k\">return</span> <span class=\"bp\">None</span>\n    <span class=\"k\">except</span> <span class=\"nb\">FileNotFoundError</span><span class=\"p\">:</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">Error: The file </span><span class=\"sh\">'</span><span class=\"si\">{</span><span class=\"n\">fasta_file</span><span class=\"si\">}</span><span class=\"sh\">'</span><span class=\"s\"> was not found.</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"nb\">file</span><span class=\"o\">=</span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">stderr</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">None</span>\n\n<span class=\"c1\"># (main関数は変更なし)\n</span><span class=\"bp\">...</span>\n</code></pre></div></div>\n<p data-sourcepos=\"268:1-268:111\">このように、対話的にコーディングとリファクタリングを進めることができます。</p>\n<h3 data-sourcepos=\"270:1-270:46\">\n<span id=\"3-ollamaによるローカルllm活用例\" class=\"fragment\"></span><a href=\"#3-ollama%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%ABllm%E6%B4%BB%E7%94%A8%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>3. OllamaによるローカルLLM活用例</h3>\n<p data-sourcepos=\"272:1-272:192\"><strong>シナリオ:</strong> モンスターの機密ゲノムデータ（という想定のダミーデータ）を含むスクリプトのデバッグを、情報を外部に送らずに行います。</p>\n<ol data-sourcepos=\"274:1-329:0\">\n<li data-sourcepos=\"274:1-282:0\">\n<p data-sourcepos=\"274:5-274:76\">まず、ターミナルでOllamaの対話モードを開始します。</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"275:5-277:7\"><div class=\"highlight\"><pre><code>ollama run llama3:8b\n</code></pre></div></div>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"278:5-280:7\"><div class=\"highlight\"><pre><code>&gt;&gt;&gt;\n</code></pre></div></div>\n<p data-sourcepos=\"281:5-281:76\">とプロンプトが表示され、入力待機状態になります。</p>\n</li>\n<li data-sourcepos=\"283:1-329:0\">\n<p data-sourcepos=\"283:5-283:215\">ここに、デバッグしたいコードに関する質問を貼り付けます。<strong>機密データそのものではなく、コードのロジックに関する質問をすることがポイントです。</strong></p>\n<p data-sourcepos=\"285:5-285:27\"><strong>プロンプト例:</strong></p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"286:5-291:7\"><div class=\"highlight\"><pre><code>Pythonのコードについて質問です。\n`data`という文字列があり、ここには'A', 'T', 'G', 'C'以外の文字（例えば'N'）が含まれている可能性があります。\nこの文字列から'N'の数を数えるコードを書いていますが、`data.count('N')`よりも効率的な方法はありますか？\nデータは非常に長くなる可能性があります（数ギガバイト）。\n</code></pre></div></div>\n<p data-sourcepos=\"293:5-293:44\"><strong>Ollama (Llama 3) からの回答例:</strong></p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"294:5-314:7\"><div class=\"highlight\"><pre><code>こんにちは！興味深い質問ですね。巨大な文字列で特定の文字を数える場合、パフォーマンスは重要になります。\n\n`data.count('N')`はシンプルで読みやすいですが、PythonのC言語実装レベルで最適化されており、非常に高速です。ほとんどの場合、これで十分です。\n\nしかし、メモリ効率をさらに考慮する場合や、文字列を一度にメモリにロードできない場合は、ジェネレータ式やイテレータを使うアプローチが考えられます。\n\n例えば、ファイルを一行ずつ読み込んで処理する場合：\n\n```python\ndef count_char_in_file(filepath, char_to_count):\n    count = 0\n    with open(filepath, 'r') as f:\n        for line in f:\n            count += line.count(char_to_count)\n    return count\n\n# 使い方\n# n_count = count_char_in_file('huge_genome_file.txt', 'N')\n# print(f\"The character 'N' appears {n_count} times.\")\n</code></pre></div></div>\n<p data-sourcepos=\"316:5-316:160\">この方法は、ファイル全体を一度にメモリに読み込まないため、巨大なファイルに対してもメモリ効率が良いです。</p>\n<p data-sourcepos=\"318:5-318:160\">もし文字列がすでにメモリ上にあるが、他の処理と並行してカウントしたい場合は、単純なループも考えられます。</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"320:5-323:7\"><div class=\"highlight\"><pre><code><span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">ATGCGNATGC...</span><span class=\"sh\">\"</span> <span class=\"c1\"># 巨大な文字列と仮定\n</span><span class=\"n\">n_count</span> <span class=\"o\">=</span> <span class=\"nf\">sum</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"k\">for</span> <span class=\"n\">char</span> <span class=\"ow\">in</span> <span class=\"n\">data</span> <span class=\"k\">if</span> <span class=\"n\">char</span> <span class=\"o\">==</span> <span class=\"sh\">'</span><span class=\"s\">N</span><span class=\"sh\">'</span><span class=\"p\">)</span>\n</code></pre></div></div>\n<p data-sourcepos=\"325:5-325:244\">このジェネレータ式を使った方法は、<code>count()</code>メソッドとパフォーマンス的には大差ないことが多いですが、より複雑な条件（例：'N'または'n'を数える）を追加するのが容易です。</p>\n<p data-sourcepos=\"327:5-327:246\">結論として、シンプルさで言えば<code>data.count('N')</code>が最善です。メモリが懸念される巨大なファイルの場合は、ファイルをチャンクまたは行ごとに読み込むアプローチをお勧めします。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"328:5-330:141\"><div class=\"highlight\"><pre><code>\n</code></pre></div></div>\n</li>\n</ol>\n<p data-sourcepos=\"330:1-330:141\">このように、ローカル環境で完結させながら、具体的なコードの改善案や代替案を得ることができます。</p>\n<h3 data-sourcepos=\"332:1-332:84\">\n<span id=\"4-ハイブリッド戦略の実践-cursorからローカルllmを呼び出す\" class=\"fragment\"></span><a href=\"#4-%E3%83%8F%E3%82%A4%E3%83%96%E3%83%AA%E3%83%83%E3%83%89%E6%88%A6%E7%95%A5%E3%81%AE%E5%AE%9F%E8%B7%B5-cursor%E3%81%8B%E3%82%89%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%ABllm%E3%82%92%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%99\"><i class=\"fa fa-link\"></i></a>4. ハイブリッド戦略の実践: CursorからローカルLLMを呼び出す</h3>\n<p data-sourcepos=\"334:1-334:98\">Cursorの真価は、使用するAIモデルを柔軟に切り替えられる点にあります。</p>\n<ol data-sourcepos=\"336:1-341:0\">\n<li data-sourcepos=\"336:1-336:67\">Cursorで <code>Cmd+,</code> (Ctrl+,) を押して設定を開きます。</li>\n<li data-sourcepos=\"337:1-337:84\">\"Models\" を検索し、\"Model Provider\" のセクションを見つけます。</li>\n<li data-sourcepos=\"338:1-338:76\">\"Add a new model...\" をクリックし、\"Ollama\" を選択します。</li>\n<li data-sourcepos=\"339:1-339:86\">設定で、使用したいモデル名（例: <code>llama3:8b</code>）を入力します。</li>\n<li data-sourcepos=\"340:1-341:0\">これで、チャットウィンドウやインライン編集時に、モデル選択ドロップダウンから<code>Ollama/llama3:8b</code>を選べるようになります。</li>\n</ol>\n<p data-sourcepos=\"342:1-342:246\">これにより、「この一般的な関数はGPT-4で生成し、この機密データに触れる部分のデバッグはローカルのLlama 3で」といった使い分けが、同じエディタ内でシームレスに実現できます。</p>\n<hr data-sourcepos=\"344:1-345:0\">\n<h2 data-sourcepos=\"346:1-346:35\">\n<span id=\"-応用発展実用例\" class=\"fragment\"></span><a href=\"#-%E5%BF%9C%E7%94%A8%E7%99%BA%E5%B1%95%E5%AE%9F%E7%94%A8%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>🚀 応用・発展・実用例</h2>\n<p data-sourcepos=\"348:1-348:83\">このハイブリッドAI解析環境は、様々な場面で応用できます。</p>\n<ul data-sourcepos=\"350:1-358:0\">\n<li data-sourcepos=\"350:1-350:394\">\n<strong>新規パイプラインの設計</strong>: NextflowやSnakemakeのようなワークフロー言語のボイラープレートをAIに生成させ、迅速にパイプラインの骨格を作ることができます。「Snakemakeを使って、FASTQファイルをTrimmomaticでトリミングし、BWAでマッピングするルールの雛形を書いて」といった指示が有効です。</li>\n<li data-sourcepos=\"351:1-351:254\">\n<strong>データ可視化の高速化</strong>: MatplotlibやSeabornを使った複雑なグラフ（例: 火山プロット、クラスタリングのヒートマップ）の描画コードをAIに生成させ、自分はデータの解釈に集中できます。</li>\n<li data-sourcepos=\"352:1-354:264\">\n<strong>他技術との統合</strong>:\n<ul data-sourcepos=\"353:5-354:264\">\n<li data-sourcepos=\"353:5-353:239\">\n<strong>Docker</strong>: <code>Dockerfile</code>の作成や最適化をAIに相談できます。「Python 3.10ベースで、BiopythonとPandasをインストールするDockerfileを書いて」と依頼すれば、すぐに雛形が手に入ります。</li>\n<li data-sourcepos=\"354:5-354:264\">\n<strong>Jupyter</strong>: データ探索フェーズでは、Jupyter Lab内で<a href=\"https://github.com/jupyter-ai/jupyter-ai\" rel=\"nofollow noopener\" target=\"_blank\">Jupyter AI</a>拡張機能を使うことで、ノートブック上で直接LLMと対話し、コードセルを生成させることが可能です。</li>\n</ul>\n</li>\n<li data-sourcepos=\"355:1-358:0\">\n<strong>モンスター生命体の解析への応用</strong>:\n<ul data-sourcepos=\"356:5-358:0\">\n<li data-sourcepos=\"356:5-356:209\">未知の遺伝子配列が与えられた際、「この配列に似た機能を持つ既知の遺伝子をBLASTで検索するためのBiopythonスクリプトを書いて」とCursorに依頼する。</li>\n<li data-sourcepos=\"357:5-358:0\">発見された新種モンスターのゲノムアセンブリ結果（機密）について、「このアセンブリ結果に含まれるコンティグのN50を計算するPythonスクリプトを、メモリ効率を考慮して書いて」とOllamaに相談する。</li>\n</ul>\n</li>\n</ul>\n<hr data-sourcepos=\"359:1-360:0\">\n<h2 data-sourcepos=\"361:1-361:32\">\n<span id=\"-まとめtakeaways\" class=\"fragment\"></span><a href=\"#-%E3%81%BE%E3%81%A8%E3%82%81takeaways\"><i class=\"fa fa-link\"></i></a>📝 まとめ（Takeaways）</h2>\n<p data-sourcepos=\"363:1-363:110\">この記事で紹介した「ハイブリッドAI解析環境」の重要なポイントをまとめます。</p>\n<ul data-sourcepos=\"365:1-370:0\">\n<li data-sourcepos=\"365:1-365:198\">\n<strong>AIは「相棒」</strong>: AI駆動開発は、単なるコード補完ではなく、設計・実装・デバッグ・ドキュメント化の全工程を支援する強力なパートナーです。</li>\n<li data-sourcepos=\"366:1-366:202\">\n<strong>Cursorで開発を加速</strong>: AIネイティブエディタCursorは、深いコンテキスト理解とシームレスな対話機能により、開発体験を次のレベルに引き上げます。</li>\n<li data-sourcepos=\"367:1-367:211\">\n<strong>Ollamaでセキュリティを確保</strong>: 機密データを扱う際は、Ollamaを使ってローカル環境でLLMを実行することで、情報漏洩のリスクなくAIの恩恵を受けられます。</li>\n<li data-sourcepos=\"368:1-368:259\">\n<strong>ハイブリッドが最適解</strong>: クラウドAIの性能とローカルLLMのセキュリティを使い分ける「ハイブリッド戦略」が、現代の多くの開発・解析業務において現実的かつ強力なソリューションです。</li>\n<li data-sourcepos=\"369:1-370:0\">\n<strong>まずは試すことから</strong>: CursorとOllamaのインストールは非常に簡単です。まずは手元のPCに導入し、日々のちょっとした作業からAIに任せてみることをお勧めします。</li>\n</ul>\n<hr data-sourcepos=\"371:1-372:0\">\n<h2 data-sourcepos=\"373:1-373:55\">\n<span id=\"-faq読者が抱きそうな疑問と回答\" class=\"fragment\"></span><a href=\"#-faq%E8%AA%AD%E8%80%85%E3%81%8C%E6%8A%B1%E3%81%8D%E3%81%9D%E3%81%86%E3%81%AA%E7%96%91%E5%95%8F%E3%81%A8%E5%9B%9E%E7%AD%94\"><i class=\"fa fa-link\"></i></a>❓ FAQ（読者が抱きそうな疑問と回答）</h2>\n<p data-sourcepos=\"375:1-376:410\"><strong>Q1: マシンスペックが低いPCでもローカルLLMは使えますか？</strong><br>\nA1: はい、使えますがモデルの選択が重要になります。Ollamaは比較的軽量ですが、快適な動作には16GB以上のRAMを推奨します。もし動作が重い場合は、<code>llama3:8b</code>よりもさらに小さいモデル、例えば<code>tinydolphin</code>や<code>qwen:4b</code>などを試してみてください。これらは性能は少し落ちますが、要求スペックは低くなります。</p>\n<p data-sourcepos=\"378:1-379:484\"><strong>Q2: Cursorは無料ですか？ 有料プランとの違いは何ですか？</strong><br>\nA2: Cursorには無料枠があります。無料枠では、GPT-4などの高性能モデルを月に一定回数利用できます。回数制限を超えて利用したい場合や、より高度な機能（プロジェクト全体をAIに読み込ませる\"Auto-repo\"など）を使いたい場合は、有料プランへのアップグレードが必要です。ただし、Ollamaと連携してローカルLLMを使う分には、回数制限なく無料で利用できます。</p>\n<p data-sourcepos=\"381:1-382:394\"><strong>Q3: AIが生成したコードの信頼性はどのように担保すればよいですか？</strong><br>\nA3: 非常に重要な質問です。AIが生成したコードは<strong>絶対に鵜呑みにしてはいけません</strong>。それはあくまで「非常に優秀なアシスタントが書いた下書き」と捉えるべきです。特に、バイオインフォマティクスのような科学的な正確性が求められる分野では、以下の点を確認することが不可欠です。</p>\n<ol data-sourcepos=\"383:1-386:0\">\n<li data-sourcepos=\"383:1-383:154\">\n<strong>ロジックの検証</strong>: 生成されたコードのアルゴリズムが、意図した解析手法と一致しているか必ず確認します。</li>\n<li data-sourcepos=\"384:1-384:142\">\n<strong>テスト</strong>: 小さなダミーデータセットでコードを動かし、期待通りの結果が得られるかテストします。</li>\n<li data-sourcepos=\"385:1-386:0\">\n<strong>ライブラリのドキュメント参照</strong>: 使用されている関数やオプションが適切か、公式ドキュメントで裏を取る習慣をつけましょう。</li>\n</ol>\n<hr data-sourcepos=\"387:1-388:0\">\n<h2 data-sourcepos=\"389:1-389:35\">\n<span id=\"-参考文献リンク集\" class=\"fragment\"></span><a href=\"#-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%E3%83%AA%E3%83%B3%E3%82%AF%E9%9B%86\"><i class=\"fa fa-link\"></i></a>🔗 参考文献・リンク集</h2>\n<ul data-sourcepos=\"391:1-395:111\">\n<li data-sourcepos=\"391:1-391:70\">\n<strong>Cursor 公式サイト</strong>: <a href=\"https://cursor.sh/\" rel=\"nofollow noopener\" target=\"_blank\">https://cursor.sh/</a>\n</li>\n<li data-sourcepos=\"392:1-392:72\">\n<strong>Ollama 公式サイト</strong>: <a href=\"https://ollama.com/\" rel=\"nofollow noopener\" target=\"_blank\">https://ollama.com/</a>\n</li>\n<li data-sourcepos=\"393:1-393:84\">\n<strong>Ollama Model Library</strong>: <a href=\"https://ollama.com/library\" rel=\"nofollow noopener\" target=\"_blank\">https://ollama.com/library</a>\n</li>\n<li data-sourcepos=\"394:1-394:73\">\n<strong>Biopython Project</strong>: <a href=\"https://biopython.org/\" rel=\"nofollow noopener\" target=\"_blank\">https://biopython.org/</a>\n</li>\n<li data-sourcepos=\"395:1-395:111\">\n<strong>Jupyter AI (GitHub)</strong>: <a href=\"https://github.com/jupyter-ai/jupyter-ai\" rel=\"nofollow noopener\" target=\"_blank\">https://github.com/jupyter-ai/jupyter-ai</a>\n</li>\n</ul>\n",
      "body": "---\n\n> **対象読者**  \n> - 日々のコーディングやデータ解析を効率化したいエンジニア・研究者\n> - GitHub Copilotの次に試すAIツールを探している方\n> - バイオインフォマティクスに興味があり、AIをどう活用できるか知りたい方\n> - 機密性の高いデータを扱うため、クラウドAIの利用に懸念がある方\n\n> **動作確認環境 / 前提条件**  \n> - OS: macOS Sonoma (Apple M1) / Ubuntu 22.04\n> - Cursor: 0.33.1\n> - Ollama: 0.1.43\n> - Python: 3.10+\n> - Dockerが利用可能な環境（推奨）\n> - 기본적인コマンドライン操作、Pythonプログラミングの知識\n\n> **この記事で得られること（3点程度）**\n> 1. AIネイティブエディタ「Cursor」の基本的な使い方と、開発効率を上げるための活用法\n> 2. ローカル環境で大規模言語モデル（LLM）を動かすツール「Ollama」のセットアップと利用方法\n> 3. クラウドAIとローカルLLMを使い分ける、セキュリティと利便性を両立した「ハイブリッドAI解析環境」の構築ノウハウ\n\n---\n\n## 🧭 導入：背景・課題・なぜ重要か\n\nGEM Lab（遺伝生態モンスター研究所）の調査員として、我々は日々、未知のモンスター生命体から得られる膨大なゲノムデータと格闘しています。シーケンサーから出力されるテラバイト級のデータを処理し、生命の謎に迫る…聞こえは良いですが、その実態は地道な作業の連続です。解析パイプラインの構築、バグだらけのスクリプトのデバッグ、そして山のような結果の可視化。正直、解析の本質的な部分にたどり着く前に、力尽きてしまうこともしばしばです。\n\n以前の記事では、GitHub Actionsを使って調査報告（Qiita記事）の投稿を自動化し、「報告」の効率化を図りました。\n\n- [【ハマりどころ満載】PythonでQiita記事投稿を自動化するパイプライン構築で爆速改善！](https://qiita.com/cocokara_bioinfo/items/4bd415ef2f801497951e)\n- [Python × GitHub Actions で始める！Qiita 自動投稿パイプライン構築術](https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957)\n\nしかし、今回はさらに踏み込み、**「解析」そのものをAIの力で加速させる**ための開発・解析環境についてご紹介します。\n\nGitHub Copilotは既に多くの開発者にとって手放せないツールとなりましたが、時々「もっと文脈を理解してくれたら…」「このプロジェクト全体のことを分かってくれた上で提案してほしい…」と感じることはないでしょうか？\n\nこの記事では、単なるコード補完ツールを超え、開発者の「思考のパートナー」となるAI駆動の開発環境を構築する方法を解説します。具体的には、AIネイティブエディタ**Cursor**と、ローカル環境でLLMを動かす**Ollama**を組み合わせ、利便性とセキュリティを両立させたハイブリッド環境を目指します。この環境があれば、複雑なモンスターの遺伝子解析も、もっと速く、もっと創造的に進められるはずです。\n\n---\n\n## 📘 トピックの概要（専門外にも分かる説明）\n\n### AI駆動開発環境とは？\n\n「AI駆動開発環境」とは、AI（特に大規模言語モデル, LLM）が開発ワークフローのあらゆる側面に深く統合された環境のことです。これは、単にコードを補完する（Code Completion）だけではありません。\n\n- **対話型コーディング**: チャット形式でAIに指示し、コードを生成・修正・リファクタリングする。\n- **コンテキスト理解**: 開いているファイルだけでなく、プロジェクト全体のコードベースやドキュメントをAIが理解し、より的確な提案を行う。\n- **デバッグ支援**: エラーメッセージをAIに貼り付けるだけで、原因の特定や修正案を提示してくれる。\n- **ドキュメント生成**: 既存のコードから仕様書やコメントを自動で生成する。\n\n### なぜバイオインフォマティクスで重要なのか？\n\nバイオインフォマティクスの世界は、専門的なツールやライブラリ（例: Biopython, Samtools, GATK）、そして複雑なデータフォーマット（FASTA, FASTQ, BAM, VCF）に溢れています。\n\n- **学習コストの削減**: 「このライブラリでVCFファイルをパースするにはどう書けば？」といった初歩的な問いにAIが即座に答えてくれるため、学習コストを大幅に削減できます。\n- **定型作業の自動化**: 塩基配列のクリーニングやフォーマット変換など、頻繁に発生する定型的な前処理スクリプトをAIに一瞬で生成させることができます。\n- **解析の再現性向上**: AIに依頼して、解析手順をドキュメント化したり、Jupyter Notebookに適切なマークダウン説明を追加したりすることで、解析の再現性を高められます。\n\n### 今回構築する「ハイブリッドAI解析環境」\n\nこの記事で提案するのは、クラウドベースの強力なAIと、手元のマシンで動くセキュアなAIを組み合わせた「ハイブリッド環境」です。\n\n[文章で図解イメージ案]\n```\n+-------------------------------------------------------------+\n|                     開発者 (GEM Lab 調査員)                   |\n+-------------------------------------------------------------+\n      |                                      |\n      | エディタ上で対話・コーディング         |\n      |                                      |\n+-------------------------------------------------------------+\n|                 Cursor (AIネイティブエディタ)                 |\n+-------------------------------------------------------------+\n      |                                      |\n      | (1) 一般的な質問/コード生成          | (2) 機密情報を含むコードの相談\n      | (インターネット経由)                 | (ローカルネットワーク内)\n      |                                      |\n+--------------------------+         +-------------------------+\n|   クラウドAI (GPT-4など)   |         |  ローカルLLM (Ollama)   |\n| (OpenAI API)             |         | (Llama3, CodeLlamaなど) |\n+--------------------------+         +-------------------------+\n                                           ^\n                                           |\n                               +-----------------------------+\n                               | モンスター遺伝子データ (機密) |\n                               +-----------------------------+\n```\n\nこのアーキテクチャのポイントは、**扱う情報に応じてAIを使い分ける**点です。\n1.  **クラウドAI (Cursor経由)**: 一般的なアルゴリズムの相談や、公開されているライブラリの使い方など、機密情報を含まないタスクに使用します。最新かつ非常に高性能なモデル（GPT-4など）の能力を最大限に活用できます。\n2.  **ローカルLLM (Ollama)**: モンスターの遺伝子配列など、絶対に外部に送信できない機密データを含むコードのデバッグや解析ロジックの相談に使用します。これにより、セキュリティを確保しつつAIの支援を受けられます。\n\n---\n\n## 🔧 技術的な仕組み・実装・アーキテクチャ\n\n### 1. AIネイティブエディタ「Cursor」\n\n**Cursorとは？**\n[Cursor](https://cursor.sh/)は、VSCodeをフォークして開発された、AI機能を第一に考えて設計されたコードエディタです。VSCodeの拡張機能エコシステムをそのまま利用できるため、既存のVSCodeユーザーはスムーズに移行できます。\n\n**なぜVSCode + CopilotではなくCursorなのか？**\n- **深いコンテキスト理解**: `@`シンボルを使って、特定のファイル（`@file.py`）やドキュメント（`@docs`）をAIのコンテキストに含めることができます。これにより、「このファイルの実装を参考にして、新しい関数を作って」といった、より精度の高い指示が可能になります。\n- **インラインでの編集・チャット**: コードを選択して`Cmd+K`（Windows/Linuxでは`Ctrl+K`）を押すだけで、その場でAIと対話し、コードを直接編集させることができます。エディタとチャットウィンドウを行き来する必要がありません。\n- **AIによるリファクタリング**: 「この関数の変数名を分かりやすくして」「このクラスにテストコードを書いて」といったリファクタリング作業をAIに一任できます。\n\n**メリット／デメリット**\n- **メリット**: 開発速度が劇的に向上する。複雑なコードベースの理解が容易になる。AIとの対話がシームレス。\n- **デメリット**: デフォルトではCursorのサーバーを経由してOpenAIのAPIを利用するため、プライバシーポリシーの確認が必要。一部機能は有料。\n\n**初心者がつまずくポイント**\nプロンプトの書き方に少しコツが必要です。ただ「〇〇して」と書くのではなく、「あなたは経験豊富なバイオインフォマティシャンです。Biopythonを使って、FASTAファイルからGC含量を計算する関数を書いてください。エラーハンドリングも考慮してください。」のように、**役割（ペルソナ）、文脈、詳細な要件**を伝えることで、生成されるコードの質が格段に向上します。\n\n### 2. ローカルLLM実行環境「Ollama」\n\n**Ollamaとは？**\n[Ollama](https://ollama.com/)は、Llama 3, Code Llama, MistralといったオープンソースのLLMを、自分のPC上で驚くほど簡単に実行できるようにするツールです。複雑な環境構築は不要で、数個のコマンドを打つだけで準備が完了します。\n\n**なぜローカルLLMが必要なのか？**\n最大の理由は**セキュリティ**です。GEM Labが扱うモンスターの遺伝子情報は最高機密事項。これを外部のAPIに送信することは絶対に許されません。Ollamaを使えば、全ての処理がローカルマシン内で完結するため、情報漏洩のリスクをゼロにできます。オフライン環境でも動作するのも大きな利点です。\n\n**メリット／デメリット**\n- **メリット**: 高いセキュリティとプライバシー。オフライン利用可能。API利用料がかからない。\n- **デメリット**: 高性能なモデルを動かすには、相応のマシンスペック（特にメモリとGPU）が必要。クラウドの最新モデル（GPT-4oなど）と比較すると性能が劣る場合がある。\n\n**初心者がつまずくポイント**\n- **メモリ不足**: 大規模なモデルを実行しようとすると、メモリ不足で動作が遅くなったり、エラーが発生したりします。まずは`llama3:8b`（80億パラメータ）のような比較的小さなモデルから試すのがおすすめです。\n- **モデルの選択**: 用途に応じてモデルを選ぶ必要があります。コーディング支援なら`codellama`、汎用的な対話なら`llama3`、日本語性能を重視するなら`gemma:7b`など、様々な選択肢があります。Ollamaの[ライブラリページ](https://ollama.com/library)で探してみましょう。\n\n---\n\n## 🧪 実践編：動くコード／コマンド例\n\n### 1. 環境構築\n\n#### a. Cursorのインストール\n1.  [公式サイト](https://cursor.sh/)にアクセスし、お使いのOS用のインストーラをダウンロードします。\n2.  ダウンロードしたファイルを実行し、アプリケーションをインストールします。\n3.  起動するとVSCodeと非常によく似た画面が表示されます。既存のVSCode設定や拡張機能もインポートできます。\n\n#### b. Ollamaのインストールとセットアップ\n\n**macOS / Linux の場合:**\n```bash\n# 公式サイトのインストールスクリプトを実行\ncurl -fsSL https://ollama.com/install.sh | sh\n```\n\n**Windows の場合:**\n[公式サイト](https://ollama.com/download)からインストーラをダウンロードして実行します。\n\n**Llama 3 (8B) モデルのダウンロード:**\nインストール後、ターミナルで以下のコマンドを実行します。モデルのダウンロードが始まります（数GBあります）。\n\n```bash\n# Llama 3 (8B) instructモデルをプル\nollama pull llama3:8b\n\n# 成功ログの例\n# pulling manifest\n# pulling 2ab3b58f9049... 100% ▕██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████- 4.7g/s 4.7 GB\n# success\n```\n\n### 2. CursorによるクラウドAI活用例\n\nここでは、一般的なバイオインフォマティクスのタスクをCursorに依頼してみます。\n\n**シナリオ:** `monster_sequences.fasta` というFASTA形式のファイルから、特定のID (`MONSTER_007`) を持つ配列を抽出するPythonスクリプトを作成します。\n\n1.  `main.py` という空のファイルを作成します。\n2.  `Cmd+L` (Windows/Linux: `Ctrl+L`) でチャットウィンドウを開き、以下のプロンプトを入力します。\n    ```\n    あなたは熟練のPythonプログラマです。\n    Biopythonライブラリを使って、FASTAファイルから特定のIDを持つシーケンスを抽出するコマンドラインツールを作成してください。\n\n    要件：\n    - 入力ファイルパスとシーケンスIDを引数として受け取ること。\n    - 該当するIDが見つかった場合は、そのシーケンスを標準出力に出力すること。\n    - 見つからなかった場合は、エラーメッセージを出力すること。\n    - argparseを使って、使いやすいインターフェースにすること。\n    ```\n3.  AIがコードを生成します。以下はその一例です。\n\n```python\n# main.py (AIが生成したコード)\nimport argparse\nfrom Bio import SeqIO\nimport sys\n\ndef extract_sequence_by_id(fasta_file, sequence_id):\n    \"\"\"\n    Extracts a sequence from a FASTA file by its ID.\n\n    Args:\n        fasta_file (str): Path to the input FASTA file.\n        sequence_id (str): The ID of the sequence to extract.\n\n    Returns:\n        Bio.SeqRecord.SeqRecord or None: The found sequence record, or None if not found.\n    \"\"\"\n    try:\n        for record in SeqIO.parse(fasta_file, \"fasta\"):\n            if record.id == sequence_id:\n                return record\n        return None\n    except FileNotFoundError:\n        print(f\"Error: The file '{fasta_file}' was not found.\", file=sys.stderr)\n        return None\n\ndef main():\n    parser = argparse.ArgumentParser(description=\"Extract a specific sequence from a FASTA file.\")\n    parser.add_argument(\"fasta_file\", help=\"Path to the input FASTA file.\")\n    parser.add_argument(\"sequence_id\", help=\"The ID of the sequence to extract.\")\n    args = parser.parse_args()\n\n    found_record = extract_sequence_by_id(args.fasta_file, args.sequence_id)\n\n    if found_record:\n        print(f\">{found_record.description}\")\n        print(found_record.seq)\n    else:\n        print(f\"Sequence with ID '{args.sequence_id}' not found in '{args.fasta_file}'.\", file=sys.stderr)\n        sys.exit(1)\n\nif __name__ == \"__main__\":\n    main()\n```\n\n4.  次に、このコードをリファクタリングしてみましょう。`extract_sequence_by_id`関数を選択して`Cmd+K` (Ctrl+K) を押し、こう指示します。\n    `この関数に型ヒントを追加し、docstringをGoogleスタイルに変更してください。`\n\nすると、AIが即座にコードを以下のように書き換えてくれます。\n\n```python\n# main.py (リファクタリング後のコード)\nimport argparse\nfrom Bio import SeqIO\nfrom Bio.SeqRecord import SeqRecord\nimport sys\nfrom typing import Optional\n\ndef extract_sequence_by_id(fasta_file: str, sequence_id: str) -> Optional[SeqRecord]:\n    \"\"\"Extracts a sequence from a FASTA file by its ID.\n\n    Args:\n        fasta_file (str): Path to the input FASTA file.\n        sequence_id (str): The ID of the sequence to extract.\n\n    Returns:\n        Optional[SeqRecord]: The found sequence record, or None if not found or\n                             if the file does not exist.\n    \"\"\"\n    try:\n        for record in SeqIO.parse(fasta_file, \"fasta\"):\n            if record.id == sequence_id:\n                return record\n        return None\n    except FileNotFoundError:\n        print(f\"Error: The file '{fasta_file}' was not found.\", file=sys.stderr)\n        return None\n\n# (main関数は変更なし)\n...\n```\n\nこのように、対話的にコーディングとリファクタリングを進めることができます。\n\n### 3. OllamaによるローカルLLM活用例\n\n**シナリオ:** モンスターの機密ゲノムデータ（という想定のダミーデータ）を含むスクリプトのデバッグを、情報を外部に送らずに行います。\n\n1.  まず、ターミナルでOllamaの対話モードを開始します。\n    ```bash\n    ollama run llama3:8b\n    ```\n    ```\n    >>>\n    ```\n    とプロンプトが表示され、入力待機状態になります。\n\n2.  ここに、デバッグしたいコードに関する質問を貼り付けます。**機密データそのものではなく、コードのロジックに関する質問をすることがポイントです。**\n\n    **プロンプト例:**\n    ```\n    Pythonのコードについて質問です。\n    `data`という文字列があり、ここには'A', 'T', 'G', 'C'以外の文字（例えば'N'）が含まれている可能性があります。\n    この文字列から'N'の数を数えるコードを書いていますが、`data.count('N')`よりも効率的な方法はありますか？\n    データは非常に長くなる可能性があります（数ギガバイト）。\n    ```\n    \n    **Ollama (Llama 3) からの回答例:**\n    ```\n    こんにちは！興味深い質問ですね。巨大な文字列で特定の文字を数える場合、パフォーマンスは重要になります。\n\n    `data.count('N')`はシンプルで読みやすいですが、PythonのC言語実装レベルで最適化されており、非常に高速です。ほとんどの場合、これで十分です。\n\n    しかし、メモリ効率をさらに考慮する場合や、文字列を一度にメモリにロードできない場合は、ジェネレータ式やイテレータを使うアプローチが考えられます。\n\n    例えば、ファイルを一行ずつ読み込んで処理する場合：\n\n    ```python\n    def count_char_in_file(filepath, char_to_count):\n        count = 0\n        with open(filepath, 'r') as f:\n            for line in f:\n                count += line.count(char_to_count)\n        return count\n\n    # 使い方\n    # n_count = count_char_in_file('huge_genome_file.txt', 'N')\n    # print(f\"The character 'N' appears {n_count} times.\")\n    ```\n\n    この方法は、ファイル全体を一度にメモリに読み込まないため、巨大なファイルに対してもメモリ効率が良いです。\n\n    もし文字列がすでにメモリ上にあるが、他の処理と並行してカウントしたい場合は、単純なループも考えられます。\n\n    ```python\n    data = \"ATGCGNATGC...\" # 巨大な文字列と仮定\n    n_count = sum(1 for char in data if char == 'N')\n    ```\n\n    このジェネレータ式を使った方法は、`count()`メソッドとパフォーマンス的には大差ないことが多いですが、より複雑な条件（例：'N'または'n'を数える）を追加するのが容易です。\n\n    結論として、シンプルさで言えば`data.count('N')`が最善です。メモリが懸念される巨大なファイルの場合は、ファイルをチャンクまたは行ごとに読み込むアプローチをお勧めします。\n    ```\n\nこのように、ローカル環境で完結させながら、具体的なコードの改善案や代替案を得ることができます。\n\n### 4. ハイブリッド戦略の実践: CursorからローカルLLMを呼び出す\n\nCursorの真価は、使用するAIモデルを柔軟に切り替えられる点にあります。\n\n1.  Cursorで `Cmd+,` (Ctrl+,) を押して設定を開きます。\n2.  \"Models\" を検索し、\"Model Provider\" のセクションを見つけます。\n3.  \"Add a new model...\" をクリックし、\"Ollama\" を選択します。\n4.  設定で、使用したいモデル名（例: `llama3:8b`）を入力します。\n5.  これで、チャットウィンドウやインライン編集時に、モデル選択ドロップダウンから`Ollama/llama3:8b`を選べるようになります。\n\nこれにより、「この一般的な関数はGPT-4で生成し、この機密データに触れる部分のデバッグはローカルのLlama 3で」といった使い分けが、同じエディタ内でシームレスに実現できます。\n\n---\n\n## 🚀 応用・発展・実用例\n\nこのハイブリッドAI解析環境は、様々な場面で応用できます。\n\n- **新規パイプラインの設計**: NextflowやSnakemakeのようなワークフロー言語のボイラープレートをAIに生成させ、迅速にパイプラインの骨格を作ることができます。「Snakemakeを使って、FASTQファイルをTrimmomaticでトリミングし、BWAでマッピングするルールの雛形を書いて」といった指示が有効です。\n- **データ可視化の高速化**: MatplotlibやSeabornを使った複雑なグラフ（例: 火山プロット、クラスタリングのヒートマップ）の描画コードをAIに生成させ、自分はデータの解釈に集中できます。\n- **他技術との統合**:\n    - **Docker**: `Dockerfile`の作成や最適化をAIに相談できます。「Python 3.10ベースで、BiopythonとPandasをインストールするDockerfileを書いて」と依頼すれば、すぐに雛形が手に入ります。\n    - **Jupyter**: データ探索フェーズでは、Jupyter Lab内で[Jupyter AI](https://github.com/jupyter-ai/jupyter-ai)拡張機能を使うことで、ノートブック上で直接LLMと対話し、コードセルを生成させることが可能です。\n- **モンスター生命体の解析への応用**:\n    - 未知の遺伝子配列が与えられた際、「この配列に似た機能を持つ既知の遺伝子をBLASTで検索するためのBiopythonスクリプトを書いて」とCursorに依頼する。\n    - 発見された新種モンスターのゲノムアセンブリ結果（機密）について、「このアセンブリ結果に含まれるコンティグのN50を計算するPythonスクリプトを、メモリ効率を考慮して書いて」とOllamaに相談する。\n\n---\n\n## 📝 まとめ（Takeaways）\n\nこの記事で紹介した「ハイブリッドAI解析環境」の重要なポイントをまとめます。\n\n- **AIは「相棒」**: AI駆動開発は、単なるコード補完ではなく、設計・実装・デバッグ・ドキュメント化の全工程を支援する強力なパートナーです。\n- **Cursorで開発を加速**: AIネイティブエディタCursorは、深いコンテキスト理解とシームレスな対話機能により、開発体験を次のレベルに引き上げます。\n- **Ollamaでセキュリティを確保**: 機密データを扱う際は、Ollamaを使ってローカル環境でLLMを実行することで、情報漏洩のリスクなくAIの恩恵を受けられます。\n- **ハイブリッドが最適解**: クラウドAIの性能とローカルLLMのセキュリティを使い分ける「ハイブリッド戦略」が、現代の多くの開発・解析業務において現実的かつ強力なソリューションです。\n- **まずは試すことから**: CursorとOllamaのインストールは非常に簡単です。まずは手元のPCに導入し、日々のちょっとした作業からAIに任せてみることをお勧めします。\n\n---\n\n## ❓ FAQ（読者が抱きそうな疑問と回答）\n\n**Q1: マシンスペックが低いPCでもローカルLLMは使えますか？**\nA1: はい、使えますがモデルの選択が重要になります。Ollamaは比較的軽量ですが、快適な動作には16GB以上のRAMを推奨します。もし動作が重い場合は、`llama3:8b`よりもさらに小さいモデル、例えば`tinydolphin`や`qwen:4b`などを試してみてください。これらは性能は少し落ちますが、要求スペックは低くなります。\n\n**Q2: Cursorは無料ですか？ 有料プランとの違いは何ですか？**\nA2: Cursorには無料枠があります。無料枠では、GPT-4などの高性能モデルを月に一定回数利用できます。回数制限を超えて利用したい場合や、より高度な機能（プロジェクト全体をAIに読み込ませる\"Auto-repo\"など）を使いたい場合は、有料プランへのアップグレードが必要です。ただし、Ollamaと連携してローカルLLMを使う分には、回数制限なく無料で利用できます。\n\n**Q3: AIが生成したコードの信頼性はどのように担保すればよいですか？**\nA3: 非常に重要な質問です。AIが生成したコードは**絶対に鵜呑みにしてはいけません**。それはあくまで「非常に優秀なアシスタントが書いた下書き」と捉えるべきです。特に、バイオインフォマティクスのような科学的な正確性が求められる分野では、以下の点を確認することが不可欠です。\n1.  **ロジックの検証**: 生成されたコードのアルゴリズムが、意図した解析手法と一致しているか必ず確認します。\n2.  **テスト**: 小さなダミーデータセットでコードを動かし、期待通りの結果が得られるかテストします。\n3.  **ライブラリのドキュメント参照**: 使用されている関数やオプションが適切か、公式ドキュメントで裏を取る習慣をつけましょう。\n\n---\n\n## 🔗 参考文献・リンク集\n\n- **Cursor 公式サイト**: [https://cursor.sh/](https://cursor.sh/)\n- **Ollama 公式サイト**: [https://ollama.com/](https://ollama.com/)\n- **Ollama Model Library**: [https://ollama.com/library](https://ollama.com/library)\n- **Biopython Project**: [https://biopython.org/](https://biopython.org/)\n- **Jupyter AI (GitHub)**: [https://github.com/jupyter-ai/jupyter-ai](https://github.com/jupyter-ai/jupyter-ai)\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-05T18:21:34+09:00",
      "group": null,
      "id": "5ca46b45f0ba191895c9",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Python",
          "versions": []
        },
        {
          "name": "自動化",
          "versions": []
        }
      ],
      "title": "AI駆動でモンスター遺伝子解析を加速！CursorとローカルLLMで作る次世代バイオインフォ環境",
      "updated_at": "2025-12-05T18:21:34+09:00",
      "url": "https://qiita.com/cocokara_bioinfo/items/5ca46b45f0ba191895c9",
      "user": {
        "description": "ポッケ村出身の名もなき若手生物学研究員です。\r\n現代の技術やエンジニア知識を学びながらモンスターハンターの生態・生物学研究に日々励んでおります！\r\nまだまだ勉強不足なところはありますが、皆さんに少しでも学びになるものをお届けできればとの思いで発信させていただきます\r\n\r\n※フィクションとして、時にTips記事として楽しんでいただければ幸いです",
        "facebook_id": "",
        "followees_count": 3,
        "followers_count": 0,
        "github_login_name": null,
        "id": "cocokara_bioinfo",
        "items_count": 4,
        "linkedin_id": "",
        "location": "",
        "name": "シャル・S 調査員",
        "organization": "Genome & Ecology Monster-Lab (架空)",
        "permanent_id": 4288059,
        "profile_image_url": "https://lh3.googleusercontent.com/a/ACg8ocLkgrrRuDzozKQ4XeInetzc0um1rPWRGXY2daT9pLIi1z1JdQ=s96-c",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": ""
      },
      "page_views_count": 155,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "my_popular"
    },
    {
      "rendered_body": "<blockquote data-sourcepos=\"1:1-2:126\">\n<p data-sourcepos=\"1:3-2:126\"><strong>対象読者</strong><br>\nPython をある程度書けるエンジニア、GitHub Actions に興味がある方、Qiita 投稿を効率化したい方</p>\n</blockquote>\n<blockquote data-sourcepos=\"4:1-9:26\">\n<p data-sourcepos=\"4:3-4:41\"><strong>動作確認環境 / 前提条件</strong></p>\n<ul data-sourcepos=\"5:3-9:26\">\n<li data-sourcepos=\"5:3-5:27\">macOS Monterey (12.6.3)</li>\n<li data-sourcepos=\"6:3-6:14\">Python 3.9</li>\n<li data-sourcepos=\"7:3-7:12\">pip 23.0</li>\n<li data-sourcepos=\"8:3-8:26\">GitHub アカウント</li>\n<li data-sourcepos=\"9:3-9:26\">Qiita API トークン</li>\n</ul>\n</blockquote>\n<blockquote data-sourcepos=\"11:1-14:65\">\n<p data-sourcepos=\"11:3-11:39\"><strong>この記事で得られること</strong></p>\n<ul data-sourcepos=\"12:3-14:65\">\n<li data-sourcepos=\"12:3-12:53\">Qiita API を利用した記事投稿の自動化</li>\n<li data-sourcepos=\"13:3-13:68\">GitHub Actions を利用した CI/CD パイプラインの構築</li>\n<li data-sourcepos=\"14:3-14:65\">Python スクリプトのテストとデプロイの自動化</li>\n</ul>\n</blockquote>\n<h2 data-sourcepos=\"16:1-16:50\">\n<span id=\"-導入背景課題なぜ重要か\" class=\"fragment\"></span><a href=\"#-%E5%B0%8E%E5%85%A5%E8%83%8C%E6%99%AF%E8%AA%B2%E9%A1%8C%E3%81%AA%E3%81%9C%E9%87%8D%E8%A6%81%E3%81%8B\"><i class=\"fa fa-link\"></i></a>🧭 導入：背景・課題・なぜ重要か</h2>\n<p data-sourcepos=\"18:1-18:307\">日々の業務や学習で得た知識を Qiita に投稿するのは、エンジニアにとって非常に有益な習慣です。しかし、「記事を書く時間がない」「投稿が面倒」といった理由で、せっかくの知識が埋もれてしまうことも少なくありません。</p>\n<p data-sourcepos=\"20:1-20:269\">そこで、この記事では <strong>Python と GitHub Actions を活用して、Qiita への記事投稿を自動化するパイプライン</strong> を構築します。これにより、記事作成に集中し、より多くの知識を共有できるようになります。</p>\n<p data-sourcepos=\"22:1-22:469\">以前の記事 <a href=\"https://qiita.com/cocokara_bioinfo/items/78b20fc5aff614e609e2\" id=\"reference-146fe97063490483165a\">使用例</a> では、Qiita 投稿の効率化について紹介しましたが、今回はさらに一歩進んで、完全に自動化されたパイプラインを構築します。この自動化によって、記事の作成から投稿までの一連のフローが劇的に改善され、より多くの時間を記事の質向上に費やすことができるようになります。</p>\n<h2 data-sourcepos=\"24:1-24:29\">\n<span id=\"-トピックの概要\" class=\"fragment\"></span><a href=\"#-%E3%83%88%E3%83%94%E3%83%83%E3%82%AF%E3%81%AE%E6%A6%82%E8%A6%81\"><i class=\"fa fa-link\"></i></a>📘 トピックの概要</h2>\n<p data-sourcepos=\"26:1-26:248\">今回のトピックは、<strong>Qiita API を利用した記事投稿の自動化</strong> です。Qiita API を利用することで、プログラムから Qiita に記事を投稿したり、既存の記事を更新したりすることができます。</p>\n<p data-sourcepos=\"28:1-28:323\"><strong>GitHub Actions</strong> は、GitHub 上で CI/CD (継続的インテグレーション/継続的デリバリー) パイプラインを構築するためのサービスです。GitHub リポジトリへのプッシュやプルリクエストをトリガーとして、自動的にテストやデプロイを実行できます。</p>\n<p data-sourcepos=\"30:1-30:69\">今回のパイプラインのイメージは以下の通りです。</p>\n<p data-sourcepos=\"32:1-32:35\"><strong>文章で図解イメージ案:</strong></p>\n<ol data-sourcepos=\"34:1-38:0\">\n<li data-sourcepos=\"34:1-34:82\">GitHub リポジトリに Markdown ファイル (Qiita 記事) をプッシュ</li>\n<li data-sourcepos=\"35:1-35:43\">GitHub Actions がプッシュを検知</li>\n<li data-sourcepos=\"36:1-36:109\">Python スクリプトが Markdown ファイルを読み込み、Qiita API を利用して記事を投稿</li>\n<li data-sourcepos=\"37:1-38:0\">投稿結果を GitHub Actions のログに出力</li>\n</ol>\n<p data-sourcepos=\"39:1-39:622\">バイオインフォマティクス分野では、大量のデータを解析し、その結果を共有する必要があります。この自動投稿パイプラインは、解析結果を Qiita で共有する際に非常に役立ちます。例えば、ある遺伝子セットに対する解析結果を自動的に Qiita に投稿し、他の研究者と共有することができます。これは、<strong>遺伝子配列という「文字列データ」</strong> を解析し、その結果を共有するという点で、ソフトウェア開発におけるドキュメント生成と似た側面を持っています。</p>\n<h2 data-sourcepos=\"41:1-41:62\">\n<span id=\"-技術的な仕組み実装アーキテクチャ\" class=\"fragment\"></span><a href=\"#-%E6%8A%80%E8%A1%93%E7%9A%84%E3%81%AA%E4%BB%95%E7%B5%84%E3%81%BF%E5%AE%9F%E8%A3%85%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3\"><i class=\"fa fa-link\"></i></a>🔧 技術的な仕組み・実装・アーキテクチャ</h2>\n<p data-sourcepos=\"43:1-43:72\">今回のパイプラインは、以下の要素で構成されます。</p>\n<ol data-sourcepos=\"45:1-48:0\">\n<li data-sourcepos=\"45:1-45:96\">\n<strong>Python スクリプト</strong>: Qiita API を利用して記事を投稿するスクリプト。</li>\n<li data-sourcepos=\"46:1-46:161\">\n<strong>GitHub Actions ワークフロー</strong>: リポジトリへのプッシュをトリガーとして、Python スクリプトを実行するワークフロー。</li>\n<li data-sourcepos=\"47:1-48:0\">\n<strong>Qiita API トークン</strong>: Qiita API を利用するための認証情報。GitHub Actions のシークレットとして安全に管理します。</li>\n</ol>\n<p data-sourcepos=\"49:1-49:17\"><strong>メリット:</strong></p>\n<ul data-sourcepos=\"51:1-54:0\">\n<li data-sourcepos=\"51:1-51:43\">記事投稿の手間を大幅に削減</li>\n<li data-sourcepos=\"52:1-52:37\">継続的な知識共有を促進</li>\n<li data-sourcepos=\"53:1-54:0\">チーム内での情報共有を円滑化</li>\n</ul>\n<p data-sourcepos=\"55:1-55:20\"><strong>デメリット:</strong></p>\n<ul data-sourcepos=\"57:1-59:0\">\n<li data-sourcepos=\"57:1-57:59\">Qiita API の仕様変更に対応する必要がある</li>\n<li data-sourcepos=\"58:1-59:0\">GitHub Actions の設定に慣れる必要がある</li>\n</ul>\n<p data-sourcepos=\"60:1-60:26\"><strong>ハマりポイント:</strong></p>\n<ul data-sourcepos=\"62:1-64:0\">\n<li data-sourcepos=\"62:1-62:127\">Qiita API トークンの管理: GitHub Actions のシークレットとして安全に管理する必要があります。</li>\n<li data-sourcepos=\"63:1-64:0\">Python スクリプトの依存関係: GitHub Actions の環境に Python のライブラリをインストールする必要があります。</li>\n</ul>\n<h2 data-sourcepos=\"65:1-65:53\">\n<span id=\"-実践編動くコードコマンド例\" class=\"fragment\"></span><a href=\"#-%E5%AE%9F%E8%B7%B5%E7%B7%A8%E5%8B%95%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>🧪 実践編：動くコード／コマンド例</h2>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"67:1-70:3\"><div class=\"highlight\"><pre><code><span class=\"c\"># 必要なライブラリのインストール</span>\npip <span class=\"nb\">install </span>requests python-dotenv\n</code></pre></div></div>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"72:1-109:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># Qiita API を利用して記事を投稿する Python スクリプト (qiita_poster.py)\n</span><span class=\"kn\">import</span> <span class=\"n\">os</span>\n<span class=\"kn\">import</span> <span class=\"n\">requests</span>\n<span class=\"kn\">from</span> <span class=\"n\">dotenv</span> <span class=\"kn\">import</span> <span class=\"n\">load_dotenv</span>\n\n<span class=\"nf\">load_dotenv</span><span class=\"p\">()</span>\n\n<span class=\"n\">QIITA_API_TOKEN</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">environ</span><span class=\"p\">.</span><span class=\"nf\">get</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\">QIITA_API_TOKEN</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n<span class=\"n\">QIITA_ENDPOINT</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">https://qiita.com/api/v2/items</span><span class=\"sh\">\"</span>\n<span class=\"n\">HEADERS</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"sh\">\"</span><span class=\"s\">Authorization</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">Bearer </span><span class=\"si\">{</span><span class=\"n\">QIITA_API_TOKEN</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">,</span>\n    <span class=\"sh\">\"</span><span class=\"s\">Content-Type</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sh\">\"</span><span class=\"s\">application/json</span><span class=\"sh\">\"</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">post_to_qiita</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">,</span> <span class=\"n\">body</span><span class=\"p\">,</span> <span class=\"n\">tags</span><span class=\"p\">,</span> <span class=\"n\">is_private</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">):</span>\n    <span class=\"sh\">\"\"\"</span><span class=\"s\">Qiita に記事を投稿する</span><span class=\"sh\">\"\"\"</span>\n    <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"sh\">\"</span><span class=\"s\">title</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">title</span><span class=\"p\">,</span>\n        <span class=\"sh\">\"</span><span class=\"s\">body</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">body</span><span class=\"p\">,</span>\n        <span class=\"sh\">\"</span><span class=\"s\">tags</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"sh\">\"</span><span class=\"s\">name</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">tag</span><span class=\"p\">}</span> <span class=\"k\">for</span> <span class=\"n\">tag</span> <span class=\"ow\">in</span> <span class=\"n\">tags</span><span class=\"p\">],</span>\n        <span class=\"sh\">\"</span><span class=\"s\">private</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">is_private</span><span class=\"p\">,</span>\n    <span class=\"p\">}</span>\n    <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"n\">requests</span><span class=\"p\">.</span><span class=\"nf\">post</span><span class=\"p\">(</span><span class=\"n\">QIITA_ENDPOINT</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"o\">=</span><span class=\"n\">HEADERS</span><span class=\"p\">,</span> <span class=\"n\">json</span><span class=\"o\">=</span><span class=\"n\">data</span><span class=\"p\">)</span>\n    <span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">raise_for_status</span><span class=\"p\">()</span>  <span class=\"c1\"># エラーが発生した場合に例外を発生させる\n</span>    <span class=\"k\">return</span> <span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">json</span><span class=\"p\">()</span>\n\n<span class=\"k\">if</span> <span class=\"n\">__name__</span> <span class=\"o\">==</span> <span class=\"sh\">\"</span><span class=\"s\">__main__</span><span class=\"sh\">\"</span><span class=\"p\">:</span>\n    <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">テスト投稿</span><span class=\"sh\">\"</span>\n    <span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">これはテスト投稿です。</span><span class=\"sh\">\"</span>\n    <span class=\"n\">tags</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"sh\">\"</span><span class=\"s\">Python</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"sh\">\"</span><span class=\"s\">Qiita</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"sh\">\"</span><span class=\"s\">GitHub Actions</span><span class=\"sh\">\"</span><span class=\"p\">]</span>\n\n    <span class=\"k\">try</span><span class=\"p\">:</span>\n        <span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"nf\">post_to_qiita</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">,</span> <span class=\"n\">body</span><span class=\"p\">,</span> <span class=\"n\">tags</span><span class=\"p\">)</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">投稿成功！ URL: </span><span class=\"si\">{</span><span class=\"n\">result</span><span class=\"p\">[</span><span class=\"sh\">'</span><span class=\"s\">url</span><span class=\"sh\">'</span><span class=\"p\">]</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n    <span class=\"k\">except</span> <span class=\"n\">requests</span><span class=\"p\">.</span><span class=\"n\">exceptions</span><span class=\"p\">.</span><span class=\"n\">RequestException</span> <span class=\"k\">as</span> <span class=\"n\">e</span><span class=\"p\">:</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">投稿失敗: </span><span class=\"si\">{</span><span class=\"n\">e</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n</code></pre></div></div>\n<div class=\"code-frame\" data-lang=\"yaml\" data-sourcepos=\"111:1-137:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># GitHub Actions ワークフローの定義 (qiita_poster.yml)</span>\n<span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Qiita Poster</span>\n\n<span class=\"na\">on</span><span class=\"pi\">:</span>\n  <span class=\"na\">push</span><span class=\"pi\">:</span>\n    <span class=\"na\">branches</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"s\">main</span>\n\n<span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">deploy</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-latest</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/checkout@v3</span>\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Set up Python </span><span class=\"m\">3.9</span>\n        <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/setup-python@v3</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">python-version</span><span class=\"pi\">:</span> <span class=\"m\">3.9</span>\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Install dependencies</span>\n        <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n          <span class=\"s\">python -m pip install --upgrade pip</span>\n          <span class=\"s\">pip install -r requirements.txt</span>\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Run Qiita Poster</span>\n        <span class=\"na\">env</span><span class=\"pi\">:</span>\n          <span class=\"na\">QIITA_API_TOKEN</span><span class=\"pi\">:</span> <span class=\"s\">${{ secrets.QIITA_API_TOKEN }}</span>\n        <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">python qiita_poster.py</span>\n</code></pre></div></div>\n<p data-sourcepos=\"139:1-139:17\"><strong>実行手順:</strong></p>\n<ol data-sourcepos=\"141:1-146:0\">\n<li data-sourcepos=\"141:1-141:47\">GitHub リポジトリを作成します。</li>\n<li data-sourcepos=\"142:1-142:84\">\n<code>qiita_poster.py</code> と <code>qiita_poster.yml</code> をリポジトリに追加します。</li>\n<li data-sourcepos=\"143:1-143:122\">\n<code>requirements.txt</code> ファイルを作成し、必要なライブラリ (requests, python-dotenv) を記述します。</li>\n<li data-sourcepos=\"144:1-144:145\">Qiita API トークンを取得し、GitHub リポジトリの Settings &gt; Secrets &gt; Actions に <code>QIITA_API_TOKEN</code> として登録します。</li>\n<li data-sourcepos=\"145:1-146:0\">リポジトリにプッシュすると、GitHub Actions が自動的に実行され、Qiita に記事が投稿されます。</li>\n</ol>\n<p data-sourcepos=\"147:1-147:20\"><strong>成功時ログ:</strong></p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"149:1-151:3\"><div class=\"highlight\"><pre><code>投稿成功！ URL: https://qiita.com/your_qiita_id/items/xxxxxxxxxxxxxxxxxxxx\n</code></pre></div></div>\n<p data-sourcepos=\"153:1-153:20\"><strong>失敗時ログ:</strong></p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"155:1-157:3\"><div class=\"highlight\"><pre><code>投稿失敗: 401 Client Error: Unauthorized for url: https://qiita.com/api/v2/items\n</code></pre></div></div>\n<p data-sourcepos=\"159:1-159:14\"><strong>注意点:</strong></p>\n<ul data-sourcepos=\"161:1-164:0\">\n<li data-sourcepos=\"161:1-161:88\">\n<code>qiita_poster.py</code> の <code>title</code>、<code>body</code>、<code>tags</code> を適宜変更してください。</li>\n<li data-sourcepos=\"162:1-162:134\">\n<code>qiita_poster.yml</code> の <code>branches</code> を、プッシュをトリガーとするブランチに合わせて変更してください。</li>\n<li data-sourcepos=\"163:1-164:0\">\n<code>requirements.txt</code> には、Python スクリプトに必要なすべてのライブラリを記述してください。</li>\n</ul>\n<h2 data-sourcepos=\"165:1-165:35\">\n<span id=\"-応用発展実用例\" class=\"fragment\"></span><a href=\"#-%E5%BF%9C%E7%94%A8%E7%99%BA%E5%B1%95%E5%AE%9F%E7%94%A8%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>🚀 応用・発展・実用例</h2>\n<ul data-sourcepos=\"167:1-172:0\">\n<li data-sourcepos=\"167:1-167:125\">\n<strong>記事内容の自動生成</strong>: AI を活用して記事の草稿を自動生成し、それを Qiita に投稿する。</li>\n<li data-sourcepos=\"168:1-168:182\">\n<strong>定期的な情報共有</strong>: 定期的に実行されるスクリプトを作成し、特定の情報を Qiita に自動投稿する（例：日々のニュースサマリ）。</li>\n<li data-sourcepos=\"169:1-169:179\">\n<strong>Docker 化</strong>: Python スクリプトを Docker コンテナ化することで、環境依存性の問題を解消し、より安定したパイプラインを構築する。</li>\n<li data-sourcepos=\"170:1-170:135\">\n<strong>可視化</strong>: データの可視化ツール (例: Matplotlib, Seaborn) で生成したグラフを Qiita 記事に埋め込む。</li>\n<li data-sourcepos=\"171:1-172:0\">\n<strong>創薬</strong>: 実験データや解析結果を自動的に Qiita に投稿し、研究チーム内での情報共有を効率化する。</li>\n</ul>\n<h2 data-sourcepos=\"173:1-173:32\">\n<span id=\"-まとめtakeaways\" class=\"fragment\"></span><a href=\"#-%E3%81%BE%E3%81%A8%E3%82%81takeaways\"><i class=\"fa fa-link\"></i></a>📝 まとめ（Takeaways）</h2>\n<p data-sourcepos=\"175:1-177:130\">生成日時: 2025-12-05 17:04:09<br>\nステータス: draft<br>\nタグ: Qiita, チュートリアル, Python, 自動化, ワークフロー, GitHubActions, CI/CD, 効率化, API, 初心者向け</p>\n",
      "body": "> **対象読者**  \n> Python をある程度書けるエンジニア、GitHub Actions に興味がある方、Qiita 投稿を効率化したい方\n\n> **動作確認環境 / 前提条件**  \n> - macOS Monterey (12.6.3)\n> - Python 3.9\n> - pip 23.0\n> - GitHub アカウント\n> - Qiita API トークン\n\n> **この記事で得られること**\n> - Qiita API を利用した記事投稿の自動化\n> - GitHub Actions を利用した CI/CD パイプラインの構築\n> - Python スクリプトのテストとデプロイの自動化\n\n## 🧭 導入：背景・課題・なぜ重要か\n\n日々の業務や学習で得た知識を Qiita に投稿するのは、エンジニアにとって非常に有益な習慣です。しかし、「記事を書く時間がない」「投稿が面倒」といった理由で、せっかくの知識が埋もれてしまうことも少なくありません。\n\nそこで、この記事では **Python と GitHub Actions を活用して、Qiita への記事投稿を自動化するパイプライン** を構築します。これにより、記事作成に集中し、より多くの知識を共有できるようになります。\n\n以前の記事 [使用例](https://qiita.com/cocokara_bioinfo/items/78b20fc5aff614e609e2) では、Qiita 投稿の効率化について紹介しましたが、今回はさらに一歩進んで、完全に自動化されたパイプラインを構築します。この自動化によって、記事の作成から投稿までの一連のフローが劇的に改善され、より多くの時間を記事の質向上に費やすことができるようになります。\n\n## 📘 トピックの概要\n\n今回のトピックは、**Qiita API を利用した記事投稿の自動化** です。Qiita API を利用することで、プログラムから Qiita に記事を投稿したり、既存の記事を更新したりすることができます。\n\n**GitHub Actions** は、GitHub 上で CI/CD (継続的インテグレーション/継続的デリバリー) パイプラインを構築するためのサービスです。GitHub リポジトリへのプッシュやプルリクエストをトリガーとして、自動的にテストやデプロイを実行できます。\n\n今回のパイプラインのイメージは以下の通りです。\n\n**文章で図解イメージ案:**\n\n1.  GitHub リポジトリに Markdown ファイル (Qiita 記事) をプッシュ\n2.  GitHub Actions がプッシュを検知\n3.  Python スクリプトが Markdown ファイルを読み込み、Qiita API を利用して記事を投稿\n4.  投稿結果を GitHub Actions のログに出力\n\nバイオインフォマティクス分野では、大量のデータを解析し、その結果を共有する必要があります。この自動投稿パイプラインは、解析結果を Qiita で共有する際に非常に役立ちます。例えば、ある遺伝子セットに対する解析結果を自動的に Qiita に投稿し、他の研究者と共有することができます。これは、**遺伝子配列という「文字列データ」** を解析し、その結果を共有するという点で、ソフトウェア開発におけるドキュメント生成と似た側面を持っています。\n\n## 🔧 技術的な仕組み・実装・アーキテクチャ\n\n今回のパイプラインは、以下の要素で構成されます。\n\n1.  **Python スクリプト**: Qiita API を利用して記事を投稿するスクリプト。\n2.  **GitHub Actions ワークフロー**: リポジトリへのプッシュをトリガーとして、Python スクリプトを実行するワークフロー。\n3.  **Qiita API トークン**: Qiita API を利用するための認証情報。GitHub Actions のシークレットとして安全に管理します。\n\n**メリット:**\n\n*   記事投稿の手間を大幅に削減\n*   継続的な知識共有を促進\n*   チーム内での情報共有を円滑化\n\n**デメリット:**\n\n*   Qiita API の仕様変更に対応する必要がある\n*   GitHub Actions の設定に慣れる必要がある\n\n**ハマりポイント:**\n\n*   Qiita API トークンの管理: GitHub Actions のシークレットとして安全に管理する必要があります。\n*   Python スクリプトの依存関係: GitHub Actions の環境に Python のライブラリをインストールする必要があります。\n\n## 🧪 実践編：動くコード／コマンド例\n\n```bash\n# 必要なライブラリのインストール\npip install requests python-dotenv\n```\n\n```python\n# Qiita API を利用して記事を投稿する Python スクリプト (qiita_poster.py)\nimport os\nimport requests\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nQIITA_API_TOKEN = os.environ.get(\"QIITA_API_TOKEN\")\nQIITA_ENDPOINT = \"https://qiita.com/api/v2/items\"\nHEADERS = {\n    \"Authorization\": f\"Bearer {QIITA_API_TOKEN}\",\n    \"Content-Type\": \"application/json\",\n}\n\ndef post_to_qiita(title, body, tags, is_private=False):\n    \"\"\"Qiita に記事を投稿する\"\"\"\n    data = {\n        \"title\": title,\n        \"body\": body,\n        \"tags\": [{\"name\": tag} for tag in tags],\n        \"private\": is_private,\n    }\n    response = requests.post(QIITA_ENDPOINT, headers=HEADERS, json=data)\n    response.raise_for_status()  # エラーが発生した場合に例外を発生させる\n    return response.json()\n\nif __name__ == \"__main__\":\n    title = \"テスト投稿\"\n    body = \"これはテスト投稿です。\"\n    tags = [\"Python\", \"Qiita\", \"GitHub Actions\"]\n\n    try:\n        result = post_to_qiita(title, body, tags)\n        print(f\"投稿成功！ URL: {result['url']}\")\n    except requests.exceptions.RequestException as e:\n        print(f\"投稿失敗: {e}\")\n```\n\n```yaml\n# GitHub Actions ワークフローの定義 (qiita_poster.yml)\nname: Qiita Poster\n\non:\n  push:\n    branches:\n      - main\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - name: Set up Python 3.9\n        uses: actions/setup-python@v3\n        with:\n          python-version: 3.9\n      - name: Install dependencies\n        run: |\n          python -m pip install --upgrade pip\n          pip install -r requirements.txt\n      - name: Run Qiita Poster\n        env:\n          QIITA_API_TOKEN: ${{ secrets.QIITA_API_TOKEN }}\n        run: python qiita_poster.py\n```\n\n**実行手順:**\n\n1.  GitHub リポジトリを作成します。\n2.  `qiita_poster.py` と `qiita_poster.yml` をリポジトリに追加します。\n3.  `requirements.txt` ファイルを作成し、必要なライブラリ (requests, python-dotenv) を記述します。\n4.  Qiita API トークンを取得し、GitHub リポジトリの Settings > Secrets > Actions に `QIITA_API_TOKEN` として登録します。\n5.  リポジトリにプッシュすると、GitHub Actions が自動的に実行され、Qiita に記事が投稿されます。\n\n**成功時ログ:**\n\n```\n投稿成功！ URL: https://qiita.com/your_qiita_id/items/xxxxxxxxxxxxxxxxxxxx\n```\n\n**失敗時ログ:**\n\n```\n投稿失敗: 401 Client Error: Unauthorized for url: https://qiita.com/api/v2/items\n```\n\n**注意点:**\n\n*   `qiita_poster.py` の `title`、`body`、`tags` を適宜変更してください。\n*   `qiita_poster.yml` の `branches` を、プッシュをトリガーとするブランチに合わせて変更してください。\n*   `requirements.txt` には、Python スクリプトに必要なすべてのライブラリを記述してください。\n\n## 🚀 応用・発展・実用例\n\n*   **記事内容の自動生成**: AI を活用して記事の草稿を自動生成し、それを Qiita に投稿する。\n*   **定期的な情報共有**: 定期的に実行されるスクリプトを作成し、特定の情報を Qiita に自動投稿する（例：日々のニュースサマリ）。\n*   **Docker 化**: Python スクリプトを Docker コンテナ化することで、環境依存性の問題を解消し、より安定したパイプラインを構築する。\n*   **可視化**: データの可視化ツール (例: Matplotlib, Seaborn) で生成したグラフを Qiita 記事に埋め込む。\n*   **創薬**: 実験データや解析結果を自動的に Qiita に投稿し、研究チーム内での情報共有を効率化する。\n\n## 📝 まとめ（Takeaways）\n\n生成日時: 2025-12-05 17:04:09\nステータス: draft\nタグ: Qiita, チュートリアル, Python, 自動化, ワークフロー, GitHubActions, CI/CD, 効率化, API, 初心者向け\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-05T17:04:22+09:00",
      "group": null,
      "id": "7440c80d8e6a98177957",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Qiita",
          "versions": []
        },
        {
          "name": "Python",
          "versions": []
        },
        {
          "name": "自動化",
          "versions": []
        },
        {
          "name": "チュートリアル",
          "versions": []
        },
        {
          "name": "ワークフロー",
          "versions": []
        }
      ],
      "title": "Python × GitHub Actions で始める！Qiita 自動投稿パイプライン構築術",
      "updated_at": "2025-12-05T17:04:22+09:00",
      "url": "https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957",
      "user": {
        "description": "ポッケ村出身の名もなき若手生物学研究員です。\r\n現代の技術やエンジニア知識を学びながらモンスターハンターの生態・生物学研究に日々励んでおります！\r\nまだまだ勉強不足なところはありますが、皆さんに少しでも学びになるものをお届けできればとの思いで発信させていただきます\r\n\r\n※フィクションとして、時にTips記事として楽しんでいただければ幸いです",
        "facebook_id": "",
        "followees_count": 3,
        "followers_count": 0,
        "github_login_name": null,
        "id": "cocokara_bioinfo",
        "items_count": 4,
        "linkedin_id": "",
        "location": "",
        "name": "シャル・S 調査員",
        "organization": "Genome & Ecology Monster-Lab (架空)",
        "permanent_id": 4288059,
        "profile_image_url": "https://lh3.googleusercontent.com/a/ACg8ocLkgrrRuDzozKQ4XeInetzc0um1rPWRGXY2daT9pLIi1z1JdQ=s96-c",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": ""
      },
      "page_views_count": 137,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "my_popular"
    },
    {
      "rendered_body": "<blockquote data-sourcepos=\"1:1-2:162\">\n<p data-sourcepos=\"1:3-2:162\"><strong>対象読者</strong><br>\nPython を利用したことがあるエンジニア、GitHub Actions を利用したことがあるエンジニア、Qiita への投稿を効率化したい方</p>\n</blockquote>\n<blockquote data-sourcepos=\"4:1-9:211\">\n<p data-sourcepos=\"4:3-4:41\"><strong>動作確認環境 / 前提条件</strong></p>\n<ul data-sourcepos=\"5:3-9:211\">\n<li data-sourcepos=\"5:3-5:24\">macOS Ventura 13.6.3</li>\n<li data-sourcepos=\"6:3-6:17\">Python 3.11.5</li>\n<li data-sourcepos=\"7:3-7:26\">GitHub アカウント</li>\n<li data-sourcepos=\"8:3-8:95\">Qiita API v2 の理解（<a href=\"https://qiita.com/api/v2/docs\">公式ドキュメント</a>参照）</li>\n<li data-sourcepos=\"9:3-9:211\">以前の記事「<a href=\"https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957\" id=\"reference-f84ecb787f5c23d4b71a\">Python × GitHub Actions で始める！Qiita 自動投稿パイプライン構築術</a>」の内容を理解していること</li>\n</ul>\n</blockquote>\n<blockquote data-sourcepos=\"11:1-14:88\">\n<p data-sourcepos=\"11:3-11:39\"><strong>この記事で得られること</strong></p>\n<ul data-sourcepos=\"12:3-14:88\">\n<li data-sourcepos=\"12:3-12:78\">Qiita 記事投稿を自動化する Python スクリプトの構築方法</li>\n<li data-sourcepos=\"13:3-13:74\">GitHub Actions を利用した CI/CD パイプラインの構築方法</li>\n<li data-sourcepos=\"14:3-14:88\">自動化パイプライン構築におけるハマりどころと、その解決策</li>\n</ul>\n</blockquote>\n<h2 data-sourcepos=\"17:1-17:45\">\n<span id=\"実際に躓いたポイントと解決策\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E8%BA%93%E3%81%84%E3%81%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%A8%E8%A7%A3%E6%B1%BA%E7%AD%96\"><i class=\"fa fa-link\"></i></a>実際に躓いたポイントと解決策</h2>\n<h3 data-sourcepos=\"19:1-19:41\">\n<span id=\"1-gemini-apiのモデル名エラー\" class=\"fragment\"></span><a href=\"#1-gemini-api%E3%81%AE%E3%83%A2%E3%83%87%E3%83%AB%E5%90%8D%E3%82%A8%E3%83%A9%E3%83%BC\"><i class=\"fa fa-link\"></i></a>1. Gemini APIのモデル名エラー</h3>\n<p data-sourcepos=\"21:1-21:12\"><strong>問題</strong>:</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"22:1-24:3\"><div class=\"highlight\"><pre><code>404 models/gemini-1.5-flash is not found for API version v1beta\n</code></pre></div></div>\n<p data-sourcepos=\"26:1-26:12\"><strong>原因</strong>:</p>\n<ul data-sourcepos=\"27:1-29:0\">\n<li data-sourcepos=\"27:1-27:138\">設定ファイルで<code>gemini-1.5-flash</code>を指定していたが、実際に利用可能なモデルは<code>models/gemini-2.0-flash</code>だった</li>\n<li data-sourcepos=\"28:1-29:0\">Google Gemini APIは定期的にモデル名が更新される</li>\n</ul>\n<p data-sourcepos=\"30:1-30:14\"><strong>解決策</strong>:</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"31:1-45:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># 利用可能なモデルを確認\n</span><span class=\"n\">models</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">m</span> <span class=\"k\">for</span> <span class=\"n\">m</span> <span class=\"ow\">in</span> <span class=\"n\">genai</span><span class=\"p\">.</span><span class=\"nf\">list_models</span><span class=\"p\">()</span> \n          <span class=\"k\">if</span> <span class=\"sh\">'</span><span class=\"s\">generateContent</span><span class=\"sh\">'</span> <span class=\"ow\">in</span> <span class=\"n\">m</span><span class=\"p\">.</span><span class=\"n\">supported_generation_methods</span><span class=\"p\">]</span>\n<span class=\"c1\"># 結果: models/gemini-2.0-flash, models/gemini-2.5-flash など\n</span>\n<span class=\"c1\"># 設定ファイルを更新\n</span><span class=\"p\">{</span>\n  <span class=\"sh\">\"</span><span class=\"s\">api</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"sh\">\"</span><span class=\"s\">gemini</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"sh\">\"</span><span class=\"s\">model</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sh\">\"</span><span class=\"s\">models/gemini-2.0-flash</span><span class=\"sh\">\"</span>  <span class=\"c1\"># models/プレフィックスが必要\n</span>    <span class=\"p\">}</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n<p data-sourcepos=\"47:1-47:129\"><strong>学んだこと</strong>: APIの仕様変更に備えて、利用可能なモデルを動的に確認する仕組みを追加すべき</p>\n<h3 data-sourcepos=\"49:1-49:60\">\n<span id=\"2-windowsコンソールのunicode文字表示エラー\" class=\"fragment\"></span><a href=\"#2-windows%E3%82%B3%E3%83%B3%E3%82%BD%E3%83%BC%E3%83%AB%E3%81%AEunicode%E6%96%87%E5%AD%97%E8%A1%A8%E7%A4%BA%E3%82%A8%E3%83%A9%E3%83%BC\"><i class=\"fa fa-link\"></i></a>2. WindowsコンソールのUnicode文字表示エラー</h3>\n<p data-sourcepos=\"51:1-51:11\"><strong>問題</strong>:</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"52:1-54:3\"><div class=\"highlight\"><pre><code>UnicodeEncodeError: 'cp932' codec can't encode character '✓' in position 0\n</code></pre></div></div>\n<p data-sourcepos=\"56:1-56:12\"><strong>原因</strong>:</p>\n<ul data-sourcepos=\"57:1-58:0\">\n<li data-sourcepos=\"57:1-58:0\">WindowsのPowerShellでは、Unicode文字（✓、⚠、✗）がデフォルトのエンコーディング（cp932）で表示できない</li>\n</ul>\n<p data-sourcepos=\"59:1-59:14\"><strong>解決策</strong>:</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"60:1-65:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># Unicode文字を通常の文字に置き換え\n</span><span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">[OK] 処理が完了しました</span><span class=\"sh\">\"</span><span class=\"p\">)</span>  <span class=\"c1\"># ✓ → [OK]\n</span><span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">[WARN] 警告メッセージ</span><span class=\"sh\">\"</span><span class=\"p\">)</span>    <span class=\"c1\"># ⚠ → [WARN]\n</span><span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">[ERROR] エラーが発生</span><span class=\"sh\">\"</span><span class=\"p\">)</span>     <span class=\"c1\"># ✗ → [ERROR]\n</span></code></pre></div></div>\n<p data-sourcepos=\"67:1-67:160\"><strong>学んだこと</strong>: クロスプラットフォーム対応では、Unicode文字の使用を避けるか、エンコーディングを明示的に設定する</p>\n<h3 data-sourcepos=\"69:1-69:55\">\n<span id=\"3-qiita-apiのタグ数制限による403エラー\" class=\"fragment\"></span><a href=\"#3-qiita-api%E3%81%AE%E3%82%BF%E3%82%B0%E6%95%B0%E5%88%B6%E9%99%90%E3%81%AB%E3%82%88%E3%82%8B403%E3%82%A8%E3%83%A9%E3%83%BC\"><i class=\"fa fa-link\"></i></a>3. Qiita APIのタグ数制限による403エラー</h3>\n<p data-sourcepos=\"71:1-71:11\"><strong>問題</strong>:</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"72:1-74:3\"><div class=\"highlight\"><pre><code>HTTPエラー: 403 - {'message': 'Forbidden', 'type': 'forbidden'}\n</code></pre></div></div>\n<p data-sourcepos=\"76:1-76:12\"><strong>原因</strong>:</p>\n<ul data-sourcepos=\"77:1-79:0\">\n<li data-sourcepos=\"77:1-77:124\">動的タグ生成で9個のタグを生成していたが、Qiita APIはタグを最大5個までしか受け付けない</li>\n<li data-sourcepos=\"78:1-79:0\">APIドキュメントを確認せずに実装していた</li>\n</ul>\n<p data-sourcepos=\"80:1-80:14\"><strong>解決策</strong>:</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"81:1-86:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># タグを5個に制限\n</span><span class=\"k\">if</span> <span class=\"nf\">len</span><span class=\"p\">(</span><span class=\"n\">tags</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">5</span><span class=\"p\">:</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">[WARN] タグが</span><span class=\"si\">{</span><span class=\"nf\">len</span><span class=\"p\">(</span><span class=\"n\">tags</span><span class=\"p\">)</span><span class=\"si\">}</span><span class=\"s\">個ありますが、Qiita APIの制限により5個に制限します</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n<span class=\"n\">qiita_tags</span> <span class=\"o\">=</span> <span class=\"p\">[{</span><span class=\"sh\">\"</span><span class=\"s\">name</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">tag</span><span class=\"p\">}</span> <span class=\"k\">for</span> <span class=\"n\">tag</span> <span class=\"ow\">in</span> <span class=\"n\">tags</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">]]</span>\n</code></pre></div></div>\n<p data-sourcepos=\"88:1-88:21\"><strong>学んだこと</strong>:</p>\n<ul data-sourcepos=\"89:1-91:0\">\n<li data-sourcepos=\"89:1-89:47\">APIの仕様を事前に確認する重要性</li>\n<li data-sourcepos=\"90:1-91:0\">エラーメッセージが不十分な場合、リクエスト内容を詳細にログ出力して原因を特定する</li>\n</ul>\n<h3 data-sourcepos=\"92:1-92:40\">\n<span id=\"4-llmプロンプトの設計ミス\" class=\"fragment\"></span><a href=\"#4-llm%E3%83%97%E3%83%AD%E3%83%B3%E3%83%97%E3%83%88%E3%81%AE%E8%A8%AD%E8%A8%88%E3%83%9F%E3%82%B9\"><i class=\"fa fa-link\"></i></a>4. LLMプロンプトの設計ミス</h3>\n<p data-sourcepos=\"94:1-94:12\"><strong>問題</strong>:</p>\n<ul data-sourcepos=\"95:1-97:0\">\n<li data-sourcepos=\"95:1-95:111\">タイトル案を3つ生成していたが、実際のタイトルが「使用例」になってしまった</li>\n<li data-sourcepos=\"96:1-97:0\">パース処理でタイトルが正しく抽出できなかった</li>\n</ul>\n<p data-sourcepos=\"98:1-98:11\"><strong>原因</strong>:</p>\n<ul data-sourcepos=\"99:1-101:0\">\n<li data-sourcepos=\"99:1-99:138\">プロンプトで「タイトル案（3つ）」を指示していたが、実際のタイトルを明確に指定していなかった</li>\n<li data-sourcepos=\"100:1-101:0\">パース処理がタイトル案セクションをスキップできていなかった</li>\n</ul>\n<p data-sourcepos=\"102:1-102:14\"><strong>解決策</strong>:</p>\n<div class=\"code-frame\" data-lang=\"markdown\" data-sourcepos=\"103:1-108:3\"><div class=\"highlight\"><pre><code><span class=\"gh\"># プロンプトの修正</span>\n<span class=\"gs\">**重要**</span>: 記事の最初の行に、実際に使用するタイトルを<span class=\"sb\">`# `</span>で始まるMarkdownの見出し形式で記述してください。\n\nタイトル案は不要です。最初の<span class=\"sb\">`# `</span>行がそのまま記事のタイトルとして使用されます。\n</code></pre></div></div>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"110:1-123:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># パース処理の改善\n</span><span class=\"n\">skip_title_section</span> <span class=\"o\">=</span> <span class=\"bp\">False</span>\n<span class=\"k\">for</span> <span class=\"n\">line</span> <span class=\"ow\">in</span> <span class=\"n\">lines</span><span class=\"p\">:</span>\n    <span class=\"c1\"># タイトル案セクションを検出してスキップ\n</span>    <span class=\"k\">if</span> <span class=\"sh\">\"</span><span class=\"s\">タイトル案</span><span class=\"sh\">\"</span> <span class=\"ow\">in</span> <span class=\"n\">line</span><span class=\"p\">:</span>\n        <span class=\"n\">skip_title_section</span> <span class=\"o\">=</span> <span class=\"bp\">True</span>\n        <span class=\"k\">continue</span>\n    \n    <span class=\"c1\"># 最初の`# `で始まる行をタイトルとして取得\n</span>    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">found_main_title</span> <span class=\"ow\">and</span> <span class=\"n\">line</span><span class=\"p\">.</span><span class=\"nf\">startswith</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\"># </span><span class=\"sh\">\"</span><span class=\"p\">):</span>\n        <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"n\">line</span><span class=\"p\">.</span><span class=\"nf\">replace</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\"># </span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"sh\">\"\"</span><span class=\"p\">).</span><span class=\"nf\">strip</span><span class=\"p\">()</span>\n        <span class=\"n\">found_main_title</span> <span class=\"o\">=</span> <span class=\"bp\">True</span>\n</code></pre></div></div>\n<p data-sourcepos=\"125:1-125:21\"><strong>学んだこと</strong>:</p>\n<ul data-sourcepos=\"126:1-128:0\">\n<li data-sourcepos=\"126:1-126:65\">LLMへのプロンプトは明確で具体的な指示が必要</li>\n<li data-sourcepos=\"127:1-128:0\">出力形式を厳密に指定することで、パース処理を簡潔にできる</li>\n</ul>\n<h3 data-sourcepos=\"129:1-129:43\">\n<span id=\"5-エラーハンドリングの不足\" class=\"fragment\"></span><a href=\"#5-%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E4%B8%8D%E8%B6%B3\"><i class=\"fa fa-link\"></i></a>5. エラーハンドリングの不足</h3>\n<p data-sourcepos=\"131:1-131:12\"><strong>問題</strong>:</p>\n<ul data-sourcepos=\"132:1-134:0\">\n<li data-sourcepos=\"132:1-132:68\">403エラーが発生した際、原因が特定しづらかった</li>\n<li data-sourcepos=\"133:1-134:0\">デバッグ情報が不足していた</li>\n</ul>\n<p data-sourcepos=\"135:1-135:14\"><strong>解決策</strong>:</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"136:1-152:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># デバッグ情報の追加\n</span><span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">[DEBUG] アクセストークン: </span><span class=\"si\">{</span><span class=\"n\">token_preview</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">[DEBUG] リクエストURL: </span><span class=\"si\">{</span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">base_url</span><span class=\"si\">}</span><span class=\"s\">/items</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">[DEBUG] ペイロード: title=</span><span class=\"si\">{</span><span class=\"n\">title</span><span class=\"p\">[</span><span class=\"si\">:</span><span class=\"mi\">50</span><span class=\"p\">]</span><span class=\"si\">}</span><span class=\"s\">, tags=</span><span class=\"si\">{</span><span class=\"nf\">len</span><span class=\"p\">(</span><span class=\"n\">tags</span><span class=\"p\">)</span><span class=\"si\">}</span><span class=\"s\">個</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">[DEBUG] レスポンスステータス: </span><span class=\"si\">{</span><span class=\"n\">response</span><span class=\"p\">.</span><span class=\"n\">status_code</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># エラーメッセージの改善\n</span><span class=\"k\">if</span> <span class=\"n\">e</span><span class=\"p\">.</span><span class=\"n\">response</span><span class=\"p\">.</span><span class=\"n\">status_code</span> <span class=\"o\">==</span> <span class=\"mi\">403</span><span class=\"p\">:</span>\n    <span class=\"n\">error_msg</span> <span class=\"o\">+=</span> <span class=\"sh\">\"</span><span class=\"s\">\n\n考えられる原因:</span><span class=\"sh\">\"</span>\n    <span class=\"n\">error_msg</span> <span class=\"o\">+=</span> <span class=\"sh\">\"</span><span class=\"s\">\n- アクセストークンのスコープが不足しています</span><span class=\"sh\">\"</span>\n    <span class=\"n\">error_msg</span> <span class=\"o\">+=</span> <span class=\"sh\">\"</span><span class=\"s\">\n- タグ数が5個を超えています（Qiita APIの制限）</span><span class=\"sh\">\"</span>\n</code></pre></div></div>\n<p data-sourcepos=\"154:1-154:21\"><strong>学んだこと</strong>:</p>\n<ul data-sourcepos=\"155:1-157:0\">\n<li data-sourcepos=\"155:1-155:98\">エラー発生時には、リクエスト内容とレスポンスを詳細にログ出力する</li>\n<li data-sourcepos=\"156:1-157:0\">よくあるエラーについては、解決策を提示する</li>\n</ul>\n<h2 data-sourcepos=\"158:1-158:27\">\n<span id=\"工夫したポイント\" class=\"fragment\"></span><a href=\"#%E5%B7%A5%E5%A4%AB%E3%81%97%E3%81%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\"><i class=\"fa fa-link\"></i></a>工夫したポイント</h2>\n<h3 data-sourcepos=\"160:1-160:40\">\n<span id=\"1-プロンプト管理システム\" class=\"fragment\"></span><a href=\"#1-%E3%83%97%E3%83%AD%E3%83%B3%E3%83%97%E3%83%88%E7%AE%A1%E7%90%86%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0\"><i class=\"fa fa-link\"></i></a>1. プロンプト管理システム</h3>\n<p data-sourcepos=\"162:1-162:83\">プロンプトをMarkdownファイルとして管理し、変数置換に対応：</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"164:1-176:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># data/prompts/article_generation_prompt.md\n</span><span class=\"n\">トピック</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"n\">topic</span><span class=\"p\">}</span>\n<span class=\"n\">リサーチ結果</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"n\">research_results</span><span class=\"p\">}</span>\n<span class=\"n\">過去の投稿</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"n\">past_articles_summary</span><span class=\"p\">}</span>\n\n<span class=\"c1\"># 使用例\n</span><span class=\"n\">prompt</span> <span class=\"o\">=</span> <span class=\"n\">template</span><span class=\"p\">.</span><span class=\"nf\">format</span><span class=\"p\">(</span>\n    <span class=\"n\">topic</span><span class=\"o\">=</span><span class=\"n\">selected_topic</span><span class=\"p\">,</span>\n    <span class=\"n\">research_results</span><span class=\"o\">=</span><span class=\"n\">research_results</span><span class=\"p\">,</span>\n    <span class=\"n\">past_articles_summary</span><span class=\"o\">=</span><span class=\"n\">past_articles_summary</span>\n<span class=\"p\">)</span>\n</code></pre></div></div>\n<p data-sourcepos=\"178:1-178:18\"><strong>メリット</strong>:</p>\n<ul data-sourcepos=\"179:1-182:0\">\n<li data-sourcepos=\"179:1-179:35\">プロンプトの変更が容易</li>\n<li data-sourcepos=\"180:1-180:38\">バージョン管理がしやすい</li>\n<li data-sourcepos=\"181:1-182:0\">複数のプロンプトを管理できる</li>\n</ul>\n<h3 data-sourcepos=\"183:1-183:34\">\n<span id=\"2-過去の投稿参照機能\" class=\"fragment\"></span><a href=\"#2-%E9%81%8E%E5%8E%BB%E3%81%AE%E6%8A%95%E7%A8%BF%E5%8F%82%E7%85%A7%E6%A9%9F%E8%83%BD\"><i class=\"fa fa-link\"></i></a>2. 過去の投稿参照機能</h3>\n<p data-sourcepos=\"185:1-185:80\">過去のQiita投稿を取得し、ストーリー性のある記事を生成：</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"187:1-194:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># 過去の投稿を取得\n</span><span class=\"n\">fetcher</span> <span class=\"o\">=</span> <span class=\"nc\">QiitaFetcher</span><span class=\"p\">()</span>\n<span class=\"n\">items</span> <span class=\"o\">=</span> <span class=\"n\">fetcher</span><span class=\"p\">.</span><span class=\"nf\">fetch_all_my_items</span><span class=\"p\">(</span><span class=\"n\">days_back</span><span class=\"o\">=</span><span class=\"mi\">180</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># 記事生成時に参照\n</span><span class=\"n\">past_articles_summary</span> <span class=\"o\">=</span> <span class=\"n\">qiita_items_manager</span><span class=\"p\">.</span><span class=\"nf\">get_items_summary</span><span class=\"p\">(</span><span class=\"n\">limit</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n</code></pre></div></div>\n<p data-sourcepos=\"196:1-196:18\"><strong>メリット</strong>:</p>\n<ul data-sourcepos=\"197:1-200:0\">\n<li data-sourcepos=\"197:1-197:56\">連続性のある記事シリーズを構築できる</li>\n<li data-sourcepos=\"198:1-198:62\">読者が「次も読みたい」と思える内容になる</li>\n<li data-sourcepos=\"199:1-200:0\">過去の投稿への参照リンクを自動生成</li>\n</ul>\n<h3 data-sourcepos=\"201:1-201:25\">\n<span id=\"3-動的タグ生成\" class=\"fragment\"></span><a href=\"#3-%E5%8B%95%E7%9A%84%E3%82%BF%E3%82%B0%E7%94%9F%E6%88%90\"><i class=\"fa fa-link\"></i></a>3. 動的タグ生成</h3>\n<p data-sourcepos=\"203:1-203:60\">記事内容に応じてLLMが自動的にタグを生成：</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"205:1-210:3\"><div class=\"highlight\"><pre><code><span class=\"k\">def</span> <span class=\"nf\">generate_dynamic_tags</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">content</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">List</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">]:</span>\n    <span class=\"c1\"># 記事のタイトルと内容を分析してタグを生成\n</span>    <span class=\"c1\"># 言語・ツール系、目的・行為ベース、プラットフォーム系など\n</span>    <span class=\"c1\"># カテゴリから適切なタグを選ぶ\n</span></code></pre></div></div>\n<p data-sourcepos=\"212:1-212:18\"><strong>メリット</strong>:</p>\n<ul data-sourcepos=\"213:1-216:0\">\n<li data-sourcepos=\"213:1-213:56\">記事内容に最適なタグが自動生成される</li>\n<li data-sourcepos=\"214:1-214:35\">手動でのタグ付けが不要</li>\n<li data-sourcepos=\"215:1-216:0\">タグの漏れを防げる</li>\n</ul>\n<h3 data-sourcepos=\"217:1-217:55\">\n<span id=\"4-モジュール化とエラーハンドリング\" class=\"fragment\"></span><a href=\"#4-%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E5%8C%96%E3%81%A8%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0\"><i class=\"fa fa-link\"></i></a>4. モジュール化とエラーハンドリング</h3>\n<p data-sourcepos=\"219:1-219:93\">各機能を独立したモジュールに分割し、エラーハンドリングを強化：</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"221:1-227:3\"><div class=\"highlight\"><pre><code><span class=\"c1\"># 各モジュールが独立して動作\n</span><span class=\"o\">-</span> <span class=\"n\">research</span><span class=\"o\">/</span><span class=\"n\">collector</span><span class=\"p\">.</span><span class=\"n\">py</span>      <span class=\"c1\"># リサーチ機能\n</span><span class=\"o\">-</span> <span class=\"n\">generator</span><span class=\"o\">/</span><span class=\"n\">article_generator</span><span class=\"p\">.</span><span class=\"n\">py</span>  <span class=\"c1\"># 記事生成\n</span><span class=\"o\">-</span> <span class=\"n\">publisher</span><span class=\"o\">/</span><span class=\"n\">qiita_publisher</span><span class=\"p\">.</span><span class=\"n\">py</span>    <span class=\"c1\"># 投稿機能\n</span><span class=\"o\">-</span> <span class=\"n\">storage</span><span class=\"o\">/</span><span class=\"n\">article_manager</span><span class=\"p\">.</span><span class=\"n\">py</span>      <span class=\"c1\"># 記事管理\n</span></code></pre></div></div>\n<p data-sourcepos=\"229:1-229:18\"><strong>メリット</strong>:</p>\n<ul data-sourcepos=\"230:1-233:0\">\n<li data-sourcepos=\"230:1-230:20\">テストが容易</li>\n<li data-sourcepos=\"231:1-231:35\">機能の追加・変更が容易</li>\n<li data-sourcepos=\"232:1-233:0\">エラーの影響範囲を限定できる</li>\n</ul>\n<h2 data-sourcepos=\"234:1-234:15\">\n<span id=\"参考文献\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"><i class=\"fa fa-link\"></i></a>参考文献</h2>\n<ul data-sourcepos=\"236:1-250:0\">\n<li data-sourcepos=\"236:1-238:0\">\n<p data-sourcepos=\"236:3-236:66\"><a href=\"https://qiita.com/api/v2/docs\">Qiita API v2 ドキュメント</a></p>\n<ul data-sourcepos=\"237:3-238:0\">\n<li data-sourcepos=\"237:3-238:0\">タグの制限（最大5個）などの仕様を確認</li>\n</ul>\n</li>\n<li data-sourcepos=\"239:1-241:0\">\n<p data-sourcepos=\"239:3-239:68\"><a href=\"https://ai.google.dev/docs\" rel=\"nofollow noopener\" target=\"_blank\">Google Gemini API ドキュメント</a></p>\n<ul data-sourcepos=\"240:3-241:0\">\n<li data-sourcepos=\"240:3-241:0\">利用可能なモデル一覧とAPIの使い方</li>\n</ul>\n</li>\n<li data-sourcepos=\"242:1-244:0\">\n<p data-sourcepos=\"242:3-242:69\"><a href=\"https://requests.readthedocs.io/\" rel=\"nofollow noopener\" target=\"_blank\">Python requests ライブラリ</a></p>\n<ul data-sourcepos=\"243:3-244:0\">\n<li data-sourcepos=\"243:3-244:0\">HTTPリクエストのエラーハンドリング方法</li>\n</ul>\n</li>\n<li data-sourcepos=\"245:1-247:0\">\n<p data-sourcepos=\"245:3-245:80\"><a href=\"https://github.com/theskumar/python-dotenv\" rel=\"nofollow noopener\" target=\"_blank\">python-dotenv ドキュメント</a></p>\n<ul data-sourcepos=\"246:3-247:0\">\n<li data-sourcepos=\"246:3-247:0\">環境変数の管理方法</li>\n</ul>\n</li>\n<li data-sourcepos=\"248:1-250:0\">\n<p data-sourcepos=\"248:3-248:105\"><a href=\"https://qiita.com/iimuz/items/4837e9c8043ce7c1262b\" id=\"reference-999283c181ac8b919d7c\">Qiita API を利用した記事投稿の実装例</a></p>\n<ul data-sourcepos=\"249:3-250:0\">\n<li data-sourcepos=\"249:3-250:0\">アクセストークンの取得方法と投稿の実装</li>\n</ul>\n</li>\n</ul>\n<h2 data-sourcepos=\"251:1-251:12\">\n<span id=\"まとめ\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>まとめ</h2>\n<p data-sourcepos=\"253:1-253:63\">今回の開発を通じて、以下の点を学びました：</p>\n<ol data-sourcepos=\"255:1-260:0\">\n<li data-sourcepos=\"255:1-255:114\">\n<strong>APIの仕様を事前に確認する重要性</strong>: タグ数の制限など、APIの制約を理解しておく</li>\n<li data-sourcepos=\"256:1-256:114\">\n<strong>エラーハンドリングの重要性</strong>: デバッグ情報を充実させ、原因特定を容易にする</li>\n<li data-sourcepos=\"257:1-257:87\">\n<strong>プロンプト設計の重要性</strong>: LLMへの指示は明確で具体的にする</li>\n<li data-sourcepos=\"258:1-258:85\">\n<strong>クロスプラットフォーム対応</strong>: Unicode文字の使用に注意する</li>\n<li data-sourcepos=\"259:1-260:0\">\n<strong>モジュール化の重要性</strong>: 機能を分割し、テストとメンテナンスを容易にする</li>\n</ol>\n<p data-sourcepos=\"261:1-261:108\">これらの経験を活かして、より堅牢なシステムを構築していきたいと思います。</p>\n<h2 data-sourcepos=\"265:1-265:50\">\n<span id=\"-導入背景課題なぜ重要か\" class=\"fragment\"></span><a href=\"#-%E5%B0%8E%E5%85%A5%E8%83%8C%E6%99%AF%E8%AA%B2%E9%A1%8C%E3%81%AA%E3%81%9C%E9%87%8D%E8%A6%81%E3%81%8B\"><i class=\"fa fa-link\"></i></a>🧭 導入：背景・課題・なぜ重要か</h2>\n<p data-sourcepos=\"267:1-267:45\">「記事書くの、めんどくさい…」</p>\n<p data-sourcepos=\"269:1-269:295\">エンジニアなら誰しも一度は思ったことがあるのではないでしょうか？特に Qiita のような技術情報共有プラットフォームでは、継続的なアウトプットが重要だと分かっていても、ついつい後回しにしてしまいがちです。</p>\n<p data-sourcepos=\"271:1-271:369\">以前の記事「<a href=\"https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957\">Python × GitHub Actions で始める！Qiita 自動投稿パイプライン構築術</a>」では、Qiita への記事投稿を自動化する基本的なパイプラインを構築しました。しかし、実際に運用してみると、いくつかの課題が見えてきました。</p>\n<ul data-sourcepos=\"273:1-276:0\">\n<li data-sourcepos=\"273:1-273:152\">\n<strong>ローカル環境との差異</strong>: ローカルで動いていたスクリプトが GitHub Actions 上で動かない…あるあるですよね。</li>\n<li data-sourcepos=\"274:1-274:148\">\n<strong>エラーハンドリングの甘さ</strong>: エラーが発生した場合に、どこが原因なのか特定しにくい…デバッグ地獄！</li>\n<li data-sourcepos=\"275:1-276:0\">\n<strong>API レート制限</strong>: Qiita API のレート制限に引っかかって投稿が失敗する…焦る！</li>\n</ul>\n<p data-sourcepos=\"277:1-277:340\">これらの課題を解決し、より安定した自動投稿パイプラインを構築するために、試行錯誤した過程を共有したいと思います。今回の記事では、これらの <strong>“あるある” な課題</strong> に焦点を当て、具体的な解決策と、さらに効率的な運用方法を紹介します。</p>\n<h2 data-sourcepos=\"279:1-279:65\">\n<span id=\"-トピックの概要専門外にも分かる説明\" class=\"fragment\"></span><a href=\"#-%E3%83%88%E3%83%94%E3%83%83%E3%82%AF%E3%81%AE%E6%A6%82%E8%A6%81%E5%B0%82%E9%96%80%E5%A4%96%E3%81%AB%E3%82%82%E5%88%86%E3%81%8B%E3%82%8B%E8%AA%AC%E6%98%8E\"><i class=\"fa fa-link\"></i></a>📘 トピックの概要（専門外にも分かる説明）</h2>\n<p data-sourcepos=\"281:1-281:89\">今回のテーマは、<strong>Qiita 記事の自動投稿パイプライン構築</strong> です。</p>\n<p data-sourcepos=\"283:1-283:164\"><strong>パイプライン</strong> とは、一連の処理を自動的に実行する仕組みのことです。今回の場合は、以下のような流れになります。</p>\n<ol data-sourcepos=\"285:1-288:0\">\n<li data-sourcepos=\"285:1-285:69\">記事の Markdown ファイルを GitHub リポジトリに push</li>\n<li data-sourcepos=\"286:1-286:79\">GitHub Actions が push を検知して自動的にスクリプトを実行</li>\n<li data-sourcepos=\"287:1-288:0\">スクリプトが Qiita API を利用して記事を投稿</li>\n</ol>\n<p data-sourcepos=\"289:1-289:153\">このパイプラインを構築することで、記事を書いたら GitHub に push するだけで Qiita に投稿されるようになります。</p>\n<p data-sourcepos=\"291:1-291:81\">今回の記事では、特に以下の点に焦点を当てて解説します。</p>\n<ul data-sourcepos=\"293:1-296:0\">\n<li data-sourcepos=\"293:1-293:102\">\n<strong>環境構築</strong>: GitHub Actions 上で Python スクリプトを実行するための環境構築</li>\n<li data-sourcepos=\"294:1-294:121\">\n<strong>エラーハンドリング</strong>: エラーが発生した場合に、原因を特定しやすくするための工夫</li>\n<li data-sourcepos=\"295:1-296:0\">\n<strong>レート制限対策</strong>: Qiita API のレート制限に引っかからないようにするための対策</li>\n</ul>\n<h2 data-sourcepos=\"297:1-297:62\">\n<span id=\"-技術的な仕組み実装アーキテクチャ\" class=\"fragment\"></span><a href=\"#-%E6%8A%80%E8%A1%93%E7%9A%84%E3%81%AA%E4%BB%95%E7%B5%84%E3%81%BF%E5%AE%9F%E8%A3%85%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3\"><i class=\"fa fa-link\"></i></a>🔧 技術的な仕組み・実装・アーキテクチャ</h2>\n<p data-sourcepos=\"299:1-299:84\">今回のパイプラインは、主に以下の要素で構成されています。</p>\n<ol data-sourcepos=\"301:1-304:0\">\n<li data-sourcepos=\"301:1-301:93\">\n<strong>Python スクリプト</strong>: Qiita API を利用して記事を投稿するスクリプト</li>\n<li data-sourcepos=\"302:1-302:109\">\n<strong>GitHub Actions</strong>: GitHub の CI/CD サービス。push をトリガーにしてスクリプトを実行</li>\n<li data-sourcepos=\"303:1-304:0\">\n<strong>Qiita API</strong>: Qiita の記事投稿 API</li>\n</ol>\n<p data-sourcepos=\"305:1-305:151\"><strong>Python スクリプト</strong> は、Markdown ファイルを読み込み、Qiita API に必要な情報を整形してリクエストを送信します。</p>\n<p data-sourcepos=\"307:1-307:287\"><strong>GitHub Actions</strong> は、<code>.github/workflows</code> ディレクトリに YAML ファイルを配置することで、様々なイベントをトリガーにして処理を実行できます。今回は、<code>push</code> イベントをトリガーにして、Python スクリプトを実行します。</p>\n<p data-sourcepos=\"309:1-309:207\"><strong>Qiita API</strong> は、記事の投稿、更新、削除などを行うための API です。API を利用するためには、事前に Qiita でアクセストークンを取得する必要があります。</p>\n<h3 data-sourcepos=\"311:1-311:34\">\n<span id=\"メリットデメリット\" class=\"fragment\"></span><a href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"><i class=\"fa fa-link\"></i></a>メリット・デメリット</h3>\n<p data-sourcepos=\"313:1-313:17\"><strong>メリット</strong>:</p>\n<ul data-sourcepos=\"315:1-318:0\">\n<li data-sourcepos=\"315:1-315:52\">記事投稿の手間を大幅に削減できる</li>\n<li data-sourcepos=\"316:1-316:52\">継続的なアウトプットを促進できる</li>\n<li data-sourcepos=\"317:1-318:0\">チームでの記事作成を効率化できる</li>\n</ul>\n<p data-sourcepos=\"319:1-319:20\"><strong>デメリット</strong>:</p>\n<ul data-sourcepos=\"321:1-324:0\">\n<li data-sourcepos=\"321:1-321:37\">初期構築に手間がかかる</li>\n<li data-sourcepos=\"322:1-322:56\">API のレート制限に注意する必要がある</li>\n<li data-sourcepos=\"323:1-324:0\">スクリプトのメンテナンスが必要</li>\n</ul>\n<h3 data-sourcepos=\"325:1-325:37\">\n<span id=\"ハマりポイント注意点\" class=\"fragment\"></span><a href=\"#%E3%83%8F%E3%83%9E%E3%82%8A%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E6%B3%A8%E6%84%8F%E7%82%B9\"><i class=\"fa fa-link\"></i></a>ハマりポイント・注意点</h3>\n<ul data-sourcepos=\"327:1-330:0\">\n<li data-sourcepos=\"327:1-327:85\">\n<strong>環境変数</strong>: GitHub Actions 上で環境変数を設定する必要がある</li>\n<li data-sourcepos=\"328:1-328:107\">\n<strong>依存関係</strong>: 必要な Python ライブラリを <code>requirements.txt</code> に記述する必要がある</li>\n<li data-sourcepos=\"329:1-330:0\">\n<strong>エラーハンドリング</strong>: エラーが発生した場合に、原因を特定できるようにログを出力するようにする</li>\n</ul>\n<h2 data-sourcepos=\"331:1-331:53\">\n<span id=\"-実践編動くコードコマンド例\" class=\"fragment\"></span><a href=\"#-%E5%AE%9F%E8%B7%B5%E7%B7%A8%E5%8B%95%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>🧪 実践編：動くコード／コマンド例</h2>\n<h3 data-sourcepos=\"333:1-333:19\">\n<span id=\"1-環境構築\" class=\"fragment\"></span><a href=\"#1-%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\"><i class=\"fa fa-link\"></i></a>1. 環境構築</h3>\n<p data-sourcepos=\"335:1-335:74\">まず、必要な Python ライブラリをインストールします。</p>\n<div class=\"code-frame\" data-lang=\"bash\" data-sourcepos=\"337:1-340:3\"><div class=\"highlight\"><pre><code><span class=\"c\"># 必要なライブラリをインストール</span>\npip <span class=\"nb\">install </span>requests python-dotenv\n</code></pre></div></div>\n<p data-sourcepos=\"342:1-342:133\">次に、GitHub リポジトリに <code>.github/workflows/qiita_post.yml</code> ファイルを作成し、以下の内容を記述します。</p>\n<div class=\"code-frame\" data-lang=\"yaml\" data-sourcepos=\"344:1-369:3\"><div class=\"highlight\"><pre><code><span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Qiita Post</span>\n\n<span class=\"na\">on</span><span class=\"pi\">:</span>\n  <span class=\"na\">push</span><span class=\"pi\">:</span>\n    <span class=\"na\">branches</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"s\">main</span>\n\n<span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">qiita_post</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-latest</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/checkout@v3</span>\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Set up Python </span><span class=\"m\">3.11</span>\n        <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/setup-python@v3</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">python-version</span><span class=\"pi\">:</span> <span class=\"s2\">\"</span><span class=\"s\">3.11\"</span>\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Install dependencies</span>\n        <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n          <span class=\"s\">python -m pip install --upgrade pip</span>\n          <span class=\"s\">pip install -r requirements.txt</span>\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Run Qiita Post Script</span>\n        <span class=\"na\">env</span><span class=\"pi\">:</span>\n          <span class=\"na\">QIITA_ACCESS_TOKEN</span><span class=\"pi\">:</span> <span class=\"s\">${{ secrets.QIITA_ACCESS_TOKEN }}</span>\n        <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">python qiita_post.py</span>\n</code></pre></div></div>\n<p data-sourcepos=\"371:1-371:100\"><code>QIITA_ACCESS_TOKEN</code> は、GitHub リポジトリの Secrets に登録する必要があります。</p>\n<h3 data-sourcepos=\"373:1-373:29\">\n<span id=\"2-python-スクリプト\" class=\"fragment\"></span><a href=\"#2-python-%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88\"><i class=\"fa fa-link\"></i></a>2. Python スクリプト</h3>\n<p data-sourcepos=\"375:1-375:88\">次に、<code>qiita_post.py</code> ファイルを作成し、以下の内容を記述します。</p>\n<div class=\"code-frame\" data-lang=\"python\" data-sourcepos=\"377:1-434:134\"><div class=\"highlight\"><pre><code><span class=\"kn\">import</span> <span class=\"n\">os</span>\n<span class=\"kn\">import</span> <span class=\"n\">requests</span>\n<span class=\"kn\">from</span> <span class=\"n\">dotenv</span> <span class=\"kn\">import</span> <span class=\"n\">load_dotenv</span>\n\n<span class=\"nf\">load_dotenv</span><span class=\"p\">()</span>\n\n<span class=\"n\">QIITA_ACCESS_TOKEN</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">environ</span><span class=\"p\">.</span><span class=\"nf\">get</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\">QIITA_ACCESS_TOKEN</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n<span class=\"n\">QIITA_API_ENDPOINT</span> <span class=\"o\">=</span> <span class=\"sh\">\"</span><span class=\"s\">https://qiita.com/api/v2/items</span><span class=\"sh\">\"</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">post_to_qiita</span><span class=\"p\">(</span><span class=\"n\">markdown_file_path</span><span class=\"p\">):</span>\n    <span class=\"sh\">\"\"\"</span><span class=\"s\">Qiita に記事を投稿する関数</span><span class=\"sh\">\"\"\"</span>\n    <span class=\"k\">try</span><span class=\"p\">:</span>\n        <span class=\"k\">with</span> <span class=\"nf\">open</span><span class=\"p\">(</span><span class=\"n\">markdown_file_path</span><span class=\"p\">,</span> <span class=\"sh\">\"</span><span class=\"s\">r</span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"sh\">\"</span><span class=\"s\">utf-8</span><span class=\"sh\">\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n            <span class=\"n\">markdown_content</span> <span class=\"o\">=</span> <span class=\"n\">f</span><span class=\"p\">.</span><span class=\"nf\">read</span><span class=\"p\">()</span>\n\n        <span class=\"c1\"># タイトルを抽出 (最初の行が # で始まる場合)\n</span>        <span class=\"n\">lines</span> <span class=\"o\">=</span> <span class=\"n\">markdown_content</span><span class=\"p\">.</span><span class=\"nf\">splitlines</span><span class=\"p\">()</span>\n        <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"n\">lines</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">].</span><span class=\"nf\">replace</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\"># </span><span class=\"sh\">\"</span><span class=\"p\">,</span> <span class=\"sh\">\"\"</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">lines</span> <span class=\"ow\">and</span> <span class=\"n\">lines</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">].</span><span class=\"nf\">startswith</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\"># </span><span class=\"sh\">\"</span><span class=\"p\">)</span> <span class=\"k\">else</span> <span class=\"sh\">\"</span><span class=\"s\">No Title</span><span class=\"sh\">\"</span>\n\n        <span class=\"c1\"># Markdown ファイルから必要な情報を抽出\n</span>        <span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"n\">markdown_content</span>\n        <span class=\"n\">tags</span> <span class=\"o\">=</span> <span class=\"nf\">extract_tags</span><span class=\"p\">(</span><span class=\"n\">markdown_content</span><span class=\"p\">)</span> <span class=\"c1\"># タグを抽出する関数は別途定義\n</span>\n        <span class=\"c1\"># Qiita API に投稿\n</span>        <span class=\"n\">headers</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"sh\">\"</span><span class=\"s\">Authorization</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">Bearer </span><span class=\"si\">{</span><span class=\"n\">QIITA_ACCESS_TOKEN</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">,</span>\n            <span class=\"sh\">\"</span><span class=\"s\">Content-Type</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"sh\">\"</span><span class=\"s\">application/json</span><span class=\"sh\">\"</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n        <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"sh\">\"</span><span class=\"s\">title</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">title</span><span class=\"p\">,</span>\n            <span class=\"sh\">\"</span><span class=\"s\">body</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">body</span><span class=\"p\">,</span>\n            <span class=\"sh\">\"</span><span class=\"s\">tags</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"sh\">\"</span><span class=\"s\">name</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"n\">tag</span><span class=\"p\">}</span> <span class=\"k\">for</span> <span class=\"n\">tag</span> <span class=\"ow\">in</span> <span class=\"n\">tags</span><span class=\"p\">],</span>\n            <span class=\"sh\">\"</span><span class=\"s\">private</span><span class=\"sh\">\"</span><span class=\"p\">:</span> <span class=\"bp\">False</span><span class=\"p\">,</span>  <span class=\"c1\"># 公開設定\n</span>        <span class=\"p\">}</span>\n        <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"n\">requests</span><span class=\"p\">.</span><span class=\"nf\">post</span><span class=\"p\">(</span><span class=\"n\">QIITA_API_ENDPOINT</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"o\">=</span><span class=\"n\">headers</span><span class=\"p\">,</span> <span class=\"n\">json</span><span class=\"o\">=</span><span class=\"n\">data</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># レスポンスを確認\n</span>        <span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">raise_for_status</span><span class=\"p\">()</span>  <span class=\"c1\"># エラーがあれば例外を発生\n</span>        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sh\">\"</span><span class=\"s\">記事の投稿に成功しました！</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">投稿URL: </span><span class=\"si\">{</span><span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">json</span><span class=\"p\">()[</span><span class=\"sh\">'</span><span class=\"s\">url</span><span class=\"sh\">'</span><span class=\"p\">]</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n\n    <span class=\"k\">except</span> <span class=\"n\">requests</span><span class=\"p\">.</span><span class=\"n\">exceptions</span><span class=\"p\">.</span><span class=\"n\">RequestException</span> <span class=\"k\">as</span> <span class=\"n\">e</span><span class=\"p\">:</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">APIリクエストエラー: </span><span class=\"si\">{</span><span class=\"n\">e</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n    <span class=\"k\">except</span> <span class=\"nb\">FileNotFoundError</span><span class=\"p\">:</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">ファイルが見つかりません: </span><span class=\"si\">{</span><span class=\"n\">markdown_file_path</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n    <span class=\"k\">except</span> <span class=\"nb\">Exception</span> <span class=\"k\">as</span> <span class=\"n\">e</span><span class=\"p\">:</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"sh\">\"</span><span class=\"s\">予期せぬエラーが発生しました: </span><span class=\"si\">{</span><span class=\"n\">e</span><span class=\"si\">}</span><span class=\"sh\">\"</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">extract_tags</span><span class=\"p\">(</span><span class=\"n\">markdown_content</span><span class=\"p\">):</span>\n    <span class=\"sh\">\"\"\"</span><span class=\"s\">Markdown ファイルからタグを抽出する関数（例）</span><span class=\"sh\">\"\"\"</span>\n    <span class=\"c1\"># 簡単な例として、ファイル名からタグを生成\n</span>    <span class=\"c1\"># 実際には、Markdown の内容を解析してタグを抽出する処理を実装する\n</span>    <span class=\"k\">return</span> <span class=\"p\">[</span><span class=\"sh\">\"</span><span class=\"s\">\n\n生成日時: 2025-12-05 17:07:33\nステータス: draft\nタグ: Qiita, 環境構築, Python, エンジニア向け, GitHubActions, スクリプト, CI/CD, Tips, 自動化, パイプライン\n</span></code></pre></div></div>\n",
      "body": "> **対象読者**  \n> Python を利用したことがあるエンジニア、GitHub Actions を利用したことがあるエンジニア、Qiita への投稿を効率化したい方\n\n> **動作確認環境 / 前提条件**  \n> - macOS Ventura 13.6.3\n> - Python 3.11.5\n> - GitHub アカウント\n> - Qiita API v2 の理解（[公式ドキュメント](https://qiita.com/api/v2/docs)参照）\n> - 以前の記事「[Python × GitHub Actions で始める！Qiita 自動投稿パイプライン構築術](https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957)」の内容を理解していること\n\n> **この記事で得られること**\n> - Qiita 記事投稿を自動化する Python スクリプトの構築方法\n> - GitHub Actions を利用した CI/CD パイプラインの構築方法\n> - 自動化パイプライン構築におけるハマりどころと、その解決策\n\n\n## 実際に躓いたポイントと解決策\n\n### 1. Gemini APIのモデル名エラー\n\n**問題**: \n```\n404 models/gemini-1.5-flash is not found for API version v1beta\n```\n\n**原因**: \n- 設定ファイルで`gemini-1.5-flash`を指定していたが、実際に利用可能なモデルは`models/gemini-2.0-flash`だった\n- Google Gemini APIは定期的にモデル名が更新される\n\n**解決策**:\n```python\n# 利用可能なモデルを確認\nmodels = [m for m in genai.list_models() \n          if 'generateContent' in m.supported_generation_methods]\n# 結果: models/gemini-2.0-flash, models/gemini-2.5-flash など\n\n# 設定ファイルを更新\n{\n  \"api\": {\n    \"gemini\": {\n      \"model\": \"models/gemini-2.0-flash\"  # models/プレフィックスが必要\n    }\n  }\n}\n```\n\n**学んだこと**: APIの仕様変更に備えて、利用可能なモデルを動的に確認する仕組みを追加すべき\n\n### 2. WindowsコンソールのUnicode文字表示エラー\n\n**問題**:\n```\nUnicodeEncodeError: 'cp932' codec can't encode character '✓' in position 0\n```\n\n**原因**: \n- WindowsのPowerShellでは、Unicode文字（✓、⚠、✗）がデフォルトのエンコーディング（cp932）で表示できない\n\n**解決策**:\n```python\n# Unicode文字を通常の文字に置き換え\nprint(f\"[OK] 処理が完了しました\")  # ✓ → [OK]\nprint(f\"[WARN] 警告メッセージ\")    # ⚠ → [WARN]\nprint(f\"[ERROR] エラーが発生\")     # ✗ → [ERROR]\n```\n\n**学んだこと**: クロスプラットフォーム対応では、Unicode文字の使用を避けるか、エンコーディングを明示的に設定する\n\n### 3. Qiita APIのタグ数制限による403エラー\n\n**問題**:\n```\nHTTPエラー: 403 - {'message': 'Forbidden', 'type': 'forbidden'}\n```\n\n**原因**: \n- 動的タグ生成で9個のタグを生成していたが、Qiita APIはタグを最大5個までしか受け付けない\n- APIドキュメントを確認せずに実装していた\n\n**解決策**:\n```python\n# タグを5個に制限\nif len(tags) > 5:\n    print(f\"[WARN] タグが{len(tags)}個ありますが、Qiita APIの制限により5個に制限します\")\nqiita_tags = [{\"name\": tag} for tag in tags[:5]]\n```\n\n**学んだこと**: \n- APIの仕様を事前に確認する重要性\n- エラーメッセージが不十分な場合、リクエスト内容を詳細にログ出力して原因を特定する\n\n### 4. LLMプロンプトの設計ミス\n\n**問題**: \n- タイトル案を3つ生成していたが、実際のタイトルが「使用例」になってしまった\n- パース処理でタイトルが正しく抽出できなかった\n\n**原因**:\n- プロンプトで「タイトル案（3つ）」を指示していたが、実際のタイトルを明確に指定していなかった\n- パース処理がタイトル案セクションをスキップできていなかった\n\n**解決策**:\n```markdown\n# プロンプトの修正\n**重要**: 記事の最初の行に、実際に使用するタイトルを`# `で始まるMarkdownの見出し形式で記述してください。\n\nタイトル案は不要です。最初の`# `行がそのまま記事のタイトルとして使用されます。\n```\n\n```python\n# パース処理の改善\nskip_title_section = False\nfor line in lines:\n    # タイトル案セクションを検出してスキップ\n    if \"タイトル案\" in line:\n        skip_title_section = True\n        continue\n    \n    # 最初の`# `で始まる行をタイトルとして取得\n    if not found_main_title and line.startswith(\"# \"):\n        title = line.replace(\"# \", \"\").strip()\n        found_main_title = True\n```\n\n**学んだこと**: \n- LLMへのプロンプトは明確で具体的な指示が必要\n- 出力形式を厳密に指定することで、パース処理を簡潔にできる\n\n### 5. エラーハンドリングの不足\n\n**問題**: \n- 403エラーが発生した際、原因が特定しづらかった\n- デバッグ情報が不足していた\n\n**解決策**:\n```python\n# デバッグ情報の追加\nprint(f\"[DEBUG] アクセストークン: {token_preview}\")\nprint(f\"[DEBUG] リクエストURL: {self.base_url}/items\")\nprint(f\"[DEBUG] ペイロード: title={title[:50]}, tags={len(tags)}個\")\nprint(f\"[DEBUG] レスポンスステータス: {response.status_code}\")\n\n# エラーメッセージの改善\nif e.response.status_code == 403:\n    error_msg += \"\n\n考えられる原因:\"\n    error_msg += \"\n- アクセストークンのスコープが不足しています\"\n    error_msg += \"\n- タグ数が5個を超えています（Qiita APIの制限）\"\n```\n\n**学んだこと**: \n- エラー発生時には、リクエスト内容とレスポンスを詳細にログ出力する\n- よくあるエラーについては、解決策を提示する\n\n## 工夫したポイント\n\n### 1. プロンプト管理システム\n\nプロンプトをMarkdownファイルとして管理し、変数置換に対応：\n\n```python\n# data/prompts/article_generation_prompt.md\nトピック: {topic}\nリサーチ結果: {research_results}\n過去の投稿: {past_articles_summary}\n\n# 使用例\nprompt = template.format(\n    topic=selected_topic,\n    research_results=research_results,\n    past_articles_summary=past_articles_summary\n)\n```\n\n**メリット**: \n- プロンプトの変更が容易\n- バージョン管理がしやすい\n- 複数のプロンプトを管理できる\n\n### 2. 過去の投稿参照機能\n\n過去のQiita投稿を取得し、ストーリー性のある記事を生成：\n\n```python\n# 過去の投稿を取得\nfetcher = QiitaFetcher()\nitems = fetcher.fetch_all_my_items(days_back=180)\n\n# 記事生成時に参照\npast_articles_summary = qiita_items_manager.get_items_summary(limit=10)\n```\n\n**メリット**: \n- 連続性のある記事シリーズを構築できる\n- 読者が「次も読みたい」と思える内容になる\n- 過去の投稿への参照リンクを自動生成\n\n### 3. 動的タグ生成\n\n記事内容に応じてLLMが自動的にタグを生成：\n\n```python\ndef generate_dynamic_tags(title: str, content: str) -> List[str]:\n    # 記事のタイトルと内容を分析してタグを生成\n    # 言語・ツール系、目的・行為ベース、プラットフォーム系など\n    # カテゴリから適切なタグを選ぶ\n```\n\n**メリット**: \n- 記事内容に最適なタグが自動生成される\n- 手動でのタグ付けが不要\n- タグの漏れを防げる\n\n### 4. モジュール化とエラーハンドリング\n\n各機能を独立したモジュールに分割し、エラーハンドリングを強化：\n\n```python\n# 各モジュールが独立して動作\n- research/collector.py      # リサーチ機能\n- generator/article_generator.py  # 記事生成\n- publisher/qiita_publisher.py    # 投稿機能\n- storage/article_manager.py      # 記事管理\n```\n\n**メリット**: \n- テストが容易\n- 機能の追加・変更が容易\n- エラーの影響範囲を限定できる\n\n## 参考文献\n\n- [Qiita API v2 ドキュメント](https://qiita.com/api/v2/docs)\n  - タグの制限（最大5個）などの仕様を確認\n\n- [Google Gemini API ドキュメント](https://ai.google.dev/docs)\n  - 利用可能なモデル一覧とAPIの使い方\n\n- [Python requests ライブラリ](https://requests.readthedocs.io/)\n  - HTTPリクエストのエラーハンドリング方法\n\n- [python-dotenv ドキュメント](https://github.com/theskumar/python-dotenv)\n  - 環境変数の管理方法\n\n- [Qiita API を利用した記事投稿の実装例](https://qiita.com/iimuz/items/4837e9c8043ce7c1262b)\n  - アクセストークンの取得方法と投稿の実装\n\n## まとめ\n\n今回の開発を通じて、以下の点を学びました：\n\n1. **APIの仕様を事前に確認する重要性**: タグ数の制限など、APIの制約を理解しておく\n2. **エラーハンドリングの重要性**: デバッグ情報を充実させ、原因特定を容易にする\n3. **プロンプト設計の重要性**: LLMへの指示は明確で具体的にする\n4. **クロスプラットフォーム対応**: Unicode文字の使用に注意する\n5. **モジュール化の重要性**: 機能を分割し、テストとメンテナンスを容易にする\n\nこれらの経験を活かして、より堅牢なシステムを構築していきたいと思います。\n\n\n\n## 🧭 導入：背景・課題・なぜ重要か\n\n「記事書くの、めんどくさい…」\n\nエンジニアなら誰しも一度は思ったことがあるのではないでしょうか？特に Qiita のような技術情報共有プラットフォームでは、継続的なアウトプットが重要だと分かっていても、ついつい後回しにしてしまいがちです。\n\n以前の記事「[Python × GitHub Actions で始める！Qiita 自動投稿パイプライン構築術](https://qiita.com/cocokara_bioinfo/items/7440c80d8e6a98177957)」では、Qiita への記事投稿を自動化する基本的なパイプラインを構築しました。しかし、実際に運用してみると、いくつかの課題が見えてきました。\n\n*   **ローカル環境との差異**: ローカルで動いていたスクリプトが GitHub Actions 上で動かない…あるあるですよね。\n*   **エラーハンドリングの甘さ**: エラーが発生した場合に、どこが原因なのか特定しにくい…デバッグ地獄！\n*   **API レート制限**: Qiita API のレート制限に引っかかって投稿が失敗する…焦る！\n\nこれらの課題を解決し、より安定した自動投稿パイプラインを構築するために、試行錯誤した過程を共有したいと思います。今回の記事では、これらの **“あるある” な課題** に焦点を当て、具体的な解決策と、さらに効率的な運用方法を紹介します。\n\n## 📘 トピックの概要（専門外にも分かる説明）\n\n今回のテーマは、**Qiita 記事の自動投稿パイプライン構築** です。\n\n**パイプライン** とは、一連の処理を自動的に実行する仕組みのことです。今回の場合は、以下のような流れになります。\n\n1.  記事の Markdown ファイルを GitHub リポジトリに push\n2.  GitHub Actions が push を検知して自動的にスクリプトを実行\n3.  スクリプトが Qiita API を利用して記事を投稿\n\nこのパイプラインを構築することで、記事を書いたら GitHub に push するだけで Qiita に投稿されるようになります。\n\n今回の記事では、特に以下の点に焦点を当てて解説します。\n\n*   **環境構築**: GitHub Actions 上で Python スクリプトを実行するための環境構築\n*   **エラーハンドリング**: エラーが発生した場合に、原因を特定しやすくするための工夫\n*   **レート制限対策**: Qiita API のレート制限に引っかからないようにするための対策\n\n## 🔧 技術的な仕組み・実装・アーキテクチャ\n\n今回のパイプラインは、主に以下の要素で構成されています。\n\n1.  **Python スクリプト**: Qiita API を利用して記事を投稿するスクリプト\n2.  **GitHub Actions**: GitHub の CI/CD サービス。push をトリガーにしてスクリプトを実行\n3.  **Qiita API**: Qiita の記事投稿 API\n\n**Python スクリプト** は、Markdown ファイルを読み込み、Qiita API に必要な情報を整形してリクエストを送信します。\n\n**GitHub Actions** は、`.github/workflows` ディレクトリに YAML ファイルを配置することで、様々なイベントをトリガーにして処理を実行できます。今回は、`push` イベントをトリガーにして、Python スクリプトを実行します。\n\n**Qiita API** は、記事の投稿、更新、削除などを行うための API です。API を利用するためには、事前に Qiita でアクセストークンを取得する必要があります。\n\n### メリット・デメリット\n\n**メリット**:\n\n*   記事投稿の手間を大幅に削減できる\n*   継続的なアウトプットを促進できる\n*   チームでの記事作成を効率化できる\n\n**デメリット**:\n\n*   初期構築に手間がかかる\n*   API のレート制限に注意する必要がある\n*   スクリプトのメンテナンスが必要\n\n### ハマりポイント・注意点\n\n*   **環境変数**: GitHub Actions 上で環境変数を設定する必要がある\n*   **依存関係**: 必要な Python ライブラリを `requirements.txt` に記述する必要がある\n*   **エラーハンドリング**: エラーが発生した場合に、原因を特定できるようにログを出力するようにする\n\n## 🧪 実践編：動くコード／コマンド例\n\n### 1. 環境構築\n\nまず、必要な Python ライブラリをインストールします。\n\n```bash\n# 必要なライブラリをインストール\npip install requests python-dotenv\n```\n\n次に、GitHub リポジトリに `.github/workflows/qiita_post.yml` ファイルを作成し、以下の内容を記述します。\n\n```yaml\nname: Qiita Post\n\non:\n  push:\n    branches:\n      - main\n\njobs:\n  qiita_post:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - name: Set up Python 3.11\n        uses: actions/setup-python@v3\n        with:\n          python-version: \"3.11\"\n      - name: Install dependencies\n        run: |\n          python -m pip install --upgrade pip\n          pip install -r requirements.txt\n      - name: Run Qiita Post Script\n        env:\n          QIITA_ACCESS_TOKEN: ${{ secrets.QIITA_ACCESS_TOKEN }}\n        run: python qiita_post.py\n```\n\n`QIITA_ACCESS_TOKEN` は、GitHub リポジトリの Secrets に登録する必要があります。\n\n### 2. Python スクリプト\n\n次に、`qiita_post.py` ファイルを作成し、以下の内容を記述します。\n\n```python\nimport os\nimport requests\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nQIITA_ACCESS_TOKEN = os.environ.get(\"QIITA_ACCESS_TOKEN\")\nQIITA_API_ENDPOINT = \"https://qiita.com/api/v2/items\"\n\ndef post_to_qiita(markdown_file_path):\n    \"\"\"Qiita に記事を投稿する関数\"\"\"\n    try:\n        with open(markdown_file_path, \"r\", encoding=\"utf-8\") as f:\n            markdown_content = f.read()\n\n        # タイトルを抽出 (最初の行が # で始まる場合)\n        lines = markdown_content.splitlines()\n        title = lines[0].replace(\"# \", \"\") if lines and lines[0].startswith(\"# \") else \"No Title\"\n\n        # Markdown ファイルから必要な情報を抽出\n        body = markdown_content\n        tags = extract_tags(markdown_content) # タグを抽出する関数は別途定義\n\n        # Qiita API に投稿\n        headers = {\n            \"Authorization\": f\"Bearer {QIITA_ACCESS_TOKEN}\",\n            \"Content-Type\": \"application/json\",\n        }\n        data = {\n            \"title\": title,\n            \"body\": body,\n            \"tags\": [{\"name\": tag} for tag in tags],\n            \"private\": False,  # 公開設定\n        }\n        response = requests.post(QIITA_API_ENDPOINT, headers=headers, json=data)\n\n        # レスポンスを確認\n        response.raise_for_status()  # エラーがあれば例外を発生\n        print(\"記事の投稿に成功しました！\")\n        print(f\"投稿URL: {response.json()['url']}\")\n\n    except requests.exceptions.RequestException as e:\n        print(f\"APIリクエストエラー: {e}\")\n    except FileNotFoundError:\n        print(f\"ファイルが見つかりません: {markdown_file_path}\")\n    except Exception as e:\n        print(f\"予期せぬエラーが発生しました: {e}\")\n\ndef extract_tags(markdown_content):\n    \"\"\"Markdown ファイルからタグを抽出する関数（例）\"\"\"\n    # 簡単な例として、ファイル名からタグを生成\n    # 実際には、Markdown の内容を解析してタグを抽出する処理を実装する\n    return [\"\n\n生成日時: 2025-12-05 17:07:33\nステータス: draft\nタグ: Qiita, 環境構築, Python, エンジニア向け, GitHubActions, スクリプト, CI/CD, Tips, 自動化, パイプライン\n",
      "coediting": false,
      "comments_count": 0,
      "created_at": "2025-12-05T17:09:48+09:00",
      "group": null,
      "id": "4bd415ef2f801497951e",
      "likes_count": 0,
      "private": false,
      "reactions_count": 0,
      "stocks_count": 0,
      "tags": [
        {
          "name": "Qiita",
          "versions": []
        },
        {
          "name": "Python",
          "versions": []
        },
        {
          "name": "環境構築",
          "versions": []
        },
        {
          "name": "エンジニア向け",
          "versions": []
        },
        {
          "name": "GitHubActions",
          "versions": []
        }
      ],
      "title": "【ハマりどころ満載】PythonでQiita記事投稿を自動化するパイプライン構築で爆速改善！",
      "updated_at": "2025-12-05T17:09:48+09:00",
      "url": "https://qiita.com/cocokara_bioinfo/items/4bd415ef2f801497951e",
      "user": {
        "description": "ポッケ村出身の名もなき若手生物学研究員です。\r\n現代の技術やエンジニア知識を学びながらモンスターハンターの生態・生物学研究に日々励んでおります！\r\nまだまだ勉強不足なところはありますが、皆さんに少しでも学びになるものをお届けできればとの思いで発信させていただきます\r\n\r\n※フィクションとして、時にTips記事として楽しんでいただければ幸いです",
        "facebook_id": "",
        "followees_count": 3,
        "followers_count": 0,
        "github_login_name": null,
        "id": "cocokara_bioinfo",
        "items_count": 4,
        "linkedin_id": "",
        "location": "",
        "name": "シャル・S 調査員",
        "organization": "Genome & Ecology Monster-Lab (架空)",
        "permanent_id": 4288059,
        "profile_image_url": "https://lh3.googleusercontent.com/a/ACg8ocLkgrrRuDzozKQ4XeInetzc0um1rPWRGXY2daT9pLIi1z1JdQ=s96-c",
        "team_only": false,
        "twitter_screen_name": null,
        "website_url": ""
      },
      "page_views_count": 128,
      "team_membership": null,
      "organization_url_name": null,
      "slide": false,
      "_source": "my_popular"
    }
  ]
}