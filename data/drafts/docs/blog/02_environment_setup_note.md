# 研究を始めるための準備：バイオインフォマティクス研究の舞台裏

## はじめに

前回は、リオス科の性的二形を解明するための研究仮説について紹介しました。今回は、その研究を実際に始めるための**環境構築**についてお話しします。

「環境構築って、面倒くさそう...」と思われるかもしれません。確かに、バイオインフォマティクス研究では、様々なツールをインストールし、適切に設定する必要があります。しかし、この環境構築こそが、研究の基盤となる重要なステップなのです。

この記事では、なぜ環境構築が重要なのか、そしてバイオインフォマティクス研究の舞台裏を覗いてみましょう。

---

## なぜ環境構築が重要なのか？

### バイオインフォマティクス研究の特殊性

一般的なプログラミングと違い、バイオインフォマティクス研究では、**様々なツールを使い分ける**必要があります。

例えば、この研究では：
- **R**：統計解析と可視化
- **HISAT2**：RNA-seqリードのアライメント
- **samtools**：アライメント結果の処理
- **DESeq2**：発現差の統計検定
- **polyester**：RNA-seqリードのシミュレーション

これらは、それぞれ異なるプログラミング言語で書かれており、異なるバージョンが必要な場合もあります。

👉 **RNA-seq解析の基礎を学ぶ**：[RNA-seq解析入門まとめ](https://hashiyuki.hatenablog.com/entry/2025/01/08/141941) - RNA-seqの基礎・手法・各ステップがまとまっています

### バージョン管理の重要性

さらに、バイオインフォマティクス研究では、**バージョン管理が極めて重要**です。

例えば、polyesterはR 4.3が必要ですが、他のツールは異なるバージョンが必要な場合があります。もし、すべてのツールを同じ環境にインストールしようとすると、バージョンの競合が発生し、ツールが正しく動作しなくなる可能性があります。

実際の研究では、**「この解析は1年前に実行したものだが、今は再現できない」**という問題がよく発生します。これは、ツールのバージョンが変わったためです。

### 環境構築が研究の基盤となる理由

環境構築は、単なる「準備作業」ではありません。**研究の再現性と信頼性を保証する基盤**なのです。

適切な環境構築により：
- **再現性**：同じ環境で同じ解析を実行すれば、同じ結果が得られる
- **信頼性**：ツールのバージョンを固定することで、予期しない動作を避けられる
- **効率性**：環境を分けることで、ツール同士の競合を避けられる

---

## condaという魔法のツール

### 環境管理の革命

このような問題を解決するために、私たちは**conda**というツールを使っています。

condaは、PythonやRのパッケージ、バイオインフォマティクスツールを管理する**環境管理システム**です。condaを使うことで、複数の環境を作成し、それぞれに異なるバージョンのツールをインストールできます。

👉 **condaの基礎を学ぶ**：[conda公式ドキュメント](https://docs.conda.io/projects/conda/en/latest/) - 環境作成・パッケージ管理の詳細

### 環境を分ける理由

この研究では、2つのconda環境を使用しています：

1. **`rios-r43`**: R 4.3 + Bioconductor 3.18（polyester用）
2. **`rios-env`**: その他のツール（HISAT2, samtools, DESeq2など）

なぜ環境を分けるのか？

polyesterはR 4.3が必要ですが、他のツールは異なるバージョンが必要な場合があります。環境を分けることで、ツール同士の競合を避けられます。

これは、**「料理ごとに別々の調理器具を使う」**ようなものです。和食を作る時と洋食を作る時で、使う包丁が違うように、解析の種類によって、使うツールのバージョンも変わるのです。

### biocondaという宝庫

さらに、condaには**bioconda**というチャンネルがあります。biocondaは、バイオインフォマティクス専用のパッケージ集で、多くのツールが用意されています。

HISAT2、samtools、DESeq2など、RNA-seq解析に必要なツールの多くが、biocondaから簡単にインストールできます。これにより、**「ツールを探して、コンパイルして、インストールする」**という面倒な作業を避けられます。

👉 **BioCondaの使い方を学ぶ**：
- [BioCondaでRNA-seq解析をやってみる（Qiita）](https://qiita.com/takeajioka/items/83959c7bae6e3b9d6339) - Biocondaのチャンネル追加から、RNA-seq解析向けツールのインストールまで
- [BioConda環境構築チュートリアル（note）](https://note.com/ozk7311/n/naa4c1862d909) - 仮想環境の作成・Biocondaチャンネルの追加・主要ツールのインストール等を丁寧に解説
- [bioconda GitHubドキュメント](https://bioconda.github.io/) - 各ツールのインストール例

---

## ディレクトリ構成の哲学

### 大容量データとの向き合い方

バイオインフォマティクス研究では、**大量のデータファイル**を扱います。

例えば、この研究では：
- ゲノムFASTAファイル：約1GB
- RNA-seqリード：約380Mリード（数十GB）
- アライメント結果：19サンプル分のBAMファイル

これらのデータを、どのように管理するかが重要です。

### ディレクトリ構成の設計思想

私たちは、以下のようなディレクトリ構成を採用しています：

- **`data/`**：大容量データの原本。複数プロジェクトで共有
- **`work/`**：プロジェクトの作業ディレクトリ。解析スクリプトや結果を保存
- **`scratch/`**：一時ファイル。削除しても問題ない

この構成により：
- **ファイルの場所が分かりやすくなる**：どこに何があるかが明確
- **大容量データを効率的に管理できる**：同じデータを複数コピーしない
- **複数プロジェクトでデータを共有できる**：ゲノムデータを1回だけダウンロード

👉 **実践的なディレクトリ設計例**：[RNA-seqデータ解析チュートリアル（GitHub）](https://github.com/quadbio/RNAseq_tutorial/blob/main/Tutorial.md) - プロジェクト構造例がMarkdownで整理されているため、ディレクトリ設計の参考になります

### シンボリックリンクという工夫

さらに、大容量データ（ゲノムFASTAなど）は、`data/`に1回だけ保存し、プロジェクトからは**シンボリックリンク**で参照します。

シンボリックリンクは、ファイルやディレクトリへの「ショートカット」のようなものです。実際のファイルは1つだけですが、複数の場所から参照できます。

これにより：
- **ディスク容量を節約できる**：同じファイルを複数コピーしない
- **複数プロジェクトで同じデータを共有できる**：ゲノムデータを1回だけダウンロード
- **データを更新すると、すべてのプロジェクトに反映される**：一箇所を更新すれば、すべてのプロジェクトに反映

これは、**「図書館の本を、複数の人が借りる」**ようなものです。本は1冊だけですが、複数の人が参照できます。

---

## 研究の舞台が整った

### 環境構築の意味

環境構築は、単なる「準備作業」ではありません。**研究の基盤を築く重要なステップ**です。

適切な環境構築により：
- **再現性**：同じ環境で同じ解析を実行すれば、同じ結果が得られる
- **信頼性**：ツールのバージョンを固定することで、予期しない動作を避けられる
- **効率性**：環境を分けることで、ツール同士の競合を避けられる

### 次のステップへ

環境が整ったら、次は**データを準備**します。

リオス科のゲノム解析には、リファレンスゲノムが必要です。私たちは、ニワトリ（Gallus gallus）のゲノムをバックボーンとして使用します。

「なぜニワトリなのか？」「ゲノムデータはどこから取得するのか？」「染色体リネームとは何か？」

次回は、これらの疑問に答えながら、ゲノムデータの世界を覗いてみましょう。

---

**関連記事**：
- [Qiita記事シリーズ：モンスターハンターの世界で学ぶバイオインフォマティクス](https://qiita.com/)（技術的な詳細はこちら）

---
