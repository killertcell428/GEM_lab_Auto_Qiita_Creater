# vol.3 空の王者にゲノムをプレゼントする：ニワトリから始める「架空生物のDNAづくり」入門

## はじめに

前回は、研究を始めるための環境構築についてお話ししました。  
今回はいよいよ、**「リオレウスのゲノムをどうやって用意するの？」**という、一番トンチキで一番ワクワクする話です。

まず大前提として、リオス科は架空の生物です。  
当然ですが、「リオレウス全ゲノム配列（ver.1.0）」なんてものは、どのデータベースにも登録されていません。

それでもRNA-seq解析をやりたい。  
そこで私たちは、**現実の生物のゲノムを「借りてくる」**という作戦に出ます。

この連載では、その「借りてくる相手」として、**ニワトリ（Gallus gallus）**を選びました。  
「なんで空を支配する飛竜のDNAが、あのニワトリなの？」  
──この問いに答えながら、ゲノムデータの世界を覗いてみましょう。

---

## そもそも、なんでリファレンスゲノムが要るの？

### RNA-seq解析って何をしているの？

RNA-seq解析はざっくり言うと、こんなことをしています。

> 「細かくバラバラにしたRNAのかけら（リード）が、  
>  もともとゲノムのどの場所にいたのかを逆算する」

そのために必要なのが、**リファレンスゲノム**です。  
リード単体では、「これはどの遺伝子出身なのか？」が分かりません。  
そこで、**「完成図（リファレンスゲノム）」と見比べる**ことで、どこのピースだったのかを推理します。

- ピース：RNA-seqで読んだ短い配列（リード）
- 完成図：リファレンスゲノム

完成図がないと、パズルは一生完成しません。  
これが、「RNA-seq解析にはリファレンスゲノムが必須です」と言われる理由です。

<!-- 図1挿入位置：RNA-seqリード（ピース）とリファレンスゲノム（完成図）の対応関係を示す図。「ジグソーパズルでリファレンスゲノムをイメージする」 -->

👉 **リファレンスゲノムとは？**  
[Reference genome — Wikipedia](https://en.wikipedia.org/wiki/Reference_genome)  
DNA配列と、その意味（遺伝子の場所や機能）をまとめた「標準版のゲノムデータ」です。

👉 **RNA-seq解析のざっくり全体像**  
[RNA-seq解析入門まとめ](https://hashiyuki.hatenablog.com/entry/2025/01/08/141941)

---

### 「バックボーンゲノム」という発想

「でも、リオレウスのゲノムなんて存在しないじゃん？」  
──ここで出てくるのが**バックボーンゲノム**という考え方です。

- **バックボーンゲノム**  
  : 架空種のゲノムの「骨組み」として借りてくる、現実の生物のゲノム

リオス科の特徴（飛翔能力、性染色体、形態など）にいちばん近そうな生物を探し、  
そのゲノムを**「リオス科の身体設計図の代役」**として使う。  
これが今回の作戦です。

<!-- 図2挿入位置：現実世界の系統樹の一部からリオス科に矢印を伸ばし、「バックボーンとしてニワトリを借りてくる」イメージ図 -->

---

## なぜニワトリなのか？

### リオス科と鳥類の接点を探す

リオス科は「飛竜種」という設定です。  
現実世界で、これに近い存在を探すと、おおまかに次のようになります。

- **鳥類**：飛翔能力、性染色体（ZW型）、派手な性差
- **爬虫類**：体の長さや尾の多様性、骨格の雰囲気

このあたりを総合すると、「鳥類のゲノムを軸にするのが自然そうだな」という感触が出てきます。

---

### ニワトリゲノムを選んだ4つの理由

ではなぜ、数多の鳥の中から、あえてニワトリなのか？

1. **鳥類の“代表選手”だから**  
   ニワトリは、飛べる鳥たちの遺伝子セットをちゃんと持っている、  
   「鳥類研究のド定番キャラ」です。  
   空の王者リオレウスの飛行能力を考えるうえで、良いスタート地点になります。

2. **ゲノム品質が高いから（GRCg7b）**  
   RNA-seq解析では、**アノテーション**（遺伝子がどこにあって何をしているかのメモ帳）が重要です。  
   ニワトリゲノム（GRCg7b）は、EnsemblやNCBIで**かなり丁寧に整備された“きれいな版”**が用意されています。

3. **性染色体がリオス科設定と相性が良いから**  
   ニワトリは、ヒトとは逆で、**ZW型の性染色体**を持っています。  
   「オス＝ZZ、メス＝ZW」という世界観は、リオス科の設定とも相性がいい。

4. **比較ゲノム学の“ハブ”として使いやすいから**  
   ニワトリは、他の鳥類・爬虫類との比較研究でもよく使われています。  
   将来、「リオス科 vs 他の鳥 or 爬虫類」みたいな遊びをしたくなったときも、  
   すでにあるデータをフル活用しやすいのです。

<!-- 図3挿入位置：「なぜニワトリなのか？」4つの理由を整理したスライド風図。中央にニワトリ、周囲に「代表選手」「高品質ゲノム」「ZW性染色体」「比較ゲノムのハブ」を配置 -->

---

### ゲノムを選ぶことの、ちょっと深い意味

ゲノム選びは、単なる「とりあえずどれかダウンロードしとくか」ではありません。  
**「どの生物の設計図を借りるか」が、研究（あるいは妄想）の方向性を決める**重要な選択です。

ニワトリを選んだことで：

- 鳥類らしい特徴（飛翔、性染色体など）をきちんと反映できる  
- 高品質なアノテーションに甘えられる  
- 将来の比較解析の遊び場が広がる  

──そんなメリットがついてきます。

---

## Ensemblという巨大な「ゲノム図書館」

### ゲノムデータベースの世界へ

じゃあ、そのニワトリゲノムはどこから持ってくるのか？  
答えは、**Ensembl**や**NCBI**といった巨大データベースです。

Ensemblは、100種以上の生物のゲノムデータを配布している、  
**「DNA版・国会図書館」**のような存在です。  
年に2〜3回のペースでアップデートされ、最新のゲノム配列とアノテーションが整備されています。

<!-- 図4挿入位置：Ensemblトップページの模式図。「生物選択 → Gallus gallus → ダウンロード」の3ステップを矢印で示したフローチャート -->

👉 **Ensemblの使い方をざっくり眺める**  
- [Ensembl公式チュートリアル & ドキュメント](https://www.ensembl.org/info/website/tutorials/index.html)  
- [Ensemblデータエクスポート（FASTA / GTFの取得方法）](https://www.ensembl.org/info/data/export.html)  
- [Gallus gallus（ニワトリ）のEnsemblページ](https://www.ensembl.org/Gallus_gallus/Info/Index)

👉 **NCBIからゲノムを取る時の道案内**  
- [NCBI Datasetsのゲノムデータ取得ガイド](https://www.ncbi.nlm.nih.gov/datasets/docs/v2/how-tos/genomes/download-genome/)  
- [NCBI Assembly Page (Gallus gallus)](https://www.ncbi.nlm.nih.gov/assembly/1668981)

---

### FASTAとGTF：ゲノムの「地図」と「住所録」

ゲノムデータは主に2種類のファイルで配られています。

1. **FASTAファイル**：ゲノム配列そのもの  
   - A/C/G/Tがずらっと並んだ、DNAの「生データ」  
   - `>`で始まるヘッダー行と、その下に続く配列行で構成  
   - サイズはだいたい1GB前後

2. **GTFファイル**：遺伝子アノテーション  
   - 遺伝子の位置、エクソン、イントロンなどの情報を表形式で記録  
   - 9列のタブ区切りテキスト  
   - サイズはだいたい100MB前後

ざっくりたとえると：

- **FASTA**：世界地図（どこに何があるかはまだ書いてない）  
- **GTF**：住所録（どの座標にどの遺伝子が住んでいるか）

どちらか片方だけでは不便で、**両方そろってはじめて、本格的な解析ができる**ようになります。

<!-- 図5挿入位置：FASTAとGTFの役割対比図。左に「世界地図＝FASTA」、右に「住所録＝GTF」、下に「RNA-seq解析パイプラインでの使われ方」を矢印で表示 -->

👉 **ファイル形式をもう少しちゃんと知りたい人向け**  
- FASTA形式：[NCBI FASTA形式の説明](https://www.ncbi.nlm.nih.gov/genbank/fastaformat/)  
- GTF/GFF形式：[UCSC GTF形式の説明](https://genome.ucsc.edu/FAQ/FAQformat.html#format4)  
- 参考チュートリアル：[Reference Genomes & File Formats（RNA-seqチュートリアル）](https://rnabio.org/module-01-inputs/0001/02/01/Reference_Genomes/)

---

### 「ダウンロードして終わり」ではない、舞台裏の工夫

「URLをクリックして保存するだけでしょ？」  
──と思いきや、大容量のゲノムデータのダウンロードには、地味に落とし穴があります。

- **リリースごとに微妙に変わるファイル名**  
- **1GB級のダウンロードが途中で切れるネットワーク問題**  
- **数か月後に“全く同じデータ”を取り直したいときの再現性**

こういった問題を避けるために、この連載では**スクリプトで自動ダウンロードする仕組み**を作りました。  
複数の候補URLを順番に試したり、途中で失敗したらリトライしたり──  
「地味だけど、ないと詰む」系の工夫を裏でやっています。

<!-- 図6挿入位置：自動ダウンロードスクリプトのフローチャート。「候補URLリスト → ダウンロード試行 → 失敗時リトライ → 成功で保存 → ログ記録」の流れを示す図 -->

---

### ゲノムブラウザで“眺めて”みる

数字や文字列だけ眺めてもピンとこないときに便利なのが、**ゲノムブラウザ**です。  
これは、ゲノム配列と遺伝子の位置関係を、地図のように眺められるWebツールです。

- どの染色体のどのあたりに、その遺伝子がいるのか  
- エクソン・イントロンの構造はどうなっているのか  

──といった情報を、視覚的に追いかけられます。

<!-- 図7挿入位置：ゲノムブラウザ画面の模式図。上に染色体スケールバー、下にエクソン・イントロン構造、さらにRNA-seqカバレッジトラックを重ねたイメージ -->

👉 **ゲノムブラウザの代表例**  
[UCSC Genome Browser — Wikipedia](https://en.wikipedia.org/wiki/UCSC_Genome_Browser)

---

## 染色体をリネームするという儀式

### ニワトリを「リオス科」に仕立てる小さな魔法

ここからが、今回の「妄想と技術の境界線」的なポイントです。  
ニワトリのゲノムをそのまま「はい、リオレウスのゲノムです」と名乗らせるのは、さすがに気が引けます。

そこで私たちは、**染色体名をリネームする**という小さな儀式を行います。

- `chr1` → `Rios1`  
- `chr2` → `Rios2`  
- `chrZ` → `RiosZ`  
- `chrW` → `RiosW`

<!-- 図8挿入位置：染色体名のビフォーアフター表。「Gallus gallus（chr1, chr2, chrZ, chrW）」から「Rios科（Rios1, Rios2, RiosZ, RiosW）」への変換を示す図 -->

名前を変えたからといって、中身のDNA配列は同じです。  
でも、この一手間にはいくつか意味があります。

1. **「架空種のゲノム」として扱いやすくするため**  
   結果ファイルを見たときに、「あ、これはリオス科のデータだな」とすぐ分かります。

2. **解析ツールでの一貫性を保つため**  
   STAR, HISAT2, featureCountsなど、多くのツールは染色体名を前提に動きます。  
   ここで名前を揃えておくと、後の解析で迷子になりにくくなります。

3. **「ニワトリ」と「リオス科」を頭の中でちゃんと分けるため**  
   将来的に、「リオス科 vs ニワトリ本家」の比較をしたいとき、  
   染色体名が違っていると、混乱が減ります。

---

### リネームにこめたちょっとした哲学

この染色体リネーム、やっていることは単なる「文字列置換」です。  
でも、その裏には、

> 現実の生物のゲノムを、架空種のゲノムとして“再解釈”する

という、少し哲学っぽい考えが隠れています。

ニワトリのゲノムを「リオス科のゲノム」として扱うことで、  
**「もしリオス科が実在したら、どんなゲノムを持っていそうか？」**  
を、現実のデータ上でシミュレーションできるようになる。

<!-- 図9挿入位置：「現実のニワトリゲノム」から「架空のリオス科世界」へ橋をかけるイラスト。左に現実のニワトリ、右にリオス科シルエット、間をゲノム配列の橋がつなぐイメージ -->

空想とバイオインフォマティクスの境界線を、  
そっとまたいでみるための小さなステップが、このリネーム作業です。

---

## これで、空想生物に“DNA”が入った

### ゲノムデータの準備完了

ここまでのステップで、ようやくリオス科のための「土台」が整いました。

- **ゲノムFASTAファイル**：約1GB、50本前後の染色体  
- **GTFファイル**：約100MB、遺伝子アノテーション  
- **シンボリックリンク**：プロジェクトからゲノムファイルへアクセスするための窓口

これで、ようやくRNA-seq解析に進むスタートラインに立てます。  
リオス科という空想生物に、**「とりあえず動きそうなDNA」**を流し込んだ状態です。

<!-- 図10挿入位置：本記事のまとめパイプライン図。「Ensembl/NCBI → FASTA/GTF取得 → 染色体リネーム → プロジェクトへのリンク作成 → RNA-seq解析準備完了」の流れを1枚にした図 -->

---

### 次回：リオス科に「発現パターン」を与える

ゲノムが用意できたら、いよいよ次は**シミュレーション**です。

- リオス科を象徴する14遺伝子を選ぶ
- 「オスはこう、メスはこう」という発現パターン（実験デザイン）を考える
- `polyester`というツールを使って、仮想のRNA-seqリードを生成する

「なぜ14遺伝子だけなのか？」  
「発現パターンって、どうやって決めるの？」  
「polyesterって、何者？」

次回はこれらの疑問に答えつつ、  
**「空想生物の遺伝子発現を、コンピュータの中で作曲する」**プロセスを一緒に覗いていきます。