# vol.4 14遺伝子の物語：仮想のRNA-seqデータを生み出す

## はじめに

前回は、ニワトリのゲノムをバックボーンとして取得し、染色体リネームを行いました。今回は、**RNA-seqシミュレーション**について、その理論的背景と面白さを紹介します。

RNA-seq解析を学ぶには、実際のデータが必要です。しかし、実験データを取得するのは時間とコストがかかります。そこで、私たちは**polyester**というツールを使って、仮想的なRNA-seqリードを生成します。

「シミュレーションって、現実のデータと違うのでは？」と思われるかもしれません。しかし、シミュレーションデータには、**「原因が分かっているデータ」**という大きな利点があります。

---

## なぜシミュレーションなのか？

### 実験データの課題

実際のRNA-seqデータを取得するには、様々な課題があります：

- **時間とコスト**：サンプルの採取、RNA抽出、シーケンシングまで、数週間〜数ヶ月かかる
- **再現性の問題**：実験条件が少し変わるだけで、結果が大きく変わる可能性がある
- **「なぜこの結果が出たのか」が不明**：実際のデータでは、原因が分からないことが多い

👉 **RNA-seq解析の基礎を学ぶ**：[RNA-seq解析入門まとめ](https://hashiyuki.hatenablog.com/entry/2025/01/08/141941) - RNA-seqの基礎・手法・各ステップがまとまっています
👉 **RNA-seqシミュレーションが研究でどう使われているか**：[Power analysis & simulation in RNA-seq](https://bioconductor.org/help/course-materials/2016/CSAMA/lab-05-simulation.html) - ベンチマークや手法検証でのシミュレーション利用例
👉 **なぜRNA-seqをシミュレートするのか？**：[Why simulate RNA-seq data?](https://academic.oup.com/bioinformatics/article/31/12/1838/219637) - ベンチマーク・教育・手法検証の観点から整理した解説

### シミュレーションデータの利点

一方、シミュレーションデータには、以下の利点があります：

1. **仮説を先に設計できる**：「オスで翼遺伝子が2倍高発現」などの仮説を、先に設計できます

2. **原因が分かっている**：データを生成した時点で、原因（発現量の差）が分かっています

3. **再現性が高い**：同じパラメータで実行すれば、同じ結果が得られます

4. **学習ツールとして優秀**：「仮説→データ生成→解析→検証」の一連の流れを体験できます

### シミュレーションの哲学的意味

シミュレーションは、単なる「データの生成」ではありません。**「もしこの仮説が正しければ、データはどう見えるか」を予測し、実際にデータを生成して検証する**という、科学的方法論の実践です。

これは、実際の生物学研究でも使われる手法です。例えば、**「もしこの遺伝子がこのように変化したら、どのような表現型になるか」**を予測する研究が行われています。私たちの研究は、その手法を、ゲームの世界に適用したものです。

👉 **「仮想実験は科学なのか？」を考えたい人向け**：[In silico experiments in biology](https://www.nature.com/articles/nrg.2016.30) - シミュレーションと実験の関係を論じたレビュー

<!-- 図1挿入位置：仮説 → 発現マトリクス設計 → polyester 実行 → RNA-seqリード生成 までの流れを1枚にしたフロー図。上から下への矢印で「仮想実験の全体像」が伝わる構成。 -->

---

## 14遺伝子の選定

### なぜ14遺伝子だけなのか？

この研究では、**14遺伝子のみ**を対象としています。これは、以下の理由からです：

1. **学習目的**：解析手法を理解するため、少数の遺伝子で十分
2. **計算リソース**：メモリとディスク容量を節約
3. **仮説検証**：性差・組織差の主要遺伝子に焦点を当てる

実際のRNA-seq解析では、通常数万〜数十万の遺伝子を対象とします。しかし、学習目的では、少数の遺伝子で十分です。手法を理解した後、全遺伝子に適用できます。

### 選定した遺伝子とその物語

14遺伝子は、それぞれが**リオス科の形態形成の物語**を語っています：

**翼形成遺伝子群（RiosWingBMP1, RiosWingBMP2）**
- 役割：翼基部軟骨形成
- 性差の想定：オスで高発現
- 物語：リオレウス（オス）の大きな翼を支える遺伝子

**尾棘形成遺伝子群（RiosTailSpine1, RiosTailSpine2）**
- 役割：尾棘形成
- 性差の想定：メスで高発現
- 物語：リオレイア（メス）の鋭い尾棘を生み出す遺伝子

**毒腺遺伝子群（RiosToxinA1, RiosToxinA2）**
- 役割：毒腺分泌タンパク質
- 性差の想定：メス特異的
- 物語：リオレイア（メス）の毒腺を機能させる遺伝子

**体軸パターン遺伝子群（HoxRiosA9, HoxRiosC6）**
- 役割：体軸パターン形成
- 性差の想定：オスは前方シフト、メスは後方シフト
- 物語：リオス科の体軸を決定する、進化的に重要な遺伝子

**軟骨・骨格遺伝子群（Sox9Rios, Runx2Rios）**
- 役割：軟骨・骨格形成
- 性差の想定：組織特異的（翼/尾）
- 物語：リオス科の骨格を形成する、マスター遺伝子

**色素・模様遺伝子群（MC1R-Rios, ASIP-Rios, EDNRB-Rios）**
- 役割：色素・模様形成
- 性差の想定：亜種差
- 物語：リオス科の多様な模様を生み出す遺伝子

**ハウスキーピング遺伝子（ACTB_Rios）**
- 役割：アクチン（正規化用）
- 性差の想定：発現一定
- 物語：すべての細胞で一定に発現する、基準となる遺伝子

<!-- 図2挿入位置：14遺伝子を「翼」「尾棘」「毒腺」「体軸」「骨格」「色素」「ハウスキーピング」のカテゴリごとに並べた一覧図。カテゴリごとに色分けし、リオス科のどの特徴と対応しているかをアイコンで示す。 -->

### 遺伝子選定の理論的背景

これらの遺伝子は、現実の生物学でも重要な役割を果たしています：

- **Hox遺伝子**：脊椎動物の体軸パターンを決定する遺伝子群。ヘビの体が長いのは、Hox遺伝子の発現ドメインが変化したためと考えられています。

- **BMP/Wnt系**：軟骨・骨格形成に関与。現実の生物でも、これらの遺伝子が形態形成に重要な役割を果たしています。

- **Sox9/Runx2**：軟骨・骨格形成のマスター遺伝子。これらの遺伝子が変異すると、骨格の形成に異常が生じます。

つまり、私たちが選んだ14遺伝子は、**現実の生物学の理論に基づいて選ばれた、意味のある遺伝子**なのです。

👉 **Hox遺伝子とは何か？**：[Hox genes and body plan evolution](https://www.nature.com/scitable/topicpage/hox-genes-and-body-plan-evolution-862/) - 体軸と進化の基礎を図付きで解説  
👉 **骨・軟骨形成におけるBMPシグナル**：[BMP signaling in skeletal development](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6361621/)  
👉 **Sox9 / Runx2と骨格形成**：[Sox9 and Runx2 in chondrogenesis & osteogenesis](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3947233/)  
👉 **色・模様の遺伝学の総覧**：[Genetics of pigmentation](https://www.nature.com/scitable/topicpage/genetics-of-pigmentation-1076/) - MC1R / ASIP / EDNRBなどの役割を整理

---

## 実験デザインの考え方

### 19サンプルで何を検証するか

この研究では、**19サンプル**を設計しました。なぜ19サンプルなのか？

RNA-seq解析では、統計的に意味のある差を検出するために、**複数のサンプル（replicate）**が必要です。通常、各条件につき3-5サンプルが必要ですが、この研究では学習目的のため、一部の条件でサンプル数を減らしています。

### 実験デザインの理論的背景

19サンプルを設計した理由は、以下の仮説を検証するためです：

1. **性差検出**：M vs F（例：M_Wing vs F_Wing）
   - オスとメスで発現量に差があるか？

2. **組織差検出**：wing_base vs tail_spine vs toxin_gland
   - 組織によって発現量が異なるか？

3. **交互作用**：Sex × Tissue（例：オスの翼 vs メスの翼）
   - 性別による発現差が組織によって異なるか？

4. **亜種差**：volcanicus（翼強化）、sylvestris（毒腺強化）、marina（尾棘強化）
   - 亜種によって発現量が異なるか？

これにより、**「設定通りの性差・組織差が統計的に検出できるか」**を検証できます。

👉 **RNA-seq実験デザインの基礎**：[Experimental design for RNA-seq](https://hbctraining.github.io/DGE_workshop/lessons/experimental_design.html) - replicateや交互作用を初心者向けに解説   
👉 **DESeq2のデザイン式の考え方（次回の伏線）**：[DESeq2 design formula explained](https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#experimental-design)

<!-- 図3挿入位置：19サンプル（性別×組織×亜種）をマトリクス状に配置した実験デザイン図。行にサンプルID、列に Sex / Tissue / Subspecies をとり、「どの条件を何サンプル取っているか」が一目で分かるようにする。 -->

### 発現マトリクスの設計

実験デザインに基づいて、**発現マトリクス**を設計します。

発現マトリクスは、**各遺伝子が各サンプルでどれだけ発現しているか**を表す表です。polyesterは、このマトリクスに基づいてリードを生成します。

例えば：
- **RiosWingBMP1**：オス翼で500-520（高発現）、メス翼で60-70（低発現）
- **RiosToxinA1**：メス毒腺で500-540（高発現）、オス毒腺で30-35（低発現）

このように、**「設計通りの発現パターン」**を先に定義し、そのパターンに基づいてデータを生成します。

👉 **カウントマトリクスとは何か？**：[Count matrices explained](https://hbctraining.github.io/Intro-to-rnaseq/lessons/03_countmatrices.html) - genes × samples の表が何を意味するかを丁寧に解説

<!-- 図4挿入位置：行＝遺伝子、列＝サンプルの発現マトリクスを簡易なヒートマップ風に示した図。RiosWingBMP1 など一部遺伝子に濃い色が集中する様子を描き、「設計した発現パターン」が視覚的に伝わる構成。 -->

---

## polyesterという魔法のツール

### 発現量からリードを生成する

**polyester**は、R/Bioconductorパッケージで、**発現マトリクスからRNA-seqリードを生成**するツールです。

polyesterを使うことで：
- **発現量を直接指定できる**：TPMやfold changeを明示的に設定可能
- **ペアエンド対応**：現実のRNA-seqデータに近い形式
- **再現性**：乱数種を設定することで、同じ結果を再現できる

### なぜpolyesterを使うのか？

RNA-seqリードのシミュレーションツールは、いくつか存在します。しかし、polyesterを選んだ理由は：

1. **R/Bioconductor統合**：DESeq2/edgeRと同じ環境で使える
2. **発現量を直接指定できる**：TPMやfold changeを明示的に設定可能
3. **ペアエンド対応**：現実のRNA-seqデータに近い形式
4. **再現性**：乱数種を設定することで、同じ結果を再現できる

👉 **polyester公式ドキュメント**：[polyester Bioconductor vignette](https://bioconductor.org/packages/release/bioc/vignettes/polyester/inst/doc/polyester.html) - 発現量指定やfold change、乱数種などの詳細   
👉 **polyesterの背景論文**：[polyester: Simulating RNA-seq datasets with differential transcript expression](https://academic.oup.com/bioinformatics/article/31/17/2778/183378)

### 約380Mリードが生まれた

polyesterを実行すると、**約380Mリード**が生成されます。

**実際の生成結果**：
- **総リード数**：約380Mリード（約3.8億リード）
- **サンプル数**：19サンプル
- **サンプルあたりリード数**：約1000万リード（範囲：9,976,612 - 10,016,044リード）

これは、19サンプル×14遺伝子×約1000万リード/サンプルという規模です。実際のRNA-seq解析でも、この程度のリード数は一般的です。

生成されたリードは、FASTA形式で出力されます。ただし、多くのアライメントツールはFASTQ形式を要求するため、後で変換が必要です。

---

## 約380Mリードが生まれた

### シミュレーションデータの完成

polyesterの実行が完了すると、**約380Mリード**のRNA-seqデータが生成されます。

これは、19サンプル×14遺伝子×約5Mリード/サンプルという規模です。実際のRNA-seq解析でも、この程度のリード数は一般的です。

### 設計通りのデータが生成された

生成されたリードは、**設計通りの発現パターン**を反映しています。

例えば：
- オス翼サンプルでは、RiosWingBMP1が高発現
- メス毒腺サンプルでは、RiosToxinA1が高発現
- 全サンプルで、ACTB_Riosが一定に発現

**後続の解析で確認された結果**：

次回以降の記事（vol.5-7）で詳しく解説しますが、実際にアライメント・統計解析・可視化を行った結果、以下のことが確認されました：

- **アライメント**：マッピング率99.99%（全19サンプルで一貫）
- **統計解析**：RiosWingBMP1がオスで約2倍高発現（log₂FC = +1.02, padj = 0.045）、RiosToxinA1/A2がメスで約2倍高発現（log₂FC = -1.00, padj = 0.020）
- **可視化**：火山図・ヒートマップ・PCAで設計通りのパターンが確認

これにより、**「もしリオス科が実在したら、このような発現パターンになる」**という仮説を、データとして検証できます。次回以降で、これらの解析結果を詳しく見ていきましょう。

### 次のステップへ

リードが生成されたら、次は**アライメント**を始めます。

アライメントは、**リード配列をリファレンス配列（トランスクリプト）にマッピングする**処理です。これにより、各リードがどの遺伝子から来たのかを特定できます。

「アライメントとは何か？」「なぜマッピング率が99.99%なのか？」「リードカウントとは何か？」

次回は、これらの疑問に答えながら、RNA-seq解析の核心であるアライメントとカウントの過程を覗いてみましょう。