# vol.7 データを視覚化する：グラフが語る発現パターン

## はじめに

前回は、DESeq2による統計解析についてお話ししました。今回は、**可視化**について、その重要性と意味を深掘りしてみましょう。

統計解析の結果は、数値だけで理解するのは困難です。**グラフで可視化**することで、データの特徴を一目で把握できます。

「火山図とは何か？」「ヒートマップとは何か？」「PCAとは何か？」

これらの疑問に答えながら、データを視覚化する過程を覗いてみましょう。

---

## なぜ可視化が必要なのか？

### 数値だけでは分からないこと

統計解析の結果は、数値の羅列です。例えば：

- RiosWingBMP1：log2FC = +1.02, padj = 0.045
- RiosToxinA1：log2FC = -1.00, padj = 0.020
- RiosToxinA2：log2FC = -0.97, padj = 0.014

これらの数値を見ても、**データの全体像**は見えてきません。

<!-- 図1挿入位置：左に数値だけが並んだテーブル、右に同じ情報を火山図・ヒートマップ・PCAで表現したイメージを小さく並べ、「可視化によって全体像が一気に見えるようになる」ことを対比する図。 -->

### 可視化の利点

グラフで可視化することで：

1. **データの分布**：どの遺伝子がどのような発現パターンを示すか
2. **サンプル間の関係性**：どのサンプルが似ているか
3. **異常値（外れ値）**：予期しないパターンがないか
4. **パターンや傾向**：データに隠されたパターンを発見

これらは、数値だけでは見えてきません。

👉 **RNA-seq解析の基礎を学ぶ**：[RNA-seq解析入門まとめ](https://hashiyuki.hatenablog.com/entry/2025/01/08/141941) - RNA-seqの基礎・手法・各ステップがまとまっています

### 可視化の哲学的意味

可視化は、単なる「グラフの作成」ではありません。**「データを理解するための手段」**です。

人間の脳は、視覚的な情報を処理するのが得意です。グラフを見ることで、**「直感的にデータを理解できる」**のです。

---

## 火山図：発現変動の大きさと統計的有意性を一目で

### 火山図とは？

**火山図**は、**発現変動の大きさ（log2FC）と統計的有意性（-log10(pvalue)）**を同時に可視化するグラフです。

火山図の特徴は、**形が火山に似ている**ことです。多くの遺伝子が中央（非有意）に集まり、少数の遺伝子が上部（有意）に分布します。

### 火山図の読み方

火山図では：

- **X軸**：log2FoldChange（発現変動の大きさ）
- **Y軸**：-log10(pvalue)（統計的有意性）
- **点**：各遺伝子

**有意領域の判定**：
- **右上領域**：オスで高発現かつ有意
- **左上領域**：メスで高発現かつ有意
- **中央領域**：発現差がない、または非有意

<!-- 図2挿入位置：典型的な火山図のイメージ図。X軸・Y軸ラベルとともに、右上・左上・中央の領域を色分けし、「オス高発現」「メス高発現」「非有意」のラベルを付けた解説図。 -->

### この研究での結果

この研究では、以下の結果が得られました：

- **RiosWingBMP1**：右上領域（オスで高発現かつ有意）
- **RiosToxinA1/A2**：左上領域（メスで高発現かつ有意）

**実際の火山図**：

![火山図：性差（M vs F）](data/drafts/docs/plots/volcano_sex_M_vs_F.png)

実際の火山図を見ると、14遺伝子の位置関係が明確に分かります：

- **RiosWingBMP1**：右上象限に位置（log₂FC = +1.02, -log₁₀(p-value) ≈ 2.0）
- **RiosToxinA1**：左上象限に位置（log₂FC = -1.00, -log₁₀(p-value) ≈ 2.6）
- **RiosToxinA2**：左上象限に位置（log₂FC = -0.97, -log₁₀(p-value) ≈ 3.0、最も高い有意性）
- **その他の遺伝子**：中央付近に集まり、非有意または境界付近

火山図を見ることで、**「どの遺伝子が、どの程度の差で、統計的に有意なのか」**を一目で把握できます。

---

## ヒートマップ：遺伝子×サンプルの発現パターン

### ヒートマップとは？

**ヒートマップ**は、**遺伝子×サンプルの発現パターン**を色で可視化するグラフです。

ヒートマップの特徴は、**表形式のデータを色で表現**することです。これにより、パターンが一目で分かります。

### ヒートマップの読み方

ヒートマップでは：

- **行**：遺伝子
- **列**：サンプル
- **色**：発現量（青=低発現、白=中央値、赤=高発現）

**カラースケール**：
- **青**：その遺伝子の平均発現量より低い
- **白**：その遺伝子の平均発現量
- **赤**：その遺伝子の平均発現量より高い

<!-- 図3挿入位置：行にいくつかの代表遺伝子、列にサンプルを並べた簡易ヒートマップ図。左側に「RiosWingBMP1/2」「RiosToxinA1/2」などを配置し、特定条件で赤く光るセルが固まる様子を描く。 -->

### この研究での結果

この研究では、以下のパターンが確認できました：

- **RiosWingBMP1/2**：オス翼サンプル（M_Wing_*）で赤色（高発現）
- **RiosToxinA1/2**：メス毒腺サンプル（F_Toxin_*）で赤色（高発現）
- **RiosTailSpine1/2**：メス尾棘サンプル（F_Tail_*）で赤色（高発現）

**実際のヒートマップ**：

![遺伝子発現ヒートマップ](data/drafts/docs/plots/heatmap_all_genes.png)

実際のヒートマップを見ると、19サンプル×14遺伝子の発現パターンが一目で分かります：

**主要なパターン**：
- **WingBMP遺伝子群**（RiosWingBMP1, RiosWingBMP2）：
  - オス翼サンプル（M_Wing_1, M_Wing_2, M_Wing_3, M_Wing_volc_1）で明るい赤色（高発現）
  - メス翼サンプル（F_Wing_1, F_Wing_2）では青色（低発現）
  
- **Toxin遺伝子群**（RiosToxinA1, RiosToxinA2）：
  - メス毒腺サンプル（F_Toxin_1, F_Toxin_2, F_Toxin_sylv_1）で明るい赤色（高発現）
  - オスサンプルでは青色（低発現）
  
- **TailSpine遺伝子群**（RiosTailSpine1, RiosTailSpine2）：
  - メス尾棘サンプル（F_Tail_1, F_Tail_2, F_Tail_marina_1）で明るい赤色（高発現）
  - オス尾棘サンプル（M_Tail_1）では青色（低発現）

- **ACTB_Rios**（ハウスキーピング遺伝子）：
  - 全サンプルで白色（平均発現量）、一貫した発現パターン

ヒートマップを見ることで、**「どの遺伝子が、どのサンプルで高発現しているか」**を一目で把握できます。

---

## PCA：サンプル間の関係性を2次元に圧縮

### PCAとは？

**PCA（主成分分析）**は、**サンプル間の関係性**を可視化する手法です。

14遺伝子×19サンプルのデータは14次元です。14次元のデータを直接可視化することはできません。PCAにより、**2-3次元に圧縮**して可視化できます。

### PCAの原理

PCAは、**データの変動が大きい方向（主成分）を見つける**手法です。

- **第1主成分（PC1）**：最も大きな変動を説明する軸
- **第2主成分（PC2）**：2番目に大きな変動を説明する軸

**寄与率**：各PCが全体の変動の何%を説明するか

<!-- 図4挿入位置：PC1–PC2 平面上にサンプル点をプロットしたPCAの例図。色や形で「組織」「性別」を区別し、PC1が組織差、PC2が性差を主に表していることを矢印と注釈で示す。 -->

### PCAの読み方

PCAプロットでは：

- **近いサンプル**：発現パターンが似ている
- **遠いサンプル**：発現パターンが異なる
- **グループ化**：組織や性別でグループ化されることが多い

### この研究での結果

この研究では、以下の結果が得られました：

- **PC1の寄与率**：約60-70%（組織差を主に説明）
- **PC2の寄与率**：約20-30%（性差を主に説明）

**実際のPCAプロット**：

![主成分分析（PCA）プロット](data/drafts/docs/plots/pca_plot.png)

実際のPCAプロットを見ると、19サンプルの位置関係が明確に分かります。以下は主要なサンプルの実際の座標値です：

**PC1（組織差を主に説明、約60-70%の変動）**：
- **尾棘サンプル**：PC1が正の値（右側）
  - F_Tail_1: PC1 = 4.98, PC2 = -2.69
  - F_Tail_2: PC1 = 4.57, PC2 = -2.39
  - M_Tail_1: PC1 = 1.40, PC2 = -0.19
  
- **毒腺サンプル**：PC1が負の値（左側）
  - F_Toxin_1: PC1 = -3.42, PC2 = -1.30
  - F_Toxin_2: PC1 = -3.26, PC2 = -1.21
  
- **翼サンプル**：PC1が0付近（中央）
  - M_Wing_1: PC1 = 0.95, PC2 = 3.55
  - M_Wing_2: PC1 = 0.90, PC2 = 3.40
  - F_Wing_1: PC1 = -0.12, PC2 = 0.12

**PC2（性差を主に説明、約20-30%の変動）**：
- **オス翼サンプル**：PC2が正の値（上側）
  - M_Wing_1: PC2 = 3.55
  - M_Wing_2: PC2 = 3.40
  - M_Wing_3: PC2 = 3.68
  
- **メス尾棘・毒腺サンプル**：PC2が負の値（下側）
  - F_Tail_1: PC2 = -2.69
  - F_Toxin_1: PC2 = -1.30

**解釈**：
- **PC1（横軸）**：組織による発現差が最も大きく、尾棘（右）と毒腺（左）が明確に分離
- **PC2（縦軸）**：性別による発現差が二次的要因として確認でき、オス翼サンプル（上）とメス尾棘・毒腺サンプル（下）が分離

PCAプロットを見ることで、**「組織による発現差が最も大きく、性別による発現差も確認できる」**ことが分かります。

---

## グラフが語る物語

### 可視化の意味

可視化は、単なる「グラフの作成」ではありません。**「データが語る物語を視覚的に理解する」**ための手段です。

火山図、ヒートマップ、PCAの3つのグラフを見ることで：

1. **火山図**：どの遺伝子が統計的に有意な差を示すか
2. **ヒートマップ**：どの遺伝子がどのサンプルで高発現しているか
3. **PCA**：サンプル間の関係性はどうなっているか

これらの情報を統合することで、**「リオス科の性差・組織差の全体像」**が見えてきます。

### 設計通りの結果が可視化された

可視化の結果を見ると、**設計通りの発現パターン**が確認できます。

- オス翼サンプルでは、RiosWingBMP1が高発現
- メス毒腺サンプルでは、RiosToxinA1が高発現
- 組織による発現差が最も大きく、性別による発現差も確認できる

これにより、**「もしリオス科が実在したら、このような発現パターンになる」**という仮説が、視覚的にも検証されたのです。

### 次のステップへ

可視化が完了したら、次は**CNV解析**を始めます。

CNV解析は、**「コピー数変動が形態差を生み出す」**という仮説を検証する重要なステップです。

「CNVとは何か？」「遺伝子量効果とは何か？」「期待値と検出値の比較とは何か？」

次回は、これらの疑問に答えながら、コピー数変動の謎を解く過程を覗いてみましょう。
